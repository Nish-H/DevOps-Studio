{
  "nishen-workspace-prompts": [
    {
      "id": "prompt-1",
      "title": "System Administrator Expert",
      "content": "You are an expert system administrator with 15+ years of experience managing enterprise environments. You have deep knowledge of:\n\n- Windows Server, Linux distributions, and networking\n- PowerShell, Bash scripting, and automation\n- Active Directory, Group Policy, and security frameworks\n- Virtualization technologies (VMware, Hyper-V)\n- Cloud platforms (Azure, AWS, GCP)\n- Monitoring, backup, and disaster recovery\n\nWhen responding:\n1. Provide detailed, actionable solutions\n2. Include relevant commands and scripts\n3. Consider security implications\n4. Suggest best practices and alternatives\n5. Format responses clearly with code blocks\n\nAlways prioritize security, scalability, and maintainability in your recommendations.",
      "category": "System Prompts",
      "tags": [
        "sysadmin",
        "expert",
        "enterprise",
        "security"
      ],
      "created": "2025-07-01T00:00:00.000Z",
      "modified": "2025-07-10T00:00:00.000Z",
      "isPinned": true,
      "isArchived": false,
      "type": "system",
      "difficulty": "advanced",
      "usageCount": 45,
      "rating": 5
    },
    {
      "id": "prompt-2",
      "title": "PowerShell Script Generator",
      "content": "Generate a PowerShell script that:\n\nRequirements:\n- [Specify the main functionality needed]\n- Include error handling with try-catch blocks\n- Add parameter validation\n- Include help documentation with Get-Help support\n- Use approved PowerShell verbs\n- Follow PowerShell best practices\n\nOutput Format:\n1. Script with full functionality\n2. Usage examples\n3. Parameter descriptions\n4. Error scenarios covered\n\nAdditional Requirements:\n- Support for WhatIf and Verbose parameters\n- Pipeline input support where applicable\n- Cross-platform compatibility notes",
      "category": "Code Generation",
      "tags": [
        "powershell",
        "automation",
        "scripting",
        "best-practices"
      ],
      "created": "2025-07-05T00:00:00.000Z",
      "modified": "2025-07-10T00:00:00.000Z",
      "isPinned": false,
      "isArchived": false,
      "type": "technical",
      "difficulty": "intermediate",
      "usageCount": 23,
      "rating": 4
    },
    {
      "id": "prompt-3",
      "title": "Code Review Assistant",
      "content": "Review the following code and provide a comprehensive analysis:\n\nFocus Areas:\n1. **Security vulnerabilities** - Identify potential security issues\n2. **Performance optimization** - Suggest improvements for efficiency\n3. **Code quality** - Check for maintainability, readability, and best practices\n4. **Error handling** - Evaluate robustness and edge case coverage\n5. **Documentation** - Assess code comments and documentation quality\n\nReview Format:\n## Summary\n[Overall assessment and key findings]\n\n## Critical Issues\n[Security, performance, or functional problems]\n\n## Suggestions\n[Specific improvements with code examples]\n\n## Best Practices\n[Adherence to language/framework conventions]\n\n## Rating: [1-5 stars] ‚≠ê\n\nProvide specific line numbers and code snippets in your feedback.",
      "category": "Code Generation",
      "tags": [
        "code-review",
        "quality",
        "security",
        "performance"
      ],
      "created": "2025-07-03T00:00:00.000Z",
      "modified": "2025-07-08T00:00:00.000Z",
      "isPinned": true,
      "isArchived": false,
      "type": "technical",
      "difficulty": "advanced",
      "usageCount": 67,
      "rating": 5
    },
    {
      "id": "prompt-4",
      "title": "Technical Documentation Writer",
      "content": "Create comprehensive technical documentation for the following:\n\nDocumentation Structure:\n1. **Overview** - Purpose and scope\n2. **Prerequisites** - Requirements and dependencies\n3. **Installation/Setup** - Step-by-step instructions\n4. **Configuration** - Settings and customization\n5. **Usage Examples** - Practical implementation scenarios\n6. **Troubleshooting** - Common issues and solutions\n7. **API Reference** - Detailed parameter documentation\n8. **Best Practices** - Recommended approaches\n\nWriting Style:\n- Clear, concise language\n- Numbered steps for procedures\n- Code examples with syntax highlighting\n- Warning callouts for important notes\n- Cross-references to related topics\n\nTarget Audience: [Specify: developers, admins, end-users]\nFormat: [Specify: Markdown, Wiki, PDF, etc.]",
      "category": "Documentation",
      "tags": [
        "technical-writing",
        "documentation",
        "user-guides",
        "api"
      ],
      "created": "2025-07-02T00:00:00.000Z",
      "modified": "2025-07-07T00:00:00.000Z",
      "isPinned": false,
      "isArchived": false,
      "type": "user",
      "difficulty": "intermediate",
      "usageCount": 34,
      "rating": 4
    },
    {
      "id": "prompt-5",
      "title": "Creative Problem Solving",
      "content": "Approach this challenge using creative problem-solving techniques:\n\nProblem Analysis Framework:\n1. **Define the Problem**\n   - What exactly needs to be solved?\n   - Who are the stakeholders?\n   - What are the constraints?\n\n2. **Generate Solutions**\n   - Brainstorm 5-10 different approaches\n   - Consider unconventional methods\n   - Think outside traditional boundaries\n\n3. **Evaluate Options**\n   - Pros and cons of each solution\n   - Resource requirements\n   - Risk assessment\n   - Implementation difficulty\n\n4. **Recommend Solution**\n   - Best approach with justification\n   - Implementation plan\n   - Success metrics\n   - Contingency plans\n\nUse creative thinking methods like:\n- SCAMPER technique\n- Mind mapping\n- Reverse thinking\n- Analogical reasoning",
      "category": "Problem Solving",
      "tags": [
        "creativity",
        "innovation",
        "analysis",
        "strategy"
      ],
      "created": "2025-06-28T00:00:00.000Z",
      "modified": "2025-07-06T00:00:00.000Z",
      "isPinned": false,
      "isArchived": false,
      "type": "creative",
      "difficulty": "intermediate",
      "usageCount": 19,
      "rating": 4
    },
    {
      "id": "prompt-1754846542807",
      "title": "BUILD your own AI chat Bot ",
      "content": "# BUILD your own AI chat Bot \n\nThe Big Prompt\n\nSet up a Next.js 15 project with Tailwind v4 and shadcn for any component you require. Do not get confused with Tailwind v3. Use defaults without requiring user input, and set the project up in the root folder without creating a new project folder. Once set up, pull in the Vercel AI SDK and create a modern, ChatGPT-like interface that allows the user to chat with GPT-4. Context of the messages must persist throughout the conversation, so that if I for example start with ‚ÄúHey there, my name is Robin, who are you?‚Äù and ask send a follow up later asking ‚ÄúDo you remember my name?‚Äù, AI SDK must have the required data in its context. Do not persist the messages beyond the current browser session. Do not use local storage or cookies. On reload, all messages should be lost and a new session must begin. Conduct a web search on best practices, how to do this best, and then create a detailed task list to help you accomplish everything that is required for this task.\n",
      "category": "Code Generation",
      "tags": [
        "AI",
        "chat",
        "free ai",
        "chatbot"
      ],
      "created": "2025-08-10T17:22:22.807Z",
      "modified": "2025-08-10T17:23:44.024Z",
      "isPinned": true,
      "isArchived": false,
      "type": "creative",
      "difficulty": "beginner",
      "usageCount": 1,
      "rating": 0
    },
    {
      "id": "prompt-1756464074947",
      "title": "test,ps1",
      "content": "# test,ps1\n\nWrite your prompt content here...\n\nAssume the role of an experienced and skilled Microsoft Engineer who has over 20 years of experience in the industry, Please Create a PowerShell script which will run on all Windows 11 endpoints  on a clients domain  which will analyze the endpts current hardware spec and report on any bottlenecks which i can either remediate or upgrade to improve the overall performance of my system. \noutput the findings in a visually appealing html report which should be a single .html file  : output to c:\\temp ",
      "category": "Creative Writing",
      "tags": [],
      "created": "2025-08-29T10:41:14.947Z",
      "modified": "2025-08-29T10:56:05.203Z",
      "isPinned": false,
      "isArchived": false,
      "type": "user",
      "difficulty": "beginner",
      "usageCount": 1,
      "rating": 0
    }
  ],
  "nishen-workspace-notes_REDUNDANT": {
    "data": [
      {
        "id": "note-1759098468379",
        "title": "Task Tracker",
        "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Task Tracker</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            margin: 0;\n            padding: 20px;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n            min-height: 100vh;\n        }\n        .container {\n            max-width: 800px;\n            margin: 0 auto;\n            background: rgba(255, 255, 255, 0.1);\n            padding: 30px;\n            border-radius: 15px;\n            backdrop-filter: blur(10px);\n        }\n        h1 { color: #fff; text-align: center; margin-bottom: 30px; }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>üöÄ Task Tracker</h1>\n        <p>Start building your HTML content here...</p>\n    </div>\n</body>\n</html>",
        "category": "HTML Tools",
        "tags": [
          "tasks"
        ],
        "created": "2025-09-28T22:27:48.379Z",
        "modified": "2025-09-28T22:27:48.379Z",
        "isPinned": false,
        "isArchived": false,
        "type": "html"
      },
      {
        "id": "note-1759098334978",
        "title": "Budget Tracker",
        "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Budget Tracker</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            margin: 0;\n            padding: 20px;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n            min-height: 100vh;\n        }\n        .container {\n            max-width: 800px;\n            margin: 0 auto;\n            background: rgba(255, 255, 255, 0.1);\n            padding: 30px;\n            border-radius: 15px;\n            backdrop-filter: blur(10px);\n        }\n        h1 { color: #fff; text-align: center; margin-bottom: 30px; }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>üöÄ Budget Tracker</h1>\n        <p>Start building your HTML content here...</p>\n    </div>\n</body>\n</html>",
        "category": "HTML Tools",
        "tags": [
          "budget"
        ],
        "created": "2025-09-28T22:25:34.978Z",
        "modified": "2025-09-28T22:25:34.978Z",
        "isPinned": false,
        "isArchived": false,
        "type": "html"
      },
      {
        "id": "note-1759096483129",
        "title": "Nishen's Engineer Dashboard",
        "content": "<!DOCTYPE html>\n<!-- saved from url=(0081)file:///X:/ClaudeCode/eNGINEdashBoard_Tasks/Nishen'sTask_Notes_FileDashboard.html -->\n<html lang=\"en\"><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\n    \n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Nishen's Engineer Dashboard</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        body {\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);\n            color: #ffffff;\n            min-height: 100vh;\n            padding: 15px;\n        }\n\n        .header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 20px;\n            padding: 15px 20px;\n            background: rgba(255, 255, 255, 0.1);\n            border-radius: 12px;\n            backdrop-filter: blur(10px);\n            gap: 20px;\n            height: 120px;\n        }\n\n        .header-left {\n            flex: 0 0 200px;\n        }\n\n        .header-center {\n            flex: 1;\n            text-align: center;\n        }\n\n        .header-right {\n            flex: 0 0 250px;\n            display: flex;\n            flex-direction: column;\n            align-items: flex-end;\n            gap: 10px;\n        }\n\n        .header-center h1 {\n            font-size: 1.8em;\n            margin-bottom: 8px;\n            color: #ffffff;\n            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);\n        }\n\n        /* Navigation Tabs */\n        .nav-tabs {\n            display: flex;\n            background: rgba(255, 255, 255, 0.1);\n            border-radius: 8px;\n            padding: 4px;\n            margin-top: 8px;\n            backdrop-filter: blur(10px);\n            justify-content: center;\n        }\n\n        .nav-tab {\n            background: transparent;\n            border: none;\n            color: rgba(255, 255, 255, 0.7);\n            padding: 8px 20px;\n            border-radius: 6px;\n            cursor: pointer;\n            font-size: 0.9em;\n            font-weight: 500;\n            transition: all 0.3s ease;\n            margin: 0 2px;\n        }\n\n        .nav-tab:hover {\n            color: #ffffff;\n            background: rgba(255, 255, 255, 0.1);\n        }\n\n        .nav-tab.active {\n            background: rgba(255, 255, 255, 0.2);\n            color: #ffffff;\n            font-weight: 600;\n            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\n        }\n\n        .header-center p {\n            font-size: 1em;\n            opacity: 0.9;\n        }\n\n        /* DateTime Display Styles */\n        .datetime-display {\n            text-align: right;\n            margin-bottom: 10px;\n        }\n\n        .current-time {\n            font-size: 1.6em;\n            font-weight: bold;\n            color: #ffffff;\n            font-family: 'Courier New', monospace;\n            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);\n        }\n\n        .current-date {\n            font-size: 0.85em;\n            color: #b8d4f0;\n            margin-top: 5px;\n        }\n\n        /* Config Controls Styles */\n        .config-controls {\n            display: flex;\n            gap: 10px;\n        }\n\n        .control-btn {\n            background: rgba(255, 255, 255, 0.2);\n            color: white;\n            border: none;\n            padding: 8px 15px;\n            border-radius: 8px;\n            cursor: pointer;\n            font-size: 0.85em;\n            transition: all 0.3s ease;\n            backdrop-filter: blur(5px);\n        }\n\n        .control-btn:hover {\n            background: rgba(255, 255, 255, 0.3);\n            transform: translateY(-2px);\n        }\n\n        .export-btn:hover {\n            background: rgba(76, 175, 80, 0.6);\n        }\n\n        .import-btn:hover {\n            background: rgba(33, 150, 243, 0.6);\n        }\n\n        /* Hidden file input for import */\n        #importFileInput {\n            display: none;\n        }\n\n        .grid-container {\n            display: grid;\n            grid-template-columns: repeat(3, 1fr);\n            grid-template-rows: repeat(2, 1fr);\n            gap: 20px;\n            height: calc(100vh - 200px);\n            min-height: 600px;\n        }\n\n        .folder-panel {\n            border-radius: 15px;\n            padding: 20px;\n            backdrop-filter: blur(10px);\n            border: 1px solid rgba(255, 255, 255, 0.2);\n            display: flex;\n            flex-direction: column;\n            transition: all 0.3s ease;\n        }\n\n        /* Unique colors for each panel */\n        .folder-panel:nth-child(1) { background: linear-gradient(135deg, rgba(46, 125, 50, 0.4), rgba(76, 175, 80, 0.3)); }\n        .folder-panel:nth-child(2) { background: linear-gradient(135deg, rgba(25, 118, 210, 0.4), rgba(33, 150, 243, 0.3)); }\n        .folder-panel:nth-child(3) { background: linear-gradient(135deg, rgba(156, 39, 176, 0.4), rgba(233, 30, 99, 0.3)); }\n        .folder-panel:nth-child(4) { background: linear-gradient(135deg, rgba(255, 111, 0, 0.4), rgba(255, 152, 0, 0.3)); }\n        .folder-panel:nth-child(5) { background: linear-gradient(135deg, rgba(244, 67, 54, 0.4), rgba(239, 83, 80, 0.3)); }\n        .folder-panel:nth-child(6) { background: linear-gradient(135deg, rgba(0, 150, 136, 0.4), rgba(77, 182, 172, 0.3)); }\n\n        .folder-panel:hover {\n            transform: translateY(-5px);\n            box-shadow: 0 10px 30px rgba(0,0,0,0.3);\n        }\n\n        .panel-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 15px;\n            padding-bottom: 10px;\n            border-bottom: 1px solid rgba(255, 255, 255, 0.2);\n        }\n\n        .btn-group-header {\n            display: flex;\n            gap: 5px;\n        }\n\n        .panel-title {\n            font-size: 1.1em;\n            font-weight: bold;\n            color: #ffffff;\n        }\n\n        .folder-path {\n            font-size: 0.8em;\n            color: #b8d4f0;\n            margin-bottom: 10px;\n            word-break: break-all;\n        }\n\n        .config-btn {\n            background: #4CAF50;\n            color: white;\n            border: none;\n            padding: 5px 10px;\n            border-radius: 5px;\n            cursor: pointer;\n            font-size: 0.8em;\n            transition: background 0.3s;\n        }\n\n        .config-btn:hover {\n            background: #45a049;\n        }\n\n        .reset-btn {\n            background: #f44336;\n            color: white;\n            border: none;\n            padding: 5px 10px;\n            border-radius: 5px;\n            cursor: pointer;\n            font-size: 0.8em;\n            transition: background 0.3s;\n        }\n\n        .reset-btn:hover {\n            background: #d32f2f;\n        }\n\n        .file-list {\n            flex: 1;\n            overflow-y: auto;\n            max-height: calc(100% - 80px);\n        }\n\n        .file-item {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 8px 12px;\n            margin: 5px 0;\n            background: rgba(255, 255, 255, 0.1);\n            border-radius: 8px;\n            cursor: pointer;\n            transition: all 0.2s ease;\n            border-left: 4px solid transparent;\n        }\n\n        .file-item:hover {\n            background: rgba(255, 255, 255, 0.2);\n            transform: translateX(5px);\n        }\n\n        .file-item.ps1 { border-left-color: #1f4e79; }\n        .file-item.html { border-left-color: #e34c26; }\n        .file-item.txt { border-left-color: #6c757d; }\n        .file-item.docx { border-left-color: #2b579a; }\n        .file-item.xlsx { border-left-color: #217346; }\n        .file-item.pdf { border-left-color: #dc3545; }\n\n        .file-name {\n            font-size: 0.9em;\n            color: #ffffff;\n            flex: 1;\n            margin-right: 10px;\n            white-space: nowrap;\n            overflow: hidden;\n            text-overflow: ellipsis;\n        }\n\n        .file-ext {\n            background: rgba(255, 255, 255, 0.2);\n            padding: 2px 6px;\n            border-radius: 4px;\n            font-size: 0.7em;\n            font-weight: bold;\n            margin-right: 8px;\n        }\n\n        .file-date {\n            font-size: 0.7em;\n            color: #b8d4f0;\n        }\n\n        .modal {\n            display: none;\n            position: fixed;\n            z-index: 1000;\n            left: 0;\n            top: 0;\n            width: 100%;\n            height: 100%;\n            background-color: rgba(0,0,0,0.5);\n        }\n\n        .modal-content {\n            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);\n            margin: 15% auto;\n            padding: 30px;\n            border-radius: 15px;\n            width: 50%;\n            max-width: 500px;\n            color: white;\n            box-shadow: 0 20px 60px rgba(0,0,0,0.5);\n        }\n\n        .modal h2 {\n            margin-bottom: 20px;\n            color: #ffffff;\n        }\n\n        .form-group {\n            margin-bottom: 20px;\n        }\n\n        .form-group label {\n            display: block;\n            margin-bottom: 8px;\n            font-weight: bold;\n        }\n\n        .form-group input {\n            width: 100%;\n            padding: 12px;\n            border: none;\n            border-radius: 8px;\n            background: rgba(255, 255, 255, 0.1);\n            color: white;\n            font-size: 1em;\n        }\n\n        .form-group input::placeholder {\n            color: rgba(255, 255, 255, 0.6);\n        }\n\n        .btn-group {\n            display: flex;\n            gap: 10px;\n            justify-content: flex-end;\n        }\n\n        .btn {\n            padding: 12px 24px;\n            border: none;\n            border-radius: 8px;\n            cursor: pointer;\n            font-size: 1em;\n            transition: all 0.3s ease;\n        }\n\n        .btn-primary {\n            background: #4CAF50;\n            color: white;\n        }\n\n        .btn-primary:hover {\n            background: #45a049;\n        }\n\n        .btn-secondary {\n            background: rgba(255, 255, 255, 0.2);\n            color: white;\n        }\n\n        .btn-secondary:hover {\n            background: rgba(255, 255, 255, 0.3);\n        }\n\n        .refresh-btn {\n            position: fixed;\n            bottom: 30px;\n            right: 30px;\n            background: #2196F3;\n            color: white;\n            border: none;\n            padding: 15px;\n            border-radius: 50%;\n            cursor: pointer;\n            font-size: 1.2em;\n            box-shadow: 0 5px 15px rgba(0,0,0,0.3);\n            transition: all 0.3s ease;\n        }\n\n        .refresh-btn:hover {\n            transform: scale(1.1);\n            background: #1976D2;\n        }\n\n        .empty-panel {\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n            color: rgba(255, 255, 255, 0.6);\n            text-align: center;\n        }\n\n        .empty-panel i {\n            font-size: 3em;\n            margin-bottom: 15px;\n            opacity: 0.5;\n        }\n\n        .file-list::-webkit-scrollbar {\n            width: 6px;\n        }\n\n        .file-list::-webkit-scrollbar-track {\n            background: rgba(255, 255, 255, 0.1);\n            border-radius: 3px;\n        }\n\n        .file-list::-webkit-scrollbar-thumb {\n            background: rgba(255, 255, 255, 0.3);\n            border-radius: 3px;\n        }\n\n        .file-list::-webkit-scrollbar-thumb:hover {\n            background: rgba(255, 255, 255, 0.5);\n        }\n\n        /* Task Tracker Specific Styles */\n        .task-tracker {\n            background: rgba(255, 255, 255, 0.98);\n            border-radius: 12px;\n            box-shadow: 0 25px 50px rgba(0,0,0,0.15);\n            overflow: hidden;\n            backdrop-filter: blur(10px);\n            margin: 0;\n            height: calc(100vh - 180px);\n            min-height: 650px;\n        }\n        \n        .task-header {\n            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);\n            color: white;\n            padding: 12px 25px;\n            position: relative;\n            text-align: center;\n        }\n        \n        .task-header h2 {\n            font-size: 1.3em;\n            margin-bottom: 3px;\n            color: #ecf0f1;\n            text-shadow: 1px 1px 3px rgba(0,0,0,0.3);\n        }\n        \n        .task-header p {\n            opacity: 0.85;\n            font-size: 0.85em;\n            color: #bdc3c7;\n        }\n        \n        .task-main-content {\n            display: grid;\n            grid-template-columns: 320px 1fr 300px;\n            gap: 0;\n            height: calc(100% - 65px);\n        }\n        \n        .task-sidebar {\n            background: #f8fafc;\n            padding: 15px;\n            border-right: 1px solid #e2e8f0;\n            overflow-y: auto;\n        }\n        \n        .task-area {\n            padding: 15px;\n            overflow-y: auto;\n            background: #ffffff;\n        }\n\n        .task-calendar-sidebar {\n            background: #f1f5f9;\n            padding: 15px;\n            border-left: 1px solid #e2e8f0;\n            overflow-y: auto;\n        }\n        \n        .form-section {\n            background: white;\n            border-radius: 6px;\n            padding: 15px;\n            margin-bottom: 15px;\n            box-shadow: 0 1px 4px rgba(0,0,0,0.08);\n            border: 1px solid #e2e8f0;\n        }\n        \n        .form-section h3 {\n            color: #2d3748;\n            margin-bottom: 12px;\n            font-size: 1em;\n            border-bottom: 2px solid #3182ce;\n            padding-bottom: 6px;\n        }\n        \n        .form-group {\n            margin-bottom: 10px;\n        }\n        \n        .form-group label {\n            display: block;\n            margin-bottom: 3px;\n            font-weight: 600;\n            color: #4a5568;\n            font-size: 12px;\n        }\n        \n        .form-group input, .form-group select, .form-group textarea {\n            width: 100%;\n            padding: 6px 10px;\n            border: 1px solid #e2e8f0;\n            border-radius: 4px;\n            font-size: 12px;\n            transition: all 0.2s ease;\n        }\n        \n        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {\n            outline: none;\n            border-color: #3182ce;\n            box-shadow: 0 0 0 2px rgba(49, 130, 206, 0.1);\n        }\n        \n        .form-group textarea {\n            resize: vertical;\n            min-height: 50px;\n        }\n        \n        .form-row {\n            display: grid;\n            grid-template-columns: 1fr 70px;\n            gap: 8px;\n            align-items: end;\n        }\n        \n        .btn {\n            background: linear-gradient(135deg, #3182ce 0%, #2c5282 100%);\n            color: white;\n            border: none;\n            padding: 8px 16px;\n            border-radius: 4px;\n            cursor: pointer;\n            font-size: 12px;\n            font-weight: 600;\n            transition: all 0.2s ease;\n            width: 100%;\n        }\n        \n        .btn:hover {\n            transform: translateY(-1px);\n            box-shadow: 0 3px 8px rgba(49, 130, 206, 0.3);\n        }\n        \n        .task-stats {\n            background: linear-gradient(135deg, #4c51bf 0%, #553c9a 100%);\n            color: white;\n            border-radius: 6px;\n            padding: 12px;\n            margin-bottom: 12px;\n            box-shadow: 0 2px 8px rgba(76, 81, 191, 0.15);\n        }\n        \n        .task-stats h3 {\n            margin-bottom: 10px;\n            font-size: 0.9em;\n        }\n        \n        .stats-grid {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 8px;\n        }\n        \n        .stat-item {\n            text-align: center;\n            padding: 8px;\n            border-radius: 4px;\n            background: rgba(255, 255, 255, 0.15);\n        }\n        \n        .stat-number {\n            font-size: 1.3em;\n            font-weight: bold;\n        }\n        \n        .stat-label {\n            font-size: 0.75em;\n            opacity: 0.9;\n            margin-top: 2px;\n        }\n        \n        .task-card {\n            background: white;\n            border-radius: 6px;\n            padding: 10px;\n            margin-bottom: 6px;\n            box-shadow: 0 1px 4px rgba(0,0,0,0.08);\n            border-left: 3px solid #3182ce;\n            transition: all 0.2s ease;\n            border: 1px solid #e2e8f0;\n        }\n        \n        .task-card:hover {\n            transform: translateY(-1px);\n            box-shadow: 0 2px 8px rgba(0,0,0,0.12);\n        }\n        \n        .task-header-card {\n            display: flex;\n            justify-content: space-between;\n            align-items: start;\n            margin-bottom: 6px;\n        }\n        \n        .task-title {\n            font-size: 1em;\n            font-weight: 600;\n            color: #2d3748;\n            margin-bottom: 3px;\n            line-height: 1.3;\n        }\n        \n        .task-meta {\n            display: flex;\n            gap: 4px;\n            flex-wrap: wrap;\n            margin-bottom: 5px;\n        }\n        \n        .task-badge {\n            padding: 3px 10px;\n            border-radius: 12px;\n            font-size: 0.7em;\n            font-weight: 600;\n            text-transform: uppercase;\n            letter-spacing: 0.5px;\n            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n        }\n        \n        .priority-high {\n            background: linear-gradient(135deg, #ffffff 0%, #fef5f5 100%);\n            color: #c53030;\n            border-left: 4px solid #dc2626;\n            box-shadow: 0 2px 8px rgba(220, 38, 38, 0.15);\n        }\n\n        .priority-medium {\n            background: linear-gradient(135deg, #ffffff 0%, #fffbf0 100%);\n            color: #d69e2e;\n            border-left: 4px solid #f59e0b;\n            box-shadow: 0 2px 8px rgba(245, 158, 11, 0.15);\n        }\n\n        .priority-low {\n            background: linear-gradient(135deg, #ffffff 0%, #f0fff4 100%);\n            color: #38a169;\n            border-left: 4px solid #10b981;\n            box-shadow: 0 2px 8px rgba(16, 185, 129, 0.15);\n        }\n        \n        .task-badge.priority-high {\n            background: linear-gradient(135deg, #dc2626, #ef4444);\n            color: white;\n        }\n\n        .task-badge.priority-medium {\n            background: linear-gradient(135deg, #f59e0b, #fbbf24);\n            color: white;\n        }\n\n        .task-badge.priority-low {\n            background: linear-gradient(135deg, #10b981, #34d399);\n            color: white;\n        }\n\n        .category-badge {\n            background: linear-gradient(135deg, #6366f1, #8b5cf6);\n            color: white;\n            padding: 3px 10px;\n            border-radius: 12px;\n            font-size: 0.7em;\n            font-weight: 600;\n            letter-spacing: 0.5px;\n            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n        }\n        \n        .status-badge {\n            padding: 3px 10px;\n            border-radius: 12px;\n            font-size: 0.7em;\n            font-weight: 600;\n            letter-spacing: 0.5px;\n            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n        }\n\n        .status-pending {\n            background: linear-gradient(135deg, #f59e0b, #fbbf24);\n            color: white;\n        }\n\n        .status-in-progress {\n            background: linear-gradient(135deg, #3b82f6, #60a5fa);\n            color: white;\n        }\n\n        .status-completed {\n            background: linear-gradient(135deg, #10b981, #34d399);\n            color: white;\n        }\n\n        .status-overdue {\n            background: linear-gradient(135deg, #dc2626, #ef4444);\n            color: white;\n        }\n        \n        .task-description {\n            color: #718096;\n            margin-bottom: 6px;\n            line-height: 1.3;\n            font-size: 0.85em;\n        }\n        \n        .task-footer {\n            display: grid;\n            grid-template-columns: 1fr auto auto;\n            gap: 10px;\n            align-items: center;\n            padding-top: 6px;\n            border-top: 1px solid #f7fafc;\n            font-size: 0.8em;\n        }\n        \n        .task-due {\n            color: #718096;\n        }\n        \n        .task-time {\n            color: #3182ce;\n            font-weight: 600;\n        }\n        \n        .task-actions {\n            display: flex;\n            gap: 3px;\n        }\n        \n        .action-btn {\n            padding: 6px 10px;\n            border: none;\n            border-radius: 6px;\n            cursor: pointer;\n            font-size: 11px;\n            font-weight: 600;\n            transition: all 0.2s ease;\n            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n        }\n\n        .edit-btn {\n            background: linear-gradient(135deg, #3b82f6, #60a5fa);\n            color: white;\n        }\n\n        .edit-btn:hover {\n            background: linear-gradient(135deg, #2563eb, #3b82f6);\n            transform: translateY(-1px);\n            box-shadow: 0 4px 8px rgba(59, 130, 246, 0.3);\n        }\n\n        .delete-btn {\n            background: linear-gradient(135deg, #dc2626, #ef4444);\n            color: white;\n        }\n\n        .delete-btn:hover {\n            background: linear-gradient(135deg, #b91c1c, #dc2626);\n            transform: translateY(-1px);\n            box-shadow: 0 4px 8px rgba(220, 38, 38, 0.3);\n        }\n\n        .complete-btn {\n            background: linear-gradient(135deg, #10b981, #34d399);\n            color: white;\n        }\n\n        .complete-btn:hover {\n            background: linear-gradient(135deg, #059669, #10b981);\n            transform: translateY(-1px);\n            box-shadow: 0 4px 8px rgba(16, 185, 129, 0.3);\n        }\n\n        .timer-btn {\n            background: linear-gradient(135deg, #dc2626, #ef4444);\n            color: white;\n            border: none;\n            padding: 6px 12px;\n            border-radius: 6px;\n            cursor: pointer;\n            font-size: 11px;\n            font-weight: 600;\n            transition: all 0.2s ease;\n            box-shadow: 0 2px 4px rgba(220, 38, 38, 0.2);\n            margin-left: 8px;\n        }\n\n        .timer-btn:hover {\n            background: linear-gradient(135deg, #b91c1c, #dc2626);\n            transform: translateY(-1px);\n            box-shadow: 0 4px 8px rgba(220, 38, 38, 0.3);\n        }\n\n        .timer-btn.running {\n            background: linear-gradient(135deg, #059669, #10b981);\n            animation: pulse 2s infinite;\n        }\n\n        @keyframes pulse {\n            0% { transform: scale(1); }\n            50% { transform: scale(1.05); }\n            100% { transform: scale(1); }\n        }\n        \n        .empty-state {\n            text-align: center;\n            padding: 30px 15px;\n            color: #718096;\n        }\n        \n        .empty-state h3 {\n            color: #a0aec0;\n            margin-bottom: 6px;\n        }\n\n        /* Calendar Widget Styles for Task Tracker */\n        .calendar-widget {\n            background: rgba(255, 255, 255, 0.9);\n            border-radius: 8px;\n            padding: 12px;\n            border: 1px solid rgba(0, 0, 0, 0.1);\n            margin-bottom: 15px;\n        }\n\n        .calendar-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 8px;\n        }\n\n        .calendar-title {\n            font-weight: bold;\n            font-size: 0.85em;\n            color: #2d3748;\n        }\n\n        .calendar-nav {\n            background: #e2e8f0;\n            border: none;\n            color: #4a5568;\n            padding: 4px 6px;\n            border-radius: 4px;\n            cursor: pointer;\n            font-size: 0.75em;\n            transition: background 0.3s;\n        }\n\n        .calendar-nav:hover {\n            background: #cbd5e0;\n        }\n\n        .calendar-grid {\n            display: grid;\n            grid-template-columns: repeat(7, 1fr);\n            gap: 1px;\n        }\n\n        .calendar-day {\n            text-align: center;\n            padding: 3px 1px;\n            font-size: 0.7em;\n            color: #4a5568;\n            border-radius: 2px;\n            cursor: pointer;\n            transition: all 0.2s;\n        }\n\n        .calendar-day:hover {\n            background: #e2e8f0;\n        }\n\n        .calendar-day.today {\n            background: #3182ce;\n            color: white;\n            font-weight: bold;\n        }\n\n        .calendar-day.other-month {\n            opacity: 0.4;\n        }\n\n        .calendar-day-header {\n            font-weight: bold;\n            color: #2d3748;\n            font-size: 0.65em;\n            padding: 2px;\n            text-align: center;\n        }\n\n        /* Quick Links Section */\n        .quick-links {\n            background: rgba(255, 255, 255, 0.9);\n            border-radius: 8px;\n            padding: 12px;\n            border: 1px solid rgba(0, 0, 0, 0.1);\n            margin-bottom: 15px;\n        }\n\n        .quick-links h4 {\n            color: #2d3748;\n            margin-bottom: 8px;\n            font-size: 0.9em;\n            border-bottom: 1px solid #e2e8f0;\n            padding-bottom: 4px;\n        }\n\n        .quick-link {\n            display: block;\n            padding: 6px 8px;\n            margin-bottom: 3px;\n            color: #4a5568;\n            text-decoration: none;\n            font-size: 0.8em;\n            border-radius: 4px;\n            transition: all 0.2s;\n        }\n\n        .quick-link:hover {\n            background: #e2e8f0;\n            color: #2d3748;\n        }\n\n        .quick-link i {\n            margin-right: 6px;\n            color: #3182ce;\n        }\n\n        /* Quick Notes Styles */\n        .note-item {\n            background: rgba(255, 255, 255, 0.7);\n            border: 1px solid #e2e8f0;\n            border-radius: 4px;\n            padding: 6px 8px;\n            margin-bottom: 4px;\n            font-size: 0.75em;\n            line-height: 1.3;\n            position: relative;\n            word-wrap: break-word;\n        }\n\n        .note-content {\n            color: #2d3748;\n            margin-bottom: 4px;\n        }\n\n        .note-meta {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            font-size: 0.65em;\n            color: #718096;\n            border-top: 1px solid #f1f5f9;\n            padding-top: 3px;\n        }\n\n        .note-actions {\n            display: flex;\n            gap: 3px;\n        }\n\n        .note-btn {\n            background: none;\n            border: none;\n            cursor: pointer;\n            padding: 2px 4px;\n            border-radius: 2px;\n            font-size: 0.7em;\n            transition: all 0.2s;\n        }\n\n        .note-btn:hover {\n            background: #e2e8f0;\n        }\n\n        .note-btn.convert {\n            color: #3182ce;\n        }\n\n        .note-btn.delete {\n            color: #e53e3e;\n        }\n\n        .note-timestamp {\n            font-size: 0.6em;\n            color: #a0aec0;\n        }\n    </style>\n    <link rel=\"stylesheet\" href=\"./Nishen's Engineer Dashboard/all.min.css\">\n</head>\n<body>\n    <div class=\"header\">\n        <div class=\"header-left\">\n            <!-- Empty space where calendar used to be -->\n        </div>\n        \n        <div class=\"header-center\">\n            <h1><i class=\"fas fa-server\"></i> Nishen's Engineer Dashboard</h1>\n            <p>Integrated File Browser &amp; Task Management Portal</p>\n            <div class=\"nav-tabs\">\n                <button class=\"nav-tab\" onclick=\"switchTab(&#39;files&#39;)\">\n                    <i class=\"fas fa-folder\"></i> File Browser\n                </button>\n                <button class=\"nav-tab active\" onclick=\"switchTab(&#39;tasks&#39;)\">\n                    <i class=\"fas fa-tasks\"></i> Task Tracker\n                </button>\n            </div>\n        </div>\n        \n        <div class=\"header-right\">\n            <div class=\"datetime-display\">\n                <div class=\"current-time\" id=\"currentTime\">05:10:51</div>\n                <div class=\"current-date\" id=\"currentDate\">Monday, September 22, 2025</div>\n            </div>\n            <div class=\"config-controls\">\n                <button class=\"control-btn export-btn\" onclick=\"exportConfig()\" title=\"Export Configuration\">\n                    <i class=\"fas fa-download\"></i> Export\n                </button>\n                <button class=\"control-btn import-btn\" onclick=\"importConfig()\" title=\"Import Configuration\">\n                    <i class=\"fas fa-upload\"></i> Import\n                </button>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"grid-container\" id=\"gridContainer\" style=\"display: none;\">\n        <div class=\"folder-panel\">\n            <div class=\"panel-header\">\n                <div class=\"panel-title\" id=\"panelTitle0\">Claude Dev</div>\n                <div class=\"btn-group-header\">\n                    <button class=\"config-btn\" onclick=\"openConfigModal(0)\" title=\"Configure Panel\">\n                        <i class=\"fas fa-cog\"></i>\n                    </button>\n                    <button class=\"reset-btn\" onclick=\"resetPanel(0)\" title=\"Reset Panel\">\n                        <i class=\"fas fa-trash-alt\"></i>\n                    </button>\n                </div>\n            </div>\n            <div class=\"folder-path\" id=\"folderPath0\">X:\\ClaudeCode</div>\n            <div class=\"file-list\" id=\"fileList0\">\n                <div class=\"file-item ps1\" onclick=\"openFile(&#39;script1.ps1&#39;, &#39;ps1&#39;)\">\n                    <div class=\"file-name\" title=\"script1.ps1\">script1.ps1</div>\n                    <div class=\"file-ext\">PS1</div>\n                    <div class=\"file-date\">Today</div>\n                </div>\n            \n                <div class=\"file-item xml\" onclick=\"openFile(&#39;config.xml&#39;, &#39;xml&#39;)\">\n                    <div class=\"file-name\" title=\"config.xml\">config.xml</div>\n                    <div class=\"file-ext\">XML</div>\n                    <div class=\"file-date\">Today</div>\n                </div>\n            \n                <div class=\"file-item html\" onclick=\"openFile(&#39;report.html&#39;, &#39;html&#39;)\">\n                    <div class=\"file-name\" title=\"report.html\">report.html</div>\n                    <div class=\"file-ext\">HTML</div>\n                    <div class=\"file-date\">Today</div>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"folder-panel\">\n            <div class=\"panel-header\">\n                <div class=\"panel-title\" id=\"panelTitle1\">Panel 2</div>\n                <div class=\"btn-group-header\">\n                    <button class=\"config-btn\" onclick=\"openConfigModal(1)\" title=\"Configure Panel\">\n                        <i class=\"fas fa-cog\"></i>\n                    </button>\n                    <button class=\"reset-btn\" onclick=\"resetPanel(1)\" title=\"Reset Panel\">\n                        <i class=\"fas fa-trash-alt\"></i>\n                    </button>\n                </div>\n            </div>\n            <div class=\"folder-path\" id=\"folderPath1\">No path configured</div>\n            <div class=\"file-list\" id=\"fileList1\">\n                <div class=\"empty-panel\">\n                    <i class=\"fas fa-folder-open\"></i>\n                    <div>Configure a folder path to view files</div>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"folder-panel\">\n            <div class=\"panel-header\">\n                <div class=\"panel-title\" id=\"panelTitle2\">Panel 3</div>\n                <div class=\"btn-group-header\">\n                    <button class=\"config-btn\" onclick=\"openConfigModal(2)\" title=\"Configure Panel\">\n                        <i class=\"fas fa-cog\"></i>\n                    </button>\n                    <button class=\"reset-btn\" onclick=\"resetPanel(2)\" title=\"Reset Panel\">\n                        <i class=\"fas fa-trash-alt\"></i>\n                    </button>\n                </div>\n            </div>\n            <div class=\"folder-path\" id=\"folderPath2\">No path configured</div>\n            <div class=\"file-list\" id=\"fileList2\">\n                <div class=\"empty-panel\">\n                    <i class=\"fas fa-folder-open\"></i>\n                    <div>Configure a folder path to view files</div>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"folder-panel\">\n            <div class=\"panel-header\">\n                <div class=\"panel-title\" id=\"panelTitle3\">Panel 4</div>\n                <div class=\"btn-group-header\">\n                    <button class=\"config-btn\" onclick=\"openConfigModal(3)\" title=\"Configure Panel\">\n                        <i class=\"fas fa-cog\"></i>\n                    </button>\n                    <button class=\"reset-btn\" onclick=\"resetPanel(3)\" title=\"Reset Panel\">\n                        <i class=\"fas fa-trash-alt\"></i>\n                    </button>\n                </div>\n            </div>\n            <div class=\"folder-path\" id=\"folderPath3\">No path configured</div>\n            <div class=\"file-list\" id=\"fileList3\">\n                <div class=\"empty-panel\">\n                    <i class=\"fas fa-folder-open\"></i>\n                    <div>Configure a folder path to view files</div>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"folder-panel\">\n            <div class=\"panel-header\">\n                <div class=\"panel-title\" id=\"panelTitle4\">Panel 5</div>\n                <div class=\"btn-group-header\">\n                    <button class=\"config-btn\" onclick=\"openConfigModal(4)\" title=\"Configure Panel\">\n                        <i class=\"fas fa-cog\"></i>\n                    </button>\n                    <button class=\"reset-btn\" onclick=\"resetPanel(4)\" title=\"Reset Panel\">\n                        <i class=\"fas fa-trash-alt\"></i>\n                    </button>\n                </div>\n            </div>\n            <div class=\"folder-path\" id=\"folderPath4\">No path configured</div>\n            <div class=\"file-list\" id=\"fileList4\">\n                <div class=\"empty-panel\">\n                    <i class=\"fas fa-folder-open\"></i>\n                    <div>Configure a folder path to view files</div>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"folder-panel\">\n            <div class=\"panel-header\">\n                <div class=\"panel-title\" id=\"panelTitle5\">Panel 6</div>\n                <div class=\"btn-group-header\">\n                    <button class=\"config-btn\" onclick=\"openConfigModal(5)\" title=\"Configure Panel\">\n                        <i class=\"fas fa-cog\"></i>\n                    </button>\n                    <button class=\"reset-btn\" onclick=\"resetPanel(5)\" title=\"Reset Panel\">\n                        <i class=\"fas fa-trash-alt\"></i>\n                    </button>\n                </div>\n            </div>\n            <div class=\"folder-path\" id=\"folderPath5\">No path configured</div>\n            <div class=\"file-list\" id=\"fileList5\">\n                <div class=\"empty-panel\">\n                    <i class=\"fas fa-folder-open\"></i>\n                    <div>Configure a folder path to view files</div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <!-- Task Tracker Section -->\n    <div id=\"taskTrackerSection\" style=\"display: block;\">\n        <div class=\"task-tracker\">\n            <div class=\"task-header\">\n                <h2><i class=\"fas fa-tasks\"></i> Professional Task Tracker</h2>\n                <p>Enterprise task management with cloud synchronization</p>\n            </div>\n            \n            <div class=\"task-main-content\">\n                <div class=\"task-sidebar\">\n                    <!-- Task Filters -->\n                    <div class=\"form-section\">\n                        <h3>üîç Filters</h3>\n                        <div class=\"form-group\">\n                            <label for=\"filterStatus\">Status</label>\n                            <select id=\"filterStatus\" onchange=\"applyFilters()\">\n                                <option value=\"\">All Status</option>\n                                <option value=\"pending\">Pending</option>\n                                <option value=\"in-progress\">In Progress</option>\n                                <option value=\"completed\">Completed</option>\n                                <option value=\"overdue\">Overdue</option>\n                            </select>\n                        </div>\n                        <div class=\"form-group\">\n                            <label for=\"filterPriority\">Priority</label>\n                            <select id=\"filterPriority\" onchange=\"applyFilters()\">\n                                <option value=\"\">All Priorities</option>\n                                <option value=\"High\">High</option>\n                                <option value=\"Medium\">Medium</option>\n                                <option value=\"Low\">Low</option>\n                            </select>\n                        </div>\n                        <div class=\"form-group\">\n                            <label for=\"filterCategory\">Category</label>\n                            <select id=\"filterCategory\" onchange=\"applyFilters()\">\n                                <option value=\"\">All Categories</option>\n                                <option value=\"Work\">Work</option>\n                                <option value=\"Personal\">Personal</option>\n                                <option value=\"Project\">Project</option>\n                                <option value=\"Meeting\">Meeting</option>\n                                <option value=\"Admin\">Admin</option>\n                                <option value=\"Learning\">Learning</option>\n                                <option value=\"Review\">Review</option>\n                            </select>\n                        </div>\n                        <div class=\"form-group\">\n                            <button onclick=\"clearFilters()\" class=\"btn\" style=\"background: #6b7280; font-size: 11px; padding: 6px 12px;\">Clear Filters</button>\n                        </div>\n                    </div>\n\n                    <!-- Task Statistics -->\n                    <div class=\"task-stats\">\n                        <h3>üìä Overview</h3>\n                        <div class=\"stats-grid\">\n                            <div class=\"stat-item\">\n                                <div class=\"stat-number\" id=\"totalTasks\">7</div>\n                                <div class=\"stat-label\">Total</div>\n                            </div>\n                            <div class=\"stat-item\">\n                                <div class=\"stat-number\" id=\"completedTasks\">1</div>\n                                <div class=\"stat-label\">Done</div>\n                            </div>\n                            <div class=\"stat-item\">\n                                <div class=\"stat-number\" id=\"pendingTasks\">3</div>\n                                <div class=\"stat-label\">Pending</div>\n                            </div>\n                            <div class=\"stat-item\">\n                                <div class=\"stat-number\" id=\"overdueTasks\">3</div>\n                                <div class=\"stat-label\">Overdue</div>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Add New Task Form -->\n                    <div class=\"form-section\">\n                        <h3>‚ûï New Task</h3>\n                        <form id=\"taskForm\">\n                            <div class=\"form-group\">\n                                <label for=\"taskTitle\">Title</label>\n                                <input type=\"text\" id=\"taskTitle\" required=\"\" placeholder=\"Task title...\">\n                            </div>\n                            \n                            <div class=\"form-group\">\n                                <label for=\"taskDescription\">Description</label>\n                                <textarea id=\"taskDescription\" placeholder=\"Task details...\"></textarea>\n                            </div>\n                            \n                            <div class=\"form-row\">\n                                <div class=\"form-group\">\n                                    <label for=\"taskCategory\">Category</label>\n                                    <select id=\"taskCategory\" required=\"\">\n                                        <option value=\"\">Select...</option>\n                                        <option value=\"Work\">Work</option>\n                                        <option value=\"Personal\">Personal</option>\n                                        <option value=\"Project\">Project</option>\n                                        <option value=\"Meeting\">Meeting</option>\n                                        <option value=\"Admin\">Admin</option>\n                                        <option value=\"Learning\">Learning</option>\n                                        <option value=\"Review\">Review</option>\n                                    </select>\n                                </div>\n                                <div class=\"form-group\">\n                                    <label for=\"taskHours\">Hours</label>\n                                    <input type=\"number\" id=\"taskHours\" step=\"0.5\" min=\"0\" placeholder=\"0\">\n                                </div>\n                            </div>\n                            \n                            <div class=\"form-row\">\n                                <div class=\"form-group\">\n                                    <label for=\"taskPriority\">Priority</label>\n                                    <select id=\"taskPriority\" required=\"\">\n                                        <option value=\"\">Select...</option>\n                                        <option value=\"High\">High</option>\n                                        <option value=\"Medium\">Medium</option>\n                                        <option value=\"Low\">Low</option>\n                                    </select>\n                                </div>\n                                <div class=\"form-group\">\n                                    <label for=\"taskDueDate\">Due Date</label>\n                                    <input type=\"date\" id=\"taskDueDate\" required=\"\" min=\"2025-09-22\">\n                                </div>\n                            </div>\n                            \n                            <button type=\"submit\" class=\"btn\">Add Task</button>\n                        </form>\n                    </div>\n                </div>\n                \n                <div class=\"task-area\">\n                    <div id=\"tasksList\">\n                        <div class=\"task-card priority-high\">\n                            <div class=\"task-header-card\">\n                                <div>\n                                    <div class=\"task-title\">Evo security</div>\n                                    <div class=\"task-meta\">\n                                        <span class=\"task-badge priority-high\">High</span>\n                                        <span class=\"category-badge\">Project</span>\n                                        <span class=\"status-badge status-pending\">Pending</span>\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"task-description\">Configure Solution (on)</div>\n                            \n                            <div class=\"task-footer\">\n                                <div class=\"task-due\">Due: 2025/09/24 (5 days)</div>\n                                <div class=\"task-time\">2h</div>\n                                <div class=\"task-actions\">\n                                    <button class=\"action-btn edit-btn\" onclick=\"editTask(1757329106448)\" title=\"Edit task\">‚úè</button>\n                                    <button class=\"action-btn complete-btn\" onclick=\"toggleTaskStatus(1757329106448)\" title=\"Mark as completed\">\n                                        ‚úì\n                                    </button>\n                                    <button class=\"action-btn delete-btn\" onclick=\"deleteTask(1757329106448)\" title=\"Delete task\">‚úï</button>\n                                </div>\n                            </div>\n                        </div>\n                    \n                        <div class=\"task-card priority-medium\">\n                            <div class=\"task-header-card\">\n                                <div>\n                                    <div class=\"task-title\">Sql Server Upgrade /Optimization -Pather &amp; Pather</div>\n                                    <div class=\"task-meta\">\n                                        <span class=\"task-badge priority-medium\">Medium</span>\n                                        <span class=\"category-badge\">Project</span>\n                                        <span class=\"status-badge status-pending\">Pending</span>\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"task-description\">Upgrade SQL EXPRESS TO SQL 2019 , PROVISION NEW DISKS FOR db's , LOGS, oPTIMIZE 12H QUOTED</div>\n                            \n                            <div class=\"task-footer\">\n                                <div class=\"task-due\">Due: 2025/09/20 (Tomorrow)</div>\n                                <div class=\"task-time\"></div>\n                                <div class=\"task-actions\">\n                                    <button class=\"action-btn edit-btn\" onclick=\"editTask(1758269150099)\" title=\"Edit task\">‚úè</button>\n                                    <button class=\"action-btn complete-btn\" onclick=\"toggleTaskStatus(1758269150099)\" title=\"Mark as completed\">\n                                        ‚úì\n                                    </button>\n                                    <button class=\"action-btn delete-btn\" onclick=\"deleteTask(1758269150099)\" title=\"Delete task\">‚úï</button>\n                                </div>\n                            </div>\n                        </div>\n                    \n                        <div class=\"task-card priority-medium\">\n                            <div class=\"task-header-card\">\n                                <div>\n                                    <div class=\"task-title\">Kanga SQL Optimization Assessment /Optimization</div>\n                                    <div class=\"task-meta\">\n                                        <span class=\"task-badge priority-medium\">Medium</span>\n                                        <span class=\"category-badge\">Project</span>\n                                        <span class=\"status-badge status-pending\">Pending</span>\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"task-description\">provide full assessment , SOW, project plan, Dude Monday 22 September</div>\n                            \n                            <div class=\"task-footer\">\n                                <div class=\"task-due\">Due: 2025/09/22 (3 days)</div>\n                                <div class=\"task-time\"></div>\n                                <div class=\"task-actions\">\n                                    <button class=\"action-btn edit-btn\" onclick=\"editTask(1758269289951)\" title=\"Edit task\">‚úè</button>\n                                    <button class=\"action-btn complete-btn\" onclick=\"toggleTaskStatus(1758269289951)\" title=\"Mark as completed\">\n                                        ‚úì\n                                    </button>\n                                    <button class=\"action-btn delete-btn\" onclick=\"deleteTask(1758269289951)\" title=\"Delete task\">‚úï</button>\n                                </div>\n                            </div>\n                        </div>\n                    \n                        <div class=\"task-card priority-low\">\n                            <div class=\"task-header-card\">\n                                <div>\n                                    <div class=\"task-title\">Shiplakes AD Remediation</div>\n                                    <div class=\"task-meta\">\n                                        <span class=\"task-badge priority-low\">Low</span>\n                                        <span class=\"category-badge\">Project</span>\n                                        <span class=\"status-badge status-pending\">Pending</span>\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"task-description\">Assessment - Tasks Fine Grain policy ClEANUPS</div>\n                            \n                            <div class=\"task-footer\">\n                                <div class=\"task-due\">Due: 2025/09/29 (10 days)</div>\n                                <div class=\"task-time\"></div>\n                                <div class=\"task-actions\">\n                                    <button class=\"action-btn edit-btn\" onclick=\"editTask(1758269394393)\" title=\"Edit task\">‚úè</button>\n                                    <button class=\"action-btn complete-btn\" onclick=\"toggleTaskStatus(1758269394393)\" title=\"Mark as completed\">\n                                        ‚úì\n                                    </button>\n                                    <button class=\"action-btn delete-btn\" onclick=\"deleteTask(1758269394393)\" title=\"Delete task\">‚úï</button>\n                                </div>\n                            </div>\n                        </div>\n                    \n                        <div class=\"task-card priority-low\">\n                            <div class=\"task-header-card\">\n                                <div>\n                                    <div class=\"task-title\">Ashtons AD Cleanup - Remediation</div>\n                                    <div class=\"task-meta\">\n                                        <span class=\"task-badge priority-low\">Low</span>\n                                        <span class=\"category-badge\">Project</span>\n                                        <span class=\"status-badge status-pending\">Pending</span>\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"task-description\">follow up on outstanding items , AD cleanup</div>\n                            \n                            <div class=\"task-footer\">\n                                <div class=\"task-due\">Due: 2025/10/03 (14 days)</div>\n                                <div class=\"task-time\"></div>\n                                <div class=\"task-actions\">\n                                    <button class=\"action-btn edit-btn\" onclick=\"editTask(1758269467247)\" title=\"Edit task\">‚úè</button>\n                                    <button class=\"action-btn complete-btn\" onclick=\"toggleTaskStatus(1758269467247)\" title=\"Mark as completed\">\n                                        ‚úì\n                                    </button>\n                                    <button class=\"action-btn delete-btn\" onclick=\"deleteTask(1758269467247)\" title=\"Delete task\">‚úï</button>\n                                </div>\n                            </div>\n                        </div>\n                    \n                        <div class=\"task-card priority-high\">\n                            <div class=\"task-header-card\">\n                                <div>\n                                    <div class=\"task-title\">SFTP Project  pather n pather</div>\n                                    <div class=\"task-meta\">\n                                        <span class=\"task-badge priority-high\">High</span>\n                                        <span class=\"category-badge\">Project</span>\n                                        <span class=\"status-badge status-in-progress\">In Progress</span>\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"task-description\">assess, scope, quote , implement</div>\n                            \n                            <div class=\"task-footer\">\n                                <div class=\"task-due\">Due: 2025/09/21 (2 days)</div>\n                                <div class=\"task-time\">5h</div>\n                                <div class=\"task-actions\">\n                                    <button class=\"action-btn edit-btn\" onclick=\"editTask(1757335217307)\" title=\"Edit task\">‚úè</button>\n                                    <button class=\"timer-btn\" onclick=\"toggleTimer(1757335217307)\" title=\"Start/Stop Timer\" id=\"timer-1757335217307\">‚ñ∂ Start</button>\n                                    <button class=\"action-btn complete-btn\" onclick=\"toggleTaskStatus(1757335217307)\" title=\"Mark as completed\">\n                                        ‚úì\n                                    </button>\n                                    <button class=\"action-btn delete-btn\" onclick=\"deleteTask(1757335217307)\" title=\"Delete task\">‚úï</button>\n                                </div>\n                            </div>\n                        </div>\n                    \n                        <div class=\"task-card priority-high\">\n                            <div class=\"task-header-card\">\n                                <div>\n                                    <div class=\"task-title\">RPA - align -Exam assignment issue</div>\n                                    <div class=\"task-meta\">\n                                        <span class=\"task-badge priority-high\">High</span>\n                                        <span class=\"category-badge\">Learning</span>\n                                        <span class=\"status-badge status-completed\">Completed</span>\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"task-description\">Exam assignment issue</div>\n                            \n                            <div class=\"task-footer\">\n                                <div class=\"task-due\">Due: 2025/09/19 (Today)</div>\n                                <div class=\"task-time\"></div>\n                                <div class=\"task-actions\">\n                                    <button class=\"action-btn edit-btn\" onclick=\"editTask(1757335298723)\" title=\"Edit task\">‚úè</button>\n                                    <button class=\"action-btn complete-btn\" onclick=\"toggleTaskStatus(1757335298723)\" title=\"Mark as pending\">\n                                        ‚Ü©\n                                    </button>\n                                    <button class=\"action-btn delete-btn\" onclick=\"deleteTask(1757335298723)\" title=\"Delete task\">‚úï</button>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <div class=\"task-calendar-sidebar\">\n                    <!-- Calendar Widget -->\n                    <div class=\"calendar-widget\" id=\"calendarWidget\">\n                        <div class=\"calendar-header\">\n                            <button class=\"calendar-nav\" onclick=\"previousMonth()\">&lt;</button>\n                            <div class=\"calendar-title\" id=\"calendarTitle\">September 2025</div>\n                            <button class=\"calendar-nav\" onclick=\"nextMonth()\">&gt;</button>\n                        </div>\n                        <div class=\"calendar-grid\" id=\"calendarGrid\"><div class=\"calendar-day-header\">Su</div><div class=\"calendar-day-header\">Mo</div><div class=\"calendar-day-header\">Tu</div><div class=\"calendar-day-header\">We</div><div class=\"calendar-day-header\">Th</div><div class=\"calendar-day-header\">Fr</div><div class=\"calendar-day-header\">Sa</div><div class=\"calendar-day other-month\">31</div><div class=\"calendar-day\">1</div><div class=\"calendar-day\">2</div><div class=\"calendar-day\">3</div><div class=\"calendar-day\">4</div><div class=\"calendar-day\">5</div><div class=\"calendar-day\">6</div><div class=\"calendar-day\">7</div><div class=\"calendar-day\">8</div><div class=\"calendar-day\">9</div><div class=\"calendar-day\">10</div><div class=\"calendar-day\">11</div><div class=\"calendar-day\">12</div><div class=\"calendar-day\">13</div><div class=\"calendar-day\">14</div><div class=\"calendar-day\">15</div><div class=\"calendar-day\">16</div><div class=\"calendar-day\">17</div><div class=\"calendar-day\">18</div><div class=\"calendar-day\">19</div><div class=\"calendar-day\">20</div><div class=\"calendar-day\">21</div><div class=\"calendar-day today\">22</div><div class=\"calendar-day\">23</div><div class=\"calendar-day\">24</div><div class=\"calendar-day\">25</div><div class=\"calendar-day\">26</div><div class=\"calendar-day\">27</div><div class=\"calendar-day\">28</div><div class=\"calendar-day\">29</div><div class=\"calendar-day\">30</div><div class=\"calendar-day other-month\">1</div><div class=\"calendar-day other-month\">2</div><div class=\"calendar-day other-month\">3</div><div class=\"calendar-day other-month\">4</div></div>\n                    </div>\n\n                    <!-- Quick Notes Section -->\n                    <div class=\"quick-links\">\n                        <h4><i class=\"fas fa-sticky-note\"></i> Quick Notes</h4>\n                        <div style=\"margin-bottom: 12px;\">\n                            <textarea id=\"quickNoteInput\" placeholder=\"Jot down a quick note...\" style=\"width: 100%; height: 100px; padding: 12px; border: 1px solid #e2e8f0; border-radius: 8px; font-size: 0.9em; resize: vertical; font-family: inherit; line-height: 1.4;\"></textarea>\n                            <div style=\"display: flex; gap: 4px; margin-top: 4px;\">\n                                <button onclick=\"addQuickNote()\" style=\"background: #3182ce; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer; font-size: 0.75em; flex: 1;\">Add Note</button>\n                                <button onclick=\"clearQuickNotes()\" style=\"background: #e53e3e; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer; font-size: 0.75em;\">Clear All</button>\n                            </div>\n                        </div>\n                        <div id=\"quickNotesList\" style=\"max-height: 300px; overflow-y: auto;\"><div style=\"text-align: center; color: #a0aec0; font-size: 0.75em; padding: 10px;\">No notes yet</div></div>\n                    </div>\n\n                    <!-- Quick Links Section -->\n                    <div class=\"quick-links\">\n                        <h4><i class=\"fas fa-link\"></i> Quick Links</h4>\n                        <a href=\"file:///X:/ClaudeCode/eNGINEdashBoard_Tasks/Nishen&#39;sTask_Notes_FileDashboard.html#\" class=\"quick-link\"><i class=\"fas fa-server\"></i> Server Management</a>\n                        <a href=\"file:///X:/ClaudeCode/eNGINEdashBoard_Tasks/Nishen&#39;sTask_Notes_FileDashboard.html#\" class=\"quick-link\"><i class=\"fas fa-database\"></i> SQL Server Tools</a>\n                        <a href=\"file:///X:/ClaudeCode/eNGINEdashBoard_Tasks/Nishen&#39;sTask_Notes_FileDashboard.html#\" class=\"quick-link\"><i class=\"fas fa-shield-alt\"></i> Security Center</a>\n                        <a href=\"file:///X:/ClaudeCode/eNGINEdashBoard_Tasks/Nishen&#39;sTask_Notes_FileDashboard.html#\" class=\"quick-link\"><i class=\"fas fa-users-cog\"></i> Active Directory</a>\n                        <a href=\"file:///X:/ClaudeCode/eNGINEdashBoard_Tasks/Nishen&#39;sTask_Notes_FileDashboard.html#\" class=\"quick-link\"><i class=\"fas fa-chart-line\"></i> Performance Monitor</a>\n                        <a href=\"file:///X:/ClaudeCode/eNGINEdashBoard_Tasks/Nishen&#39;sTask_Notes_FileDashboard.html#\" class=\"quick-link\"><i class=\"fas fa-file-alt\"></i> Documentation</a>\n                    </div>\n\n                    <!-- System Status -->\n                    <div class=\"quick-links\">\n                        <h4><i class=\"fas fa-heartbeat\"></i> System Status</h4>\n                        <div style=\"padding: 8px; font-size: 0.8em;\">\n                            <div style=\"display: flex; justify-content: space-between; margin-bottom: 4px;\">\n                                <span>Domain Controllers</span>\n                                <span style=\"color: #28a745;\">‚óèOnline</span>\n                            </div>\n                            <div style=\"display: flex; justify-content: space-between; margin-bottom: 4px;\">\n                                <span>SQL Servers</span>\n                                <span style=\"color: #28a745;\">‚óèOnline</span>\n                            </div>\n                            <div style=\"display: flex; justify-content: space-between; margin-bottom: 4px;\">\n                                <span>File Servers</span>\n                                <span style=\"color: #ffc107;\">‚óèWarning</span>\n                            </div>\n                            <div style=\"display: flex; justify-content: space-between;\">\n                                <span>Backup Status</span>\n                                <span style=\"color: #28a745;\">‚óèGood</span>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <button class=\"refresh-btn\" onclick=\"refreshAllPanels()\" title=\"Refresh All Panels\" style=\"display: none;\">\n        <i class=\"fas fa-sync-alt\"></i>\n    </button>\n\n    <!-- Hidden file input for import -->\n    <input type=\"file\" id=\"importFileInput\" accept=\".json\" onchange=\"handleImportFile(event)\">\n\n    <!-- Task Edit Modal -->\n    <div id=\"taskEditModal\" class=\"modal\" style=\"display: none;\">\n        <div class=\"modal-content\">\n            <h2><i class=\"fas fa-edit\"></i> Edit Task</h2>\n            <form id=\"taskEditForm\">\n                <div class=\"form-group\">\n                    <label for=\"editTaskTitle\">Title</label>\n                    <input type=\"text\" id=\"editTaskTitle\" required=\"\" placeholder=\"Task title...\">\n                </div>\n\n                <div class=\"form-group\">\n                    <label for=\"editTaskDescription\">Description</label>\n                    <textarea id=\"editTaskDescription\" placeholder=\"Task details...\"></textarea>\n                </div>\n\n                <div style=\"display: grid; grid-template-columns: 1fr 1fr; gap: 15px;\">\n                    <div class=\"form-group\">\n                        <label for=\"editTaskCategory\">Category</label>\n                        <select id=\"editTaskCategory\" required=\"\">\n                            <option value=\"\">Select...</option>\n                            <option value=\"Work\">Work</option>\n                            <option value=\"Personal\">Personal</option>\n                            <option value=\"Project\">Project</option>\n                            <option value=\"Meeting\">Meeting</option>\n                            <option value=\"Admin\">Admin</option>\n                            <option value=\"Learning\">Learning</option>\n                            <option value=\"Review\">Review</option>\n                        </select>\n                    </div>\n                    <div class=\"form-group\">\n                        <label for=\"editTaskHours\">Hours</label>\n                        <input type=\"number\" id=\"editTaskHours\" step=\"0.5\" min=\"0\" placeholder=\"0\">\n                    </div>\n                </div>\n\n                <div style=\"display: grid; grid-template-columns: 1fr 1fr; gap: 15px;\">\n                    <div class=\"form-group\">\n                        <label for=\"editTaskPriority\">Priority</label>\n                        <select id=\"editTaskPriority\" required=\"\">\n                            <option value=\"\">Select...</option>\n                            <option value=\"High\">High</option>\n                            <option value=\"Medium\">Medium</option>\n                            <option value=\"Low\">Low</option>\n                        </select>\n                    </div>\n                    <div class=\"form-group\">\n                        <label for=\"editTaskDueDate\">Due Date</label>\n                        <input type=\"date\" id=\"editTaskDueDate\" required=\"\" min=\"2025-09-22\">\n                    </div>\n                </div>\n\n                <div class=\"btn-group\">\n                    <button type=\"button\" class=\"btn btn-secondary\" onclick=\"closeTaskEditModal()\">Cancel</button>\n                    <button type=\"submit\" class=\"btn btn-primary\">Save Changes</button>\n                </div>\n            </form>\n        </div>\n    </div>\n\n    <!-- Configuration Modal -->\n    <div id=\"configModal\" class=\"modal\" style=\"display: none;\">\n        <div class=\"modal-content\">\n            <h2><i class=\"fas fa-cog\"></i> Configure Folder Path</h2>\n            <div class=\"form-group\">\n                <label for=\"panelTitle\">Panel Title:</label>\n                <input type=\"text\" id=\"panelTitle\" placeholder=\"e.g., PowerShell Scripts\">\n            </div>\n            <div class=\"form-group\">\n                <label for=\"folderPath\">Folder Path:</label>\n                <input type=\"text\" id=\"folderPath\" placeholder=\"e.g., C:\\Scripts\\PowerShell\">\n            </div>\n            <div class=\"btn-group\">\n                <button class=\"btn btn-secondary\" onclick=\"closeModal()\">Cancel</button>\n                <button class=\"btn btn-primary\" onclick=\"savePanelConfig()\">Save</button>\n            </div>\n        </div>\n    </div>\n\n    <script>\n        let panels = [];\n        let currentPanelIndex = -1;\n        let currentDate = new Date();\n\n        // Initialize everything when DOM is loaded\n        document.addEventListener('DOMContentLoaded', function() {\n            console.log('DOM loaded, initializing...');\n            \n            setTimeout(() => {\n                try {\n                    loadConfiguration();\n                    initializePanels();\n                    initializeDateTime();\n                    initializeCalendar();\n                    refreshAllPanels();\n                    console.log('Initialization complete');\n                } catch (error) {\n                    console.error('Initialization error:', error);\n                }\n            }, 100);\n        });\n\n        function initializePanels() {\n            const container = document.getElementById('gridContainer');\n            if (!container) {\n                console.error('Grid container not found');\n                return;\n            }\n            \n            updatePanelDisplays();\n            console.log('Panels initialized');\n        }\n\n        function updatePanelDisplays() {\n            for (let i = 0; i < 6; i++) {\n                const panel = panels[i];\n                const titleElement = document.getElementById(`panelTitle${i}`);\n                const pathElement = document.getElementById(`folderPath${i}`);\n\n                if (titleElement && pathElement) {\n                    if (panel) {\n                        titleElement.textContent = panel.title;\n                        pathElement.textContent = panel.path;\n                    } else {\n                        titleElement.textContent = `Panel ${i + 1}`;\n                        pathElement.textContent = 'No path configured';\n                    }\n                }\n            }\n        }\n\n        function openConfigModal(panelIndex) {\n            currentPanelIndex = panelIndex;\n            const panel = panels[panelIndex] || {};\n            \n            const titleInput = document.getElementById('panelTitle');\n            const pathInput = document.getElementById('folderPath');\n            const modal = document.getElementById('configModal');\n            \n            if (titleInput) titleInput.value = panel.title || `Panel ${panelIndex + 1}`;\n            if (pathInput) pathInput.value = panel.path || '';\n            if (modal) modal.style.display = 'block';\n        }\n\n        function closeModal() {\n            const modal = document.getElementById('configModal');\n            if (modal) modal.style.display = 'none';\n            currentPanelIndex = -1;\n        }\n\n        function savePanelConfig() {\n            if (currentPanelIndex === -1) return;\n\n            const titleInput = document.getElementById('panelTitle');\n            const pathInput = document.getElementById('folderPath');\n            \n            const title = titleInput ? titleInput.value : '';\n            const path = pathInput ? pathInput.value : '';\n\n            if (!title || !path) {\n                alert('Please fill in both title and folder path');\n                return;\n            }\n\n            panels[currentPanelIndex] = { title, path };\n            saveConfiguration();\n            updatePanelDisplays();\n            refreshPanel(currentPanelIndex);\n            closeModal();\n        }\n\n        function resetPanel(panelIndex) {\n            if (confirm(`Are you sure you want to reset Panel ${panelIndex + 1}? This will clear all configuration and files.`)) {\n                delete panels[panelIndex];\n                \n                const titleElement = document.getElementById(`panelTitle${panelIndex}`);\n                const pathElement = document.getElementById(`folderPath${panelIndex}`);\n                const fileListElement = document.getElementById(`fileList${panelIndex}`);\n                \n                if (titleElement) titleElement.textContent = `Panel ${panelIndex + 1}`;\n                if (pathElement) pathElement.textContent = 'No path configured';\n                if (fileListElement) {\n                    fileListElement.innerHTML = `\n                        <div class=\"empty-panel\">\n                            <i class=\"fas fa-folder-open\"></i>\n                            <div>Configure a folder path to view files</div>\n                        </div>\n                    `;\n                }\n                \n                saveConfiguration();\n            }\n        }\n\n        async function refreshPanel(panelIndex) {\n            const panel = panels[panelIndex];\n            if (!panel) return;\n\n            const fileListElement = document.getElementById(`fileList${panelIndex}`);\n            if (!fileListElement) return;\n            \n            try {\n                const files = await readRealFiles(panel.path);\n                displayFiles(fileListElement, files);\n            } catch (error) {\n                fileListElement.innerHTML = `\n                    <div class=\"empty-panel\">\n                        <i class=\"fas fa-exclamation-triangle\"></i>\n                        <div>Error reading folder: ${error.message}</div>\n                        <div style=\"font-size: 0.8em; margin-top: 10px;\">\n                            Check if the folder path exists and is accessible.\n                        </div>\n                    </div>\n                `;\n            }\n        }\n\n        async function readRealFiles(folderPath) {\n            // Mock data for demonstration\n            return [\n                { name: 'script1.ps1', ext: 'ps1', modified: new Date() },\n                { name: 'config.xml', ext: 'xml', modified: new Date() },\n                { name: 'report.html', ext: 'html', modified: new Date() }\n            ];\n        }\n\n        function displayFiles(container, files) {\n            if (!container) return;\n            \n            if (files.length === 0) {\n                container.innerHTML = `\n                    <div class=\"empty-panel\">\n                        <i class=\"fas fa-folder-open\"></i>\n                        <div>No files found in this directory</div>\n                    </div>\n                `;\n                return;\n            }\n\n            container.innerHTML = files.map(file => `\n                <div class=\"file-item ${file.ext}\" onclick=\"openFile('${file.name}', '${file.ext}')\">\n                    <div class=\"file-name\" title=\"${file.name}\">${file.name}</div>\n                    <div class=\"file-ext\">${file.ext.toUpperCase()}</div>\n                    <div class=\"file-date\">${formatDate(file.modified)}</div>\n                </div>\n            `).join('');\n        }\n\n        function openFile(fileName, extension) {\n            alert(`Opening ${fileName} (${extension.toUpperCase()}) - File handling functionality preserved from original`);\n        }\n\n        function formatDate(date) {\n            const now = new Date();\n            const diffTime = now - date;\n            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));\n\n            if (diffDays === 0) {\n                return 'Today';\n            } else if (diffDays === 1) {\n                return 'Yesterday';\n            } else if (diffDays < 7) {\n                return `${diffDays} days ago`;\n            } else {\n                return date.toLocaleDateString();\n            }\n        }\n\n        function refreshAllPanels() {\n            for (let i = 0; i < 6; i++) {\n                if (panels[i]) {\n                    refreshPanel(i);\n                }\n            }\n        }\n\n        function saveConfiguration() {\n            localStorage.setItem('fileBrowserPanels', JSON.stringify(panels));\n        }\n\n        function loadConfiguration() {\n            try {\n                const saved = localStorage.getItem('fileBrowserPanels');\n                if (saved) {\n                    panels = JSON.parse(saved);\n                }\n            } catch (error) {\n                console.error('Load configuration error:', error);\n                panels = [];\n            }\n        }\n\n        // DateTime functions\n        function initializeDateTime() {\n            updateDateTime();\n            setInterval(updateDateTime, 1000);\n        }\n\n        function updateDateTime() {\n            const now = new Date();\n            const timeOptions = { \n                hour12: false, \n                hour: '2-digit', \n                minute: '2-digit', \n                second: '2-digit' \n            };\n            const dateOptions = { \n                weekday: 'long', \n                year: 'numeric', \n                month: 'long', \n                day: 'numeric' \n            };\n\n            const timeElement = document.getElementById('currentTime');\n            const dateElement = document.getElementById('currentDate');\n            \n            if (timeElement) {\n                timeElement.textContent = now.toLocaleTimeString('en-US', timeOptions);\n            }\n            if (dateElement) {\n                dateElement.textContent = now.toLocaleDateString('en-US', dateOptions);\n            }\n        }\n\n        // Calendar functions\n        function initializeCalendar() {\n            renderCalendar();\n        }\n\n        function renderCalendar() {\n            const year = currentDate.getFullYear();\n            const month = currentDate.getMonth();\n            \n            const monthNames = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\n                \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\n            \n            const titleElement = document.getElementById('calendarTitle');\n            if (titleElement) {\n                titleElement.textContent = `${monthNames[month]} ${year}`;\n            }\n\n            const calendarGrid = document.getElementById('calendarGrid');\n            if (!calendarGrid) return;\n            \n            calendarGrid.innerHTML = '';\n\n            // Add day headers\n            const dayHeaders = ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'];\n            dayHeaders.forEach(day => {\n                const dayHeader = document.createElement('div');\n                dayHeader.className = 'calendar-day-header';\n                dayHeader.textContent = day;\n                calendarGrid.appendChild(dayHeader);\n            });\n\n            // Get first day of month and number of days\n            const firstDay = new Date(year, month, 1);\n            const lastDay = new Date(year, month + 1, 0);\n            const firstDayOfWeek = firstDay.getDay();\n            const daysInMonth = lastDay.getDate();\n\n            // Add empty cells for days before month starts\n            for (let i = 0; i < firstDayOfWeek; i++) {\n                const emptyDay = document.createElement('div');\n                emptyDay.className = 'calendar-day other-month';\n                const prevMonthDay = new Date(year, month, 0 - (firstDayOfWeek - 1 - i));\n                emptyDay.textContent = prevMonthDay.getDate();\n                calendarGrid.appendChild(emptyDay);\n            }\n\n            // Add days of current month\n            const today = new Date();\n            for (let day = 1; day <= daysInMonth; day++) {\n                const dayElement = document.createElement('div');\n                dayElement.className = 'calendar-day';\n                dayElement.textContent = day;\n                \n                // Highlight today\n                if (year === today.getFullYear() && \n                    month === today.getMonth() && \n                    day === today.getDate()) {\n                    dayElement.classList.add('today');\n                }\n                \n                calendarGrid.appendChild(dayElement);\n            }\n\n            // Add empty cells for days after month ends\n            const totalCells = calendarGrid.children.length;\n            const remainingCells = 42 - totalCells;\n            for (let i = 1; i <= remainingCells && i <= 14; i++) {\n                const nextMonthDay = document.createElement('div');\n                nextMonthDay.className = 'calendar-day other-month';\n                nextMonthDay.textContent = i;\n                calendarGrid.appendChild(nextMonthDay);\n            }\n        }\n\n        function previousMonth() {\n            currentDate.setMonth(currentDate.getMonth() - 1);\n            renderCalendar();\n        }\n\n        function nextMonth() {\n            currentDate.setMonth(currentDate.getMonth() + 1);\n            renderCalendar();\n        }\n\n        // Export/Import functions\n        function exportConfig() {\n            try {\n                const config = {\n                    panels: panels,\n                    exportDate: new Date().toISOString(),\n                    version: \"1.0\",\n                    application: \"Senior Systems Engineer File Browser\"\n                };\n\n                const dataStr = JSON.stringify(config, null, 2);\n                const dataBlob = new Blob([dataStr], { type: 'application/json' });\n                \n                const link = document.createElement('a');\n                link.href = URL.createObjectURL(dataBlob);\n                link.download = `file-browser-config-${new Date().toISOString().split('T')[0]}.json`;\n                document.body.appendChild(link);\n                link.click();\n                document.body.removeChild(link);\n                \n                alert('Configuration exported successfully!');\n            } catch (error) {\n                console.error('Export error:', error);\n                alert('Error exporting configuration: ' + error.message);\n            }\n        }\n\n        function importConfig() {\n            try {\n                const fileInput = document.getElementById('importFileInput');\n                if (fileInput) {\n                    fileInput.click();\n                }\n            } catch (error) {\n                console.error('Import error:', error);\n                alert('Error opening file dialog: ' + error.message);\n            }\n        }\n\n        function handleImportFile(event) {\n            try {\n                const file = event.target.files[0];\n                if (!file) return;\n\n                const reader = new FileReader();\n                reader.onload = function(e) {\n                    try {\n                        const config = JSON.parse(e.target.result);\n                        \n                        if (!config.panels || !Array.isArray(config.panels)) {\n                            throw new Error('Invalid configuration format');\n                        }\n\n                        const exportDate = config.exportDate ? new Date(config.exportDate).toLocaleDateString() : 'Unknown';\n                        const confirmMessage = `Import configuration exported on ${exportDate}?\\n\\nThis will replace your current configuration.`;\n                        if (confirm(confirmMessage)) {\n                            panels = config.panels;\n                            saveConfiguration();\n                            updatePanelDisplays();\n                            refreshAllPanels();\n                            alert('Configuration imported successfully!');\n                        }\n                    } catch (error) {\n                        alert(`Error importing configuration: ${error.message}`);\n                    }\n                };\n                reader.readAsText(file);\n                \n                event.target.value = '';\n            } catch (error) {\n                console.error('Handle import file error:', error);\n                alert('Error handling import file: ' + error.message);\n            }\n        }\n\n        // Tab switching functionality\n        function switchTab(tab) {\n            const fileBrowserSection = document.getElementById('gridContainer');\n            const taskTrackerSection = document.getElementById('taskTrackerSection');\n            const refreshBtn = document.querySelector('.refresh-btn');\n            const tabs = document.querySelectorAll('.nav-tab');\n            \n            // Update tab states\n            tabs.forEach(t => t.classList.remove('active'));\n            event.target.classList.add('active');\n            \n            if (tab === 'files') {\n                fileBrowserSection.style.display = 'grid';\n                taskTrackerSection.style.display = 'none';\n                refreshBtn.style.display = 'block';\n            } else if (tab === 'tasks') {\n                fileBrowserSection.style.display = 'none';\n                taskTrackerSection.style.display = 'block';\n                refreshBtn.style.display = 'none';\n                initializeTaskTracker();\n            }\n        }\n        \n        function initializeTaskTracker() {\n            // Task management variables\n            let tasks = [\n                {\n                    id: 1757329106448,\n                    title: \"Evo security\",\n                    description: \"Configure Solution (on)\",\n                    category: \"Project\",\n                    priority: \"High\",\n                    dueDate: \"2025-09-24\",\n                    hours: 2,\n                    status: \"pending\",\n                    createdAt: \"2025-09-19T10:00:00Z\",\n                    completedAt: null\n                },\n                {\n                    id: 1758269150099,\n                    title: \"Sql Server Upgrade /Optimization -Pather & Pather\",\n                    description: \"Upgrade SQL EXPRESS TO SQL 2019 , PROVISION NEW DISKS FOR db's , LOGS, oPTIMIZE 12H QUOTED\",\n                    category: \"Project\",\n                    priority: \"Medium\",\n                    dueDate: \"2025-09-20\",\n                    hours: 0,\n                    status: \"pending\",\n                    createdAt: \"2025-09-19T10:00:00Z\",\n                    completedAt: null\n                }\n            ];\n\n            // Quick Notes management\n            let quickNotes = [];\n\n            // Timer management\n            let taskTimers = {};\n            let currentEditTaskId = null;\n            \n            // Load tasks from localStorage\n            function loadTasks() {\n                try {\n                    const saved = localStorage.getItem('taskTracker_tasks');\n                    if (saved) {\n                        tasks = JSON.parse(saved);\n                    }\n                } catch (error) {\n                    console.error('Error loading saved tasks:', error);\n                }\n            }\n            \n            // Save tasks to localStorage\n            function saveTasks() {\n                try {\n                    localStorage.setItem('taskTracker_tasks', JSON.stringify(tasks));\n                } catch (error) {\n                    console.error('Error saving tasks:', error);\n                }\n            }\n\n            // Load notes from localStorage\n            function loadQuickNotes() {\n                try {\n                    const saved = localStorage.getItem('taskTracker_quickNotes');\n                    if (saved) {\n                        quickNotes = JSON.parse(saved);\n                    }\n                } catch (error) {\n                    console.error('Error loading saved notes:', error);\n                }\n            }\n            \n            // Save notes to localStorage\n            function saveQuickNotes() {\n                try {\n                    localStorage.setItem('taskTracker_quickNotes', JSON.stringify(quickNotes));\n                } catch (error) {\n                    console.error('Error saving notes:', error);\n                }\n            }\n\n            // Render quick notes\n            function renderQuickNotes() {\n                const notesList = document.getElementById('quickNotesList');\n                if (!notesList) return;\n\n                if (quickNotes.length === 0) {\n                    notesList.innerHTML = '<div style=\"text-align: center; color: #a0aec0; font-size: 0.75em; padding: 10px;\">No notes yet</div>';\n                    return;\n                }\n\n                notesList.innerHTML = quickNotes.map(note => `\n                    <div class=\"note-item\">\n                        <div class=\"note-content\">${escapeHtml(note.content)}</div>\n                        <div class=\"note-meta\">\n                            <span class=\"note-timestamp\">${formatNoteDate(note.createdAt)}</span>\n                            <div class=\"note-actions\">\n                                <button class=\"note-btn convert\" onclick=\"convertNoteToTask(${note.id})\" title=\"Convert to Task\">\n                                    <i class=\"fas fa-arrow-right\"></i>\n                                </button>\n                                <button class=\"note-btn delete\" onclick=\"deleteQuickNote(${note.id})\" title=\"Delete Note\">\n                                    <i class=\"fas fa-times\"></i>\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                `).join('');\n            }\n\n            // Add quick note function\n            window.addQuickNote = function() {\n                const input = document.getElementById('quickNoteInput');\n                if (!input) return;\n\n                const content = input.value.trim();\n                if (!content) {\n                    alert('Please enter a note before adding');\n                    return;\n                }\n\n                const note = {\n                    id: Date.now(),\n                    content: content,\n                    createdAt: new Date().toISOString()\n                };\n\n                quickNotes.unshift(note); // Add to beginning of array\n                saveQuickNotes();\n                renderQuickNotes();\n                input.value = ''; // Clear input\n            };\n\n            // Delete quick note function\n            window.deleteQuickNote = function(id) {\n                quickNotes = quickNotes.filter(note => note.id !== id);\n                saveQuickNotes();\n                renderQuickNotes();\n            };\n\n            // Clear all notes function\n            window.clearQuickNotes = function() {\n                if (quickNotes.length === 0) {\n                    alert('No notes to clear');\n                    return;\n                }\n\n                if (confirm(`Are you sure you want to delete all ${quickNotes.length} notes?`)) {\n                    quickNotes = [];\n                    saveQuickNotes();\n                    renderQuickNotes();\n                }\n            };\n\n            // Convert note to task function\n            window.convertNoteToTask = function(noteId) {\n                const note = quickNotes.find(n => n.id === noteId);\n                if (!note) return;\n\n                // Pre-fill the task form with note content\n                const titleInput = document.getElementById('taskTitle');\n                const descriptionInput = document.getElementById('taskDescription');\n                \n                if (titleInput) {\n                    // Use first 50 characters as title, or full content if shorter\n                    titleInput.value = note.content.length > 50 ? \n                        note.content.substring(0, 50) + '...' : \n                        note.content;\n                }\n                \n                if (descriptionInput) {\n                    descriptionInput.value = note.content;\n                }\n\n                // Set default values for new task\n                const categoryInput = document.getElementById('taskCategory');\n                const priorityInput = document.getElementById('taskPriority');\n                const dueDateInput = document.getElementById('taskDueDate');\n\n                if (categoryInput) categoryInput.value = 'Work';\n                if (priorityInput) priorityInput.value = 'Medium';\n                if (dueDateInput) {\n                    // Set due date to tomorrow\n                    const tomorrow = new Date();\n                    tomorrow.setDate(tomorrow.getDate() + 1);\n                    dueDateInput.value = tomorrow.toISOString().split('T')[0];\n                }\n\n                // Ask if user wants to delete the note after conversion\n                if (confirm('Note content copied to task form. Delete the original note?')) {\n                    deleteQuickNote(noteId);\n                }\n\n                // Scroll to task form\n                const taskForm = document.getElementById('taskForm');\n                if (taskForm) {\n                    taskForm.scrollIntoView({ behavior: 'smooth', block: 'start' });\n                }\n            };\n\n            // Format note date\n            function formatNoteDate(dateString) {\n                const date = new Date(dateString);\n                const now = new Date();\n                const diffMs = now - date;\n                const diffMins = Math.floor(diffMs / (1000 * 60));\n                const diffHours = Math.floor(diffMs / (1000 * 60 * 60));\n                const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));\n\n                if (diffMins < 1) return 'Just now';\n                if (diffMins < 60) return `${diffMins}m ago`;\n                if (diffHours < 24) return `${diffHours}h ago`;\n                if (diffDays < 7) return `${diffDays}d ago`;\n                return date.toLocaleDateString();\n            }\n\n            // Add Enter key support for quick note input\n            document.getElementById('quickNoteInput')?.addEventListener('keydown', function(e) {\n                if (e.key === 'Enter' && !e.shiftKey) {\n                    e.preventDefault();\n                    addQuickNote();\n                }\n            });\n            \n            // Update statistics\n            function updateStats() {\n                const total = tasks.length;\n                const completed = tasks.filter(t => t.status === 'completed').length;\n                const pending = tasks.filter(t => getTaskStatus(t) === 'pending').length;\n                const overdue = tasks.filter(t => getTaskStatus(t) === 'overdue').length;\n                \n                const totalEl = document.getElementById('totalTasks');\n                const completedEl = document.getElementById('completedTasks');\n                const pendingEl = document.getElementById('pendingTasks');\n                const overdueEl = document.getElementById('overdueTasks');\n                \n                if (totalEl) totalEl.textContent = total;\n                if (completedEl) completedEl.textContent = completed;\n                if (pendingEl) pendingEl.textContent = pending;\n                if (overdueEl) overdueEl.textContent = overdue;\n            }\n            \n            // Get task status\n            function getTaskStatus(task) {\n                if (task.status === 'completed') return 'completed';\n                \n                const today = new Date();\n                const dueDate = new Date(task.dueDate);\n                \n                if (dueDate < today) return 'overdue';\n                return task.status;\n            }\n\n            // Helper function to escape HTML\n            function escapeHtml(text) {\n                const div = document.createElement('div');\n                div.textContent = text;\n                return div.innerHTML;\n            }\n            \n            // Toggle task status\n            window.toggleTaskStatus = function(id) {\n                const task = tasks.find(t => t.id === id);\n                if (!task) return;\n                \n                if (task.status === 'completed') {\n                    task.status = 'pending';\n                    task.completedAt = null;\n                } else {\n                    task.status = 'completed';\n                    task.completedAt = new Date().toISOString();\n                }\n                \n                saveTasks();\n                updateStats();\n            };\n            \n            // Delete task\n            window.deleteTask = function(id) {\n                if (confirm('Are you sure you want to delete this task?')) {\n                    tasks = tasks.filter(t => t.id !== id);\n                    saveTasks();\n                    updateStats();\n                }\n            };\n\n            // Edit task function\n            window.editTask = function(id) {\n                const task = tasks.find(t => t.id === id);\n                if (!task) return;\n\n                currentEditTaskId = id;\n\n                // Populate edit form\n                document.getElementById('editTaskTitle').value = task.title;\n                document.getElementById('editTaskDescription').value = task.description;\n                document.getElementById('editTaskCategory').value = task.category;\n                document.getElementById('editTaskPriority').value = task.priority;\n                document.getElementById('editTaskDueDate').value = task.dueDate;\n                document.getElementById('editTaskHours').value = task.hours || 0;\n\n                // Show modal\n                document.getElementById('taskEditModal').style.display = 'block';\n            };\n\n            // Close task edit modal\n            window.closeTaskEditModal = function() {\n                document.getElementById('taskEditModal').style.display = 'none';\n                currentEditTaskId = null;\n            };\n\n            // Timer functions\n            window.toggleTimer = function(id) {\n                const timerBtn = document.getElementById(`timer-${id}`);\n                if (!timerBtn) return;\n\n                if (taskTimers[id]) {\n                    // Stop timer\n                    const startTime = taskTimers[id];\n                    const elapsedMs = Date.now() - startTime;\n                    const elapsedHours = elapsedMs / (1000 * 60 * 60);\n\n                    // Update task hours\n                    const task = tasks.find(t => t.id === id);\n                    if (task) {\n                        task.hours = (task.hours || 0) + elapsedHours;\n                        task.hours = Math.round(task.hours * 100) / 100; // Round to 2 decimal places\n                        saveTasks();\n                    }\n\n                    delete taskTimers[id];\n                    timerBtn.textContent = '‚ñ∂ Start';\n                    timerBtn.classList.remove('running');\n                } else {\n                    // Start timer\n                    taskTimers[id] = Date.now();\n                    timerBtn.textContent = '‚è∏ Stop';\n                    timerBtn.classList.add('running');\n                }\n            };\n\n            // Filter functions\n            window.applyFilters = function() {\n                const statusFilter = document.getElementById('filterStatus').value;\n                const priorityFilter = document.getElementById('filterPriority').value;\n                const categoryFilter = document.getElementById('filterCategory').value;\n\n                // This would normally filter the displayed tasks\n                // For now, we'll just show an alert\n                console.log('Applying filters:', { statusFilter, priorityFilter, categoryFilter });\n            };\n\n            window.clearFilters = function() {\n                document.getElementById('filterStatus').value = '';\n                document.getElementById('filterPriority').value = '';\n                document.getElementById('filterCategory').value = '';\n                applyFilters();\n            };\n            \n            // Add task form handler\n            const taskForm = document.getElementById('taskForm');\n            if (taskForm) {\n                taskForm.addEventListener('submit', function(e) {\n                    e.preventDefault();\n                    \n                    const title = document.getElementById('taskTitle').value.trim();\n                    const description = document.getElementById('taskDescription').value.trim();\n                    const category = document.getElementById('taskCategory').value;\n                    const priority = document.getElementById('taskPriority').value;\n                    const dueDate = document.getElementById('taskDueDate').value;\n                    const hours = parseFloat(document.getElementById('taskHours').value) || 0;\n                    \n                    if (!title || !category || !priority || !dueDate) {\n                        alert('Please fill in all required fields');\n                        return;\n                    }\n                    \n                    const task = {\n                        id: Date.now(),\n                        title: title,\n                        description: description,\n                        category: category,\n                        priority: priority,\n                        dueDate: dueDate,\n                        hours: hours,\n                        status: 'pending',\n                        createdAt: new Date().toISOString(),\n                        completedAt: null\n                    };\n                    \n                    tasks.push(task);\n                    saveTasks();\n                    updateStats();\n                    \n                    // Reset form\n                    taskForm.reset();\n                });\n            }\n            \n            // Edit task form handler\n            const taskEditForm = document.getElementById('taskEditForm');\n            if (taskEditForm) {\n                taskEditForm.addEventListener('submit', function(e) {\n                    e.preventDefault();\n\n                    if (!currentEditTaskId) return;\n\n                    const title = document.getElementById('editTaskTitle').value.trim();\n                    const description = document.getElementById('editTaskDescription').value.trim();\n                    const category = document.getElementById('editTaskCategory').value;\n                    const priority = document.getElementById('editTaskPriority').value;\n                    const dueDate = document.getElementById('editTaskDueDate').value;\n                    const hours = parseFloat(document.getElementById('editTaskHours').value) || 0;\n\n                    if (!title || !category || !priority || !dueDate) {\n                        alert('Please fill in all required fields');\n                        return;\n                    }\n\n                    // Find and update task\n                    const taskIndex = tasks.findIndex(t => t.id === currentEditTaskId);\n                    if (taskIndex !== -1) {\n                        tasks[taskIndex] = {\n                            ...tasks[taskIndex],\n                            title: title,\n                            description: description,\n                            category: category,\n                            priority: priority,\n                            dueDate: dueDate,\n                            hours: hours\n                        };\n\n                        saveTasks();\n                        updateStats();\n                        closeTaskEditModal();\n\n                        // In a real implementation, you would re-render the tasks list here\n                        alert('Task updated successfully! Please refresh to see changes.');\n                    }\n                });\n            }\n\n            // Set minimum date to today\n            const today = new Date().toISOString().split('T')[0];\n            const dueDateInput = document.getElementById('taskDueDate');\n            if (dueDateInput) {\n                dueDateInput.setAttribute('min', today);\n            }\n\n            const editDueDateInput = document.getElementById('editTaskDueDate');\n            if (editDueDateInput) {\n                editDueDateInput.setAttribute('min', today);\n            }\n            \n            // Initialize\n            loadTasks();\n            loadQuickNotes();\n            updateStats();\n            renderQuickNotes();\n        }\n\n        // Event handlers\n        window.onclick = function(event) {\n            const configModal = document.getElementById('configModal');\n            const taskEditModal = document.getElementById('taskEditModal');\n\n            if (event.target === configModal) {\n                closeModal();\n            }\n            if (event.target === taskEditModal) {\n                closeTaskEditModal();\n            }\n        }\n\n        document.addEventListener('keydown', function(event) {\n            const modal = document.getElementById('configModal');\n            if (event.key === 'Enter' && modal && modal.style.display === 'block') {\n                savePanelConfig();\n            }\n        });\n    </script>\n\n\n</body></html>",
        "category": "HTML Tools",
        "tags": [
          "Engineer",
          "Dashboard",
          "tasktracker"
        ],
        "created": "2025-09-28T21:54:43.129Z",
        "modified": "2025-09-28T21:58:41.334Z",
        "isPinned": false,
        "isArchived": false,
        "type": "html"
      },
      {
        "id": "note-1757846283968",
        "title": "UI Designing AI-Driven Terms",
        "content": "Here's a breakdown of key UI building terms for AI modernization:\n\nAI-Driven Design:\n\nGenerative AI (GenAI):\nUsing AI to create design elements, suggest layouts, and generate components based on historical data and real-time feedback. \n\nAI-Generated User Interfaces (AIGUI):\nDynamic designs created on the fly by AI companions or other AI-powered systems. \nAI-Powered Prototyping Tools:\nTools that leverage AI to suggest design elements and interaction patterns during the prototyping phase. \nModern UI/UX Principles:\nResponsiveness:\nDesigns that adapt to different screen sizes and devices, ensuring a consistent experience across platforms. \nInteraction Design:\nDesigning intuitive and smooth user interactions with elements like buttons, forms, and animations. \nBehavioral Design:\nFocusing on understanding and influencing user behavior through design to guide their actions within the interface. \nUsability:\nThe ease with which users can achieve their goals using the interface. \nAccessibility:\nDesigning interfaces that are usable by everyone, including people with disabilities. \nAI Integration into the UI:\nAI Interfaces and Presence:\nThe overall experience of interacting with AI within a digital interface, encompassing both functionality and aesthetics. \n\nContextual AI:\nAI that understands and adapts to the user's context, providing relevant information and features when needed. \n\nUnderlying Processes:\nPrototyping:\nCreating detailed representations of the final product to test and refine design concepts before full development. \n\nTest Automation:\nUsing automated tools to test user interfaces, improving development speed and reliability. ",
        "category": "Development",
        "tags": [
          "ui",
          "ai",
          "gui design"
        ],
        "created": "2025-09-14T10:38:03.968Z",
        "modified": "2025-09-14T10:41:23.991Z",
        "isPinned": true,
        "isArchived": false,
        "type": "document"
      },
      {
        "id": "note-1757453538331",
        "title": "UbUNTU Setup",
        "content": "iNSTALL uBUNTU 1ST , Launch terminal and update Ubuntu\n\n#!/bin/bash\nset -e\n\necho \"Starting Ubuntu configuration for Claude Code...\"\n\n# Update package lists\nsudo apt update && sudo apt upgrade -y\n\n# Install essential packages\nsudo apt install -y curl wget git build-essential python3 python3-pip nodejs npm\n\n# Install Node.js LTS via NodeSource\ncurl -fsSL https://deb.nodesource.com/setup_lts.x | sudo -E bash -\nsudo apt-get install -y nodejs\n\n# Verify installations\necho \"Node.js version: \\\"\necho \"npm version: \\\"\necho \"Python version: \\\"\n\n# Install Claude Code\necho \"Installing Claude Code...\"\nnpm install -g @anthropic-ai/claude-code\n\n# Verify Claude Code installation\nif command -v claude-code &> /dev/null; then\n    echo \"Claude Code installed successfully!\"\n    echo \"Version: \\\"\nelse\n    echo \"Claude Code installation failed!\"\n    exit 1\nfi\n\n# Set up git configuration prompts\necho \"Setting up Git configuration...\"\necho \"Please configure Git with your details:\"\nread -p \"Enter your Git username: \" git_username\nread -p \"Enter your Git email: \" git_email\n\ngit config --global user.name \"\\\"\ngit config --global user.email \"\\\"\n\n# Create workspace directory\nmkdir -p ~/workspace/claude-projects\ncd ~/workspace/claude-projects\n\necho \"Setup complete! You can now use Claude Code.\"\necho \"Run 'claude-code --help' to get started.\"\necho \"Workspace created at: ~/workspace/claude-projects\"\n",
        "category": "Setup Scripts -1installer",
        "tags": [
          "Ubuntu Setup",
          "Claude",
          "WSL"
        ],
        "created": "2025-09-09T21:32:18.331Z",
        "modified": "2025-09-09T21:34:22.558Z",
        "isPinned": false,
        "isArchived": false,
        "type": "code"
      },
      {
        "id": "note-1756884962650",
        "title": "Standby Email Template -Disk Alerts ",
        "content": "Standby Email Template -Disk Alerts \n====================================\n\nCreated in Nishen's AI Workspace on 2025/09/03\n\nOverview:\n---------\nDocument description here.\n\nContents:\n---------\n- Section 1\n- Section 2\n- Section 3\n\nNotes:\n------\nAdd your documentation content here.",
        "category": "Documentation",
        "tags": [
          "standby",
          "template"
        ],
        "created": "2025-09-03T07:36:02.650Z",
        "modified": "2025-09-03T07:36:02.650Z",
        "isPinned": false,
        "isArchived": false,
        "type": "document"
      },
      {
        "id": "note-1756884603452",
        "title": "Standby Template Failed Disk Alerts",
        "content": "Standby Template Failed Disk Alerts\n===================================\n\nCreated in Nishen's AI Workspace on 2025/09/03\n\nOverview:\n---------\nDocument description here.\n\nContents:\n---------\n- Section 1\n- Section 2\n- Section 3\n\nNotes:\n------\nAdd your documentation content here.",
        "category": "Documentation",
        "tags": [
          "standby",
          "template",
          ""
        ],
        "created": "2025-09-03T07:30:03.452Z",
        "modified": "2025-09-03T07:30:03.452Z",
        "isPinned": false,
        "isArchived": false,
        "type": "document"
      },
      {
        "id": "note-1755651165564",
        "title": "evo security",
        "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>evo security</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            margin: 0;\n            padding: 20px;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n            min-height: 100vh;\n        }\n        .container {\n            max-width: 800px;\n            margin: 0 auto;\n            background: rgba(255, 255, 255, 0.1);\n            padding: 30px;\n            border-radius: 15px;\n            backdrop-filter: blur(10px);\n        }\n        h1 { color: #fff; text-align: center; margin-bottom: 30px; }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>üöÄ evo security</h1>\n        <p>EVO Cloud\nFor the below we‚Äôre going to add a simple\n Evo Cloud Directory-as-a-Service (DaaS). Unlike the other directory types, an Evo Cloud directory doesn‚Äôt sync users, once the directory is created, you‚Äôll need to add users directly to Evo.\n1. From the left navigation menu, select My Company. Alternatively, select Customers and choose a customer from the list.\n2. From the side navigation, click Directories.\n3. Select the Evo Cloud tab.\n4. Click the Add New Directory\n5. Enter a name for the directory.\n6. Click Create Directory.\nAt this point, users will automatically start to populate into the People section of the Evo portal if you have setup one of the sync options.\n\nStep 3. User Licensing\nOnce you have users syncing and showing up in the People section, the next step is to assign those user licenses. To enable features like MFA, SSO, or Elevated Access, all users must have an Evo license assigned to them. \n1. Expand the below section to see instructions on how to assign licenses to users:\n\n\nAssigning Licenses\n1. On the People screen, select the user(s) using the checkbox on the left.\n2. Click Actions ‚Üí Assign Licenses ‚Üí EVO Standard.\n\n\n1. The license for the user now shows EVO Standard\n\n\n\nStep 4. Converting Users to Admins\nThe next step is to convert users to admins. When you or your technicians need to manage customers, need to have privileges within the Evo portal or use Elevated Access/Shared accounts, their user will need to be converted into an Admin. \nConverting a user to an admin does not give them additional privileges or access. That is configured separately in subsequent steps.\n1. Expand the below section to see instructions on how to convert users to admins:\n\nConverting Users into Evo Admins\n1. Select People from the left navigation menu.\n2. In the displayed list of users, click on the user you want to edit.\n3. Click Convert to Admin.\n\n\n4. Click Yes.\n\nStep 5. Setting Up EVO Portal Admins\nEVO Portal Admins are users that will have administrative access to your EVO MSP portal.\n\nRole-Based Permission Groups\nRole-Based Permissions are permission groups.\n5. Expand the below section to see instructions on how to create a permission group:\n\n\nCreating Role-Based Permission Groups & Assigning Users\n6. From the dashboard, click Access.\n7. Click Role-Based Permissions.\n8. Click Create New Permission Group.\n9. Enter a name for the new group (EVO Admins) for example, and optionally a description.\n\n\n10. Click Next.\n11. Check Select All Roles\n\n\n12. If creating a group for restricted permissions (Technician access for example), you can use the ‚ÄúTechnicians‚Äù example permissions below.\n13. Click Next.\n14. From the list of administrators, check each administrator that should be included in the group.\n15. Click Complete.\n\nExamples of Permissions for technicians that normally preform basic EVO management functions:\n‚Ä¢ Users\n\t‚Ä¢ All\n‚Ä¢ Directories\n\t‚Ä¢ View Directories\n‚Ä¢ Elevated Access\n\t‚Ä¢ Can be Elevated Admin\n‚Ä¢ Keys\n\t‚Ä¢ All\n‚Ä¢ Devices\n\t‚Ä¢ All\n‚Ä¢ Billing\n\t‚Ä¢ All\n‚Ä¢ Customers\n\t‚Ä¢ All\n‚Ä¢ Dashboard\n\t‚Ä¢ All\n\nCustomer Access Permissions\nNow we need to grant access to customers (if any) to your EVO admin users.\n16. Expand the below section to see instructions on how to grant customer permissions to EVO admins:\n\n\nManaging Customer Access\n17. From the dashboard, click Access.\n18. Click Customer Access.\n19. In the displayed list of customers located on the left, find the customer for the restrictions that are to be made. Click the customer‚Äôs name.\n20. From the list of administrators: Changes made are automatically saved.\n21. To grant access: Check the row for each user who should be granted access.\n22. To remove access: Uncheck the row for each user who should no longer be granted access.\n\n\n\nFrom <https://www.sonicwall.com/support/knowledge-base/evo-partner-deployment-guide/240827123540380> \n\nMSS EVO User Guide\n\n\n..</p>\n    </div>\n</body>\n</html>",
        "category": "Documentation",
        "tags": [],
        "created": "2025-08-20T00:52:45.564Z",
        "modified": "2025-08-20T00:54:59.928Z",
        "isPinned": true,
        "isArchived": false,
        "type": "html"
      },
      {
        "id": "note-1755524238196",
        "title": "Evo Security: RMS Technical Document ",
        "content": "Evo Security: RMS Technical Document -    by:  Nishen Harichunder RMS L4            Aug 2025\n\n\nFTRMS Engineer Group Definitions - (Naming conventions & Standards)\n\n\n\n\n\n\n\n\n\n\nEVO User Accounts - Explained\n\n1. Use Evo Cloud User for everyday MSP engineers or operational staff.\n\n2. Use Evo Cloud User (Admin) for MSP administrators who manage the EvoSecurity environment.   - (Restricted to L4 )\n\n3. Use Evo Cloud User (Guest) for temporary or highly restricted access users such as external auditors or clients with minimal interaction rights.\n\n\nChoosing the appropriate user type ensures proper segmentation of duties and adherence to least privilege principles within the EvoSecurity system.\n\n",
        "category": "System Admin",
        "tags": [
          "EvoSecurity",
          "evo",
          "rms doc",
          "msp"
        ],
        "created": "2025-08-18T13:37:18.196Z",
        "modified": "2025-08-18T13:48:16.093Z",
        "isPinned": false,
        "isArchived": false,
        "type": "document"
      },
      {
        "id": "note-1755179491076",
        "title": "Halo and Ncentral Cheats",
        "content": "Halo and Ncentral Cheats\n========================\n\nCreated in Nishen's AI Workspace on 2025/08/14\n\nOverview:\n---------\nDocument description here.\n\nContents:\n---------\n- Section 1\n- Section 2\n- Section 3\n\nNotes:\n------\nAdd your documentation content here.",
        "category": "Documentation",
        "tags": [
          "cheats"
        ],
        "created": "2025-08-14T13:51:31.076Z",
        "modified": "2025-08-14T13:51:31.076Z",
        "isPinned": false,
        "isArchived": false,
        "type": "document"
      },
      {
        "id": "note-1754492581306",
        "title": "Rewst-Enhanced Power Verification Solution<Standby checks -POWER CONFIRMATION ",
        "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Email Summary - Rewst Power Verification</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            line-height: 1.6;\n            color: #333;\n            max-width: 800px;\n            margin: 0 auto;\n            padding: 20px;\n            background: #f9f9f9;\n        }\n        \n        .email-container {\n            background: white;\n            padding: 30px;\n            border-radius: 8px;\n            box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n        }\n        \n        .header {\n            text-align: center;\n            margin-bottom: 30px;\n            padding-bottom: 15px;\n            border-bottom: 2px solid #3498db;\n        }\n        \n        .header h1 {\n            color: #2c3e50;\n            margin: 0;\n            font-size: 1.8em;\n        }\n        \n        .header p {\n            color: #7f8c8d;\n            margin: 5px 0 0 0;\n            font-style: italic;\n        }\n        \n        .executive-summary {\n            background: linear-gradient(135deg, #3498db, #2980b9);\n            color: white;\n            padding: 20px;\n            border-radius: 8px;\n            margin: 20px 0;\n            text-align: center;\n        }\n        \n        .key-benefits {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));\n            gap: 15px;\n            margin: 20px 0;\n        }\n        \n        .benefit-card {\n            background: #e8f4fd;\n            border: 1px solid #bee5eb;\n            border-radius: 6px;\n            padding: 15px;\n            text-align: center;\n        }\n        \n        .benefit-number {\n            font-size: 2em;\n            font-weight: bold;\n            color: #e74c3c;\n            margin-bottom: 5px;\n        }\n        \n        .benefit-text {\n            font-size: 0.9em;\n            color: #2c3e50;\n        }\n        \n        .flowchart {\n            background: #f8f9fa;\n            border: 2px solid #dee2e6;\n            border-radius: 10px;\n            padding: 20px;\n            margin: 25px 0;\n            text-align: center;\n        }\n        \n        .flow-step {\n            display: inline-block;\n            background: #fff;\n            border: 2px solid #3498db;\n            border-radius: 8px;\n            padding: 12px;\n            margin: 8px;\n            min-width: 120px;\n            font-size: 0.9em;\n            vertical-align: top;\n        }\n        \n        .flow-trigger {\n            background: linear-gradient(135deg, #e74c3c, #c0392b);\n            color: white;\n            border-color: #c0392b;\n        }\n        \n        .flow-process {\n            background: linear-gradient(135deg, #9b59b6, #8e44ad);\n            color: white;\n            border-color: #8e44ad;\n        }\n        \n        .flow-decision {\n            background: linear-gradient(135deg, #f39c12, #e67e22);\n            color: white;\n            border-color: #e67e22;\n            border-radius: 50px;\n            width: 140px;\n            height: 80px;\n            display: inline-flex;\n            align-items: center;\n            justify-content: center;\n            text-align: center;\n        }\n        \n        .flow-outcome-a {\n            background: linear-gradient(135deg, #e74c3c, #c0392b);\n            color: white;\n            border-color: #c0392b;\n        }\n        \n        .flow-outcome-b {\n            background: linear-gradient(135deg, #27ae60, #229954);\n            color: white;\n            border-color: #229954;\n        }\n        \n        .flow-arrow {\n            font-size: 20px;\n            color: #3498db;\n            margin: 0 5px;\n        }\n        \n        .comparison-table {\n            width: 100%;\n            border-collapse: collapse;\n            margin: 20px 0;\n            font-size: 0.9em;\n        }\n        \n        .comparison-table th,\n        .comparison-table td {\n            padding: 10px;\n            border: 1px solid #ddd;\n            text-align: left;\n        }\n        \n        .comparison-table th {\n            background: #3498db;\n            color: white;\n        }\n        \n        .comparison-table tr:nth-child(even) {\n            background: #f8f9fa;\n        }\n        \n        .current-problem {\n            background: #fff5f5;\n            border-left: 4px solid #e74c3c;\n            padding: 15px;\n            margin: 15px 0;\n        }\n        \n        .proposed-solution {\n            background: #f0fff4;\n            border-left: 4px solid #27ae60;\n            padding: 15px;\n            margin: 15px 0;\n        }\n        \n        .timeline {\n            background: #f8f9fa;\n            border-radius: 8px;\n            padding: 15px;\n            margin: 20px 0;\n        }\n        \n        .timeline-item {\n            display: flex;\n            align-items: center;\n            margin: 10px 0;\n            padding: 8px;\n            background: white;\n            border-radius: 5px;\n        }\n        \n        .timeline-day {\n            background: #3498db;\n            color: white;\n            border-radius: 50%;\n            width: 35px;\n            height: 35px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            margin-right: 15px;\n            font-weight: bold;\n            font-size: 0.8em;\n        }\n        \n        .roi-highlight {\n            background: linear-gradient(135deg, #2ecc71, #27ae60);\n            color: white;\n            padding: 20px;\n            border-radius: 8px;\n            text-align: center;\n            margin: 20px 0;\n        }\n        \n        .action-required {\n            background: #fff3cd;\n            border: 1px solid #ffc107;\n            border-radius: 6px;\n            padding: 15px;\n            margin: 20px 0;\n        }\n        \n        .signature {\n            margin-top: 30px;\n            padding-top: 15px;\n            border-top: 1px solid #dee2e6;\n            font-size: 0.9em;\n            color: #6c757d;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"email-container\">\n        <div class=\"header\">\n            <h1>üöÄ Automated Power Verification Solution</h1>\n            <p>Rewst-Enhanced Implementation | FTech KZN | August 2025</p>\n        </div>\n\n        <div class=\"executive-summary\">\n            <h3 style=\"margin-top: 0;\">Executive Summary</h3>\n            <p>Transform FTech's incident response from manual customer inquiries to intelligent, automated service delivery. Eliminate \"Do you have power?\" calls and provide proactive customer communication.</p>\n        </div>\n\n        <h3>üìä Key Benefits & ROI</h3>\n        <div class=\"key-benefits\">\n            <div class=\"benefit-card\">\n                <div class=\"benefit-number\">80%</div>\n                <div class=\"benefit-text\">Reduction in Customer<br>Power Inquiries</div>\n            </div>\n            <div class=\"benefit-card\">\n                <div class=\"benefit-number\">40%</div>\n                <div class=\"benefit-text\">Faster Mean Time<br>to Resolution</div>\n            </div>\n            <div class=\"benefit-card\">\n                <div class=\"benefit-number\">90%</div>\n                <div class=\"benefit-text\">Automated Ticket<br>Enrichment Rate</div>\n            </div>\n            <div class=\"benefit-card\">\n                <div class=\"benefit-number\">10</div>\n                <div class=\"benefit-text\">Days Implementation<br>Timeline</div>\n            </div>\n        </div>\n\n        <h3>üîÑ Complete Workflow Process</h3>\n        <div class=\"flowchart\">\n            <!-- Row 1: Trigger -->\n            <div style=\"margin: 15px 0;\">\n                <div class=\"flow-step flow-trigger\">\n                    <strong>üö® SERVER OFFLINE</strong><br>\n                    N-Central Alert<br>\n                    \"OfflineDevice Rule\"\n                </div>\n            </div>\n            \n            <div class=\"flow-arrow\">‚¨áÔ∏è</div>\n            \n            <!-- Row 2: Processing -->\n            <div style=\"margin: 15px 0;\">\n                <div class=\"flow-step flow-process\">\n                    <strong>üîç REWST WORKFLOW</strong><br>\n                    Automated Correlation<br>\n                    Multi-Source Analysis\n                </div>\n            </div>\n            \n            <div class=\"flow-arrow\">‚¨áÔ∏è</div>\n            \n            <!-- Row 3: Data Collection -->\n            <div style=\"margin: 15px 0;\">\n                <div class=\"flow-step\" style=\"background: #ecf0f1; border-color: #bdc3c7;\">\n                    <strong>N-Central</strong><br>\n                    Site Devices<br>\n                    OOB Status\n                </div>\n                \n                <div class=\"flow-step\" style=\"background: #ecf0f1; border-color: #bdc3c7;\">\n                    <strong>NMSaaS</strong><br>\n                    APs, Switches<br>\n                    Firewall, Router\n                </div>\n                \n                <div class=\"flow-step\" style=\"background: #ecf0f1; border-color: #bdc3c7;\">\n                    <strong>WAN Links</strong><br>\n                    Primary Link<br>\n                    Failover Status\n                </div>\n            </div>\n            \n            <div class=\"flow-arrow\">‚¨áÔ∏è</div>\n            \n            <!-- Row 4: Decision -->\n            <div style=\"margin: 20px 0;\">\n                <div class=\"flow-decision\">\n                    <strong>‚ö° POWER<br>STATUS<br>DECISION</strong>\n                </div>\n            </div>\n            \n            <div style=\"margin: 10px 0;\">\n                <span class=\"flow-arrow\">‚¨áÔ∏è</span>\n                <span style=\"margin: 0 80px;\"></span>\n                <span class=\"flow-arrow\">‚¨áÔ∏è</span>\n            </div>\n            \n            <!-- Row 5: Outcomes -->\n            <div style=\"margin: 15px 0;\">\n                <div class=\"flow-step flow-outcome-a\" style=\"display: inline-block; margin: 0 20px;\">\n                    <strong>üî¥ OUTCOME A</strong><br>\n                    POWER OUTAGE<br>\n                    <small>Confidence &lt;50%</small><br><br>\n                    \n                    <div style=\"font-size: 0.8em; margin-top: 8px;\">\n                        ‚Ä¢ Critical Priority<br>\n                        ‚Ä¢ Utility Engagement<br>\n                        ‚Ä¢ Proactive Customer SMS\n                    </div>\n                </div>\n                \n                <div class=\"flow-step flow-outcome-b\" style=\"display: inline-block; margin: 0 20px;\">\n                    <strong>üü¢ OUTCOME B</strong><br>\n                    DEVICE ISSUE<br>\n                    <small>Confidence ‚â•80%</small><br><br>\n                    \n                    <div style=\"font-size: 0.8em; margin-top: 8px;\">\n                        ‚Ä¢ Medium Priority<br>\n                        ‚Ä¢ Hardware Investigation<br>\n                        ‚Ä¢ Technical Update Email\n                    </div>\n                </div>\n            </div>\n            \n            <div style=\"background: #d5f4e6; padding: 10px; border-radius: 5px; margin-top: 20px; border: 2px solid #27ae60;\">\n                <strong>‚úÖ RESULT: Zero manual verification + Proactive customer communication</strong>\n            </div>\n        </div>\n\n        <h3>üìã Current vs Future State</h3>\n        <table class=\"comparison-table\">\n            <tr>\n                <th>Process</th>\n                <th>Current State ‚ùå</th>\n                <th>Future State ‚úÖ</th>\n            </tr>\n            <tr>\n                <td><strong>Power Verification</strong></td>\n                <td>Manual customer calls</td>\n                <td>Automated multi-source correlation</td>\n            </tr>\n            <tr>\n                <td><strong>Data Collection</strong></td>\n                <td>Manual NMSaaS login checks</td>\n                <td>Parallel API queries (5 seconds)</td>\n            </tr>\n            <tr>\n                <td><strong>Ticket Creation</strong></td>\n                <td>Basic alerts, no context</td>\n                <td>Enriched tickets with full analysis</td>\n            </tr>\n            <tr>\n                <td><strong>Customer Communication</strong></td>\n                <td>\"Do you have power?\"</td>\n                <td>\"We've detected a power outage\"</td>\n            </tr>\n            <tr>\n                <td><strong>Response Time</strong></td>\n                <td>15+ minutes investigation</td>\n                <td>Immediate intelligent response</td>\n            </tr>\n        </table>\n\n        <h3>üí∞ Why Rewst Changes Everything</h3>\n        <div class=\"current-problem\">\n            <h4>‚ùå Without Rewst (Original 4-Week Plan):</h4>\n            <ul>\n                <li>Custom PowerShell service development required</li>\n                <li>Manual Windows service management and maintenance</li>\n                <li>Basic error handling and single-threaded processing</li>\n                <li>Limited visibility into workflow execution</li>\n            </ul>\n        </div>\n\n        <div class=\"proposed-solution\">\n            <h4>‚úÖ With Rewst Integration (10-Day Implementation):</h4>\n            <ul>\n                <li><strong>75% faster implementation</strong> - Visual workflow builder, no coding</li>\n                <li><strong>Enterprise reliability</strong> - 99.9% uptime SLA, advanced error handling</li>\n                <li><strong>Real-time monitoring</strong> - Live dashboards, performance analytics</li>\n                <li><strong>Parallel processing</strong> - Sub-10 second correlation vs 30+ seconds</li>\n            </ul>\n        </div>\n\n        <h3>üìÖ Implementation Timeline</h3>\n        <div class=\"timeline\">\n            <div class=\"timeline-item\">\n                <div class=\"timeline-day\">1-2</div>\n                <div><strong>Foundation Setup:</strong> API validation, Rewst access, site inventory</div>\n            </div>\n            <div class=\"timeline-item\">\n                <div class=\"timeline-day\">3-6</div>\n                <div><strong>Workflow Development:</strong> Visual workflow creation, data correlation logic</div>\n            </div>\n            <div class=\"timeline-item\">\n                <div class=\"timeline-day\">7-8</div>\n                <div><strong>Testing & Validation:</strong> End-to-end testing, pilot customer validation</div>\n            </div>\n            <div class=\"timeline-item\">\n                <div class=\"timeline-day\">9-10</div>\n                <div><strong>Go-Live & Training:</strong> Production deployment, staff training</div>\n            </div>\n        </div>\n\n        <div class=\"roi-highlight\">\n            <h3 style=\"margin-top: 0;\">üéØ Strategic Impact</h3>\n            <p><strong>This transforms FTech from reactive support to proactive service delivery, establishing us as the premier MSP in the region through intelligent automation and superior customer experience.</strong></p>\n        </div>\n\n        <h3>‚ö° Technical Requirements</h3>\n        <ul>\n            <li><strong>‚úÖ Rewst Platform:</strong> Already integrated with N-Central and HaloPSA</li>\n            <li><strong>‚úÖ API Access:</strong> Existing N-Central and HaloPSA API credentials</li>\n            <li><strong>üîß NMSaaS Integration:</strong> API access validation required</li>\n            <li><strong>üìã Configuration:</strong> Alert rules, webhook setup, ticket templates</li>\n        </ul>\n\n        <div class=\"action-required\">\n            <h4>üöÄ Action Required - Management Decision</h4>\n            <p><strong>Recommendation:</strong> Proceed with immediate implementation to capitalize on Rewst's existing integration and achieve rapid ROI.</p>\n            \n            <p><strong>Next Steps:</strong></p>\n            <ul>\n                <li>Management approval to proceed</li>\n                <li>Project team assignment (Technical Lead, Platform Admins)</li>\n                <li>Pilot customer site selection</li>\n                <li>Implementation start date confirmation</li>\n            </ul>\n            \n            <p><strong>Expected Go-Live:</strong> End of August 2025</p>\n        </div>\n\n        <h3>üìä Success Metrics (30 Days Post-Implementation)</h3>\n        <ul>\n            <li><strong>Zero</strong> manual power verification customer calls</li>\n            <li><strong>90%+</strong> automated ticket enrichment rate</li>\n            <li><strong>40%</strong> reduction in mean time to resolution</li>\n            <li><strong>25%</strong> improvement in customer satisfaction scores</li>\n            <li><strong>&lt;5%</strong> false positive rate</li>\n        </ul>\n\n        <div style=\"background: linear-gradient(135deg, #3498db, #2980b9); color: white; padding: 20px; border-radius: 8px; text-align: center; margin: 25px 0;\">\n            <h4 style=\"margin-top: 0;\">üí° Bottom Line</h4>\n            <p style=\"margin-bottom: 0; font-size: 1.1em;\">\n                <strong>With Rewst already integrated, this solution delivers enterprise-grade automation in 10 days instead of 4+ weeks, transforming customer experience while reducing operational overhead.</strong>\n            </p>\n        </div>\n\n        <div class=\"signature\">\n            <p><strong>Prepared by:</strong> Senior Systems Engineer<br>\n            <strong>For:</strong> RMS - First Technology KZN<br>\n            <strong>Project Sponsor:</strong> Nishen Harichunder<br>\n            <strong>Date:</strong> August 2025</p>\n        </div>\n    </div>\n</body>\n</html>",
        "category": "Documentation",
        "tags": [],
        "created": "2025-08-06T15:03:01.306Z",
        "modified": "2025-08-06T15:04:51.949Z",
        "isPinned": false,
        "isArchived": false,
        "type": "html"
      },
      {
        "id": "note-1754479735446",
        "title": "Rewst-Enhanced Power Verification Solution<Standby checks -POWER CONFIRMATION ",
        "content": "\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Rewst-Enhanced Power Verification Solution</title>\n    <style>\n        body {\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n            line-height: 1.6;\n            color: #333;\n            max-width: 1200px;\n            margin: 0 auto;\n            padding: 20px;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            min-height: 100vh;\n        }\n        \n        .container {\n            background: white;\n            border-radius: 15px;\n            padding: 30px;\n            box-shadow: 0 20px 40px rgba(0,0,0,0.1);\n        }\n        \n        h1 {\n            color: #2c3e50;\n            text-align: center;\n            margin-bottom: 30px;\n            font-size: 2.5em;\n            background: linear-gradient(45deg, #3498db, #2ecc71);\n            -webkit-background-clip: text;\n            -webkit-text-fill-color: transparent;\n        }\n        \n        h2 {\n            color: #34495e;\n            border-bottom: 3px solid #3498db;\n            padding-bottom: 10px;\n            margin-top: 40px;\n        }\n        \n        .comparison-grid {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 30px;\n            margin: 30px 0;\n        }\n        \n        .before-box {\n            background: #fff5f5;\n            border: 2px solid #e74c3c;\n            border-radius: 10px;\n            padding: 20px;\n        }\n        \n        .after-box {\n            background: #f0fff4;\n            border: 2px solid #27ae60;\n            border-radius: 10px;\n            padding: 20px;\n        }\n        \n        .box-header {\n            font-weight: bold;\n            font-size: 1.2em;\n            margin-bottom: 15px;\n            text-align: center;\n        }\n        \n        .before-header {\n            color: #e74c3c;\n        }\n        \n        .after-header {\n            color: #27ae60;\n        }\n        \n        .workflow-section {\n            background: #f8f9fa;\n            border: 2px solid #e9ecef;\n            border-radius: 15px;\n            padding: 30px;\n            margin: 30px 0;\n        }\n        \n        .rewst-workflow {\n            background: linear-gradient(135deg, #6c5ce7, #a29bfe);\n            color: white;\n            padding: 20px;\n            border-radius: 10px;\n            margin: 20px 0;\n            text-align: center;\n        }\n        \n        .workflow-step {\n            background: white;\n            border: 1px solid #ddd;\n            border-radius: 8px;\n            padding: 15px;\n            margin: 15px 0;\n            display: flex;\n            align-items: center;\n        }\n        \n        .step-number {\n            background: #3498db;\n            color: white;\n            border-radius: 50%;\n            width: 30px;\n            height: 30px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            margin-right: 15px;\n            font-weight: bold;\n        }\n        \n        .advantage-card {\n            background: #e8f5e8;\n            border-left: 4px solid #27ae60;\n            padding: 15px;\n            margin: 15px 0;\n            border-radius: 5px;\n        }\n        \n        .implementation-table {\n            width: 100%;\n            border-collapse: collapse;\n            margin: 20px 0;\n        }\n        \n        .implementation-table th,\n        .implementation-table td {\n            border: 1px solid #ddd;\n            padding: 12px;\n            text-align: left;\n        }\n        \n        .implementation-table th {\n            background: #3498db;\n            color: white;\n        }\n        \n        .implementation-table tr:nth-child(even) {\n            background: #f2f2f2;\n        }\n        \n        .code-block {\n            background: #2d3748;\n            color: #e2e8f0;\n            padding: 20px;\n            border-radius: 8px;\n            overflow-x: auto;\n            font-family: 'Courier New', monospace;\n            margin: 15px 0;\n        }\n        \n        .highlight {\n            background: #fff3cd;\n            padding: 2px 6px;\n            border-radius: 4px;\n            font-weight: bold;\n        }\n        \n        .warning-box {\n            background: #fff3cd;\n            border: 1px solid #ffeaa7;\n            border-radius: 6px;\n            padding: 15px;\n            margin: 15px 0;\n            border-left: 4px solid #ffc107;\n        }\n        \n        .info-box {\n            background: #d1ecf1;\n            border: 1px solid #bee5eb;\n            border-radius: 6px;\n            padding: 15px;\n            margin: 15px 0;\n            border-left: 4px solid #17a2b8;\n        }\n        \n        .metric-improvement {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n            gap: 20px;\n            margin: 30px 0;\n        }\n        \n        .metric-card {\n            background: linear-gradient(135deg, #74b9ff, #0984e3);\n            color: white;\n            padding: 20px;\n            border-radius: 10px;\n            text-align: center;\n        }\n        \n        .metric-number {\n            font-size: 2em;\n            font-weight: bold;\n            margin-bottom: 5px;\n        }\n        \n        .architecture-diagram {\n            background: #f8f9fa;\n            border: 2px dashed #6c757d;\n            border-radius: 10px;\n            padding: 20px;\n            text-align: center;\n            margin: 20px 0;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>üöÄ Rewst-Enhanced Power Verification Solution</h1>\n        \n        <div class=\"info-box\">\n            <strong>üéØ Game Changer:</strong> With Rewst already integrated to N-Central and HaloPSA APIs, this solution transforms from a custom PowerShell implementation to a robust, enterprise-grade automation platform with advanced workflow capabilities, error handling, and scalability.\n        </div>\n\n        <h2>üìà How Rewst Transforms the Solution</h2>\n\n        <div class=\"comparison-grid\">\n            <div class=\"before-box\">\n                <div class=\"box-header before-header\">‚ùå Without Rewst (Original Plan)</div>\n                <ul>\n                    <li>Custom PowerShell service development</li>\n                    <li>Manual Windows service management</li>\n                    <li>Basic error handling</li>\n                    <li>Limited workflow visualization</li>\n                    <li>Monitoring via logs only</li>\n                    <li>Single-threaded processing</li>\n                    <li>4+ weeks development time</li>\n                </ul>\n            </div>\n            \n            <div class=\"after-box\">\n                <div class=\"box-header after-header\">‚úÖ With Rewst Integration</div>\n                <ul>\n                    <li>Visual workflow builder - no coding required</li>\n                    <li>Enterprise-grade automation platform</li>\n                    <li>Advanced error handling & retry logic</li>\n                    <li>Real-time workflow monitoring</li>\n                    <li>Built-in alerting and notifications</li>\n                    <li>Parallel processing capabilities</li>\n                    <li>1-2 weeks implementation time</li>\n                </ul>\n            </div>\n        </div>\n\n        <h2>üîß Rewst-Enhanced Architecture</h2>\n\n        <div class=\"architecture-diagram\">\n            <h3>Streamlined Integration Flow</h3>\n            \n            <div style=\"display: flex; justify-content: space-around; align-items: center; flex-wrap: wrap; gap: 20px; margin: 30px 0;\">\n                <div style=\"background: #3498db; color: white; padding: 15px; border-radius: 8px; min-width: 150px;\">\n                    <strong>N-Central Alert</strong><br>\n                    Device Offline<br>\n                    Webhook Trigger\n                </div>\n                \n                <div style=\"font-size: 28px; color: #e74c3c;\">‚û°Ô∏è</div>\n                \n                <div style=\"background: #6c5ce7; color: white; padding: 15px; border-radius: 8px; min-width: 150px;\">\n                    <strong>Rewst Workflow</strong><br>\n                    Automated Correlation<br>\n                    Decision Engine\n                </div>\n                \n                <div style=\"font-size: 28px; color: #e74c3c;\">‚û°Ô∏è</div>\n                \n                <div style=\"background: #27ae60; color: white; padding: 15px; border-radius: 8px; min-width: 150px;\">\n                    <strong>HaloPSA Ticket</strong><br>\n                    Enriched Context<br>\n                    Automated Priority\n                </div>\n            </div>\n        </div>\n\n        <h2>üéØ Enhanced Workflow with Rewst</h2>\n\n        <div class=\"rewst-workflow\">\n            <h3 style=\"margin-top: 0;\">‚ö° Rewst Automation Workflow</h3>\n            <p>Visual, drag-and-drop workflow builder with enterprise capabilities</p>\n        </div>\n\n        <div class=\"workflow-section\">\n            <h4 style=\"color: #2c3e50; margin-top: 0;\">Complete Rewst Workflow Steps:</h4>\n            \n            <div class=\"workflow-step\">\n                <div class=\"step-number\">1</div>\n                <div>\n                    <strong>Webhook Trigger:</strong> N-Central sends OfflineDevice alert to Rewst webhook endpoint\n                    <br><em>Advantage: Instant triggering, no polling delays</em>\n                </div>\n            </div>\n            \n            <div class=\"workflow-step\">\n                <div class=\"step-number\">2</div>\n                <div>\n                    <strong>Parallel Data Collection:</strong> Rewst simultaneously queries multiple sources\n                    <br><em>‚Ä¢ N-Central API: Site devices, OOB status, connectivity</em>\n                    <br><em>‚Ä¢ NMSaaS API: APs, switches, firewalls, routers</em>\n                    <br><em>‚Ä¢ External checks: ISP gateways, DNS servers</em>\n                </div>\n            </div>\n            \n            <div class=\"workflow-step\">\n                <div class=\"step-number\">3</div>\n                <div>\n                    <strong>Intelligent Decision Engine:</strong> Built-in logic evaluates all data points\n                    <br><em>Advantage: Visual decision trees, easy to modify thresholds</em>\n                </div>\n            </div>\n            \n            <div class=\"workflow-step\">\n                <div class=\"step-number\">4</div>\n                <div>\n                    <strong>Dynamic Ticket Creation:</strong> HaloPSA API creates contextual tickets\n                    <br><em>Advantage: Template-based, consistent formatting, automatic field population</em>\n                </div>\n            </div>\n            \n            <div class=\"workflow-step\">\n                <div class=\"step-number\">5</div>\n                <div>\n                    <strong>Multi-Channel Notifications:</strong> Customer and team communication\n                    <br><em>Advantage: Email, SMS, Teams, Slack - all configurable</em>\n                </div>\n            </div>\n            \n            <div class=\"workflow-step\">\n                <div class=\"step-number\">6</div>\n                <div>\n                    <strong>Monitoring & Reporting:</strong> Real-time workflow execution tracking\n                    <br><em>Advantage: Built-in dashboards, success/failure metrics, performance analytics</em>\n                </div>\n            </div>\n        </div>\n\n        <h2>üíé Key Advantages with Rewst</h2>\n\n        <div class=\"advantage-card\">\n            <h4>üé® Visual Workflow Builder</h4>\n            <p>No PowerShell coding required. Drag-and-drop workflow creation with visual decision trees, making it easy to modify logic and add new data sources.</p>\n        </div>\n\n        <div class=\"advantage-card\">\n            <h4>üîÑ Advanced Error Handling</h4>\n            <p>Built-in retry logic, error branching, and fallback procedures. If one API is down, workflow continues with available data sources.</p>\n        </div>\n\n        <div class=\"advantage-card\">\n            <h4>‚ö° Parallel Processing</h4>\n            <p>Simultaneous API calls reduce correlation time from 30+ seconds to under 5 seconds. Multiple site checks can run concurrently.</p>\n        </div>\n\n        <div class=\"advantage-card\">\n            <h4>üìä Real-time Monitoring</h4>\n            <p>Live workflow execution monitoring, success/failure tracking, performance metrics, and detailed audit trails for compliance.</p>\n        </div>\n\n        <div class=\"advantage-card\">\n            <h4>üîß Template Management</h4>\n            <p>Standardized ticket templates, customer communication templates, and easy customization for different customer types or SLA levels.</p>\n        </div>\n\n        <div class=\"advantage-card\">\n            <h4>üìà Scalability</h4>\n            <p>Handle hundreds of concurrent alerts, auto-scaling, and enterprise-grade reliability with built-in high availability.</p>\n        </div>\n\n        <h2>üìä Improved Metrics with Rewst</h2>\n\n        <div class=\"metric-improvement\">\n            <div class=\"metric-card\">\n                <div class=\"metric-number\">90%</div>\n                <div>Faster Implementation<br>(1-2 weeks vs 4+ weeks)</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-number\">5 sec</div>\n                <div>Correlation Time<br>(vs 30+ seconds)</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-number\">99.9%</div>\n                <div>Reliability<br>Enterprise Platform</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-number\">100%</div>\n                <div>Workflow Visibility<br>Real-time Monitoring</div>\n            </div>\n        </div>\n\n        <h2>üõ†Ô∏è Implementation Comparison</h2>\n\n        <table class=\"implementation-table\">\n            <tr>\n                <th>Aspect</th>\n                <th>PowerShell Solution</th>\n                <th>Rewst Solution</th>\n                <th>Improvement</th>\n            </tr>\n            <tr>\n                <td><strong>Development Time</strong></td>\n                <td>4+ weeks coding</td>\n                <td>1-2 weeks configuration</td>\n                <td>75% time reduction</td>\n            </tr>\n            <tr>\n                <td><strong>Error Handling</strong></td>\n                <td>Basic try/catch</td>\n                <td>Enterprise-grade retry/fallback</td>\n                <td>Robust failure recovery</td>\n            </tr>\n            <tr>\n                <td><strong>Monitoring</strong></td>\n                <td>Log file analysis</td>\n                <td>Real-time dashboards</td>\n                <td>Live visibility</td>\n            </tr>\n            <tr>\n                <td><strong>Scalability</strong></td>\n                <td>Single-threaded processing</td>\n                <td>Parallel multi-threading</td>\n                <td>10x performance improvement</td>\n            </tr>\n            <tr>\n                <td><strong>Maintenance</strong></td>\n                <td>Code updates required</td>\n                <td>Visual workflow updates</td>\n                <td>No technical skills needed</td>\n            </tr>\n            <tr>\n                <td><strong>Reliability</strong></td>\n                <td>Custom service dependency</td>\n                <td>Enterprise platform SLA</td>\n                <td>99.9% uptime guarantee</td>\n            </tr>\n        </table>\n\n        <h2>üîß Rewst Workflow Configuration</h2>\n\n        <div class=\"code-block\">\n# Rewst Workflow Components (Visual Configuration, No Coding Required)\n\n## Trigger Configuration\n- Webhook URL: https://rewst.ftechkzn.co.za/webhooks/power-verification\n- Source: N-Central OfflineDevice alerts\n- Authentication: API key validation\n\n## Data Collection (Parallel Actions)\nAction 1: N-Central Site Query\n  ‚îú‚îÄ‚îÄ Get site devices status\n  ‚îú‚îÄ‚îÄ Check OOB device connectivity  \n  ‚îî‚îÄ‚îÄ Verify other servers online\n\nAction 2: NMSaaS Network Check\n  ‚îú‚îÄ‚îÄ Query AP status\n  ‚îú‚îÄ‚îÄ Check switch connectivity\n  ‚îú‚îÄ‚îÄ Validate firewall status\n  ‚îî‚îÄ‚îÄ Test router reachability\n\nAction 3: External Validation\n  ‚îú‚îÄ‚îÄ ISP gateway ping\n  ‚îú‚îÄ‚îÄ DNS resolution tests\n  ‚îî‚îÄ‚îÄ Cloud service connectivity\n\n## Decision Engine (Visual Logic Tree)\nIF (Confidence Score >= 80):\n  ‚îî‚îÄ‚îÄ Branch to \"Device Issue\" workflow\nELSE IF (Confidence Score < 50):\n  ‚îî‚îÄ‚îÄ Branch to \"Power Outage\" workflow  \nELSE:\n  ‚îî‚îÄ‚îÄ Branch to \"Manual Review\" workflow\n\n## Output Actions\n- HaloPSA ticket creation with templates\n- Customer notification (email/SMS)\n- Team alert (Slack/Teams)\n- Dashboard metric updates\n        </div>\n\n        <h2>üéØ Enhanced Business Benefits</h2>\n\n        <div class=\"info-box\">\n            <h4>üí∞ Additional ROI with Rewst:</h4>\n            <ul>\n                <li><strong>Faster Time to Market:</strong> 75% reduction in development time</li>\n                <li><strong>Reduced Technical Debt:</strong> No custom code to maintain</li>\n                <li><strong>Enhanced Reliability:</strong> Enterprise-grade platform with SLA</li>\n                <li><strong>Future Extensibility:</strong> Easy to add new integrations and workflows</li>\n                <li><strong>Compliance Ready:</strong> Built-in audit trails and reporting</li>\n                <li><strong>Team Efficiency:</strong> Non-technical staff can modify workflows</li>\n            </ul>\n        </div>\n\n        <h2>üöÄ Recommended Implementation Strategy</h2>\n\n        <div class=\"workflow-section\">\n            <h4>Week 1: Rewst Workflow Design</h4>\n            <ul>\n                <li>Configure N-Central webhook triggers</li>\n                <li>Design visual workflow in Rewst platform</li>\n                <li>Set up parallel data collection actions</li>\n                <li>Create decision logic and confidence scoring</li>\n            </ul>\n            \n            <h4>Week 2: Integration & Testing</h4>\n            <ul>\n                <li>Connect HaloPSA ticket creation templates</li>\n                <li>Configure customer notification channels</li>\n                <li>Set up monitoring dashboards</li>\n                <li>Pilot test with selected customer sites</li>\n            </ul>\n        </div>\n\n        <div class=\"warning-box\">\n            <h4>‚ö° Strategic Recommendation:</h4>\n            <p><strong>Leverage Rewst immediately!</strong> Since APIs are already integrated, you can build this solution 75% faster with enterprise-grade reliability, visual workflows, and real-time monitoring. This transforms the project from a development effort to a configuration task, dramatically reducing risk and time to value.</p>\n        </div>\n\n        <div style=\"background: linear-gradient(135deg, #2ecc71, #27ae60); color: white; padding: 25px; border-radius: 10px; text-align: center; margin: 30px 0;\">\n            <h3 style=\"margin-top: 0;\">üéØ Bottom Line Impact</h3>\n            <p style=\"font-size: 1.1em; margin-bottom: 0;\">\n                With Rewst, this solution goes from a \"4-week development project\" to a \"1-2 week configuration task\" with enterprise-grade capabilities, dramatically improving ROI and reducing implementation risk.\n            </p>\n        </div>\n    </div>\n</body>\n</html>",
        "category": "Development",
        "tags": [],
        "created": "2025-08-06T11:28:55.446Z",
        "modified": "2025-08-06T11:31:27.967Z",
        "isPinned": false,
        "isArchived": false,
        "type": "html"
      },
      {
        "id": "note-1",
        "title": "PowerShell Best Practices",
        "content": "# PowerShell Best Practices for System Administration\n\n## Key Guidelines:\n- Always use approved verbs (Get-, Set-, New-, Remove-)\n- Use proper error handling with try/catch blocks\n- Implement parameter validation\n- Use Write-Output instead of Write-Host for data\n- Always test scripts in development environment first\n\n## Security Considerations:\n- Use execution policies appropriately\n- Avoid hardcoded credentials\n- Implement proper logging\n- Use constrained endpoints when possible\n\n## Performance Tips:\n- Use pipeline efficiently\n- Avoid unnecessary object creation\n- Filter left, format right\n- Use specific property selection",
        "category": "System Admin",
        "tags": [
          "powershell",
          "best-practices",
          "security"
        ],
        "created": "2025-06-15T00:00:00.000Z",
        "modified": "2025-06-30T00:00:00.000Z",
        "isPinned": true,
        "isArchived": false,
        "type": "markdown"
      },
      {
        "id": "note-2",
        "title": "Next.js 14 Project Setup",
        "content": "# Next.js 14 Project Setup Notes\n\n## Installation:\n```bash\nnpx create-next-app@latest my-app\ncd my-app\nnpm run dev\n```\n\n## Key Features in v14:\n- App Router (stable)\n- Server Components by default\n- Improved TypeScript support\n- Turbopack (beta)\n\n## Essential Dependencies:\n- tailwindcss\n- @types/node\n- lucide-react for icons\n\n## Configuration Tips:\n- Use exact versions to avoid compatibility issues\n- Configure tailwind.config.ts for custom colors\n- Set up proper ESLint rules",
        "category": "Development",
        "tags": [
          "nextjs",
          "react",
          "setup"
        ],
        "created": "2025-06-20T00:00:00.000Z",
        "modified": "2025-06-28T00:00:00.000Z",
        "isPinned": false,
        "isArchived": false,
        "type": "markdown"
      },
      {
        "id": "note-3",
        "title": "Workspace Color Scheme",
        "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Nishen's AI Workspace Color Palette</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            margin: 0;\n            padding: 20px;\n            background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);\n            color: white;\n            min-height: 100vh;\n        }\n        .container {\n            max-width: 800px;\n            margin: 0 auto;\n            background: rgba(255, 255, 255, 0.1);\n            padding: 30px;\n            border-radius: 15px;\n            backdrop-filter: blur(10px);\n        }\n        .color-swatch {\n            display: flex;\n            align-items: center;\n            margin: 10px 0;\n            padding: 10px;\n            border-radius: 8px;\n            background: rgba(255, 255, 255, 0.1);\n        }\n        .color-box {\n            width: 50px;\n            height: 50px;\n            border-radius: 8px;\n            margin-right: 15px;\n            border: 2px solid rgba(255, 255, 255, 0.3);\n        }\n        .neon-red { background: #ff073a; }\n        .burnt-orange { background: #cc5500; }\n        .british-silver { background: #8B9499; }\n        .neon-green { background: #00CC33; }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>üé® Nishen's AI Workspace Color Palette</h1>\n        \n        <div class=\"color-swatch\">\n            <div class=\"color-box neon-red\"></div>\n            <div>\n                <strong>Neon Red</strong> - #ff073a<br>\n                <small>Primary actions, highlights, active states</small>\n            </div>\n        </div>\n        \n        <div class=\"color-swatch\">\n            <div class=\"color-box burnt-orange\"></div>\n            <div>\n                <strong>Burnt Orange</strong> - #cc5500<br>\n                <small>Secondary actions, accents, hover states</small>\n            </div>\n        </div>\n        \n        <div class=\"color-swatch\">\n            <div class=\"color-box british-silver\"></div>\n            <div>\n                <strong>British Silver</strong> - #8B9499<br>\n                <small>Professional silver theme, neutral accents</small>\n            </div>\n        </div>\n        \n        <div class=\"color-swatch\">\n            <div class=\"color-box neon-green\"></div>\n            <div>\n                <strong>Neon Green</strong> - #00CC33<br>\n                <small>Success states, accent green theme</small>\n            </div>\n        </div>\n        \n        <h2>üéØ Usage Guidelines</h2>\n        <ul>\n            <li>Use neon red for primary CTAs and active states</li>\n            <li>Burnt orange for secondary actions and hover states</li>\n            <li>Gray scale for text hierarchy</li>\n            <li>Maintain WCAG contrast ratios</li>\n        </ul>\n    </div>\n</body>\n</html>",
        "category": "Documentation",
        "tags": [
          "design",
          "colors",
          "branding"
        ],
        "created": "2025-06-25T00:00:00.000Z",
        "modified": "2025-06-25T00:00:00.000Z",
        "isPinned": false,
        "isArchived": false,
        "type": "html"
      },
      {
        "id": "note-4",
        "title": "Nishen's Skills Development and Knowledge Gained on the Job and in R&D",
        "content": "# Nishen's Skills Development and Knowledge Gained on the Job and in R&D\n\n## Project Portfolio & Technical Skills\n\n### üöÄ Nishen's AI Workspace (July 2025 - Ongoing)\n**Status**: Production Ready | **Time Invested**: 17.5+ hours | **Category**: Full-Stack Web/Desktop Application\n\n#### Technologies Mastered:\n- **Frontend**: React 18.2.0, Next.js 14.2.5, TypeScript, Tailwind CSS\n- **Desktop**: Electron (cross-platform Windows/macOS/Linux)\n- **State Management**: React Context API, localStorage persistence\n- **UI/UX**: Dynamic theming system, responsive design, accessibility (WCAG)\n- **Build Tools**: npm, webpack, electron-builder\n- **Development**: VS Code, ESLint, Hot reload, TypeScript strict mode\n\n#### Architecture Patterns Learned:\n- **Single-page workspace architecture** with state-based routing\n- **Component composition** with conditional rendering\n- **CSS custom properties** for dynamic theming\n- **Hydration-safe rendering** for SSR/CSR compatibility\n- **Systematic error handling** and dependency management\n- **Minimal dependency approach** for stability\n- **Production build optimization** and static export configuration\n\n#### Advanced Features Implemented:\n- **Real-time settings system** with 6 configuration categories\n- **Multi-format file preview** (HTML/Markdown rendering)\n- **Terminal simulation** with command history and Claude integration\n- **Note-taking system** with categories, search, tags, pin/unpin functionality\n- **Professional prompt engineering database** with usage tracking\n- **20+ system administration tools** with monitoring simulation\n- **Cross-platform desktop packaging** with native menu integration\n\n#### Key Problem-Solving Skills Developed:\n- **Systematic debugging methodology** using scanning approaches\n- **Production deployment troubleshooting** (Electron static export issues)\n- **TypeScript error resolution** with proper type casting\n- **CSS architecture design** for maintainable theming systems\n- **Performance optimization** for smooth user experience\n- **Version control management** with meaningful commit messages\n\n### üõ†Ô∏è Development Environment Expertise\n\n#### Platforms Mastered:\n- **Ubuntu Linux** (WSL2 on Windows) - Primary development environment\n- **Windows PowerShell** - Cross-platform scripting and terminal management\n- **VS Code** - Advanced configuration, extensions, integrated terminal usage\n- **Git** - Version control, branching strategies, commit message standards\n\n#### Command Line Proficiency:\n- **Node.js/npm** - Package management, script automation, dependency resolution\n- **Bash/PowerShell** - File system operations, process management, environment setup\n- **Build tools** - npm scripts, webpack configuration, production optimization\n- **System administration** - Process monitoring, resource management, troubleshooting\n\n### üìä Technical Documentation & Project Management\n\n#### Skills Developed:\n- **Comprehensive time tracking** with detailed session logs\n- **Technical documentation** writing (README files, API docs, user guides)\n- **Project planning** with phase-based development approaches\n- **Code review methodologies** and systematic testing approaches\n- **Backup and recovery procedures** with versioned snapshots\n- **Performance monitoring** and resource optimization\n\n#### Professional Development Practices:\n- **Agile methodology** application in solo development\n- **Test-driven development** mindset for reliability\n- **Security-first approach** in authentication and data handling\n- **User experience design** with accessibility considerations\n- **Cross-browser compatibility** testing and optimization\n\n### üéØ Current Expertise Level Assessment\n\n#### Advanced Skills:\n- React/Next.js full-stack development\n- TypeScript advanced type system usage\n- Electron desktop application development\n- CSS architecture and dynamic theming\n- Component-based UI design patterns\n\n#### Intermediate Skills:\n- System administration and monitoring\n- Build tool configuration and optimization\n- Cross-platform development considerations\n- Performance profiling and optimization\n- API design and integration patterns\n\n#### Growing Skills:\n- Advanced Node.js backend development\n- Database design and management\n- DevOps and CI/CD pipeline setup\n- Cloud deployment and scaling\n- Advanced security implementation\n\n### üìà Learning & Development Goals\n\n#### Short-term (Next 30 days):\n- Real Claude AI API integration with streaming responses\n- Advanced terminal emulation with multiple shell support\n- File system integration for real file operations\n- Performance optimization and memory management\n\n#### Medium-term (Next 90 days):\n- Backend API development with authentication\n- Database integration (PostgreSQL/MongoDB)\n- Real-time collaboration features\n- Advanced DevOps and deployment automation\n\n#### Long-term (Next 6 months):\n- Cloud-native architecture design\n- Microservices development patterns\n- Advanced security and compliance implementation\n- Team leadership and code review processes\n\n---\n\n**Last Updated**: July 12, 2025  \n**Auto-Update Schedule**: Every 2 days  \n**Total Projects Completed**: 1 major (Nishen's AI Workspace)  \n**Total Development Hours**: 17.5+ hours  \n**Current Focus**: Real-time features and Claude AI integration",
        "category": "Personal",
        "tags": [
          "skills",
          "development",
          "career",
          "projects",
          "learning"
        ],
        "created": "2025-07-12T00:00:00.000Z",
        "modified": "2025-07-12T00:00:00.000Z",
        "isPinned": true,
        "isArchived": false,
        "type": "markdown"
      }
    ],
    "timestamp": "2025-09-29T01:06:41.978Z",
    "operation": "USER_SAVE",
    "component": "NOTES"
  },
  "nishen-workspace-settings": {
    "theme": "dark",
    "accentColor": "custom",
    "fontSize": "medium",
    "animations": true,
    "compactMode": true,
    "enableNotifications": true,
    "soundEnabled": true,
    "notificationTypes": {
      "system": true,
      "security": true,
      "tools": true,
      "files": false
    },
    "autoSave": true,
    "autoSaveInterval": 5,
    "maxHistoryItems": 100,
    "enableSystemMonitoring": true,
    "monitoringInterval": 3,
    "encryptData": false,
    "autoLock": false,
    "autoLockTime": 30,
    "clearDataOnExit": false,
    "anonymousUsage": false,
    "debugMode": false,
    "developerTools": true,
    "experimentalFeatures": false,
    "customCSS": "",
    "backupLocation": "./backups",
    "timerAutoStart": false,
    "timerShowInHeader": true,
    "timerFormat": "24h",
    "timerPersistOnRefresh": true
  },
  "nishen-workspace-notes_CHANGELOG": [
    {
      "timestamp": "2025-09-29T01:06:42.907Z",
      "operation": "INIT",
      "beforeData": null,
      "afterData": null,
      "component": "NOTES"
    }
  ],
  "nishen-workspace-dev": [
    {
      "id": "proj-1",
      "name": "RMS Tools Collection",
      "description": "Professional system administration tools and scripts",
      "files": [
        {
          "id": "file-1",
          "name": "password-audit.ps1",
          "type": "script",
          "category": "Security",
          "content": "# PowerShell Password Audit Script\n# Author: Nishen Harichunder\n\nParam(\n    [string]$Domain = $env:USERDNSDOMAIN\n)\n\nWrite-Host \"Starting password audit for domain: $Domain\" -ForegroundColor Green\n\n# Add your audit logic here",
          "versions": [],
          "created": "2025-06-01T00:00:00.000Z",
          "modified": "2025-06-25T00:00:00.000Z",
          "timeSpent": 7200
        },
        {
          "id": "file-2",
          "name": "incident-report.html",
          "type": "html",
          "category": "Reporting",
          "content": "<!DOCTYPE html>\n<html>\n<head>\n    <title>RMS Incident Report</title>\n    <style>\n        body { font-family: Arial, sans-serif; }\n        .header { background: #003366; color: white; padding: 20px; }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <h1>RMS Incident Report</h1>\n    </div>\n</body>\n</html>",
          "versions": [],
          "created": "2025-06-10T00:00:00.000Z",
          "modified": "2025-06-28T00:00:00.000Z",
          "timeSpent": 5400
        },
        {
          "id": "file-1755174928167",
          "name": "Kofax  - Run as service NSSM - wrapper",
          "type": "document",
          "category": "Kofax, sso",
          "content": "# Kofax  - Run as service NSSM - wrapper\n\nCreated in Nishen's AI Workspace on 2025/08/14\n\nhe Kofax processes as a Windows service under a service account, so no interactive login is required. This is definitely the better approach. Here are several options:\nService Wrapper Solutions:\n1. NSSM (Non-Sucking Service Manager) ‚≠ê Recommended\npowershell# Download NSSM and install Kofax as service\nnssm install \"KofaxProcessingService\" \"C:\\Path\\To\\Kofax\\Application.exe\"\nnssm set \"KofaxProcessingService\" ObjectName \"DOMAIN\\KofaxServiceAccount\" \"ServicePassword\"\nnssm set \"KofaxProcessingService\" Start SERVICE_AUTO_START\nnssm start \"KofaxProcessingService\"\n2. Windows Service Wrapper (WinSW)\nxml<!-- Create KofaxService.xml -->\n<service>\n  <id>KofaxProcessing</id>\n  <name>Kofax Document Processing</name>\n  <description>Kofax automated job processing service</description>\n  <executable>C:\\Path\\To\\Kofax\\Application.exe</executable>\n  <serviceaccount>\n    <domain>YOURDOMAIN</domain>\n    <user>KofaxServiceAccount</user>\n    <password>ServicePassword</password>\n  </serviceaccount>\n  <startmode>Automatic</startmode>\n</service>\n3. PowerShell Service Wrapper\npowershell# Create scheduled task that runs as service\n$Action = New-ScheduledTaskAction -Execute \"C:\\Path\\To\\Kofax\\Application.exe\"\n$Trigger = New-ScheduledTaskTrigger -AtStartup\n$Principal = New-ScheduledTaskPrincipal -UserId \"DOMAIN\\KofaxServiceAccount\" -LogonType ServiceAccount\n$Settings = New-ScheduledTaskSettingsSet -AllowStartIfOnBatteries -DontStopIfGoingOnBatteries -StartWhenAvailable -RestartCount 3\n\nRegister-ScheduledTask -TaskName \"KofaxProcessingService\" -Action $Action -Trigger $Trigger -Principal $Principal -Settings $Settings\nService Account Configuration:\nRequired Permissions:\n\nLog on as a service (SeServiceLogonRight)\nReplace a process level token (SeAssignPrimaryTokenPrivilege)\nAdjust memory quotas (SeIncreaseQuotaPrivilege)\nAct as part of operating system (SeTcbPrivilege) - if needed\n\nPowerShell to Set Permissions:\npowershell# Grant service logon rights\n$UserAccount = \"DOMAIN\\KofaxServiceAccount\"\n$TempFile = [System.IO.Path]::GetTempFileName()\n\n# Export current policy\nsecedit /export /cfg $TempFile /areas USER_RIGHTS\n\n# Add service logon right\n$Content = Get-Content $TempFile\n$Content = $Content.Replace(\"SeServiceLogonRight = \", \"SeServiceLogonRight = $UserAccount,\")\n$Content | Set-Content $TempFile\n\n# Import modified policy\nsecedit /configure /db secedit.sdb /cfg $TempFile\nRemove-Item $TempFile\nAlternative: Interactive Service in Session 0\npowershell# Create service that can interact with desktop (legacy method)\nsc create \"KofaxService\" binPath=\"C:\\Path\\To\\Kofax\\Application.exe\" type=interact type=own obj=\"DOMAIN\\KofaxServiceAccount\" password=\"ServicePassword\"\nsc config \"KofaxService\" start=auto\nKofax-Specific Considerations:\n\nCheck if Kofax has native service mode\nVerify database/network connectivity from service context\nConfigure file system permissions for service account\nTest COM/DCOM registrations if Kofax uses them\nHandle any GUI dependencies (some Kofax modules need desktop interaction)",
          "versions": [
            {
              "id": "ver-1755174951862",
              "content": "# Kofax  - Run as service NSSM - wrapper\n\nCreated in Nishen's AI Workspace on 2025/08/14\n\nhe Kofax processes as a Windows service under a service account, so no interactive login is required. This is definitely the better approach. Here are several options:\nService Wrapper Solutions:\n1. NSSM (Non-Sucking Service Manager) ‚≠ê Recommended\npowershell# Download NSSM and install Kofax as service\nnssm install \"KofaxProcessingService\" \"C:\\Path\\To\\Kofax\\Application.exe\"\nnssm set \"KofaxProcessingService\" ObjectName \"DOMAIN\\KofaxServiceAccount\" \"ServicePassword\"\nnssm set \"KofaxProcessingService\" Start SERVICE_AUTO_START\nnssm start \"KofaxProcessingService\"\n2. Windows Service Wrapper (WinSW)\nxml<!-- Create KofaxService.xml -->\n<service>\n  <id>KofaxProcessing</id>\n  <name>Kofax Document Processing</name>\n  <description>Kofax automated job processing service</description>\n  <executable>C:\\Path\\To\\Kofax\\Application.exe</executable>\n  <serviceaccount>\n    <domain>YOURDOMAIN</domain>\n    <user>KofaxServiceAccount</user>\n    <password>ServicePassword</password>\n  </serviceaccount>\n  <startmode>Automatic</startmode>\n</service>\n3. PowerShell Service Wrapper\npowershell# Create scheduled task that runs as service\n$Action = New-ScheduledTaskAction -Execute \"C:\\Path\\To\\Kofax\\Application.exe\"\n$Trigger = New-ScheduledTaskTrigger -AtStartup\n$Principal = New-ScheduledTaskPrincipal -UserId \"DOMAIN\\KofaxServiceAccount\" -LogonType ServiceAccount\n$Settings = New-ScheduledTaskSettingsSet -AllowStartIfOnBatteries -DontStopIfGoingOnBatteries -StartWhenAvailable -RestartCount 3\n\nRegister-ScheduledTask -TaskName \"KofaxProcessingService\" -Action $Action -Trigger $Trigger -Principal $Principal -Settings $Settings\nService Account Configuration:\nRequired Permissions:\n\nLog on as a service (SeServiceLogonRight)\nReplace a process level token (SeAssignPrimaryTokenPrivilege)\nAdjust memory quotas (SeIncreaseQuotaPrivilege)\nAct as part of operating system (SeTcbPrivilege) - if needed\n\nPowerShell to Set Permissions:\npowershell# Grant service logon rights\n$UserAccount = \"DOMAIN\\KofaxServiceAccount\"\n$TempFile = [System.IO.Path]::GetTempFileName()\n\n# Export current policy\nsecedit /export /cfg $TempFile /areas USER_RIGHTS\n\n# Add service logon right\n$Content = Get-Content $TempFile\n$Content = $Content.Replace(\"SeServiceLogonRight = \", \"SeServiceLogonRight = $UserAccount,\")\n$Content | Set-Content $TempFile\n\n# Import modified policy\nsecedit /configure /db secedit.sdb /cfg $TempFile\nRemove-Item $TempFile\nAlternative: Interactive Service in Session 0\npowershell# Create service that can interact with desktop (legacy method)\nsc create \"KofaxService\" binPath=\"C:\\Path\\To\\Kofax\\Application.exe\" type=interact type=own obj=\"DOMAIN\\KofaxServiceAccount\" password=\"ServicePassword\"\nsc config \"KofaxService\" start=auto\nKofax-Specific Considerations:\n\nCheck if Kofax has native service mode\nVerify database/network connectivity from service context\nConfigure file system permissions for service account\nTest COM/DCOM registrations if Kofax uses them\nHandle any GUI dependencies (some Kofax modules need desktop interaction)",
              "timestamp": "2025-08-14T12:35:51.862Z",
              "description": "baseline"
            }
          ],
          "created": "2025-08-14T12:35:28.167Z",
          "modified": "2025-08-14T12:35:51.862Z",
          "timeSpent": 0
        },
        {
          "id": "file-1755648025947",
          "name": "Modern_V3_EngIssue_reporting_Tool_deepseek.html",
          "type": "html",
          "category": "incident report,tool,deepseek",
          "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>IT Incident Reporting Tool | First Technology</title>\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\">\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js\"></script>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js\"></script>\n    <style>\n        :root {\n            --primary: #1a3a5f;\n            --secondary: #2c5b82;\n            --accent: #4a90e2;\n            --light: #f8f9fa;\n            --dark: #212529;\n            --success: #28a745;\n            --warning: #ffc107;\n            --danger: #dc3545;\n            --info: #17a2b8;\n            --gray: #6c757d;\n            --border: #dee2e6;\n            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\n            --bg-color: white;\n            --text-color: #212529;\n            --form-bg: #f8fafc;\n        }\n        \n        /* Dark Theme */\n        .theme-dark {\n            --primary: #2c3e50;\n            --secondary: #34495e;\n            --accent: #3498db;\n            --light: #34495e;\n            --dark: #ecf0f1;\n            --bg-color: #2c3e50;\n            --text-color: #ecf0f1;\n            --form-bg: #34495e;\n            --border: #4a6278;\n        }\n        \n        /* Blue Theme (default) */\n        .theme-blue {\n            --primary: #1a3a5f;\n            --secondary: #2c5b82;\n            --accent: #4a90e2;\n        }\n        \n        /* Green Theme */\n        .theme-green {\n            --primary: #1e5631;\n            --secondary: #2d7d46;\n            --accent: #4caf50;\n        }\n        \n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n        }\n        \n        body {\n            background: linear-gradient(135deg, #f0f4f8, #e6edf5);\n            color: var(--dark);\n            line-height: 1.6;\n            min-height: 100vh;\n            padding: 20px;\n            background-color: var(--bg-color);\n            color: var(--text-color);\n        }\n        \n        .app-container {\n            max-width: 1200px;\n            margin: 0 auto;\n            background: var(--bg-color);\n            border-radius: 15px;\n            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);\n            overflow: hidden;\n        }\n        \n        /* Header */\n        .header {\n            background: linear-gradient(to right, var(--primary), var(--secondary));\n            color: white;\n            padding: 25px 40px;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            position: relative;\n        }\n        \n        .logo {\n            display: flex;\n            align-items: center;\n            gap: 15px;\n        }\n        \n        .logo-icon {\n            font-size: 32px;\n            color: white;\n        }\n        \n        .logo-text h1 {\n            font-size: 26px;\n            font-weight: 700;\n            letter-spacing: 0.5px;\n        }\n        \n        .logo-text p {\n            font-size: 14px;\n            opacity: 0.9;\n            margin-top: 3px;\n        }\n        \n        .action-buttons {\n            display: flex;\n            gap: 12px;\n        }\n        \n        .btn {\n            padding: 12px 22px;\n            border-radius: 8px;\n            font-weight: 600;\n            cursor: pointer;\n            display: inline-flex;\n            align-items: center;\n            gap: 8px;\n            transition: all 0.3s;\n            border: none;\n            font-size: 15px;\n        }\n        \n        .btn-primary {\n            background-color: white;\n            color: var(--primary);\n            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);\n        }\n        \n        .btn-outline {\n            background-color: transparent;\n            border: 2px solid rgba(255, 255, 255, 0.7);\n            color: white;\n        }\n        \n        .btn-success {\n            background-color: var(--success);\n            color: white;\n        }\n        \n        .btn-danger {\n            background-color: var(--danger);\n            color: white;\n        }\n        \n        .btn:hover {\n            transform: translateY(-3px);\n            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.15);\n        }\n        \n        .btn:active {\n            transform: translateY(-1px);\n        }\n        \n        /* Navigation */\n        .nav-tabs {\n            display: flex;\n            background-color: var(--bg-color);\n            border-bottom: 1px solid var(--border);\n            padding: 0 40px;\n        }\n        \n        .nav-item {\n            padding: 18px 25px;\n            cursor: pointer;\n            position: relative;\n            font-weight: 600;\n            color: var(--gray);\n            transition: all 0.3s;\n        }\n        \n        .nav-item.active {\n            color: var(--primary);\n        }\n        \n        .nav-item.active::after {\n            content: '';\n            position: absolute;\n            bottom: -1px;\n            left: 0;\n            width: 100%;\n            height: 3px;\n            background-color: var(--accent);\n            border-radius: 3px 3px 0 0;\n        }\n        \n        .nav-item:hover {\n            color: var(--primary);\n            background-color: rgba(74, 144, 226, 0.05);\n        }\n        \n        /* Main Content */\n        .main-content {\n            padding: 30px 40px;\n            min-height: 600px;\n        }\n        \n        .tab-content {\n            display: none;\n        }\n        \n        .tab-content.active {\n            display: block;\n        }\n        \n        .form-section {\n            background: var(--bg-color);\n            border-radius: 10px;\n            box-shadow: var(--card-shadow);\n            padding: 30px;\n            margin-bottom: 25px;\n            border: 1px solid var(--border);\n        }\n        \n        .section-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 25px;\n            padding-bottom: 15px;\n            border-bottom: 2px solid rgba(26, 58, 95, 0.1);\n        }\n        \n        .section-header h3 {\n            color: var(--primary);\n            font-weight: 700;\n            font-size: 20px;\n            display: flex;\n            align-items: center;\n            gap: 10px;\n        }\n        \n        .section-header i {\n            color: var(--accent);\n        }\n        \n        .form-row {\n            display: flex;\n            gap: 25px;\n            margin-bottom: 25px;\n            flex-wrap: wrap;\n        }\n        \n        .form-group {\n            flex: 1;\n            min-width: 250px;\n        }\n        \n        .form-group label {\n            display: block;\n            margin-bottom: 10px;\n            font-weight: 600;\n            color: var(--text-color);\n            font-size: 15px;\n        }\n        \n        .form-control {\n            width: 100%;\n            padding: 14px 18px;\n            border: 1px solid var(--border);\n            border-radius: 8px;\n            font-size: 15px;\n            transition: all 0.3s;\n            background-color: var(--form-bg);\n            color: var(--text-color);\n        }\n        \n        .form-control:focus {\n            outline: none;\n            border-color: var(--accent);\n            box-shadow: 0 0 0 4px rgba(74, 144, 226, 0.2);\n            background-color: var(--bg-color);\n        }\n        \n        textarea.form-control {\n            min-height: 140px;\n            resize: vertical;\n        }\n        \n        select.form-control {\n            appearance: none;\n            background-image: url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%236c757d' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10z'/%3E%3C/svg%3E\");\n            background-repeat: no-repeat;\n            background-position: right 15px center;\n            background-size: 12px;\n            padding-right: 40px;\n        }\n        \n        /* Timeline Table */\n        .timeline-table {\n            width: 100%;\n            border-collapse: collapse;\n            margin: 20px 0;\n            border-radius: 8px;\n            overflow: hidden;\n            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);\n        }\n        \n        .timeline-table th {\n            background-color: var(--primary);\n            color: white;\n            padding: 16px 20px;\n            text-align: left;\n            font-weight: 600;\n        }\n        \n        .timeline-table td {\n            padding: 16px 20px;\n            border-bottom: 1px solid var(--border);\n            background-color: var(--bg-color);\n        }\n        \n        .timeline-table tr:nth-child(even) td {\n            background-color: var(--form-bg);\n        }\n        \n        .timeline-table tr:hover td {\n            background-color: #e9f0f9;\n        }\n        \n        .add-row-btn {\n            background-color: var(--success);\n            color: white;\n            border: none;\n            border-radius: 8px;\n            padding: 12px 20px;\n            cursor: pointer;\n            margin-top: 15px;\n            display: inline-flex;\n            align-items: center;\n            gap: 8px;\n            font-weight: 600;\n            transition: all 0.3s;\n        }\n        \n        .add-row-btn:hover {\n            background-color: #218838;\n            transform: translateY(-2px);\n        }\n        \n        /* Status Indicators */\n        .system-status {\n            display: flex;\n            gap: 20px;\n            flex-wrap: wrap;\n            margin: 20px 0;\n        }\n        \n        .status-card {\n            flex: 1;\n            min-width: 250px;\n            background: var(--bg-color);\n            border-radius: 12px;\n            padding: 20px;\n            box-shadow: var(--card-shadow);\n            border-left: 4px solid var(--accent);\n            transition: all 0.3s;\n        }\n        \n        .status-card:hover {\n            transform: translateY(-5px);\n            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);\n        }\n        \n        .status-card h4 {\n            font-size: 16px;\n            margin-bottom: 15px;\n            color: var(--gray);\n            font-weight: 600;\n            display: flex;\n            align-items: center;\n            gap: 8px;\n        }\n        \n        .status-card .status {\n            font-weight: 700;\n            font-size: 17px;\n            padding: 10px 15px;\n            border-radius: 8px;\n            display: inline-block;\n        }\n        \n        .status-resolved {\n            background-color: rgba(40, 167, 69, 0.15);\n            color: var(--success);\n        }\n        \n        .status-in-progress {\n            background-color: rgba(255, 193, 7, 0.15);\n            color: var(--warning);\n        }\n        \n        .status-pending {\n            background-color: rgba(220, 53, 69, 0.15);\n            color: var(--danger);\n        }\n        \n        .status-info {\n            background-color: rgba(23, 162, 184, 0.15);\n            color: var(--info);\n        }\n        \n        /* Footer */\n        .footer {\n            margin-top: 40px;\n            padding: 25px 40px;\n            background-color: var(--form-bg);\n            border-top: 1px solid var(--border);\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            flex-wrap: wrap;\n            gap: 20px;\n        }\n        \n        .footer-text {\n            color: var(--gray);\n            font-size: 14px;\n        }\n        \n        .footer-links {\n            display: flex;\n            gap: 15px;\n        }\n        \n        .footer-link {\n            color: var(--primary);\n            text-decoration: none;\n            font-weight: 600;\n            font-size: 14px;\n            transition: all 0.3s;\n        }\n        \n        .footer-link:hover {\n            color: var(--accent);\n            text-decoration: underline;\n        }\n        \n        /* Modal */\n        .modal {\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background-color: rgba(0, 0, 0, 0.7);\n            z-index: 1000;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            opacity: 0;\n            visibility: hidden;\n            transition: all 0.3s;\n        }\n        \n        .modal.active {\n            opacity: 1;\n            visibility: visible;\n        }\n        \n        .modal-content {\n            background: var(--bg-color);\n            border-radius: 15px;\n            width: 100%;\n            max-width: 500px;\n            padding: 30px;\n            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.25);\n            transform: translateY(-30px);\n            transition: all 0.4s;\n        }\n        \n        .modal.active .modal-content {\n            transform: translateY(0);\n        }\n        \n        .modal-header {\n            margin-bottom: 25px;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n        \n        .modal-header h3 {\n            color: var(--primary);\n            font-size: 24px;\n            font-weight: 700;\n        }\n        \n        .close-modal {\n            background: none;\n            border: none;\n            font-size: 24px;\n            color: var(--gray);\n            cursor: pointer;\n            transition: all 0.3s;\n        }\n        \n        .close-modal:hover {\n            color: var(--danger);\n            transform: rotate(90deg);\n        }\n        \n        .modal-footer {\n            display: flex;\n            justify-content: flex-end;\n            gap: 15px;\n            margin-top: 25px;\n        }\n        \n        /* Dashboard Styles */\n        .dashboard-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n            gap: 25px;\n            margin-top: 20px;\n        }\n        \n        .dashboard-card {\n            background: var(--bg-color);\n            border-radius: 12px;\n            padding: 25px;\n            box-shadow: var(--card-shadow);\n            border-top: 4px solid var(--accent);\n            transition: all 0.3s;\n        }\n        \n        .dashboard-card:hover {\n            transform: translateY(-5px);\n            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);\n        }\n        \n        .dashboard-card h3 {\n            color: var(--primary);\n            margin-bottom: 15px;\n            display: flex;\n            align-items: center;\n            gap: 10px;\n        }\n        \n        .stat-number {\n            font-size: 32px;\n            font-weight: 700;\n            color: var(--primary);\n            margin: 10px 0;\n        }\n        \n        .stat-label {\n            color: var(--gray);\n            font-weight: 600;\n        }\n        \n        .recent-reports {\n            margin-top: 20px;\n        }\n        \n        .report-item {\n            padding: 15px;\n            border-bottom: 1px solid var(--border);\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n        \n        .report-item:last-child {\n            border-bottom: none;\n        }\n        \n        .report-title {\n            font-weight: 600;\n            color: var(--text-color);\n        }\n        \n        .report-date {\n            color: var(--gray);\n            font-size: 14px;\n        }\n        \n        /* FAQ Accordion */\n        .faq-content {\n            display: none;\n            padding: 15px;\n            background-color: var(--form-bg);\n            border-radius: 0 0 8px 8px;\n            margin-top: -10px;\n            border: 1px solid var(--border);\n            border-top: none;\n        }\n        \n        .faq-item.active .faq-content {\n            display: block;\n        }\n        \n        .faq-item.active .fa-chevron-down {\n            transform: rotate(180deg);\n        }\n        \n        /* Responsive */\n        @media (max-width: 992px) {\n            .header {\n                flex-direction: column;\n                align-items: flex-start;\n                gap: 25px;\n            }\n            \n            .action-buttons {\n                width: 100%;\n                flex-wrap: wrap;\n            }\n            \n            .btn {\n                flex: 1;\n                justify-content: center;\n            }\n        }\n        \n        @media (max-width: 768px) {\n            .header, .main-content, .footer {\n                padding: 20px;\n            }\n            \n            .nav-tabs {\n                padding: 0 20px;\n                overflow-x: auto;\n            }\n            \n            .nav-item {\n                white-space: nowrap;\n                padding: 15px 20px;\n            }\n            \n            .form-section {\n                padding: 20px;\n            }\n            \n            .system-status {\n                flex-direction: column;\n            }\n        }\n        \n        @media (max-width: 576px) {\n            .form-row {\n                flex-direction: column;\n                gap: 15px;\n            }\n            \n            .modal-content {\n                padding: 20px;\n            }\n            \n            .btn {\n                padding: 10px 15px;\n                font-size: 14px;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"app-container\">\n        <!-- Header -->\n        <div class=\"header\">\n            <div class=\"logo\">\n                <div class=\"logo-icon\">\n                    <i class=\"fas fa-bug fa-2x\"></i>\n                </div>\n                <div class=\"logo-text\">\n                    <h1>IT Incident Reporting Tool</h1>\n                    <p>Professional Incident Management Solution</p>\n                </div>\n            </div>\n            <div class=\"action-buttons\">\n                <button class=\"btn btn-outline\" id=\"saveBtn\">\n                    <i class=\"fas fa-save\"></i> Save Draft\n                </button>\n                <button class=\"btn btn-outline\" id=\"loadBtn\">\n                    <i class=\"fas fa-folder-open\"></i> Load Draft\n                </button>\n                <button class=\"btn btn-primary\" id=\"exportPdfBtn\">\n                    <i class=\"fas fa-file-pdf\"></i> Export PDF\n                </button>\n                <button class=\"btn btn-success\" id=\"emailBtn\">\n                    <i class=\"fas fa-envelope\"></i> Email Report\n                </button>\n            </div>\n        </div>\n        \n        <!-- Navigation -->\n        <div class=\"nav-tabs\">\n            <div class=\"nav-item active\" data-tab=\"dashboard\">\n                <i class=\"fas fa-home\"></i> Dashboard\n            </div>\n            <div class=\"nav-item\" data-tab=\"new-report\">\n                <i class=\"fas fa-file-alt\"></i> New Report\n            </div>\n            <div class=\"nav-item\" data-tab=\"history\">\n                <i class=\"fas fa-history\"></i> Report History\n            </div>\n            <div class=\"nav-item\" data-tab=\"settings\">\n                <i class=\"fas fa-cog\"></i> Settings\n            </div>\n            <div class=\"nav-item\" data-tab=\"help\">\n                <i class=\"fas fa-question-circle\"></i> Help & Support\n            </div>\n        </div>\n        \n        <!-- Main Content -->\n        <div class=\"main-content\">\n            <!-- Dashboard Tab -->\n            <div id=\"dashboardContent\" class=\"tab-content active\">\n                <div class=\"form-section\">\n                    <div class=\"section-header\">\n                        <h3><i class=\"fas fa-chart-line\"></i> Incident Dashboard</h3>\n                    </div>\n                    \n                    <div class=\"dashboard-grid\">\n                        <div class=\"dashboard-card\">\n                            <h3><i class=\"fas fa-exclamation-circle\"></i> Open Incidents</h3>\n                            <div class=\"stat-number\">12</div>\n                            <div class=\"stat-label\">Active issues requiring attention</div>\n                        </div>\n                        \n                        <div class=\"dashboard-card\">\n                            <h3><i class=\"fas fa-check-circle\"></i> Resolved This Week</h3>\n                            <div class=\"stat-number\">24</div>\n                            <div class=\"stat-label\">Issues successfully resolved</div>\n                        </div>\n                        \n                        <div class=\"dashboard-card\">\n                            <h3><i class=\"fas fa-clock\"></i> Average Resolution Time</h3>\n                            <div class=\"stat-number\">18.5h</div>\n                            <div class=\"stat-label\">From report to resolution</div>\n                        </div>\n                        \n                        <div class=\"dashboard-card\">\n                            <h3><i class=\"fas fa-user-shield\"></i> Your Reports</h3>\n                            <div class=\"stat-number\">7</div>\n                            <div class=\"stat-label\">Incidents managed by you</div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-section\">\n                        <h3><i class=\"fas fa-list\"></i> Recent Reports</h3>\n                        <div class=\"recent-reports\">\n                            <div class=\"report-item\">\n                                <div>\n                                    <div class=\"report-title\">SQL Service Failure on ASTW-APP04</div>\n                                    <div class=\"report-date\">Priority: High ‚Ä¢ Created: 2023-11-15</div>\n                                </div>\n                                <div>\n                                    <span class=\"status status-in-progress\">In Progress</span>\n                                </div>\n                            </div>\n                            <div class=\"report-item\">\n                                <div>\n                                    <div class=\"report-title\">Network Connectivity Issues</div>\n                                    <div class=\"report-date\">Priority: Medium ‚Ä¢ Created: 2023-11-14</div>\n                                </div>\n                                <div>\n                                    <span class=\"status status-resolved\">Resolved</span>\n                                </div>\n                            </div>\n                            <div class=\"report-item\">\n                                <div>\n                                    <div class=\"report-title\">Email Server Outage</div>\n                                    <div class=\"report-date\">Priority: Critical ‚Ä¢ Created: 2023-11-12</div>\n                                </div>\n                                <div>\n                                    <span class=\"status status-resolved\">Resolved</span>\n                                </div>\n                            </div>\n                            <div class=\"report-item\">\n                                <div>\n                                    <div class=\"report-title\">Firewall Configuration Error</div>\n                                    <div class=\"report-date\">Priority: High ‚Ä¢ Created: 2023-11-10</div>\n                                </div>\n                                <div>\n                                    <span class=\"status status-pending\">Pending</span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            \n            <!-- New Report Tab -->\n            <div id=\"newReportContent\" class=\"tab-content\">\n                <form id=\"incidentReportForm\">\n                    <!-- Ticket & Basic Info -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-info-circle\"></i> Incident Information</h3>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"ticketNumber\"><i class=\"fas fa-ticket-alt\"></i> Ticket/Incident Number</label>\n                                <input type=\"text\" id=\"ticketNumber\" class=\"form-control\" placeholder=\"INC-2023-001\" value=\"INC-2023-001\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"clientName\"><i class=\"fas fa-building\"></i> Client Name</label>\n                                <input type=\"text\" id=\"clientName\" class=\"form-control\" placeholder=\"Ashtons IT\" value=\"Ashtons IT\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"reportDate\"><i class=\"fas fa-calendar\"></i> Report Date</label>\n                                <input type=\"date\" id=\"reportDate\" class=\"form-control\">\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"priority\"><i class=\"fas fa-exclamation-triangle\"></i> Priority</label>\n                                <select id=\"priority\" class=\"form-control\">\n                                    <option value=\"HIGH\">High</option>\n                                    <option value=\"MEDIUM\">Medium</option>\n                                    <option value=\"LOW\">Low</option>\n                                </select>\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"status\"><i class=\"fas fa-sync\"></i> Current Status</label>\n                                <select id=\"status\" class=\"form-control\">\n                                    <option value=\"RESOLVED\">Resolved</option>\n                                    <option value=\"IN_PROGRESS\">In Progress</option>\n                                    <option value=\"PENDING\">Pending</option>\n                                </select>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Executive Summary -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-chart-line\"></i> Executive Summary</h3>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"issue\"><i class=\"fas fa-exclamation-circle\"></i> Issue Description</label>\n                                <textarea id=\"issue\" class=\"form-control\">SQL services failing to start on server ASTW-APP04, affecting Solcase application functionality</textarea>\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"impact\"><i class=\"fas fa-bolt\"></i> Business Impact</label>\n                                <textarea id=\"impact\" class=\"form-control\">Critical Solcase operations (including reporting and batch processing) impaired; domain admin credentials compromised.</textarea>\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"rootCause\"><i class=\"fas fa-search\"></i> Root Cause</label>\n                                <textarea id=\"rootCause\" class=\"form-control\">Domain administrator account compromise and misuse for SQL services.</textarea>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Incident Details -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-clipboard-list\"></i> Incident Details</h3>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"reportedTime\"><i class=\"fas fa-clock\"></i> Reported Time</label>\n                                <input type=\"datetime-local\" id=\"reportedTime\" class=\"form-control\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"reportedBy\"><i class=\"fas fa-user\"></i> Reported By</label>\n                                <input type=\"text\" id=\"reportedBy\" class=\"form-control\" placeholder=\"Contact name/role\" value=\"Josh Teague (Ashtons IT)\">\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"affectedSystems\"><i class=\"fas fa-server\"></i> Affected Systems</label>\n                                <textarea id=\"affectedSystems\" class=\"form-control\">ASTW-APP04 (SQL Server), Solcase application</textarea>\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"symptoms\"><i class=\"fas fa-stethoscope\"></i> Symptoms</label>\n                                <textarea id=\"symptoms\" class=\"form-control\">SQL services unresponsive; scheduled tasks failing; domain admin account locked.</textarea>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Investigation Timeline -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-history\"></i> Investigation Timeline</h3>\n                        </div>\n                        <table class=\"timeline-table\">\n                            <thead>\n                                <tr>\n                                    <th>Time</th>\n                                    <th>Action Taken</th>\n                                    <th>Engineer</th>\n                                    <th>Outcome</th>\n                                    <th></th>\n                                </tr>\n                            </thead>\n                            <tbody id=\"timelineBody\">\n                                <tr>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"15:31\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Identified domain admin account lockout\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Josh Teague\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Suspicious activity detected\"></td>\n                                    <td><button type=\"button\" class=\"btn btn-danger\" onclick=\"removeTimelineRow(this)\"><i class=\"fas fa-trash\"></i></button></td>\n                                </tr>\n                                <tr>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"15:33\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Detected unauthorized password change\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Nishen Harichunder\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Credentials compromised\"></td>\n                                    <td><button type=\"button\" class=\"btn btn-danger\" onclick=\"removeTimelineRow(this)\"><i class=\"fas fa-trash\"></i></button></td>\n                                </tr>\n                                <tr>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"15:34\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Recommended dedicated SQL service account\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Nishen Harichunder\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Plan for credential remediation\"></td>\n                                    <td><button type=\"button\" class=\"btn btn-danger\" onclick=\"removeTimelineRow(this)\"><i class=\"fas fa-trash\"></i></button></td>\n                                </tr>\n                            </tbody>\n                        </table>\n                        <button type=\"button\" class=\"add-row-btn\" onclick=\"addTimelineRow()\">\n                            <i class=\"fas fa-plus\"></i> Add Timeline Event\n                        </button>\n                    </div>\n                    \n                    <!-- Resolution Actions -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-tools\"></i> Resolution Actions</h3>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"actionsTaken\"><i class=\"fas fa-hammer\"></i> Actions Implemented</label>\n                                <textarea id=\"actionsTaken\" class=\"form-control\">1. Service Account Migration\n- Created sql_svc_progressDB@internal.ashtongraham.co.uk\n- Updated all SQL services on ASTW-APP04\n- SQL services started successfully\n\n2. Scheduled Task Remediation\n- Updated 4 tasks (RapidRTA, Claims processing, Notification retrieval, Report spooling)\n- Tasks reconfigured; manual execution required for missed jobs</textarea>\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"securityImprovements\"><i class=\"fas fa-shield-alt\"></i> Security Improvements</label>\n                                <textarea id=\"securityImprovements\" class=\"form-control\">- Eliminated Domain Admin Usage\n- Updated service account details in PassPortal\n- Dedicated Service Account for SQL operations\n- Implemented alerting for domain admin account lockouts</textarea>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Current Status -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-chart-bar\"></i> Current Status</h3>\n                        </div>\n                        <div class=\"system-status\">\n                            <div class=\"status-card\">\n                                <h4><i class=\"fas fa-database\"></i> SQL Services</h4>\n                                <div class=\"status status-resolved\">\n                                    <i class=\"fas fa-check-circle\"></i> Running with dedicated service account\n                                </div>\n                            </div>\n                            <div class=\"status-card\">\n                                <h4><i class=\"fas fa-window-restore\"></i> Application</h4>\n                                <div class=\"status status-in-progress\">\n                                    <i class=\"fas fa-exclamation-triangle\"></i> May require server reboot\n                                </div>\n                            </div>\n                            <div class=\"status-card\">\n                                <h4><i class=\"fas fa-tasks\"></i> Scheduled Tasks</h4>\n                                <div class=\"status status-info\">\n                                    <i class=\"fas fa-clipboard-list\"></i> Updated but may need manual execution\n                                </div>\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"outstandingActions\"><i class=\"fas fa-list-check\"></i> Outstanding Actions</label>\n                                <textarea id=\"outstandingActions\" class=\"form-control\">1. Server Reboot (ASTW-APP04)\n- Reboot to flush credential cache\n- Responsible: Steve (Approval Pending)\n\n2. Domain-Wide Security Audit\n- Scan all servers for services using domain admin accounts\n- Responsible: Oliver Govender (Next 48 hours)\n\n3. Password Change Investigation\n- Determine who changed domain admin password and why\n- Responsible: Ashtons IT Security Team (High priority)</textarea>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Recommendations -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-lightbulb\"></i> Recommendations</h3>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"immediateRecs\"><i class=\"fas fa-bolt\"></i> Immediate Recommendations (24-48 Hours)</label>\n                                <textarea id=\"immediateRecs\" class=\"form-control\">1. Implement Domain Admin Lockout Alerts\n- Configure SIEM/Sentinel rules for real-time detection\n\n2. Manual Task Execution\n- Execute backlog from failed scheduled jobs\n- Validate outputs post-execution</textarea>\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"longTermRecs\"><i class=\"fas fa-chart-line\"></i> Long-term Improvements (30-90 Days)</label>\n                                <textarea id=\"longTermRecs\" class=\"form-control\">1. Deploy Group Managed Service Accounts (gMSA)\n- Automate password management for service accounts\n- Eliminate manual credential rotation\n\n2. Privileged Access Audit Framework\n- Quarterly reviews of service account dependencies\n- Implement automated scanning tools</textarea>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Contact Information -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-address-card\"></i> Contact Information</h3>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"engineerName\"><i class=\"fas fa-user-tie\"></i> Primary Engineer</label>\n                                <input type=\"text\" id=\"engineerName\" class=\"form-control\" value=\"Nishen Harichunder\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"engineerEmail\"><i class=\"fas fa-envelope\"></i> Email</label>\n                                <input type=\"email\" id=\"engineerEmail\" class=\"form-control\" placeholder=\"engineer@example.com\" value=\"nishen@firsttech.com\">\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"engineerPhone\"><i class=\"fas fa-phone\"></i> Mobile</label>\n                                <input type=\"tel\" id=\"engineerPhone\" class=\"form-control\" placeholder=\"+27 123 456 789\" value=\"+27 123 456 789\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"availability\"><i class=\"fas fa-calendar-check\"></i> Availability</label>\n                                <input type=\"text\" id=\"availability\" class=\"form-control\" placeholder=\"08:00-17:00 SAST (Mon-Fri)\" value=\"08:00-17:00 SAST (Mon-Fri)\">\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-section\">\n                        <button type=\"button\" class=\"btn btn-primary\" id=\"submitReport\" style=\"width: 100%; padding: 16px; font-size: 17px; font-weight: 600;\">\n                            <i class=\"fas fa-paper-plane\"></i> Submit Final Report\n                        </button>\n                    </div>\n                </form>\n            </div>\n            \n            <!-- Report History Tab -->\n            <div id=\"historyContent\" class=\"tab-content\">\n                <div class=\"form-section\">\n                    <div class=\"section-header\">\n                        <h3><i class=\"fas fa-history\"></i> Report History</h3>\n                    </div>\n                    \n                    <div class=\"recent-reports\">\n                        <div class=\"report-item\">\n                            <div>\n                                <div class=\"report-title\">Database Connection Failure</div>\n                                <div class=\"report-date\">Created: 2023-11-14 ‚Ä¢ Priority: High</div>\n                            </div>\n                            <div>\n                                <span class=\"status status-resolved\">Resolved</span>\n                            </div>\n                        </div>\n                        <div class=\"report-item\">\n                            <div>\n                                <div class=\"report-title\">Firewall Configuration Error</div>\n                                <div class=\"report-date\">Created: 2023-11-12 ‚Ä¢ Priority: Critical</div>\n                            </div>\n                            <div>\n                                <span class=\"status status-resolved\">Resolved</span>\n                            </div>\n                        </div>\n                        <div class=\"report-item\">\n                            <div>\n                                <div class=\"report-title\">Email Server Outage</div>\n                                <div class=\"report-date\">Created: 2023-11-10 ‚Ä¢ Priority: High</div>\n                            </div>\n                            <div>\n                                <span class=\"status status-resolved\">Resolved</span>\n                            </div>\n                        </div>\n                        <div class=\"report-item\">\n                            <div>\n                                <div class=\"report-title\">Network Switch Failure</div>\n                                <div class=\"report-date\">Created: 2023-11-08 ‚Ä¢ Priority: Medium</div>\n                            </div>\n                            <div>\n                                <span class=\"status status-resolved\">Resolved</span>\n                            </div>\n                        </div>\n                        <div class=\"report-item\">\n                            <div>\n                                <div class=\"report-title\">Backup System Failure</div>\n                                <div class=\"report-date\">Created: 2023-11-05 ‚Ä¢ Priority: High</div>\n                            </div>\n                            <div>\n                                <span class=\"status status-resolved\">Resolved</span>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div style=\"margin-top: 30px; text-align: center;\">\n                        <button class=\"btn btn-outline\">\n                            <i class=\"fas fa-arrow-left\"></i> Previous\n                        </button>\n                        <span style=\"margin: 0 15px; font-weight: 600;\">Page 1 of 3</span>\n                        <button class=\"btn btn-outline\">\n                            Next <i class=\"fas fa-arrow-right\"></i>\n                        </button>\n                    </div>\n                </div>\n            </div>\n            \n            <!-- Settings Tab -->\n            <div id=\"settingsContent\" class=\"tab-content\">\n                <div class=\"form-section\">\n                    <div class=\"section-header\">\n                        <h3><i class=\"fas fa-cog\"></i> Application Settings</h3>\n                    </div>\n                    \n                    <div class=\"form-row\">\n                        <div class=\"form-group\">\n                            <label for=\"companyName\"><i class=\"fas fa-building\"></i> Company Name</label>\n                            <input type=\"text\" id=\"companyName\" class=\"form-control\" value=\"First Technology KZN (Pty) Ltd\">\n                        </div>\n                        <div class=\"form-group\">\n                            <label for=\"defaultEngineer\"><i class=\"fas fa-user-tie\"></i> Default Engineer</label>\n                            <input type=\"text\" id=\"defaultEngineer\" class=\"form-control\" value=\"Nishen Harichunder\">\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-row\">\n                        <div class=\"form-group\">\n                            <label for=\"emailSignature\"><i class=\"fas fa-signature\"></i> Email Signature</label>\n                            <textarea id=\"emailSignature\" class=\"form-control\">Best regards,\nFirst Technology Support Team\nsupport@firsttech.com\n+27 123 456 789</textarea>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-row\">\n                        <div class=\"form-group\">\n                            <label for=\"autoSave\"><i class=\"fas fa-save\"></i> Auto-save Interval</label>\n                            <select id=\"autoSave\" class=\"form-control\">\n                                <option value=\"5\">Every 5 minutes</option>\n                                <option value=\"10\" selected>Every 10 minutes</option>\n                                <option value=\"15\">Every 15 minutes</option>\n                                <option value=\"30\">Every 30 minutes</option>\n                                <option value=\"0\">Disabled</option>\n                            </select>\n                        </div>\n                        <div class=\"form-group\">\n                            <label for=\"theme\"><i class=\"fas fa-palette\"></i> Theme</label>\n                            <select id=\"theme\" class=\"form-control\">\n                                <option value=\"light\">Light Theme</option>\n                                <option value=\"dark\">Dark Theme</option>\n                                <option value=\"blue\" selected>Blue Theme</option>\n                                <option value=\"green\">Green Theme</option>\n                            </select>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-section\">\n                        <button type=\"button\" class=\"btn btn-primary\" id=\"saveSettingsBtn\" style=\"width: 100%; padding: 16px; font-size: 17px; font-weight: 600;\">\n                            <i class=\"fas fa-save\"></i> Save Settings\n                        </button>\n                    </div>\n                </div>\n            </div>\n            \n            <!-- Help & Support Tab -->\n            <div id=\"helpContent\" class=\"tab-content\">\n                <div class=\"form-section\">\n                    <div class=\"section-header\">\n                        <h3><i class=\"fas fa-question-circle\"></i> Help & Support</h3>\n                    </div>\n                    \n                    <div class=\"system-status\">\n                        <div class=\"status-card\">\n                            <h4><i class=\"fas fa-book\"></i> Documentation</h4>\n                            <p>Access our comprehensive user guides and documentation to learn how to use all features of the Incident Reporting Tool.</p>\n                            <button class=\"btn btn-outline\" style=\"margin-top: 15px;\">\n                                <i class=\"fas fa-download\"></i> Download User Guide\n                            </button>\n                        </div>\n                        <div class=\"status-card\">\n                            <h4><i class=\"fas fa-video\"></i> Video Tutorials</h4>\n                            <p>Watch step-by-step video tutorials that demonstrate how to create, manage, and export incident reports.</p>\n                            <button class=\"btn btn-outline\" style=\"margin-top: 15px;\">\n                                <i class=\"fas fa-play-circle\"></i> View Tutorials\n                            </button>\n                        </div>\n                        <div class=\"status-card\">\n                            <h4><i class=\"fas fa-headset\"></i> Contact Support</h4>\n                            <p>Our support team is available to assist you with any questions or issues you may encounter.</p>\n                            <div style=\"margin-top: 15px;\">\n                                <p><i class=\"fas fa-envelope\"></i> support@firsttech.com</p>\n                                <p><i class=\"fas fa-phone\"></i> +27 123 456 789</p>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-section\">\n                        <h3><i class=\"fas fa-comments\"></i> Frequently Asked Questions</h3>\n                        <div class=\"recent-reports\" id=\"faqContainer\">\n                            <div class=\"report-item faq-item\">\n                                <div>\n                                    <div class=\"report-title\">How do I save a draft of my report?</div>\n                                </div>\n                                <div>\n                                    <i class=\"fas fa-chevron-down\"></i>\n                                </div>\n                                <div class=\"faq-content\">\n                                    <p>To save a draft of your report, click the \"Save Draft\" button in the top right corner of the application. This will save your current progress to your browser's local storage. You can later load this draft by clicking the \"Load Draft\" button.</p>\n                                </div>\n                            </div>\n                            <div class=\"report-item faq-item\">\n                                <div>\n                                    <div class=\"report-title\">Can I export reports to PDF?</div>\n                                </div>\n                                <div>\n                                    <i class=\"fas fa-chevron-down\"></i>\n                                </div>\n                                <div class=\"faq-content\">\n                                    <p>Yes, you can export your reports to PDF by clicking the \"Export PDF\" button in the top right corner. This will generate a PDF version of your current report that you can save to your computer or print.</p>\n                                </div>\n                            </div>\n                            <div class=\"report-item faq-item\">\n                                <div>\n                                    <div class=\"report-title\">How do I change my account settings?</div>\n                                </div>\n                                <div>\n                                    <i class=\"fas fa-chevron-down\"></i>\n                                </div>\n                                <div class=\"faq-content\">\n                                    <p>Account settings can be changed in the \"Settings\" tab. Here you can update your default engineer information, company details, email signature, and application preferences like theme and auto-save interval.</p>\n                                </div>\n                            </div>\n                            <div class=\"report-item faq-item\">\n                                <div>\n                                    <div class=\"report-title\">Where can I find my previously submitted reports?</div>\n                                </div>\n                                <div>\n                                    <i class=\"fas fa-chevron-down\"></i>\n                                </div>\n                                <div class=\"faq-content\">\n                                    <p>All your previously submitted reports can be found in the \"Report History\" tab. This section displays a list of all your past reports with their status, priority, and creation date.</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            \n            <div class=\"footer\">\n                <div class=\"footer-text\">\n                    First Technology KZN (Pty) Ltd | Incident Reporting Tool v2.1\n                </div>\n                <div class=\"footer-links\">\n                    <a href=\"#\" class=\"footer-link\">Privacy Policy</a>\n                    <a href=\"#\" class=\"footer-link\">Terms of Service</a>\n                    <a href=\"#\" class=\"footer-link\">Contact Support</a>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    <!-- Email Modal -->\n    <div class=\"modal\" id=\"emailModal\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <h3><i class=\"fas fa-envelope\"></i> Email Incident Report</h3>\n                <button class=\"close-modal\" id=\"cancelEmailBtn\">&times;</button>\n            </div>\n            <div class=\"form-group\" style=\"margin-bottom: 20px;\">\n                <label for=\"recipientEmail\">Recipient Email</label>\n                <input type=\"email\" id=\"recipientEmail\" class=\"form-control\" placeholder=\"recipient@example.com\" value=\"manager@ashtons.com\">\n            </div>\n            <div class=\"form-group\" style=\"margin-bottom: 20px;\">\n                <label for=\"emailSubject\">Subject</label>\n                <input type=\"text\" id=\"emailSubject\" class=\"form-control\" value=\"IT Incident Report - Ashtons IT\">\n            </div>\n            <div class=\"form-group\" style=\"margin-bottom: 20px;\">\n                <label for=\"emailMessage\">Additional Message</label>\n                <textarea id=\"emailMessage\" class=\"form-control\" rows=\"4\">Please find attached the incident report for your review. Let me know if you need any additional information.</textarea>\n            </div>\n            <div class=\"modal-footer\">\n                <button class=\"btn btn-outline\" id=\"cancelEmailBtn2\">Cancel</button>\n                <button class=\"btn btn-success\" id=\"sendEmailBtn\">\n                    <i class=\"fas fa-paper-plane\"></i> Send Email\n                </button>\n            </div>\n        </div>\n    </div>\n    \n    <!-- Success Modal -->\n    <div class=\"modal\" id=\"successModal\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <h3><i class=\"fas fa-check-circle\"></i> Success!</h3>\n                <button class=\"close-modal\" id=\"closeSuccessBtn\">&times;</button>\n            </div>\n            <div style=\"padding: 20px; text-align: center;\">\n                <i class=\"fas fa-check-circle fa-4x\" style=\"color: var(--success); margin-bottom: 20px;\"></i>\n                <p id=\"successMessage\" style=\"font-size: 18px; line-height: 1.6;\">\n                    Your incident report has been processed successfully.\n                </p>\n            </div>\n            <div class=\"modal-footer\" style=\"justify-content: center;\">\n                <button class=\"btn btn-primary\" id=\"successOkBtn\">\n                    OK\n                </button>\n            </div>\n        </div>\n    </div>\n    \n    <script>\n        // Set today's date as default\n        document.addEventListener('DOMContentLoaded', function() {\n            const today = new Date().toISOString().split('T')[0];\n            document.getElementById('reportDate').value = today;\n            \n            // Set reported time to 2 hours ago\n            const reportedTime = new Date();\n            reportedTime.setHours(reportedTime.getHours() - 2);\n            const reportedTimeString = reportedTime.toISOString().slice(0, 16);\n            document.getElementById('reportedTime').value = reportedTimeString;\n            \n            // Initialize navigation\n            initNavigation();\n            \n            // Initialize FAQ accordion\n            initFAQ();\n            \n            // Load saved theme if exists\n            const savedTheme = localStorage.getItem('appTheme') || 'blue';\n            document.body.classList.add(`theme-${savedTheme}`);\n            document.getElementById('theme').value = savedTheme;\n        });\n        \n        // Initialize navigation tabs\n        function initNavigation() {\n            // Set first tab as active\n            document.querySelector('.nav-item').classList.add('active');\n            document.getElementById('dashboardContent').classList.add('active');\n            \n            // Add event listeners to all nav items\n            document.querySelectorAll('.nav-item').forEach(item => {\n                item.addEventListener('click', function() {\n                    // Remove active class from all items\n                    document.querySelectorAll('.nav-item').forEach(i => {\n                        i.classList.remove('active');\n                    });\n                    \n                    // Hide all tab contents\n                    document.querySelectorAll('.tab-content').forEach(tab => {\n                        tab.classList.remove('active');\n                    });\n                    \n                    // Add active class to clicked item\n                    this.classList.add('active');\n                    \n                    // Show corresponding tab content\n                    const tabId = this.getAttribute('data-tab');\n                    document.getElementById(tabId + 'Content').classList.add('active');\n                });\n            });\n        }\n        \n        // Initialize FAQ accordion\n        function initFAQ() {\n            const faqItems = document.querySelectorAll('.faq-item');\n            \n            faqItems.forEach(item => {\n                const header = item.querySelector('.report-item');\n                \n                header.addEventListener('click', () => {\n                    // Toggle active class on the FAQ item\n                    item.classList.toggle('active');\n                    \n                    // Close other FAQ items\n                    faqItems.forEach(otherItem => {\n                        if (otherItem !== item) {\n                            otherItem.classList.remove('active');\n                        }\n                    });\n                });\n            });\n        }\n        \n        // Timeline table functions\n        function addTimelineRow() {\n            const tbody = document.getElementById('timelineBody');\n            const newRow = document.createElement('tr');\n            \n            // Get current time for new row\n            const now = new Date();\n            const timeString = now.toTimeString().substring(0,5);\n            \n            newRow.innerHTML = `\n                <td><input type=\"text\" class=\"form-control\" value=\"${timeString}\"></td>\n                <td><input type=\"text\" class=\"form-control\" placeholder=\"Action description\"></td>\n                <td><input type=\"text\" class=\"form-control\" placeholder=\"Engineer name\"></td>\n                <td><input type=\"text\" class=\"form-control\" placeholder=\"Result\"></td>\n                <td><button type=\"button\" class=\"btn btn-danger\" onclick=\"removeTimelineRow(this)\"><i class=\"fas fa-trash\"></i></button></td>\n            `;\n            \n            tbody.appendChild(newRow);\n        }\n        \n        function removeTimelineRow(button) {\n            const row = button.parentNode.parentNode;\n            row.parentNode.removeChild(row);\n        }\n        \n        // Save report to localStorage\n        document.getElementById('saveBtn').addEventListener('click', function() {\n            const formData = getFormData();\n            localStorage.setItem('incidentReportDraft', JSON.stringify(formData));\n            \n            // Show success message\n            document.getElementById('successMessage').textContent = 'Report draft saved successfully! You can load it anytime to continue working.';\n            document.getElementById('successModal').classList.add('active');\n        });\n        \n        // Load report from localStorage\n        document.getElementById('loadBtn').addEventListener('click', function() {\n            const savedData = localStorage.getItem('incidentReportDraft');\n            \n            if (savedData) {\n                const formData = JSON.parse(savedData);\n                setFormData(formData);\n                \n                // Show success message\n                document.getElementById('successMessage').textContent = 'Report draft loaded successfully! You can now continue editing.';\n                document.getElementById('successModal').classList.add('active');\n            } else {\n                alert('No saved draft found. Please save a draft first.');\n            }\n        });\n        \n        // Get all form data as an object\n        function getFormData() {\n            const form = document.getElementById('incidentReportForm');\n            const inputs = form.querySelectorAll('input, textarea, select');\n            const formData = {};\n            \n            inputs.forEach(input => {\n                if (input.type !== 'button') {\n                    formData[input.id] = input.value;\n                }\n            });\n            \n            // Get timeline data\n            const timelineRows = document.querySelectorAll('#timelineBody tr');\n            const timelineData = [];\n            \n            timelineRows.forEach(row => {\n                const cells = row.querySelectorAll('td');\n                timelineData.push({\n                    time: cells[0].querySelector('input').value,\n                    action: cells[1].querySelector('input').value,\n                    engineer: cells[2].querySelector('input').value,\n                    outcome: cells[3].querySelector('input').value\n                });\n            });\n            \n            formData.timeline = timelineData;\n            \n            return formData;\n        }\n        \n        // Set form data from object\n        function setFormData(formData) {\n            for (const key in formData) {\n                if (key === 'timeline') {\n                    // Handle timeline separately\n                    const tbody = document.getElementById('timelineBody');\n                    tbody.innerHTML = '';\n                    \n                    formData.timeline.forEach(item => {\n                        const newRow = document.createElement('tr');\n                        newRow.innerHTML = `\n                            <td><input type=\"text\" class=\"form-control\" value=\"${item.time}\"></td>\n                            <td><input type=\"text\" class=\"form-control\" value=\"${item.action}\"></td>\n                            <td><input type=\"text\" class=\"form-control\" value=\"${item.engineer}\"></td>\n                            <td><input type=\"text\" class=\"form-control\" value=\"${item.outcome}\"></td>\n                            <td><button type=\"button\" class=\"btn btn-danger\" onclick=\"removeTimelineRow(this)\"><i class=\"fas fa-trash\"></i></button></td>\n                        `;\n                        tbody.appendChild(newRow);\n                    });\n                } else {\n                    const element = document.getElementById(key);\n                    if (element) {\n                        element.value = formData[key];\n                    }\n                }\n            }\n        }\n        \n        // Email functionality\n        document.getElementById('emailBtn').addEventListener('click', function() {\n            document.getElementById('emailModal').classList.add('active');\n        });\n        \n        document.getElementById('cancelEmailBtn').addEventListener('click', function() {\n            document.getElementById('emailModal').classList.remove('active');\n        });\n        \n        document.getElementById('cancelEmailBtn2').addEventListener('click', function() {\n            document.getElementById('emailModal').classList.remove('active');\n        });\n        \n        document.getElementById('sendEmailBtn').addEventListener('click', function() {\n            const recipient = document.getElementById('recipientEmail').value;\n            if (!recipient) {\n                alert('Please enter a recipient email address');\n                return;\n            }\n            \n            // Create mailto link with form data\n            const subject = document.getElementById('emailSubject').value;\n            const body = document.getElementById('emailMessage').value;\n            const mailtoLink = `mailto:${recipient}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;\n            \n            // Open default email client\n            window.location.href = mailtoLink;\n            \n            document.getElementById('emailModal').classList.remove('active');\n            document.getElementById('successMessage').textContent = `Incident report has been emailed to ${recipient} successfully!`;\n            document.getElementById('successModal').classList.add('active');\n        });\n        \n        // Export to PDF functionality\n        document.getElementById('exportPdfBtn').addEventListener('click', function() {\n            const { jsPDF } = window.jspdf;\n            const doc = new jsPDF();\n            \n            // Get the form content\n            const formContent = document.getElementById('incidentReportForm');\n            \n            // Use html2canvas to capture the form as an image\n            html2canvas(formContent).then(canvas => {\n                const imgData = canvas.toDataURL('image/png');\n                const imgWidth = doc.internal.pageSize.getWidth() - 20;\n                const imgHeight = (canvas.height * imgWidth) / canvas.width;\n                \n                doc.addImage(imgData, 'PNG', 10, 10, imgWidth, imgHeight);\n                \n                // Save the PDF\n                doc.save('incident-report.pdf');\n                \n                // Show success message\n                document.getElementById('successMessage').textContent = 'Incident report has been exported to PDF successfully!';\n                document.getElementById('successModal').classList.add('active');\n            });\n        });\n        \n        // Submit report\n        document.getElementById('submitReport').addEventListener('click', function() {\n            // In a real application, you would send this to a server\n            const formData = getFormData();\n            console.log('Form submitted:', formData);\n            \n            document.getElementById('successMessage').textContent = 'Incident report submitted successfully! Thank you for using our system.';\n            document.getElementById('successModal').classList.add('active');\n        });\n        \n        // Save settings\n        document.getElementById('saveSettingsBtn').addEventListener('click', function() {\n            const theme = document.getElementById('theme').value;\n            \n            // Remove all theme classes\n            document.body.classList.remove('theme-light', 'theme-dark', 'theme-blue', 'theme-green');\n            // Add selected theme class\n            document.body.classList.add(`theme-${theme}`);\n            \n            // Save to localStorage\n            localStorage.setItem('appTheme', theme);\n            \n            // Show success message\n            document.getElementById('successMessage').textContent = 'Settings saved successfully!';\n            document.getElementById('successModal').classList.add('active');\n        });\n        \n        // Close modals\n        document.getElementById('closeSuccessBtn').addEventListener('click', function() {\n            document.getElementById('successModal').classList.remove('active');\n        });\n        \n        document.getElementById('successOkBtn').addEventListener('click', function() {\n            document.getElementById('successModal').classList.remove('active');\n        });\n    </script>\n</body>\n</html>",
          "versions": [
            {
              "id": "ver-1755650895028",
              "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>IT Incident Reporting Tool | First Technology</title>\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\">\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js\"></script>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js\"></script>\n    <style>\n        :root {\n            --primary: #1a3a5f;\n            --secondary: #2c5b82;\n            --accent: #4a90e2;\n            --light: #f8f9fa;\n            --dark: #212529;\n            --success: #28a745;\n            --warning: #ffc107;\n            --danger: #dc3545;\n            --info: #17a2b8;\n            --gray: #6c757d;\n            --border: #dee2e6;\n            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\n            --bg-color: white;\n            --text-color: #212529;\n            --form-bg: #f8fafc;\n        }\n        \n        /* Dark Theme */\n        .theme-dark {\n            --primary: #2c3e50;\n            --secondary: #34495e;\n            --accent: #3498db;\n            --light: #34495e;\n            --dark: #ecf0f1;\n            --bg-color: #2c3e50;\n            --text-color: #ecf0f1;\n            --form-bg: #34495e;\n            --border: #4a6278;\n        }\n        \n        /* Blue Theme (default) */\n        .theme-blue {\n            --primary: #1a3a5f;\n            --secondary: #2c5b82;\n            --accent: #4a90e2;\n        }\n        \n        /* Green Theme */\n        .theme-green {\n            --primary: #1e5631;\n            --secondary: #2d7d46;\n            --accent: #4caf50;\n        }\n        \n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n        }\n        \n        body {\n            background: linear-gradient(135deg, #f0f4f8, #e6edf5);\n            color: var(--dark);\n            line-height: 1.6;\n            min-height: 100vh;\n            padding: 20px;\n            background-color: var(--bg-color);\n            color: var(--text-color);\n        }\n        \n        .app-container {\n            max-width: 1200px;\n            margin: 0 auto;\n            background: var(--bg-color);\n            border-radius: 15px;\n            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);\n            overflow: hidden;\n        }\n        \n        /* Header */\n        .header {\n            background: linear-gradient(to right, var(--primary), var(--secondary));\n            color: white;\n            padding: 25px 40px;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            position: relative;\n        }\n        \n        .logo {\n            display: flex;\n            align-items: center;\n            gap: 15px;\n        }\n        \n        .logo-icon {\n            font-size: 32px;\n            color: white;\n        }\n        \n        .logo-text h1 {\n            font-size: 26px;\n            font-weight: 700;\n            letter-spacing: 0.5px;\n        }\n        \n        .logo-text p {\n            font-size: 14px;\n            opacity: 0.9;\n            margin-top: 3px;\n        }\n        \n        .action-buttons {\n            display: flex;\n            gap: 12px;\n        }\n        \n        .btn {\n            padding: 12px 22px;\n            border-radius: 8px;\n            font-weight: 600;\n            cursor: pointer;\n            display: inline-flex;\n            align-items: center;\n            gap: 8px;\n            transition: all 0.3s;\n            border: none;\n            font-size: 15px;\n        }\n        \n        .btn-primary {\n            background-color: white;\n            color: var(--primary);\n            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);\n        }\n        \n        .btn-outline {\n            background-color: transparent;\n            border: 2px solid rgba(255, 255, 255, 0.7);\n            color: white;\n        }\n        \n        .btn-success {\n            background-color: var(--success);\n            color: white;\n        }\n        \n        .btn-danger {\n            background-color: var(--danger);\n            color: white;\n        }\n        \n        .btn:hover {\n            transform: translateY(-3px);\n            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.15);\n        }\n        \n        .btn:active {\n            transform: translateY(-1px);\n        }\n        \n        /* Navigation */\n        .nav-tabs {\n            display: flex;\n            background-color: var(--bg-color);\n            border-bottom: 1px solid var(--border);\n            padding: 0 40px;\n        }\n        \n        .nav-item {\n            padding: 18px 25px;\n            cursor: pointer;\n            position: relative;\n            font-weight: 600;\n            color: var(--gray);\n            transition: all 0.3s;\n        }\n        \n        .nav-item.active {\n            color: var(--primary);\n        }\n        \n        .nav-item.active::after {\n            content: '';\n            position: absolute;\n            bottom: -1px;\n            left: 0;\n            width: 100%;\n            height: 3px;\n            background-color: var(--accent);\n            border-radius: 3px 3px 0 0;\n        }\n        \n        .nav-item:hover {\n            color: var(--primary);\n            background-color: rgba(74, 144, 226, 0.05);\n        }\n        \n        /* Main Content */\n        .main-content {\n            padding: 30px 40px;\n            min-height: 600px;\n        }\n        \n        .tab-content {\n            display: none;\n        }\n        \n        .tab-content.active {\n            display: block;\n        }\n        \n        .form-section {\n            background: var(--bg-color);\n            border-radius: 10px;\n            box-shadow: var(--card-shadow);\n            padding: 30px;\n            margin-bottom: 25px;\n            border: 1px solid var(--border);\n        }\n        \n        .section-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 25px;\n            padding-bottom: 15px;\n            border-bottom: 2px solid rgba(26, 58, 95, 0.1);\n        }\n        \n        .section-header h3 {\n            color: var(--primary);\n            font-weight: 700;\n            font-size: 20px;\n            display: flex;\n            align-items: center;\n            gap: 10px;\n        }\n        \n        .section-header i {\n            color: var(--accent);\n        }\n        \n        .form-row {\n            display: flex;\n            gap: 25px;\n            margin-bottom: 25px;\n            flex-wrap: wrap;\n        }\n        \n        .form-group {\n            flex: 1;\n            min-width: 250px;\n        }\n        \n        .form-group label {\n            display: block;\n            margin-bottom: 10px;\n            font-weight: 600;\n            color: var(--text-color);\n            font-size: 15px;\n        }\n        \n        .form-control {\n            width: 100%;\n            padding: 14px 18px;\n            border: 1px solid var(--border);\n            border-radius: 8px;\n            font-size: 15px;\n            transition: all 0.3s;\n            background-color: var(--form-bg);\n            color: var(--text-color);\n        }\n        \n        .form-control:focus {\n            outline: none;\n            border-color: var(--accent);\n            box-shadow: 0 0 0 4px rgba(74, 144, 226, 0.2);\n            background-color: var(--bg-color);\n        }\n        \n        textarea.form-control {\n            min-height: 140px;\n            resize: vertical;\n        }\n        \n        select.form-control {\n            appearance: none;\n            background-image: url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%236c757d' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10z'/%3E%3C/svg%3E\");\n            background-repeat: no-repeat;\n            background-position: right 15px center;\n            background-size: 12px;\n            padding-right: 40px;\n        }\n        \n        /* Timeline Table */\n        .timeline-table {\n            width: 100%;\n            border-collapse: collapse;\n            margin: 20px 0;\n            border-radius: 8px;\n            overflow: hidden;\n            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);\n        }\n        \n        .timeline-table th {\n            background-color: var(--primary);\n            color: white;\n            padding: 16px 20px;\n            text-align: left;\n            font-weight: 600;\n        }\n        \n        .timeline-table td {\n            padding: 16px 20px;\n            border-bottom: 1px solid var(--border);\n            background-color: var(--bg-color);\n        }\n        \n        .timeline-table tr:nth-child(even) td {\n            background-color: var(--form-bg);\n        }\n        \n        .timeline-table tr:hover td {\n            background-color: #e9f0f9;\n        }\n        \n        .add-row-btn {\n            background-color: var(--success);\n            color: white;\n            border: none;\n            border-radius: 8px;\n            padding: 12px 20px;\n            cursor: pointer;\n            margin-top: 15px;\n            display: inline-flex;\n            align-items: center;\n            gap: 8px;\n            font-weight: 600;\n            transition: all 0.3s;\n        }\n        \n        .add-row-btn:hover {\n            background-color: #218838;\n            transform: translateY(-2px);\n        }\n        \n        /* Status Indicators */\n        .system-status {\n            display: flex;\n            gap: 20px;\n            flex-wrap: wrap;\n            margin: 20px 0;\n        }\n        \n        .status-card {\n            flex: 1;\n            min-width: 250px;\n            background: var(--bg-color);\n            border-radius: 12px;\n            padding: 20px;\n            box-shadow: var(--card-shadow);\n            border-left: 4px solid var(--accent);\n            transition: all 0.3s;\n        }\n        \n        .status-card:hover {\n            transform: translateY(-5px);\n            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);\n        }\n        \n        .status-card h4 {\n            font-size: 16px;\n            margin-bottom: 15px;\n            color: var(--gray);\n            font-weight: 600;\n            display: flex;\n            align-items: center;\n            gap: 8px;\n        }\n        \n        .status-card .status {\n            font-weight: 700;\n            font-size: 17px;\n            padding: 10px 15px;\n            border-radius: 8px;\n            display: inline-block;\n        }\n        \n        .status-resolved {\n            background-color: rgba(40, 167, 69, 0.15);\n            color: var(--success);\n        }\n        \n        .status-in-progress {\n            background-color: rgba(255, 193, 7, 0.15);\n            color: var(--warning);\n        }\n        \n        .status-pending {\n            background-color: rgba(220, 53, 69, 0.15);\n            color: var(--danger);\n        }\n        \n        .status-info {\n            background-color: rgba(23, 162, 184, 0.15);\n            color: var(--info);\n        }\n        \n        /* Footer */\n        .footer {\n            margin-top: 40px;\n            padding: 25px 40px;\n            background-color: var(--form-bg);\n            border-top: 1px solid var(--border);\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            flex-wrap: wrap;\n            gap: 20px;\n        }\n        \n        .footer-text {\n            color: var(--gray);\n            font-size: 14px;\n        }\n        \n        .footer-links {\n            display: flex;\n            gap: 15px;\n        }\n        \n        .footer-link {\n            color: var(--primary);\n            text-decoration: none;\n            font-weight: 600;\n            font-size: 14px;\n            transition: all 0.3s;\n        }\n        \n        .footer-link:hover {\n            color: var(--accent);\n            text-decoration: underline;\n        }\n        \n        /* Modal */\n        .modal {\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background-color: rgba(0, 0, 0, 0.7);\n            z-index: 1000;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            opacity: 0;\n            visibility: hidden;\n            transition: all 0.3s;\n        }\n        \n        .modal.active {\n            opacity: 1;\n            visibility: visible;\n        }\n        \n        .modal-content {\n            background: var(--bg-color);\n            border-radius: 15px;\n            width: 100%;\n            max-width: 500px;\n            padding: 30px;\n            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.25);\n            transform: translateY(-30px);\n            transition: all 0.4s;\n        }\n        \n        .modal.active .modal-content {\n            transform: translateY(0);\n        }\n        \n        .modal-header {\n            margin-bottom: 25px;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n        \n        .modal-header h3 {\n            color: var(--primary);\n            font-size: 24px;\n            font-weight: 700;\n        }\n        \n        .close-modal {\n            background: none;\n            border: none;\n            font-size: 24px;\n            color: var(--gray);\n            cursor: pointer;\n            transition: all 0.3s;\n        }\n        \n        .close-modal:hover {\n            color: var(--danger);\n            transform: rotate(90deg);\n        }\n        \n        .modal-footer {\n            display: flex;\n            justify-content: flex-end;\n            gap: 15px;\n            margin-top: 25px;\n        }\n        \n        /* Dashboard Styles */\n        .dashboard-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n            gap: 25px;\n            margin-top: 20px;\n        }\n        \n        .dashboard-card {\n            background: var(--bg-color);\n            border-radius: 12px;\n            padding: 25px;\n            box-shadow: var(--card-shadow);\n            border-top: 4px solid var(--accent);\n            transition: all 0.3s;\n        }\n        \n        .dashboard-card:hover {\n            transform: translateY(-5px);\n            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);\n        }\n        \n        .dashboard-card h3 {\n            color: var(--primary);\n            margin-bottom: 15px;\n            display: flex;\n            align-items: center;\n            gap: 10px;\n        }\n        \n        .stat-number {\n            font-size: 32px;\n            font-weight: 700;\n            color: var(--primary);\n            margin: 10px 0;\n        }\n        \n        .stat-label {\n            color: var(--gray);\n            font-weight: 600;\n        }\n        \n        .recent-reports {\n            margin-top: 20px;\n        }\n        \n        .report-item {\n            padding: 15px;\n            border-bottom: 1px solid var(--border);\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n        \n        .report-item:last-child {\n            border-bottom: none;\n        }\n        \n        .report-title {\n            font-weight: 600;\n            color: var(--text-color);\n        }\n        \n        .report-date {\n            color: var(--gray);\n            font-size: 14px;\n        }\n        \n        /* FAQ Accordion */\n        .faq-content {\n            display: none;\n            padding: 15px;\n            background-color: var(--form-bg);\n            border-radius: 0 0 8px 8px;\n            margin-top: -10px;\n            border: 1px solid var(--border);\n            border-top: none;\n        }\n        \n        .faq-item.active .faq-content {\n            display: block;\n        }\n        \n        .faq-item.active .fa-chevron-down {\n            transform: rotate(180deg);\n        }\n        \n        /* Responsive */\n        @media (max-width: 992px) {\n            .header {\n                flex-direction: column;\n                align-items: flex-start;\n                gap: 25px;\n            }\n            \n            .action-buttons {\n                width: 100%;\n                flex-wrap: wrap;\n            }\n            \n            .btn {\n                flex: 1;\n                justify-content: center;\n            }\n        }\n        \n        @media (max-width: 768px) {\n            .header, .main-content, .footer {\n                padding: 20px;\n            }\n            \n            .nav-tabs {\n                padding: 0 20px;\n                overflow-x: auto;\n            }\n            \n            .nav-item {\n                white-space: nowrap;\n                padding: 15px 20px;\n            }\n            \n            .form-section {\n                padding: 20px;\n            }\n            \n            .system-status {\n                flex-direction: column;\n            }\n        }\n        \n        @media (max-width: 576px) {\n            .form-row {\n                flex-direction: column;\n                gap: 15px;\n            }\n            \n            .modal-content {\n                padding: 20px;\n            }\n            \n            .btn {\n                padding: 10px 15px;\n                font-size: 14px;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"app-container\">\n        <!-- Header -->\n        <div class=\"header\">\n            <div class=\"logo\">\n                <div class=\"logo-icon\">\n                    <i class=\"fas fa-bug fa-2x\"></i>\n                </div>\n                <div class=\"logo-text\">\n                    <h1>IT Incident Reporting Tool</h1>\n                    <p>Professional Incident Management Solution</p>\n                </div>\n            </div>\n            <div class=\"action-buttons\">\n                <button class=\"btn btn-outline\" id=\"saveBtn\">\n                    <i class=\"fas fa-save\"></i> Save Draft\n                </button>\n                <button class=\"btn btn-outline\" id=\"loadBtn\">\n                    <i class=\"fas fa-folder-open\"></i> Load Draft\n                </button>\n                <button class=\"btn btn-primary\" id=\"exportPdfBtn\">\n                    <i class=\"fas fa-file-pdf\"></i> Export PDF\n                </button>\n                <button class=\"btn btn-success\" id=\"emailBtn\">\n                    <i class=\"fas fa-envelope\"></i> Email Report\n                </button>\n            </div>\n        </div>\n        \n        <!-- Navigation -->\n        <div class=\"nav-tabs\">\n            <div class=\"nav-item active\" data-tab=\"dashboard\">\n                <i class=\"fas fa-home\"></i> Dashboard\n            </div>\n            <div class=\"nav-item\" data-tab=\"new-report\">\n                <i class=\"fas fa-file-alt\"></i> New Report\n            </div>\n            <div class=\"nav-item\" data-tab=\"history\">\n                <i class=\"fas fa-history\"></i> Report History\n            </div>\n            <div class=\"nav-item\" data-tab=\"settings\">\n                <i class=\"fas fa-cog\"></i> Settings\n            </div>\n            <div class=\"nav-item\" data-tab=\"help\">\n                <i class=\"fas fa-question-circle\"></i> Help & Support\n            </div>\n        </div>\n        \n        <!-- Main Content -->\n        <div class=\"main-content\">\n            <!-- Dashboard Tab -->\n            <div id=\"dashboardContent\" class=\"tab-content active\">\n                <div class=\"form-section\">\n                    <div class=\"section-header\">\n                        <h3><i class=\"fas fa-chart-line\"></i> Incident Dashboard</h3>\n                    </div>\n                    \n                    <div class=\"dashboard-grid\">\n                        <div class=\"dashboard-card\">\n                            <h3><i class=\"fas fa-exclamation-circle\"></i> Open Incidents</h3>\n                            <div class=\"stat-number\">12</div>\n                            <div class=\"stat-label\">Active issues requiring attention</div>\n                        </div>\n                        \n                        <div class=\"dashboard-card\">\n                            <h3><i class=\"fas fa-check-circle\"></i> Resolved This Week</h3>\n                            <div class=\"stat-number\">24</div>\n                            <div class=\"stat-label\">Issues successfully resolved</div>\n                        </div>\n                        \n                        <div class=\"dashboard-card\">\n                            <h3><i class=\"fas fa-clock\"></i> Average Resolution Time</h3>\n                            <div class=\"stat-number\">18.5h</div>\n                            <div class=\"stat-label\">From report to resolution</div>\n                        </div>\n                        \n                        <div class=\"dashboard-card\">\n                            <h3><i class=\"fas fa-user-shield\"></i> Your Reports</h3>\n                            <div class=\"stat-number\">7</div>\n                            <div class=\"stat-label\">Incidents managed by you</div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-section\">\n                        <h3><i class=\"fas fa-list\"></i> Recent Reports</h3>\n                        <div class=\"recent-reports\">\n                            <div class=\"report-item\">\n                                <div>\n                                    <div class=\"report-title\">SQL Service Failure on ASTW-APP04</div>\n                                    <div class=\"report-date\">Priority: High ‚Ä¢ Created: 2023-11-15</div>\n                                </div>\n                                <div>\n                                    <span class=\"status status-in-progress\">In Progress</span>\n                                </div>\n                            </div>\n                            <div class=\"report-item\">\n                                <div>\n                                    <div class=\"report-title\">Network Connectivity Issues</div>\n                                    <div class=\"report-date\">Priority: Medium ‚Ä¢ Created: 2023-11-14</div>\n                                </div>\n                                <div>\n                                    <span class=\"status status-resolved\">Resolved</span>\n                                </div>\n                            </div>\n                            <div class=\"report-item\">\n                                <div>\n                                    <div class=\"report-title\">Email Server Outage</div>\n                                    <div class=\"report-date\">Priority: Critical ‚Ä¢ Created: 2023-11-12</div>\n                                </div>\n                                <div>\n                                    <span class=\"status status-resolved\">Resolved</span>\n                                </div>\n                            </div>\n                            <div class=\"report-item\">\n                                <div>\n                                    <div class=\"report-title\">Firewall Configuration Error</div>\n                                    <div class=\"report-date\">Priority: High ‚Ä¢ Created: 2023-11-10</div>\n                                </div>\n                                <div>\n                                    <span class=\"status status-pending\">Pending</span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            \n            <!-- New Report Tab -->\n            <div id=\"newReportContent\" class=\"tab-content\">\n                <form id=\"incidentReportForm\">\n                    <!-- Ticket & Basic Info -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-info-circle\"></i> Incident Information</h3>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"ticketNumber\"><i class=\"fas fa-ticket-alt\"></i> Ticket/Incident Number</label>\n                                <input type=\"text\" id=\"ticketNumber\" class=\"form-control\" placeholder=\"INC-2023-001\" value=\"INC-2023-001\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"clientName\"><i class=\"fas fa-building\"></i> Client Name</label>\n                                <input type=\"text\" id=\"clientName\" class=\"form-control\" placeholder=\"Ashtons IT\" value=\"Ashtons IT\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"reportDate\"><i class=\"fas fa-calendar\"></i> Report Date</label>\n                                <input type=\"date\" id=\"reportDate\" class=\"form-control\">\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"priority\"><i class=\"fas fa-exclamation-triangle\"></i> Priority</label>\n                                <select id=\"priority\" class=\"form-control\">\n                                    <option value=\"HIGH\">High</option>\n                                    <option value=\"MEDIUM\">Medium</option>\n                                    <option value=\"LOW\">Low</option>\n                                </select>\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"status\"><i class=\"fas fa-sync\"></i> Current Status</label>\n                                <select id=\"status\" class=\"form-control\">\n                                    <option value=\"RESOLVED\">Resolved</option>\n                                    <option value=\"IN_PROGRESS\">In Progress</option>\n                                    <option value=\"PENDING\">Pending</option>\n                                </select>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Executive Summary -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-chart-line\"></i> Executive Summary</h3>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"issue\"><i class=\"fas fa-exclamation-circle\"></i> Issue Description</label>\n                                <textarea id=\"issue\" class=\"form-control\">SQL services failing to start on server ASTW-APP04, affecting Solcase application functionality</textarea>\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"impact\"><i class=\"fas fa-bolt\"></i> Business Impact</label>\n                                <textarea id=\"impact\" class=\"form-control\">Critical Solcase operations (including reporting and batch processing) impaired; domain admin credentials compromised.</textarea>\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"rootCause\"><i class=\"fas fa-search\"></i> Root Cause</label>\n                                <textarea id=\"rootCause\" class=\"form-control\">Domain administrator account compromise and misuse for SQL services.</textarea>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Incident Details -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-clipboard-list\"></i> Incident Details</h3>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"reportedTime\"><i class=\"fas fa-clock\"></i> Reported Time</label>\n                                <input type=\"datetime-local\" id=\"reportedTime\" class=\"form-control\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"reportedBy\"><i class=\"fas fa-user\"></i> Reported By</label>\n                                <input type=\"text\" id=\"reportedBy\" class=\"form-control\" placeholder=\"Contact name/role\" value=\"Josh Teague (Ashtons IT)\">\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"affectedSystems\"><i class=\"fas fa-server\"></i> Affected Systems</label>\n                                <textarea id=\"affectedSystems\" class=\"form-control\">ASTW-APP04 (SQL Server), Solcase application</textarea>\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"symptoms\"><i class=\"fas fa-stethoscope\"></i> Symptoms</label>\n                                <textarea id=\"symptoms\" class=\"form-control\">SQL services unresponsive; scheduled tasks failing; domain admin account locked.</textarea>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Investigation Timeline -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-history\"></i> Investigation Timeline</h3>\n                        </div>\n                        <table class=\"timeline-table\">\n                            <thead>\n                                <tr>\n                                    <th>Time</th>\n                                    <th>Action Taken</th>\n                                    <th>Engineer</th>\n                                    <th>Outcome</th>\n                                    <th></th>\n                                </tr>\n                            </thead>\n                            <tbody id=\"timelineBody\">\n                                <tr>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"15:31\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Identified domain admin account lockout\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Josh Teague\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Suspicious activity detected\"></td>\n                                    <td><button type=\"button\" class=\"btn btn-danger\" onclick=\"removeTimelineRow(this)\"><i class=\"fas fa-trash\"></i></button></td>\n                                </tr>\n                                <tr>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"15:33\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Detected unauthorized password change\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Nishen Harichunder\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Credentials compromised\"></td>\n                                    <td><button type=\"button\" class=\"btn btn-danger\" onclick=\"removeTimelineRow(this)\"><i class=\"fas fa-trash\"></i></button></td>\n                                </tr>\n                                <tr>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"15:34\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Recommended dedicated SQL service account\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Nishen Harichunder\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Plan for credential remediation\"></td>\n                                    <td><button type=\"button\" class=\"btn btn-danger\" onclick=\"removeTimelineRow(this)\"><i class=\"fas fa-trash\"></i></button></td>\n                                </tr>\n                            </tbody>\n                        </table>\n                        <button type=\"button\" class=\"add-row-btn\" onclick=\"addTimelineRow()\">\n                            <i class=\"fas fa-plus\"></i> Add Timeline Event\n                        </button>\n                    </div>\n                    \n                    <!-- Resolution Actions -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-tools\"></i> Resolution Actions</h3>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"actionsTaken\"><i class=\"fas fa-hammer\"></i> Actions Implemented</label>\n                                <textarea id=\"actionsTaken\" class=\"form-control\">1. Service Account Migration\n- Created sql_svc_progressDB@internal.ashtongraham.co.uk\n- Updated all SQL services on ASTW-APP04\n- SQL services started successfully\n\n2. Scheduled Task Remediation\n- Updated 4 tasks (RapidRTA, Claims processing, Notification retrieval, Report spooling)\n- Tasks reconfigured; manual execution required for missed jobs</textarea>\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"securityImprovements\"><i class=\"fas fa-shield-alt\"></i> Security Improvements</label>\n                                <textarea id=\"securityImprovements\" class=\"form-control\">- Eliminated Domain Admin Usage\n- Updated service account details in PassPortal\n- Dedicated Service Account for SQL operations\n- Implemented alerting for domain admin account lockouts</textarea>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Current Status -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-chart-bar\"></i> Current Status</h3>\n                        </div>\n                        <div class=\"system-status\">\n                            <div class=\"status-card\">\n                                <h4><i class=\"fas fa-database\"></i> SQL Services</h4>\n                                <div class=\"status status-resolved\">\n                                    <i class=\"fas fa-check-circle\"></i> Running with dedicated service account\n                                </div>\n                            </div>\n                            <div class=\"status-card\">\n                                <h4><i class=\"fas fa-window-restore\"></i> Application</h4>\n                                <div class=\"status status-in-progress\">\n                                    <i class=\"fas fa-exclamation-triangle\"></i> May require server reboot\n                                </div>\n                            </div>\n                            <div class=\"status-card\">\n                                <h4><i class=\"fas fa-tasks\"></i> Scheduled Tasks</h4>\n                                <div class=\"status status-info\">\n                                    <i class=\"fas fa-clipboard-list\"></i> Updated but may need manual execution\n                                </div>\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"outstandingActions\"><i class=\"fas fa-list-check\"></i> Outstanding Actions</label>\n                                <textarea id=\"outstandingActions\" class=\"form-control\">1. Server Reboot (ASTW-APP04)\n- Reboot to flush credential cache\n- Responsible: Steve (Approval Pending)\n\n2. Domain-Wide Security Audit\n- Scan all servers for services using domain admin accounts\n- Responsible: Oliver Govender (Next 48 hours)\n\n3. Password Change Investigation\n- Determine who changed domain admin password and why\n- Responsible: Ashtons IT Security Team (High priority)</textarea>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Recommendations -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-lightbulb\"></i> Recommendations</h3>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"immediateRecs\"><i class=\"fas fa-bolt\"></i> Immediate Recommendations (24-48 Hours)</label>\n                                <textarea id=\"immediateRecs\" class=\"form-control\">1. Implement Domain Admin Lockout Alerts\n- Configure SIEM/Sentinel rules for real-time detection\n\n2. Manual Task Execution\n- Execute backlog from failed scheduled jobs\n- Validate outputs post-execution</textarea>\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"longTermRecs\"><i class=\"fas fa-chart-line\"></i> Long-term Improvements (30-90 Days)</label>\n                                <textarea id=\"longTermRecs\" class=\"form-control\">1. Deploy Group Managed Service Accounts (gMSA)\n- Automate password management for service accounts\n- Eliminate manual credential rotation\n\n2. Privileged Access Audit Framework\n- Quarterly reviews of service account dependencies\n- Implement automated scanning tools</textarea>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Contact Information -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-address-card\"></i> Contact Information</h3>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"engineerName\"><i class=\"fas fa-user-tie\"></i> Primary Engineer</label>\n                                <input type=\"text\" id=\"engineerName\" class=\"form-control\" value=\"Nishen Harichunder\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"engineerEmail\"><i class=\"fas fa-envelope\"></i> Email</label>\n                                <input type=\"email\" id=\"engineerEmail\" class=\"form-control\" placeholder=\"engineer@example.com\" value=\"nishen@firsttech.com\">\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"engineerPhone\"><i class=\"fas fa-phone\"></i> Mobile</label>\n                                <input type=\"tel\" id=\"engineerPhone\" class=\"form-control\" placeholder=\"+27 123 456 789\" value=\"+27 123 456 789\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"availability\"><i class=\"fas fa-calendar-check\"></i> Availability</label>\n                                <input type=\"text\" id=\"availability\" class=\"form-control\" placeholder=\"08:00-17:00 SAST (Mon-Fri)\" value=\"08:00-17:00 SAST (Mon-Fri)\">\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-section\">\n                        <button type=\"button\" class=\"btn btn-primary\" id=\"submitReport\" style=\"width: 100%; padding: 16px; font-size: 17px; font-weight: 600;\">\n                            <i class=\"fas fa-paper-plane\"></i> Submit Final Report\n                        </button>\n                    </div>\n                </form>\n            </div>\n            \n            <!-- Report History Tab -->\n            <div id=\"historyContent\" class=\"tab-content\">\n                <div class=\"form-section\">\n                    <div class=\"section-header\">\n                        <h3><i class=\"fas fa-history\"></i> Report History</h3>\n                    </div>\n                    \n                    <div class=\"recent-reports\">\n                        <div class=\"report-item\">\n                            <div>\n                                <div class=\"report-title\">Database Connection Failure</div>\n                                <div class=\"report-date\">Created: 2023-11-14 ‚Ä¢ Priority: High</div>\n                            </div>\n                            <div>\n                                <span class=\"status status-resolved\">Resolved</span>\n                            </div>\n                        </div>\n                        <div class=\"report-item\">\n                            <div>\n                                <div class=\"report-title\">Firewall Configuration Error</div>\n                                <div class=\"report-date\">Created: 2023-11-12 ‚Ä¢ Priority: Critical</div>\n                            </div>\n                            <div>\n                                <span class=\"status status-resolved\">Resolved</span>\n                            </div>\n                        </div>\n                        <div class=\"report-item\">\n                            <div>\n                                <div class=\"report-title\">Email Server Outage</div>\n                                <div class=\"report-date\">Created: 2023-11-10 ‚Ä¢ Priority: High</div>\n                            </div>\n                            <div>\n                                <span class=\"status status-resolved\">Resolved</span>\n                            </div>\n                        </div>\n                        <div class=\"report-item\">\n                            <div>\n                                <div class=\"report-title\">Network Switch Failure</div>\n                                <div class=\"report-date\">Created: 2023-11-08 ‚Ä¢ Priority: Medium</div>\n                            </div>\n                            <div>\n                                <span class=\"status status-resolved\">Resolved</span>\n                            </div>\n                        </div>\n                        <div class=\"report-item\">\n                            <div>\n                                <div class=\"report-title\">Backup System Failure</div>\n                                <div class=\"report-date\">Created: 2023-11-05 ‚Ä¢ Priority: High</div>\n                            </div>\n                            <div>\n                                <span class=\"status status-resolved\">Resolved</span>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div style=\"margin-top: 30px; text-align: center;\">\n                        <button class=\"btn btn-outline\">\n                            <i class=\"fas fa-arrow-left\"></i> Previous\n                        </button>\n                        <span style=\"margin: 0 15px; font-weight: 600;\">Page 1 of 3</span>\n                        <button class=\"btn btn-outline\">\n                            Next <i class=\"fas fa-arrow-right\"></i>\n                        </button>\n                    </div>\n                </div>\n            </div>\n            \n            <!-- Settings Tab -->\n            <div id=\"settingsContent\" class=\"tab-content\">\n                <div class=\"form-section\">\n                    <div class=\"section-header\">\n                        <h3><i class=\"fas fa-cog\"></i> Application Settings</h3>\n                    </div>\n                    \n                    <div class=\"form-row\">\n                        <div class=\"form-group\">\n                            <label for=\"companyName\"><i class=\"fas fa-building\"></i> Company Name</label>\n                            <input type=\"text\" id=\"companyName\" class=\"form-control\" value=\"First Technology KZN (Pty) Ltd\">\n                        </div>\n                        <div class=\"form-group\">\n                            <label for=\"defaultEngineer\"><i class=\"fas fa-user-tie\"></i> Default Engineer</label>\n                            <input type=\"text\" id=\"defaultEngineer\" class=\"form-control\" value=\"Nishen Harichunder\">\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-row\">\n                        <div class=\"form-group\">\n                            <label for=\"emailSignature\"><i class=\"fas fa-signature\"></i> Email Signature</label>\n                            <textarea id=\"emailSignature\" class=\"form-control\">Best regards,\nFirst Technology Support Team\nsupport@firsttech.com\n+27 123 456 789</textarea>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-row\">\n                        <div class=\"form-group\">\n                            <label for=\"autoSave\"><i class=\"fas fa-save\"></i> Auto-save Interval</label>\n                            <select id=\"autoSave\" class=\"form-control\">\n                                <option value=\"5\">Every 5 minutes</option>\n                                <option value=\"10\" selected>Every 10 minutes</option>\n                                <option value=\"15\">Every 15 minutes</option>\n                                <option value=\"30\">Every 30 minutes</option>\n                                <option value=\"0\">Disabled</option>\n                            </select>\n                        </div>\n                        <div class=\"form-group\">\n                            <label for=\"theme\"><i class=\"fas fa-palette\"></i> Theme</label>\n                            <select id=\"theme\" class=\"form-control\">\n                                <option value=\"light\">Light Theme</option>\n                                <option value=\"dark\">Dark Theme</option>\n                                <option value=\"blue\" selected>Blue Theme</option>\n                                <option value=\"green\">Green Theme</option>\n                            </select>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-section\">\n                        <button type=\"button\" class=\"btn btn-primary\" id=\"saveSettingsBtn\" style=\"width: 100%; padding: 16px; font-size: 17px; font-weight: 600;\">\n                            <i class=\"fas fa-save\"></i> Save Settings\n                        </button>\n                    </div>\n                </div>\n            </div>\n            \n            <!-- Help & Support Tab -->\n            <div id=\"helpContent\" class=\"tab-content\">\n                <div class=\"form-section\">\n                    <div class=\"section-header\">\n                        <h3><i class=\"fas fa-question-circle\"></i> Help & Support</h3>\n                    </div>\n                    \n                    <div class=\"system-status\">\n                        <div class=\"status-card\">\n                            <h4><i class=\"fas fa-book\"></i> Documentation</h4>\n                            <p>Access our comprehensive user guides and documentation to learn how to use all features of the Incident Reporting Tool.</p>\n                            <button class=\"btn btn-outline\" style=\"margin-top: 15px;\">\n                                <i class=\"fas fa-download\"></i> Download User Guide\n                            </button>\n                        </div>\n                        <div class=\"status-card\">\n                            <h4><i class=\"fas fa-video\"></i> Video Tutorials</h4>\n                            <p>Watch step-by-step video tutorials that demonstrate how to create, manage, and export incident reports.</p>\n                            <button class=\"btn btn-outline\" style=\"margin-top: 15px;\">\n                                <i class=\"fas fa-play-circle\"></i> View Tutorials\n                            </button>\n                        </div>\n                        <div class=\"status-card\">\n                            <h4><i class=\"fas fa-headset\"></i> Contact Support</h4>\n                            <p>Our support team is available to assist you with any questions or issues you may encounter.</p>\n                            <div style=\"margin-top: 15px;\">\n                                <p><i class=\"fas fa-envelope\"></i> support@firsttech.com</p>\n                                <p><i class=\"fas fa-phone\"></i> +27 123 456 789</p>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-section\">\n                        <h3><i class=\"fas fa-comments\"></i> Frequently Asked Questions</h3>\n                        <div class=\"recent-reports\" id=\"faqContainer\">\n                            <div class=\"report-item faq-item\">\n                                <div>\n                                    <div class=\"report-title\">How do I save a draft of my report?</div>\n                                </div>\n                                <div>\n                                    <i class=\"fas fa-chevron-down\"></i>\n                                </div>\n                                <div class=\"faq-content\">\n                                    <p>To save a draft of your report, click the \"Save Draft\" button in the top right corner of the application. This will save your current progress to your browser's local storage. You can later load this draft by clicking the \"Load Draft\" button.</p>\n                                </div>\n                            </div>\n                            <div class=\"report-item faq-item\">\n                                <div>\n                                    <div class=\"report-title\">Can I export reports to PDF?</div>\n                                </div>\n                                <div>\n                                    <i class=\"fas fa-chevron-down\"></i>\n                                </div>\n                                <div class=\"faq-content\">\n                                    <p>Yes, you can export your reports to PDF by clicking the \"Export PDF\" button in the top right corner. This will generate a PDF version of your current report that you can save to your computer or print.</p>\n                                </div>\n                            </div>\n                            <div class=\"report-item faq-item\">\n                                <div>\n                                    <div class=\"report-title\">How do I change my account settings?</div>\n                                </div>\n                                <div>\n                                    <i class=\"fas fa-chevron-down\"></i>\n                                </div>\n                                <div class=\"faq-content\">\n                                    <p>Account settings can be changed in the \"Settings\" tab. Here you can update your default engineer information, company details, email signature, and application preferences like theme and auto-save interval.</p>\n                                </div>\n                            </div>\n                            <div class=\"report-item faq-item\">\n                                <div>\n                                    <div class=\"report-title\">Where can I find my previously submitted reports?</div>\n                                </div>\n                                <div>\n                                    <i class=\"fas fa-chevron-down\"></i>\n                                </div>\n                                <div class=\"faq-content\">\n                                    <p>All your previously submitted reports can be found in the \"Report History\" tab. This section displays a list of all your past reports with their status, priority, and creation date.</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            \n            <div class=\"footer\">\n                <div class=\"footer-text\">\n                    First Technology KZN (Pty) Ltd | Incident Reporting Tool v2.1\n                </div>\n                <div class=\"footer-links\">\n                    <a href=\"#\" class=\"footer-link\">Privacy Policy</a>\n                    <a href=\"#\" class=\"footer-link\">Terms of Service</a>\n                    <a href=\"#\" class=\"footer-link\">Contact Support</a>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    <!-- Email Modal -->\n    <div class=\"modal\" id=\"emailModal\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <h3><i class=\"fas fa-envelope\"></i> Email Incident Report</h3>\n                <button class=\"close-modal\" id=\"cancelEmailBtn\">&times;</button>\n            </div>\n            <div class=\"form-group\" style=\"margin-bottom: 20px;\">\n                <label for=\"recipientEmail\">Recipient Email</label>\n                <input type=\"email\" id=\"recipientEmail\" class=\"form-control\" placeholder=\"recipient@example.com\" value=\"manager@ashtons.com\">\n            </div>\n            <div class=\"form-group\" style=\"margin-bottom: 20px;\">\n                <label for=\"emailSubject\">Subject</label>\n                <input type=\"text\" id=\"emailSubject\" class=\"form-control\" value=\"IT Incident Report - Ashtons IT\">\n            </div>\n            <div class=\"form-group\" style=\"margin-bottom: 20px;\">\n                <label for=\"emailMessage\">Additional Message</label>\n                <textarea id=\"emailMessage\" class=\"form-control\" rows=\"4\">Please find attached the incident report for your review. Let me know if you need any additional information.</textarea>\n            </div>\n            <div class=\"modal-footer\">\n                <button class=\"btn btn-outline\" id=\"cancelEmailBtn2\">Cancel</button>\n                <button class=\"btn btn-success\" id=\"sendEmailBtn\">\n                    <i class=\"fas fa-paper-plane\"></i> Send Email\n                </button>\n            </div>\n        </div>\n    </div>\n    \n    <!-- Success Modal -->\n    <div class=\"modal\" id=\"successModal\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <h3><i class=\"fas fa-check-circle\"></i> Success!</h3>\n                <button class=\"close-modal\" id=\"closeSuccessBtn\">&times;</button>\n            </div>\n            <div style=\"padding: 20px; text-align: center;\">\n                <i class=\"fas fa-check-circle fa-4x\" style=\"color: var(--success); margin-bottom: 20px;\"></i>\n                <p id=\"successMessage\" style=\"font-size: 18px; line-height: 1.6;\">\n                    Your incident report has been processed successfully.\n                </p>\n            </div>\n            <div class=\"modal-footer\" style=\"justify-content: center;\">\n                <button class=\"btn btn-primary\" id=\"successOkBtn\">\n                    OK\n                </button>\n            </div>\n        </div>\n    </div>\n    \n    <script>\n        // Set today's date as default\n        document.addEventListener('DOMContentLoaded', function() {\n            const today = new Date().toISOString().split('T')[0];\n            document.getElementById('reportDate').value = today;\n            \n            // Set reported time to 2 hours ago\n            const reportedTime = new Date();\n            reportedTime.setHours(reportedTime.getHours() - 2);\n            const reportedTimeString = reportedTime.toISOString().slice(0, 16);\n            document.getElementById('reportedTime').value = reportedTimeString;\n            \n            // Initialize navigation\n            initNavigation();\n            \n            // Initialize FAQ accordion\n            initFAQ();\n            \n            // Load saved theme if exists\n            const savedTheme = localStorage.getItem('appTheme') || 'blue';\n            document.body.classList.add(`theme-${savedTheme}`);\n            document.getElementById('theme').value = savedTheme;\n        });\n        \n        // Initialize navigation tabs\n        function initNavigation() {\n            // Set first tab as active\n            document.querySelector('.nav-item').classList.add('active');\n            document.getElementById('dashboardContent').classList.add('active');\n            \n            // Add event listeners to all nav items\n            document.querySelectorAll('.nav-item').forEach(item => {\n                item.addEventListener('click', function() {\n                    // Remove active class from all items\n                    document.querySelectorAll('.nav-item').forEach(i => {\n                        i.classList.remove('active');\n                    });\n                    \n                    // Hide all tab contents\n                    document.querySelectorAll('.tab-content').forEach(tab => {\n                        tab.classList.remove('active');\n                    });\n                    \n                    // Add active class to clicked item\n                    this.classList.add('active');\n                    \n                    // Show corresponding tab content\n                    const tabId = this.getAttribute('data-tab');\n                    document.getElementById(tabId + 'Content').classList.add('active');\n                });\n            });\n        }\n        \n        // Initialize FAQ accordion\n        function initFAQ() {\n            const faqItems = document.querySelectorAll('.faq-item');\n            \n            faqItems.forEach(item => {\n                const header = item.querySelector('.report-item');\n                \n                header.addEventListener('click', () => {\n                    // Toggle active class on the FAQ item\n                    item.classList.toggle('active');\n                    \n                    // Close other FAQ items\n                    faqItems.forEach(otherItem => {\n                        if (otherItem !== item) {\n                            otherItem.classList.remove('active');\n                        }\n                    });\n                });\n            });\n        }\n        \n        // Timeline table functions\n        function addTimelineRow() {\n            const tbody = document.getElementById('timelineBody');\n            const newRow = document.createElement('tr');\n            \n            // Get current time for new row\n            const now = new Date();\n            const timeString = now.toTimeString().substring(0,5);\n            \n            newRow.innerHTML = `\n                <td><input type=\"text\" class=\"form-control\" value=\"${timeString}\"></td>\n                <td><input type=\"text\" class=\"form-control\" placeholder=\"Action description\"></td>\n                <td><input type=\"text\" class=\"form-control\" placeholder=\"Engineer name\"></td>\n                <td><input type=\"text\" class=\"form-control\" placeholder=\"Result\"></td>\n                <td><button type=\"button\" class=\"btn btn-danger\" onclick=\"removeTimelineRow(this)\"><i class=\"fas fa-trash\"></i></button></td>\n            `;\n            \n            tbody.appendChild(newRow);\n        }\n        \n        function removeTimelineRow(button) {\n            const row = button.parentNode.parentNode;\n            row.parentNode.removeChild(row);\n        }\n        \n        // Save report to localStorage\n        document.getElementById('saveBtn').addEventListener('click', function() {\n            const formData = getFormData();\n            localStorage.setItem('incidentReportDraft', JSON.stringify(formData));\n            \n            // Show success message\n            document.getElementById('successMessage').textContent = 'Report draft saved successfully! You can load it anytime to continue working.';\n            document.getElementById('successModal').classList.add('active');\n        });\n        \n        // Load report from localStorage\n        document.getElementById('loadBtn').addEventListener('click', function() {\n            const savedData = localStorage.getItem('incidentReportDraft');\n            \n            if (savedData) {\n                const formData = JSON.parse(savedData);\n                setFormData(formData);\n                \n                // Show success message\n                document.getElementById('successMessage').textContent = 'Report draft loaded successfully! You can now continue editing.';\n                document.getElementById('successModal').classList.add('active');\n            } else {\n                alert('No saved draft found. Please save a draft first.');\n            }\n        });\n        \n        // Get all form data as an object\n        function getFormData() {\n            const form = document.getElementById('incidentReportForm');\n            const inputs = form.querySelectorAll('input, textarea, select');\n            const formData = {};\n            \n            inputs.forEach(input => {\n                if (input.type !== 'button') {\n                    formData[input.id] = input.value;\n                }\n            });\n            \n            // Get timeline data\n            const timelineRows = document.querySelectorAll('#timelineBody tr');\n            const timelineData = [];\n            \n            timelineRows.forEach(row => {\n                const cells = row.querySelectorAll('td');\n                timelineData.push({\n                    time: cells[0].querySelector('input').value,\n                    action: cells[1].querySelector('input').value,\n                    engineer: cells[2].querySelector('input').value,\n                    outcome: cells[3].querySelector('input').value\n                });\n            });\n            \n            formData.timeline = timelineData;\n            \n            return formData;\n        }\n        \n        // Set form data from object\n        function setFormData(formData) {\n            for (const key in formData) {\n                if (key === 'timeline') {\n                    // Handle timeline separately\n                    const tbody = document.getElementById('timelineBody');\n                    tbody.innerHTML = '';\n                    \n                    formData.timeline.forEach(item => {\n                        const newRow = document.createElement('tr');\n                        newRow.innerHTML = `\n                            <td><input type=\"text\" class=\"form-control\" value=\"${item.time}\"></td>\n                            <td><input type=\"text\" class=\"form-control\" value=\"${item.action}\"></td>\n                            <td><input type=\"text\" class=\"form-control\" value=\"${item.engineer}\"></td>\n                            <td><input type=\"text\" class=\"form-control\" value=\"${item.outcome}\"></td>\n                            <td><button type=\"button\" class=\"btn btn-danger\" onclick=\"removeTimelineRow(this)\"><i class=\"fas fa-trash\"></i></button></td>\n                        `;\n                        tbody.appendChild(newRow);\n                    });\n                } else {\n                    const element = document.getElementById(key);\n                    if (element) {\n                        element.value = formData[key];\n                    }\n                }\n            }\n        }\n        \n        // Email functionality\n        document.getElementById('emailBtn').addEventListener('click', function() {\n            document.getElementById('emailModal').classList.add('active');\n        });\n        \n        document.getElementById('cancelEmailBtn').addEventListener('click', function() {\n            document.getElementById('emailModal').classList.remove('active');\n        });\n        \n        document.getElementById('cancelEmailBtn2').addEventListener('click', function() {\n            document.getElementById('emailModal').classList.remove('active');\n        });\n        \n        document.getElementById('sendEmailBtn').addEventListener('click', function() {\n            const recipient = document.getElementById('recipientEmail').value;\n            if (!recipient) {\n                alert('Please enter a recipient email address');\n                return;\n            }\n            \n            // Create mailto link with form data\n            const subject = document.getElementById('emailSubject').value;\n            const body = document.getElementById('emailMessage').value;\n            const mailtoLink = `mailto:${recipient}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;\n            \n            // Open default email client\n            window.location.href = mailtoLink;\n            \n            document.getElementById('emailModal').classList.remove('active');\n            document.getElementById('successMessage').textContent = `Incident report has been emailed to ${recipient} successfully!`;\n            document.getElementById('successModal').classList.add('active');\n        });\n        \n        // Export to PDF functionality\n        document.getElementById('exportPdfBtn').addEventListener('click', function() {\n            const { jsPDF } = window.jspdf;\n            const doc = new jsPDF();\n            \n            // Get the form content\n            const formContent = document.getElementById('incidentReportForm');\n            \n            // Use html2canvas to capture the form as an image\n            html2canvas(formContent).then(canvas => {\n                const imgData = canvas.toDataURL('image/png');\n                const imgWidth = doc.internal.pageSize.getWidth() - 20;\n                const imgHeight = (canvas.height * imgWidth) / canvas.width;\n                \n                doc.addImage(imgData, 'PNG', 10, 10, imgWidth, imgHeight);\n                \n                // Save the PDF\n                doc.save('incident-report.pdf');\n                \n                // Show success message\n                document.getElementById('successMessage').textContent = 'Incident report has been exported to PDF successfully!';\n                document.getElementById('successModal').classList.add('active');\n            });\n        });\n        \n        // Submit report\n        document.getElementById('submitReport').addEventListener('click', function() {\n            // In a real application, you would send this to a server\n            const formData = getFormData();\n            console.log('Form submitted:', formData);\n            \n            document.getElementById('successMessage').textContent = 'Incident report submitted successfully! Thank you for using our system.';\n            document.getElementById('successModal').classList.add('active');\n        });\n        \n        // Save settings\n        document.getElementById('saveSettingsBtn').addEventListener('click', function() {\n            const theme = document.getElementById('theme').value;\n            \n            // Remove all theme classes\n            document.body.classList.remove('theme-light', 'theme-dark', 'theme-blue', 'theme-green');\n            // Add selected theme class\n            document.body.classList.add(`theme-${theme}`);\n            \n            // Save to localStorage\n            localStorage.setItem('appTheme', theme);\n            \n            // Show success message\n            document.getElementById('successMessage').textContent = 'Settings saved successfully!';\n            document.getElementById('successModal').classList.add('active');\n        });\n        \n        // Close modals\n        document.getElementById('closeSuccessBtn').addEventListener('click', function() {\n            document.getElementById('successModal').classList.remove('active');\n        });\n        \n        document.getElementById('successOkBtn').addEventListener('click', function() {\n            document.getElementById('successModal').classList.remove('active');\n        });\n    </script>\n</body>\n</html>",
              "timestamp": "2025-08-20T00:48:15.028Z",
              "description": "base"
            }
          ],
          "created": "2025-08-20T00:00:25.947Z",
          "modified": "2025-08-20T00:48:15.029Z",
          "timeSpent": 0
        }
      ],
      "totalTimeSpent": 12600,
      "created": "2025-06-01T00:00:00.000Z",
      "isTimerRunning": false
    },
    {
      "id": "proj-2",
      "name": "AI Workspace Development",
      "description": "Next.js workspace development project",
      "files": [
        {
          "id": "file-3",
          "name": "workspace-component.tsx",
          "type": "code",
          "category": "Frontend",
          "content": "import React from 'react'\n\ninterface WorkspaceProps {\n  theme: 'dark' | 'light'\n}\n\nexport default function Workspace({ theme }: WorkspaceProps) {\n  return (\n    <div className={`workspace ${theme}`}>\n      <h1>Nishen's AI Workspace</h1>\n    </div>\n  )\n}",
          "versions": [],
          "created": "2025-06-30T00:00:00.000Z",
          "modified": "2025-06-30T00:00:00.000Z",
          "timeSpent": 3600
        }
      ],
      "totalTimeSpent": 3600,
      "created": "2025-06-30T00:00:00.000Z",
      "isTimerRunning": false
    },
    {
      "id": "proj-1754559521998",
      "name": "Audit & Revenue Generation Scripts",
      "description": "Scripts for Auditing Backen Server Infra producing revenue opportunities.",
      "files": [
        {
          "id": "file-1754559583370",
          "name": "Physical Server Audit Script",
          "type": "script",
          "category": "Hp, Dell, Physical Servers, Audit",
          "content": "# PowerShell Script\n# Created in Nishen's AI Workspace\n# File: Physical Server Audit ScriptV1.0\n\n# Physical Server Audit Script for Hardware Inventory and Warranty Status\n# Author: Nishen Harichunder L4 Senior Systems Engineer\n# Purpose: Comprehensive server hardware assessment with warranty validation - Results to be used for revenue Opportunities \n\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$CSVPath = \".\\ServerList.csv\",\n    \n    [Parameter(Mandatory=$false)]\n    [string]$OutputPath = \".\\ServerAudit_$(Get-Date -Format 'yyyyMMdd_HHmm')\",\n    \n    [Parameter(Mandatory=$false)]\n    [switch]$SkipWarranty\n)\n\n# Required modules check and installation\n$RequiredModules = @('ImportExcel', 'DellBIOSProvider')\nforeach ($Module in $RequiredModules) {\n    if (!(Get-Module -ListAvailable -Name $Module)) {\n        Write-Host \"Installing module: $Module\" -ForegroundColor Yellow\n        Install-Module -Name $Module -Force -Scope CurrentUser\n    }\n}\n\n# Initialize collections\n$ServerInventory = @()\n$WarrantyData = @()\n$Errors = @()\n\n# HP iLO API functions\nfunction Get-HPiLOData {\n    param(\n        [string]$iLOIP,\n        [pscredential]$Credential\n    )\n    \n    try {\n        $Headers = @{\n            'Authorization' = 'Basic ' + [Convert]::ToBase64String([Text.Encoding]::ASCII.GetBytes((\"$($Credential.UserName):$($Credential.GetNetworkCredential().Password)\")))\n            'Content-Type' = 'application/json'\n        }\n        \n        # Get system info\n        $SystemInfo = Invoke-RestMethod -Uri \"https://$iLOIP/rest/v1/Systems/1\" -Headers $Headers -SkipCertificateCheck\n        $ChassisInfo = Invoke-RestMethod -Uri \"https://$iLOIP/rest/v1/Chassis/1\" -Headers $Headers -SkipCertificateCheck\n        \n        return @{\n            Manufacturer = 'HP Enterprise'\n            Model = $SystemInfo.Model\n            SerialNumber = $SystemInfo.SerialNumber\n            BIOSVersion = $SystemInfo.Bios.Current.VersionString\n            ProcessorModel = $SystemInfo.ProcessorSummary.Model\n            ProcessorCount = $SystemInfo.ProcessorSummary.Count\n            TotalMemoryGB = [math]::Round($SystemInfo.MemorySummary.TotalSystemMemoryGiB, 2)\n            PowerState = $SystemInfo.PowerState\n            HealthStatus = $SystemInfo.Status.Health\n            Firmware = @{\n                iLO = $ChassisInfo.iLO.Firmware.Current.VersionString\n                SystemROM = $SystemInfo.Bios.Current.VersionString\n            }\n        }\n    }\n    catch {\n        Write-Warning \"Failed to connect to HP iLO $iLOIP : $($_.Exception.Message)\"\n        return $null\n    }\n}\n\n# Dell iDRAC API functions\nfunction Get-DelliDRACData {\n    param(\n        [string]$iDRACIP,\n        [pscredential]$Credential\n    )\n    \n    try {\n        $Headers = @{\n            'Authorization' = 'Basic ' + [Convert]::ToBase64String([Text.Encoding]::ASCII.GetBytes((\"$($Credential.UserName):$($Credential.GetNetworkCredential().Password)\")))\n            'Content-Type' = 'application/json'\n        }\n        \n        # Get system info via Redfish API\n        $SystemInfo = Invoke-RestMethod -Uri \"https://$iDRACIP/redfish/v1/Systems/System.Embedded.1\" -Headers $Headers -SkipCertificateCheck\n        $ChassisInfo = Invoke-RestMethod -Uri \"https://$iDRACIP/redfish/v1/Chassis/System.Embedded.1\" -Headers $Headers -SkipCertificateCheck\n        \n        return @{\n            Manufacturer = 'Dell Inc.'\n            Model = $SystemInfo.Model\n            SerialNumber = $SystemInfo.SerialNumber\n            BIOSVersion = $SystemInfo.BiosVersion\n            ProcessorModel = $SystemInfo.ProcessorSummary.Model\n            ProcessorCount = $SystemInfo.ProcessorSummary.Count\n            TotalMemoryGB = [math]::Round($SystemInfo.MemorySummary.TotalSystemMemoryGiB, 2)\n            PowerState = $SystemInfo.PowerState\n            HealthStatus = $SystemInfo.Status.Health\n            Firmware = @{\n                iDRAC = $ChassisInfo.Links.ManagedBy[0].FirmwareVersion\n                BIOS = $SystemInfo.BiosVersion\n            }\n        }\n    }\n    catch {\n        Write-Warning \"Failed to connect to Dell iDRAC $iDRACIP : $($_.Exception.Message)\"\n        return $null\n    }\n}\n\n# Get OS and Hypervisor information via WMI/CIM\nfunction Get-OSInfo {\n    param(\n        [string]$ComputerName,\n        [pscredential]$Credential\n    )\n    \n    try {\n        $OS = Get-CimInstance -ComputerName $ComputerName -ClassName Win32_OperatingSystem -Credential $Credential\n        $CS = Get-CimInstance -ComputerName $ComputerName -ClassName Win32_ComputerSystem -Credential $Credential\n        \n        # Check for VMware ESXi (if applicable)\n        $VMwareCheck = $null\n        try {\n            $VMwareCheck = Get-CimInstance -ComputerName $ComputerName -ClassName Win32_Product -Filter \"Name LIKE '%VMware%'\" -Credential $Credential\n        } catch {}\n        \n        return @{\n            OSName = $OS.Caption\n            OSVersion = $OS.Version\n            OSArchitecture = $OS.OSArchitecture\n            ServicePack = $OS.ServicePackMajorVersion\n            IsVirtualized = $CS.Model -match 'Virtual'\n            HypervisorPresent = $CS.HypervisorPresent\n            VMwareVersion = if ($VMwareCheck) { $VMwareCheck.Version } else { \"Not Detected\" }\n            Domain = $CS.Domain\n            LastBootTime = $OS.LastBootUpTime\n        }\n    }\n    catch {\n        Write-Warning \"Failed to get OS info from $ComputerName : $($_.Exception.Message)\"\n        return $null\n    }\n}\n\n# Dell warranty lookup function\nfunction Get-DellWarranty {\n    param(\n        [string]$ServiceTag\n    )\n    \n    try {\n        $WarrantyURL = \"https://apigtwb2c.us.dell.com/PROD/sbil/eapi/v5/asset-entitlements?servicetags=$ServiceTag\"\n        $Response = Invoke-RestMethod -Uri $WarrantyURL -Method Get\n        \n        if ($Response -and $Response.Count -gt 0) {\n            $Warranty = $Response[0]\n            return @{\n                ServiceTag = $ServiceTag\n                WarrantyStatus = if ($Warranty.entitlements) { \"Valid\" } else { \"Expired\" }\n                StartDate = $Warranty.startDate\n                EndDate = $Warranty.endDate\n                ServiceLevel = $Warranty.serviceLevel\n                DaysRemaining = if ($Warranty.endDate) { \n                    [math]::Max(0, ([datetime]$Warranty.endDate - (Get-Date)).Days) \n                } else { 0 }\n            }\n        }\n    }\n    catch {\n        Write-Warning \"Failed to get Dell warranty for $ServiceTag : $($_.Exception.Message)\"\n        return @{\n            ServiceTag = $ServiceTag\n            WarrantyStatus = \"Unknown\"\n            StartDate = \"N/A\"\n            EndDate = \"N/A\"\n            ServiceLevel = \"N/A\"\n            DaysRemaining = 0\n        }\n    }\n}\n\n# HP warranty lookup function\nfunction Get-HPWarranty {\n    param(\n        [string]$SerialNumber,\n        [string]$ProductNumber\n    )\n    \n    try {\n        # Note: HP warranty API requires authentication and proper setup\n        # This is a simplified version - full implementation requires HP Passport authentication\n        \n        return @{\n            SerialNumber = $SerialNumber\n            WarrantyStatus = \"Requires HP API Setup\"\n            StartDate = \"N/A\"\n            EndDate = \"N/A\"\n            ServiceLevel = \"N/A\"\n            DaysRemaining = 0\n        }\n    }\n    catch {\n        return @{\n            SerialNumber = $SerialNumber\n            WarrantyStatus = \"Unknown\"\n            StartDate = \"N/A\"\n            EndDate = \"N/A\"\n            ServiceLevel = \"N/A\"\n            DaysRemaining = 0\n        }\n    }\n}\n\n# Main processing function\nfunction Process-ServerInventory {\n    param(\n        [string]$CSVPath\n    )\n    \n    # Read server list from CSV\n    # Expected columns: ServerName, OOBIP, OOBType, Username, Password, OSCredentialUser, OSCredentialPass\n    $ServerList = Import-Csv -Path $CSVPath\n    \n    foreach ($Server in $ServerList) {\n        Write-Host \"Processing server: $($Server.ServerName)\" -ForegroundColor Green\n        \n        # Create credential objects\n        $OOBCred = New-Object System.Management.Automation.PSCredential(\n            $Server.Username, \n            (ConvertTo-SecureString $Server.Password -AsPlainText -Force)\n        )\n        \n        $OSCred = New-Object System.Management.Automation.PSCredential(\n            $Server.OSCredentialUser,\n            (ConvertTo-SecureString $Server.OSCredentialPass -AsPlainText -Force)\n        )\n        \n        # Get hardware info based on OOB type\n        $HardwareInfo = $null\n        switch ($Server.OOBType.ToUpper()) {\n            'ILO' { $HardwareInfo = Get-HPiLOData -iLOIP $Server.OOBIP -Credential $OOBCred }\n            'IDRAC' { $HardwareInfo = Get-DelliDRACData -iDRACIP $Server.OOBIP -Credential $OOBCred }\n        }\n        \n        # Get OS information\n        $OSInfo = Get-OSInfo -ComputerName $Server.ServerName -Credential $OSCred\n        \n        # Combine information\n        if ($HardwareInfo) {\n            $ServerRecord = [PSCustomObject]@{\n                ServerName = $Server.ServerName\n                OOBIP = $Server.OOBIP\n                OOBType = $Server.OOBType\n                Manufacturer = $HardwareInfo.Manufacturer\n                Model = $HardwareInfo.Model\n                SerialNumber = $HardwareInfo.SerialNumber\n                BIOSVersion = $HardwareInfo.BIOSVersion\n                ProcessorModel = $HardwareInfo.ProcessorModel\n                ProcessorCount = $HardwareInfo.ProcessorCount\n                TotalMemoryGB = $HardwareInfo.TotalMemoryGB\n                PowerState = $HardwareInfo.PowerState\n                HealthStatus = $HardwareInfo.HealthStatus\n                OSName = if ($OSInfo) { $OSInfo.OSName } else { \"Unknown\" }\n                OSVersion = if ($OSInfo) { $OSInfo.OSVersion } else { \"Unknown\" }\n                VMwareVersion = if ($OSInfo) { $OSInfo.VMwareVersion } else { \"Unknown\" }\n                Domain = if ($OSInfo) { $OSInfo.Domain } else { \"Unknown\" }\n                LastBootTime = if ($OSInfo) { $OSInfo.LastBootTime } else { \"Unknown\" }\n                FirmwareVersions = ($HardwareInfo.Firmware | ConvertTo-Json -Compress)\n                AuditDate = Get-Date\n                RiskLevel = \"Low\" # Will be calculated based on warranty and firmware age\n            }\n            \n            $ServerInventory += $ServerRecord\n            \n            # Get warranty information if not skipped\n            if (-not $SkipWarranty) {\n                $WarrantyInfo = $null\n                switch ($HardwareInfo.Manufacturer) {\n                    'Dell Inc.' { \n                        $WarrantyInfo = Get-DellWarranty -ServiceTag $HardwareInfo.SerialNumber \n                    }\n                    'HP Enterprise' { \n                        $WarrantyInfo = Get-HPWarranty -SerialNumber $HardwareInfo.SerialNumber -ProductNumber $HardwareInfo.Model\n                    }\n                }\n                \n                if ($WarrantyInfo) {\n                    $WarrantyInfo | Add-Member -MemberType NoteProperty -Name \"ServerName\" -Value $Server.ServerName\n                    $WarrantyData += $WarrantyInfo\n                }\n            }\n        }\n        else {\n            $Errors += [PSCustomObject]@{\n                ServerName = $Server.ServerName\n                OOBIP = $Server.OOBIP\n                Error = \"Failed to retrieve hardware information\"\n                Timestamp = Get-Date\n            }\n        }\n    }\n}\n\n# Generate executive report\nfunction Generate-ExecutiveReport {\n    param(\n        [string]$OutputPath\n    )\n    \n    # Create output directory\n    New-Item -ItemType Directory -Path $OutputPath -Force | Out-Null\n    \n    # Export detailed data\n    $ServerInventory | Export-Csv -Path \"$OutputPath\\ServerInventory_Detailed.csv\" -NoTypeInformation\n    $WarrantyData | Export-Csv -Path \"$OutputPath\\WarrantyStatus.csv\" -NoTypeInformation\n    \n    if ($Errors.Count -gt 0) {\n        $Errors | Export-Csv -Path \"$OutputPath\\AuditErrors.csv\" -NoTypeInformation\n    }\n    \n    # Generate Excel report with charts\n    $ExcelPath = \"$OutputPath\\Physical_Server_Audit_Report.xlsx\"\n    \n    # Summary statistics\n    $Summary = @{\n        TotalServers = $ServerInventory.Count\n        DellServers = ($ServerInventory | Where-Object { $_.Manufacturer -eq 'Dell Inc.' }).Count\n        HPServers = ($ServerInventory | Where-Object { $_.Manufacturer -eq 'HP Enterprise' }).Count\n        WindowsServers = ($ServerInventory | Where-Object { $_.OSName -like '*Windows*' }).Count\n        VMwareHosts = ($ServerInventory | Where-Object { $_.VMwareVersion -ne 'Not Detected' }).Count\n        ServersWithIssues = ($ServerInventory | Where-Object { $_.HealthStatus -ne 'OK' }).Count\n        WarrantyExpired = if ($WarrantyData) { ($WarrantyData | Where-Object { $_.DaysRemaining -le 0 }).Count } else { 0 }\n        WarrantyExpiringSoon = if ($WarrantyData) { ($WarrantyData | Where-Object { $_.DaysRemaining -le 90 -and $_.DaysRemaining -gt 0 }).Count } else { 0 }\n    }\n    \n    # Create workbook\n    $ServerInventory | Export-Excel -Path $ExcelPath -WorksheetName \"Server Inventory\" -TableStyle Medium2 -AutoSize\n    $WarrantyData | Export-Excel -Path $ExcelPath -WorksheetName \"Warranty Status\" -TableStyle Medium6 -AutoSize\n    \n    # Summary worksheet\n    $SummaryData = $Summary.GetEnumerator() | ForEach-Object {\n        [PSCustomObject]@{\n            Metric = $_.Name\n            Value = $_.Value\n        }\n    }\n    $SummaryData | Export-Excel -Path $ExcelPath -WorksheetName \"Executive Summary\" -TableStyle Medium1 -AutoSize\n    \n    Write-Host \"Report generated successfully at: $ExcelPath\" -ForegroundColor Green\n    Write-Host \"Summary:\" -ForegroundColor Yellow\n    $Summary | Format-Table -AutoSize\n}\n\n# Main execution\nWrite-Host \"Starting Physical Server Audit...\" -ForegroundColor Cyan\n\nif (-not (Test-Path $CSVPath)) {\n    Write-Error \"CSV file not found at: $CSVPath\"\n    Write-Host \"Expected CSV format with columns: ServerName, OOBIP, OOBType, Username, Password, OSCredentialUser, OSCredentialPass\"\n    exit 1\n}\n\n# Process inventory\nProcess-ServerInventory -CSVPath $CSVPath\n\n# Generate reports\nGenerate-ExecutiveReport -OutputPath $OutputPath\n\nWrite-Host \"Audit completed. Check $OutputPath for detailed reports.\" -ForegroundColor Green",
          "versions": [
            {
              "id": "ver-1754559608386",
              "content": "# PowerShell Script\n# Created in Nishen's AI Workspace\n# File: Physical Server Audit Script\n\n# Physical Server Audit Script for Hardware Inventory and Warranty Status\n# Author: Senior Systems Engineer\n# Purpose: Comprehensive server hardware assessment with warranty validation\n\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$CSVPath = \".\\ServerList.csv\",\n    \n    [Parameter(Mandatory=$false)]\n    [string]$OutputPath = \".\\ServerAudit_$(Get-Date -Format 'yyyyMMdd_HHmm')\",\n    \n    [Parameter(Mandatory=$false)]\n    [switch]$SkipWarranty\n)\n\n# Required modules check and installation\n$RequiredModules = @('ImportExcel', 'DellBIOSProvider')\nforeach ($Module in $RequiredModules) {\n    if (!(Get-Module -ListAvailable -Name $Module)) {\n        Write-Host \"Installing module: $Module\" -ForegroundColor Yellow\n        Install-Module -Name $Module -Force -Scope CurrentUser\n    }\n}\n\n# Initialize collections\n$ServerInventory = @()\n$WarrantyData = @()\n$Errors = @()\n\n# HP iLO API functions\nfunction Get-HPiLOData {\n    param(\n        [string]$iLOIP,\n        [pscredential]$Credential\n    )\n    \n    try {\n        $Headers = @{\n            'Authorization' = 'Basic ' + [Convert]::ToBase64String([Text.Encoding]::ASCII.GetBytes((\"$($Credential.UserName):$($Credential.GetNetworkCredential().Password)\")))\n            'Content-Type' = 'application/json'\n        }\n        \n        # Get system info\n        $SystemInfo = Invoke-RestMethod -Uri \"https://$iLOIP/rest/v1/Systems/1\" -Headers $Headers -SkipCertificateCheck\n        $ChassisInfo = Invoke-RestMethod -Uri \"https://$iLOIP/rest/v1/Chassis/1\" -Headers $Headers -SkipCertificateCheck\n        \n        return @{\n            Manufacturer = 'HP Enterprise'\n            Model = $SystemInfo.Model\n            SerialNumber = $SystemInfo.SerialNumber\n            BIOSVersion = $SystemInfo.Bios.Current.VersionString\n            ProcessorModel = $SystemInfo.ProcessorSummary.Model\n            ProcessorCount = $SystemInfo.ProcessorSummary.Count\n            TotalMemoryGB = [math]::Round($SystemInfo.MemorySummary.TotalSystemMemoryGiB, 2)\n            PowerState = $SystemInfo.PowerState\n            HealthStatus = $SystemInfo.Status.Health\n            Firmware = @{\n                iLO = $ChassisInfo.iLO.Firmware.Current.VersionString\n                SystemROM = $SystemInfo.Bios.Current.VersionString\n            }\n        }\n    }\n    catch {\n        Write-Warning \"Failed to connect to HP iLO $iLOIP : $($_.Exception.Message)\"\n        return $null\n    }\n}\n\n# Dell iDRAC API functions\nfunction Get-DelliDRACData {\n    param(\n        [string]$iDRACIP,\n        [pscredential]$Credential\n    )\n    \n    try {\n        $Headers = @{\n            'Authorization' = 'Basic ' + [Convert]::ToBase64String([Text.Encoding]::ASCII.GetBytes((\"$($Credential.UserName):$($Credential.GetNetworkCredential().Password)\")))\n            'Content-Type' = 'application/json'\n        }\n        \n        # Get system info via Redfish API\n        $SystemInfo = Invoke-RestMethod -Uri \"https://$iDRACIP/redfish/v1/Systems/System.Embedded.1\" -Headers $Headers -SkipCertificateCheck\n        $ChassisInfo = Invoke-RestMethod -Uri \"https://$iDRACIP/redfish/v1/Chassis/System.Embedded.1\" -Headers $Headers -SkipCertificateCheck\n        \n        return @{\n            Manufacturer = 'Dell Inc.'\n            Model = $SystemInfo.Model\n            SerialNumber = $SystemInfo.SerialNumber\n            BIOSVersion = $SystemInfo.BiosVersion\n            ProcessorModel = $SystemInfo.ProcessorSummary.Model\n            ProcessorCount = $SystemInfo.ProcessorSummary.Count\n            TotalMemoryGB = [math]::Round($SystemInfo.MemorySummary.TotalSystemMemoryGiB, 2)\n            PowerState = $SystemInfo.PowerState\n            HealthStatus = $SystemInfo.Status.Health\n            Firmware = @{\n                iDRAC = $ChassisInfo.Links.ManagedBy[0].FirmwareVersion\n                BIOS = $SystemInfo.BiosVersion\n            }\n        }\n    }\n    catch {\n        Write-Warning \"Failed to connect to Dell iDRAC $iDRACIP : $($_.Exception.Message)\"\n        return $null\n    }\n}\n\n# Get OS and Hypervisor information via WMI/CIM\nfunction Get-OSInfo {\n    param(\n        [string]$ComputerName,\n        [pscredential]$Credential\n    )\n    \n    try {\n        $OS = Get-CimInstance -ComputerName $ComputerName -ClassName Win32_OperatingSystem -Credential $Credential\n        $CS = Get-CimInstance -ComputerName $ComputerName -ClassName Win32_ComputerSystem -Credential $Credential\n        \n        # Check for VMware ESXi (if applicable)\n        $VMwareCheck = $null\n        try {\n            $VMwareCheck = Get-CimInstance -ComputerName $ComputerName -ClassName Win32_Product -Filter \"Name LIKE '%VMware%'\" -Credential $Credential\n        } catch {}\n        \n        return @{\n            OSName = $OS.Caption\n            OSVersion = $OS.Version\n            OSArchitecture = $OS.OSArchitecture\n            ServicePack = $OS.ServicePackMajorVersion\n            IsVirtualized = $CS.Model -match 'Virtual'\n            HypervisorPresent = $CS.HypervisorPresent\n            VMwareVersion = if ($VMwareCheck) { $VMwareCheck.Version } else { \"Not Detected\" }\n            Domain = $CS.Domain\n            LastBootTime = $OS.LastBootUpTime\n        }\n    }\n    catch {\n        Write-Warning \"Failed to get OS info from $ComputerName : $($_.Exception.Message)\"\n        return $null\n    }\n}\n\n# Dell warranty lookup function\nfunction Get-DellWarranty {\n    param(\n        [string]$ServiceTag\n    )\n    \n    try {\n        $WarrantyURL = \"https://apigtwb2c.us.dell.com/PROD/sbil/eapi/v5/asset-entitlements?servicetags=$ServiceTag\"\n        $Response = Invoke-RestMethod -Uri $WarrantyURL -Method Get\n        \n        if ($Response -and $Response.Count -gt 0) {\n            $Warranty = $Response[0]\n            return @{\n                ServiceTag = $ServiceTag\n                WarrantyStatus = if ($Warranty.entitlements) { \"Valid\" } else { \"Expired\" }\n                StartDate = $Warranty.startDate\n                EndDate = $Warranty.endDate\n                ServiceLevel = $Warranty.serviceLevel\n                DaysRemaining = if ($Warranty.endDate) { \n                    [math]::Max(0, ([datetime]$Warranty.endDate - (Get-Date)).Days) \n                } else { 0 }\n            }\n        }\n    }\n    catch {\n        Write-Warning \"Failed to get Dell warranty for $ServiceTag : $($_.Exception.Message)\"\n        return @{\n            ServiceTag = $ServiceTag\n            WarrantyStatus = \"Unknown\"\n            StartDate = \"N/A\"\n            EndDate = \"N/A\"\n            ServiceLevel = \"N/A\"\n            DaysRemaining = 0\n        }\n    }\n}\n\n# HP warranty lookup function\nfunction Get-HPWarranty {\n    param(\n        [string]$SerialNumber,\n        [string]$ProductNumber\n    )\n    \n    try {\n        # Note: HP warranty API requires authentication and proper setup\n        # This is a simplified version - full implementation requires HP Passport authentication\n        \n        return @{\n            SerialNumber = $SerialNumber\n            WarrantyStatus = \"Requires HP API Setup\"\n            StartDate = \"N/A\"\n            EndDate = \"N/A\"\n            ServiceLevel = \"N/A\"\n            DaysRemaining = 0\n        }\n    }\n    catch {\n        return @{\n            SerialNumber = $SerialNumber\n            WarrantyStatus = \"Unknown\"\n            StartDate = \"N/A\"\n            EndDate = \"N/A\"\n            ServiceLevel = \"N/A\"\n            DaysRemaining = 0\n        }\n    }\n}\n\n# Main processing function\nfunction Process-ServerInventory {\n    param(\n        [string]$CSVPath\n    )\n    \n    # Read server list from CSV\n    # Expected columns: ServerName, OOBIP, OOBType, Username, Password, OSCredentialUser, OSCredentialPass\n    $ServerList = Import-Csv -Path $CSVPath\n    \n    foreach ($Server in $ServerList) {\n        Write-Host \"Processing server: $($Server.ServerName)\" -ForegroundColor Green\n        \n        # Create credential objects\n        $OOBCred = New-Object System.Management.Automation.PSCredential(\n            $Server.Username, \n            (ConvertTo-SecureString $Server.Password -AsPlainText -Force)\n        )\n        \n        $OSCred = New-Object System.Management.Automation.PSCredential(\n            $Server.OSCredentialUser,\n            (ConvertTo-SecureString $Server.OSCredentialPass -AsPlainText -Force)\n        )\n        \n        # Get hardware info based on OOB type\n        $HardwareInfo = $null\n        switch ($Server.OOBType.ToUpper()) {\n            'ILO' { $HardwareInfo = Get-HPiLOData -iLOIP $Server.OOBIP -Credential $OOBCred }\n            'IDRAC' { $HardwareInfo = Get-DelliDRACData -iDRACIP $Server.OOBIP -Credential $OOBCred }\n        }\n        \n        # Get OS information\n        $OSInfo = Get-OSInfo -ComputerName $Server.ServerName -Credential $OSCred\n        \n        # Combine information\n        if ($HardwareInfo) {\n            $ServerRecord = [PSCustomObject]@{\n                ServerName = $Server.ServerName\n                OOBIP = $Server.OOBIP\n                OOBType = $Server.OOBType\n                Manufacturer = $HardwareInfo.Manufacturer\n                Model = $HardwareInfo.Model\n                SerialNumber = $HardwareInfo.SerialNumber\n                BIOSVersion = $HardwareInfo.BIOSVersion\n                ProcessorModel = $HardwareInfo.ProcessorModel\n                ProcessorCount = $HardwareInfo.ProcessorCount\n                TotalMemoryGB = $HardwareInfo.TotalMemoryGB\n                PowerState = $HardwareInfo.PowerState\n                HealthStatus = $HardwareInfo.HealthStatus\n                OSName = if ($OSInfo) { $OSInfo.OSName } else { \"Unknown\" }\n                OSVersion = if ($OSInfo) { $OSInfo.OSVersion } else { \"Unknown\" }\n                VMwareVersion = if ($OSInfo) { $OSInfo.VMwareVersion } else { \"Unknown\" }\n                Domain = if ($OSInfo) { $OSInfo.Domain } else { \"Unknown\" }\n                LastBootTime = if ($OSInfo) { $OSInfo.LastBootTime } else { \"Unknown\" }\n                FirmwareVersions = ($HardwareInfo.Firmware | ConvertTo-Json -Compress)\n                AuditDate = Get-Date\n                RiskLevel = \"Low\" # Will be calculated based on warranty and firmware age\n            }\n            \n            $ServerInventory += $ServerRecord\n            \n            # Get warranty information if not skipped\n            if (-not $SkipWarranty) {\n                $WarrantyInfo = $null\n                switch ($HardwareInfo.Manufacturer) {\n                    'Dell Inc.' { \n                        $WarrantyInfo = Get-DellWarranty -ServiceTag $HardwareInfo.SerialNumber \n                    }\n                    'HP Enterprise' { \n                        $WarrantyInfo = Get-HPWarranty -SerialNumber $HardwareInfo.SerialNumber -ProductNumber $HardwareInfo.Model\n                    }\n                }\n                \n                if ($WarrantyInfo) {\n                    $WarrantyInfo | Add-Member -MemberType NoteProperty -Name \"ServerName\" -Value $Server.ServerName\n                    $WarrantyData += $WarrantyInfo\n                }\n            }\n        }\n        else {\n            $Errors += [PSCustomObject]@{\n                ServerName = $Server.ServerName\n                OOBIP = $Server.OOBIP\n                Error = \"Failed to retrieve hardware information\"\n                Timestamp = Get-Date\n            }\n        }\n    }\n}\n\n# Generate executive report\nfunction Generate-ExecutiveReport {\n    param(\n        [string]$OutputPath\n    )\n    \n    # Create output directory\n    New-Item -ItemType Directory -Path $OutputPath -Force | Out-Null\n    \n    # Export detailed data\n    $ServerInventory | Export-Csv -Path \"$OutputPath\\ServerInventory_Detailed.csv\" -NoTypeInformation\n    $WarrantyData | Export-Csv -Path \"$OutputPath\\WarrantyStatus.csv\" -NoTypeInformation\n    \n    if ($Errors.Count -gt 0) {\n        $Errors | Export-Csv -Path \"$OutputPath\\AuditErrors.csv\" -NoTypeInformation\n    }\n    \n    # Generate Excel report with charts\n    $ExcelPath = \"$OutputPath\\Physical_Server_Audit_Report.xlsx\"\n    \n    # Summary statistics\n    $Summary = @{\n        TotalServers = $ServerInventory.Count\n        DellServers = ($ServerInventory | Where-Object { $_.Manufacturer -eq 'Dell Inc.' }).Count\n        HPServers = ($ServerInventory | Where-Object { $_.Manufacturer -eq 'HP Enterprise' }).Count\n        WindowsServers = ($ServerInventory | Where-Object { $_.OSName -like '*Windows*' }).Count\n        VMwareHosts = ($ServerInventory | Where-Object { $_.VMwareVersion -ne 'Not Detected' }).Count\n        ServersWithIssues = ($ServerInventory | Where-Object { $_.HealthStatus -ne 'OK' }).Count\n        WarrantyExpired = if ($WarrantyData) { ($WarrantyData | Where-Object { $_.DaysRemaining -le 0 }).Count } else { 0 }\n        WarrantyExpiringSoon = if ($WarrantyData) { ($WarrantyData | Where-Object { $_.DaysRemaining -le 90 -and $_.DaysRemaining -gt 0 }).Count } else { 0 }\n    }\n    \n    # Create workbook\n    $ServerInventory | Export-Excel -Path $ExcelPath -WorksheetName \"Server Inventory\" -TableStyle Medium2 -AutoSize\n    $WarrantyData | Export-Excel -Path $ExcelPath -WorksheetName \"Warranty Status\" -TableStyle Medium6 -AutoSize\n    \n    # Summary worksheet\n    $SummaryData = $Summary.GetEnumerator() | ForEach-Object {\n        [PSCustomObject]@{\n            Metric = $_.Name\n            Value = $_.Value\n        }\n    }\n    $SummaryData | Export-Excel -Path $ExcelPath -WorksheetName \"Executive Summary\" -TableStyle Medium1 -AutoSize\n    \n    Write-Host \"Report generated successfully at: $ExcelPath\" -ForegroundColor Green\n    Write-Host \"Summary:\" -ForegroundColor Yellow\n    $Summary | Format-Table -AutoSize\n}\n\n# Main execution\nWrite-Host \"Starting Physical Server Audit...\" -ForegroundColor Cyan\n\nif (-not (Test-Path $CSVPath)) {\n    Write-Error \"CSV file not found at: $CSVPath\"\n    Write-Host \"Expected CSV format with columns: ServerName, OOBIP, OOBType, Username, Password, OSCredentialUser, OSCredentialPass\"\n    exit 1\n}\n\n# Process inventory\nProcess-ServerInventory -CSVPath $CSVPath\n\n# Generate reports\nGenerate-ExecutiveReport -OutputPath $OutputPath\n\nWrite-Host \"Audit completed. Check $OutputPath for detailed reports.\" -ForegroundColor Green",
              "timestamp": "2025-08-07T09:40:08.386Z",
              "description": "baseline0"
            },
            {
              "id": "ver-1754559735044",
              "content": "# PowerShell Script\n# Created in Nishen's AI Workspace\n# File: Physical Server Audit ScriptV1.0\n\n# Physical Server Audit Script for Hardware Inventory and Warranty Status\n# Author: Nishen Harichunder L4 Senior Systems Engineer\n# Purpose: Comprehensive server hardware assessment with warranty validation - Results to be used for revenue Opportunities \n\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$CSVPath = \".\\ServerList.csv\",\n    \n    [Parameter(Mandatory=$false)]\n    [string]$OutputPath = \".\\ServerAudit_$(Get-Date -Format 'yyyyMMdd_HHmm')\",\n    \n    [Parameter(Mandatory=$false)]\n    [switch]$SkipWarranty\n)\n\n# Required modules check and installation\n$RequiredModules = @('ImportExcel', 'DellBIOSProvider')\nforeach ($Module in $RequiredModules) {\n    if (!(Get-Module -ListAvailable -Name $Module)) {\n        Write-Host \"Installing module: $Module\" -ForegroundColor Yellow\n        Install-Module -Name $Module -Force -Scope CurrentUser\n    }\n}\n\n# Initialize collections\n$ServerInventory = @()\n$WarrantyData = @()\n$Errors = @()\n\n# HP iLO API functions\nfunction Get-HPiLOData {\n    param(\n        [string]$iLOIP,\n        [pscredential]$Credential\n    )\n    \n    try {\n        $Headers = @{\n            'Authorization' = 'Basic ' + [Convert]::ToBase64String([Text.Encoding]::ASCII.GetBytes((\"$($Credential.UserName):$($Credential.GetNetworkCredential().Password)\")))\n            'Content-Type' = 'application/json'\n        }\n        \n        # Get system info\n        $SystemInfo = Invoke-RestMethod -Uri \"https://$iLOIP/rest/v1/Systems/1\" -Headers $Headers -SkipCertificateCheck\n        $ChassisInfo = Invoke-RestMethod -Uri \"https://$iLOIP/rest/v1/Chassis/1\" -Headers $Headers -SkipCertificateCheck\n        \n        return @{\n            Manufacturer = 'HP Enterprise'\n            Model = $SystemInfo.Model\n            SerialNumber = $SystemInfo.SerialNumber\n            BIOSVersion = $SystemInfo.Bios.Current.VersionString\n            ProcessorModel = $SystemInfo.ProcessorSummary.Model\n            ProcessorCount = $SystemInfo.ProcessorSummary.Count\n            TotalMemoryGB = [math]::Round($SystemInfo.MemorySummary.TotalSystemMemoryGiB, 2)\n            PowerState = $SystemInfo.PowerState\n            HealthStatus = $SystemInfo.Status.Health\n            Firmware = @{\n                iLO = $ChassisInfo.iLO.Firmware.Current.VersionString\n                SystemROM = $SystemInfo.Bios.Current.VersionString\n            }\n        }\n    }\n    catch {\n        Write-Warning \"Failed to connect to HP iLO $iLOIP : $($_.Exception.Message)\"\n        return $null\n    }\n}\n\n# Dell iDRAC API functions\nfunction Get-DelliDRACData {\n    param(\n        [string]$iDRACIP,\n        [pscredential]$Credential\n    )\n    \n    try {\n        $Headers = @{\n            'Authorization' = 'Basic ' + [Convert]::ToBase64String([Text.Encoding]::ASCII.GetBytes((\"$($Credential.UserName):$($Credential.GetNetworkCredential().Password)\")))\n            'Content-Type' = 'application/json'\n        }\n        \n        # Get system info via Redfish API\n        $SystemInfo = Invoke-RestMethod -Uri \"https://$iDRACIP/redfish/v1/Systems/System.Embedded.1\" -Headers $Headers -SkipCertificateCheck\n        $ChassisInfo = Invoke-RestMethod -Uri \"https://$iDRACIP/redfish/v1/Chassis/System.Embedded.1\" -Headers $Headers -SkipCertificateCheck\n        \n        return @{\n            Manufacturer = 'Dell Inc.'\n            Model = $SystemInfo.Model\n            SerialNumber = $SystemInfo.SerialNumber\n            BIOSVersion = $SystemInfo.BiosVersion\n            ProcessorModel = $SystemInfo.ProcessorSummary.Model\n            ProcessorCount = $SystemInfo.ProcessorSummary.Count\n            TotalMemoryGB = [math]::Round($SystemInfo.MemorySummary.TotalSystemMemoryGiB, 2)\n            PowerState = $SystemInfo.PowerState\n            HealthStatus = $SystemInfo.Status.Health\n            Firmware = @{\n                iDRAC = $ChassisInfo.Links.ManagedBy[0].FirmwareVersion\n                BIOS = $SystemInfo.BiosVersion\n            }\n        }\n    }\n    catch {\n        Write-Warning \"Failed to connect to Dell iDRAC $iDRACIP : $($_.Exception.Message)\"\n        return $null\n    }\n}\n\n# Get OS and Hypervisor information via WMI/CIM\nfunction Get-OSInfo {\n    param(\n        [string]$ComputerName,\n        [pscredential]$Credential\n    )\n    \n    try {\n        $OS = Get-CimInstance -ComputerName $ComputerName -ClassName Win32_OperatingSystem -Credential $Credential\n        $CS = Get-CimInstance -ComputerName $ComputerName -ClassName Win32_ComputerSystem -Credential $Credential\n        \n        # Check for VMware ESXi (if applicable)\n        $VMwareCheck = $null\n        try {\n            $VMwareCheck = Get-CimInstance -ComputerName $ComputerName -ClassName Win32_Product -Filter \"Name LIKE '%VMware%'\" -Credential $Credential\n        } catch {}\n        \n        return @{\n            OSName = $OS.Caption\n            OSVersion = $OS.Version\n            OSArchitecture = $OS.OSArchitecture\n            ServicePack = $OS.ServicePackMajorVersion\n            IsVirtualized = $CS.Model -match 'Virtual'\n            HypervisorPresent = $CS.HypervisorPresent\n            VMwareVersion = if ($VMwareCheck) { $VMwareCheck.Version } else { \"Not Detected\" }\n            Domain = $CS.Domain\n            LastBootTime = $OS.LastBootUpTime\n        }\n    }\n    catch {\n        Write-Warning \"Failed to get OS info from $ComputerName : $($_.Exception.Message)\"\n        return $null\n    }\n}\n\n# Dell warranty lookup function\nfunction Get-DellWarranty {\n    param(\n        [string]$ServiceTag\n    )\n    \n    try {\n        $WarrantyURL = \"https://apigtwb2c.us.dell.com/PROD/sbil/eapi/v5/asset-entitlements?servicetags=$ServiceTag\"\n        $Response = Invoke-RestMethod -Uri $WarrantyURL -Method Get\n        \n        if ($Response -and $Response.Count -gt 0) {\n            $Warranty = $Response[0]\n            return @{\n                ServiceTag = $ServiceTag\n                WarrantyStatus = if ($Warranty.entitlements) { \"Valid\" } else { \"Expired\" }\n                StartDate = $Warranty.startDate\n                EndDate = $Warranty.endDate\n                ServiceLevel = $Warranty.serviceLevel\n                DaysRemaining = if ($Warranty.endDate) { \n                    [math]::Max(0, ([datetime]$Warranty.endDate - (Get-Date)).Days) \n                } else { 0 }\n            }\n        }\n    }\n    catch {\n        Write-Warning \"Failed to get Dell warranty for $ServiceTag : $($_.Exception.Message)\"\n        return @{\n            ServiceTag = $ServiceTag\n            WarrantyStatus = \"Unknown\"\n            StartDate = \"N/A\"\n            EndDate = \"N/A\"\n            ServiceLevel = \"N/A\"\n            DaysRemaining = 0\n        }\n    }\n}\n\n# HP warranty lookup function\nfunction Get-HPWarranty {\n    param(\n        [string]$SerialNumber,\n        [string]$ProductNumber\n    )\n    \n    try {\n        # Note: HP warranty API requires authentication and proper setup\n        # This is a simplified version - full implementation requires HP Passport authentication\n        \n        return @{\n            SerialNumber = $SerialNumber\n            WarrantyStatus = \"Requires HP API Setup\"\n            StartDate = \"N/A\"\n            EndDate = \"N/A\"\n            ServiceLevel = \"N/A\"\n            DaysRemaining = 0\n        }\n    }\n    catch {\n        return @{\n            SerialNumber = $SerialNumber\n            WarrantyStatus = \"Unknown\"\n            StartDate = \"N/A\"\n            EndDate = \"N/A\"\n            ServiceLevel = \"N/A\"\n            DaysRemaining = 0\n        }\n    }\n}\n\n# Main processing function\nfunction Process-ServerInventory {\n    param(\n        [string]$CSVPath\n    )\n    \n    # Read server list from CSV\n    # Expected columns: ServerName, OOBIP, OOBType, Username, Password, OSCredentialUser, OSCredentialPass\n    $ServerList = Import-Csv -Path $CSVPath\n    \n    foreach ($Server in $ServerList) {\n        Write-Host \"Processing server: $($Server.ServerName)\" -ForegroundColor Green\n        \n        # Create credential objects\n        $OOBCred = New-Object System.Management.Automation.PSCredential(\n            $Server.Username, \n            (ConvertTo-SecureString $Server.Password -AsPlainText -Force)\n        )\n        \n        $OSCred = New-Object System.Management.Automation.PSCredential(\n            $Server.OSCredentialUser,\n            (ConvertTo-SecureString $Server.OSCredentialPass -AsPlainText -Force)\n        )\n        \n        # Get hardware info based on OOB type\n        $HardwareInfo = $null\n        switch ($Server.OOBType.ToUpper()) {\n            'ILO' { $HardwareInfo = Get-HPiLOData -iLOIP $Server.OOBIP -Credential $OOBCred }\n            'IDRAC' { $HardwareInfo = Get-DelliDRACData -iDRACIP $Server.OOBIP -Credential $OOBCred }\n        }\n        \n        # Get OS information\n        $OSInfo = Get-OSInfo -ComputerName $Server.ServerName -Credential $OSCred\n        \n        # Combine information\n        if ($HardwareInfo) {\n            $ServerRecord = [PSCustomObject]@{\n                ServerName = $Server.ServerName\n                OOBIP = $Server.OOBIP\n                OOBType = $Server.OOBType\n                Manufacturer = $HardwareInfo.Manufacturer\n                Model = $HardwareInfo.Model\n                SerialNumber = $HardwareInfo.SerialNumber\n                BIOSVersion = $HardwareInfo.BIOSVersion\n                ProcessorModel = $HardwareInfo.ProcessorModel\n                ProcessorCount = $HardwareInfo.ProcessorCount\n                TotalMemoryGB = $HardwareInfo.TotalMemoryGB\n                PowerState = $HardwareInfo.PowerState\n                HealthStatus = $HardwareInfo.HealthStatus\n                OSName = if ($OSInfo) { $OSInfo.OSName } else { \"Unknown\" }\n                OSVersion = if ($OSInfo) { $OSInfo.OSVersion } else { \"Unknown\" }\n                VMwareVersion = if ($OSInfo) { $OSInfo.VMwareVersion } else { \"Unknown\" }\n                Domain = if ($OSInfo) { $OSInfo.Domain } else { \"Unknown\" }\n                LastBootTime = if ($OSInfo) { $OSInfo.LastBootTime } else { \"Unknown\" }\n                FirmwareVersions = ($HardwareInfo.Firmware | ConvertTo-Json -Compress)\n                AuditDate = Get-Date\n                RiskLevel = \"Low\" # Will be calculated based on warranty and firmware age\n            }\n            \n            $ServerInventory += $ServerRecord\n            \n            # Get warranty information if not skipped\n            if (-not $SkipWarranty) {\n                $WarrantyInfo = $null\n                switch ($HardwareInfo.Manufacturer) {\n                    'Dell Inc.' { \n                        $WarrantyInfo = Get-DellWarranty -ServiceTag $HardwareInfo.SerialNumber \n                    }\n                    'HP Enterprise' { \n                        $WarrantyInfo = Get-HPWarranty -SerialNumber $HardwareInfo.SerialNumber -ProductNumber $HardwareInfo.Model\n                    }\n                }\n                \n                if ($WarrantyInfo) {\n                    $WarrantyInfo | Add-Member -MemberType NoteProperty -Name \"ServerName\" -Value $Server.ServerName\n                    $WarrantyData += $WarrantyInfo\n                }\n            }\n        }\n        else {\n            $Errors += [PSCustomObject]@{\n                ServerName = $Server.ServerName\n                OOBIP = $Server.OOBIP\n                Error = \"Failed to retrieve hardware information\"\n                Timestamp = Get-Date\n            }\n        }\n    }\n}\n\n# Generate executive report\nfunction Generate-ExecutiveReport {\n    param(\n        [string]$OutputPath\n    )\n    \n    # Create output directory\n    New-Item -ItemType Directory -Path $OutputPath -Force | Out-Null\n    \n    # Export detailed data\n    $ServerInventory | Export-Csv -Path \"$OutputPath\\ServerInventory_Detailed.csv\" -NoTypeInformation\n    $WarrantyData | Export-Csv -Path \"$OutputPath\\WarrantyStatus.csv\" -NoTypeInformation\n    \n    if ($Errors.Count -gt 0) {\n        $Errors | Export-Csv -Path \"$OutputPath\\AuditErrors.csv\" -NoTypeInformation\n    }\n    \n    # Generate Excel report with charts\n    $ExcelPath = \"$OutputPath\\Physical_Server_Audit_Report.xlsx\"\n    \n    # Summary statistics\n    $Summary = @{\n        TotalServers = $ServerInventory.Count\n        DellServers = ($ServerInventory | Where-Object { $_.Manufacturer -eq 'Dell Inc.' }).Count\n        HPServers = ($ServerInventory | Where-Object { $_.Manufacturer -eq 'HP Enterprise' }).Count\n        WindowsServers = ($ServerInventory | Where-Object { $_.OSName -like '*Windows*' }).Count\n        VMwareHosts = ($ServerInventory | Where-Object { $_.VMwareVersion -ne 'Not Detected' }).Count\n        ServersWithIssues = ($ServerInventory | Where-Object { $_.HealthStatus -ne 'OK' }).Count\n        WarrantyExpired = if ($WarrantyData) { ($WarrantyData | Where-Object { $_.DaysRemaining -le 0 }).Count } else { 0 }\n        WarrantyExpiringSoon = if ($WarrantyData) { ($WarrantyData | Where-Object { $_.DaysRemaining -le 90 -and $_.DaysRemaining -gt 0 }).Count } else { 0 }\n    }\n    \n    # Create workbook\n    $ServerInventory | Export-Excel -Path $ExcelPath -WorksheetName \"Server Inventory\" -TableStyle Medium2 -AutoSize\n    $WarrantyData | Export-Excel -Path $ExcelPath -WorksheetName \"Warranty Status\" -TableStyle Medium6 -AutoSize\n    \n    # Summary worksheet\n    $SummaryData = $Summary.GetEnumerator() | ForEach-Object {\n        [PSCustomObject]@{\n            Metric = $_.Name\n            Value = $_.Value\n        }\n    }\n    $SummaryData | Export-Excel -Path $ExcelPath -WorksheetName \"Executive Summary\" -TableStyle Medium1 -AutoSize\n    \n    Write-Host \"Report generated successfully at: $ExcelPath\" -ForegroundColor Green\n    Write-Host \"Summary:\" -ForegroundColor Yellow\n    $Summary | Format-Table -AutoSize\n}\n\n# Main execution\nWrite-Host \"Starting Physical Server Audit...\" -ForegroundColor Cyan\n\nif (-not (Test-Path $CSVPath)) {\n    Write-Error \"CSV file not found at: $CSVPath\"\n    Write-Host \"Expected CSV format with columns: ServerName, OOBIP, OOBType, Username, Password, OSCredentialUser, OSCredentialPass\"\n    exit 1\n}\n\n# Process inventory\nProcess-ServerInventory -CSVPath $CSVPath\n\n# Generate reports\nGenerate-ExecutiveReport -OutputPath $OutputPath\n\nWrite-Host \"Audit completed. Check $OutputPath for detailed reports.\" -ForegroundColor Green",
              "timestamp": "2025-08-07T09:42:15.044Z",
              "description": "baseline0.1"
            }
          ],
          "created": "2025-08-07T09:39:43.370Z",
          "modified": "2025-08-07T09:42:15.044Z",
          "timeSpent": 0
        },
        {
          "id": "file-1755457318278",
          "name": "N1_Rms_PP_ADUsers_Security_Ass4NC.ps1",
          "type": "script",
          "category": "Password Policy, domain users, ad assessement, ncentral version, security",
          "content": "# PowerShell Script\n# Created in Nishen's AI Workspace\n# File: N1_Rms_PP_ADUsers_Security_Ass4NC.ps1\n\n#Requires -Modules ActiveDirectory\n<#\n.SYNOPSIS\n    N1_Rms_PassPolicy_ADUsers_Security_Assessment4NCentral :\n    Active Directory Security Assessment Tool - N-Central Complete Automated Version\n    \n.DESCRIPTION\n    N-Central compatible version of the comprehensive audit script that:\n    - Reports current domain password policy with enhanced best practice evaluation\n    - Identifies fine-grained password policies with risk assessment\n    - Analyzes ALL privileged groups (Domain Admins, Enterprise Admins, Schema Admins, Administrators)\n    - Handles recursive nested group memberships automatically\n    - Comprehensive analysis of ALL domain users with password security risks\n    - Enhanced risk assessment with multi-factor analysis\n    - Generates dual professional PDF reports (Security Assessment + User Analysis)\n    - Professional presentation-ready format for customer delivery\n    - AUTOMATED: No interactive prompts - auto-generates customer name from domain\n    \n.PARAMETER CustomerName\n    Name of the customer/client (optional - auto-generated from domain if not specified)\n    Auto-extracts customer name from domain by removing suffixes (.local, .co.za, .com, etc.)\n    \n.PARAMETER DomainName\n    FQDN of domain to assess (optional - uses current domain if not specified)\n    \n.PARAMETER EngineerName\n    Name of engineer/technician running assessment (optional)\n    Defaults to \"N-Central RMS Assessment\" with timestamp\n    \n.AUTHOR\n    Nishen Harichunder L4 RMS Senior Systems Engineer\n    Modified for N-Central Complete Automation\n    \n.VERSION\n    12.0 - N-Central Complete Automated Version (Full Functionality)\n    \n.DATE\n    August 2025\n    \n.EXAMPLE\n    # Simplest execution - auto-generates customer name from domain\n    .\\N1_Rms_PassPolicy_ADUsers_Security_Assessment4NCentral.ps1\n    \n.EXAMPLE\n    # N-Central execution - fully automated (no parameters needed)  \n    powershell.exe -ExecutionPolicy Bypass -File \"C:\\Scripts\\N1_Rms_PassPolicy_ADUsers_Security_Assessment4NCentral.ps1\"\n\n.NOTES\n    N-Central Deployment Instructions:\n    1. Deploy script to C:\\Scripts\\ on target servers\n    2. Create scheduled task - NO PARAMETERS REQUIRED:\n       Command: powershell.exe\n       Arguments: -ExecutionPolicy Bypass -WindowStyle Hidden -File \"C:\\Scripts\\N1_Rms_PassPolicy_ADUsers_Security_Assessment4NCentral.ps1\"\n    3. Customer name automatically extracted from domain (e.g., \"acme.local\" becomes \"Acme\")\n    4. Reports generated in C:\\Temp\\ with auto-generated customer name and timestamp\n    5. Use AMP or file retrieval to collect reports\n    6. Generates full HTML/PDF reports + CSV data + N-Central summary files\n    \n    Requirements:\n    - Domain-joined server with AD PowerShell module\n    - Read access to Active Directory\n    - Local admin rights for report generation\n    \nScript Overview\n\n  This is a comprehensive Active Directory security assessment tool (Version 12.0) that generates\n  professional PDF reports for client security audits. The script analyzes domain security posture and\n  produces dual reports: a main security assessment and a detailed user analysis.\n\n  What the Script Does\n\n  1. Domain Password Policy Analysis: Evaluates password policies against Microsoft best practices and NIST      \n  SP 800-63B standards\n  2. Privileged Account Assessment: Analyzes Domain Admins, Enterprise Admins, Schema Admins, and local\n  Administrators groups with recursive nested membership support\n  3. Complete User Analysis: Reviews ALL domain users for password and account security risks\n  4. Compliance Mapping: Maps findings to Microsoft Security Baseline, NIST Cybersecurity Framework, and\n  NIST SP 800-63B\n  5. Report Generation: Creates HTML and PDF reports with professional formatting, charts, and metrics\n  6. Data Export: Generates CSV files with detailed findings for further analysis\n\n  Risk Scoring Methodology\n\n  Overall Risk Levels\n\n  - Critical: 80-100 points\n  - High: 60-79 points\n  - Medium: 40-59 points\n  - Low: 20-39 points\n  - Info: <20 points (for disabled accounts)\n\n  Password Policy Risk Scoring\n\n  - No complexity enabled: +20 points\n  - Password length < 14 chars: +15-30 points (scaled by severity)\n  - Min password age issues: +5-20 points\n  - Max password age > 365 days: +15-35 points\n  - Password history < 12: +10 points\n  - No account lockout: +35 points\n  - Lockout threshold issues: +5-15 points\n  - Lockout duration issues: +5-20 points\n  - Reversible encryption enabled: +35 points (critical)\n\n  User Account Risk Scoring\n\n  - Never logged on: +25-40 points\n  - No logon 30+ days: +40 points (critical)\n  - No logon 90+ days: +20 points\n  - No logon 180+ days: +30 points\n  - Password never set: +30-40 points\n  - Password > 6 months old: +20-30 points\n  - Password never expires: +25-30 points\n  - Default Administrator enabled: +40 points (critical)\n  - Multiple privileged memberships: +5 points\n\n  The compliance score is calculated as (100 - RiskScore), providing a percentage-based security posture\n  rating. The script produces actionable recommendations prioritized by risk level for immediate\n  remediation.\n\n#>\n\n# Instructions , Can be run on any Server thats on the domain , because we only capturing and quering AD - read only access is more than sufficient. \n# Reports are created on c:\\temp - copy this over to your machine and store centraly on sharepoint /SDMs to access.\n\n# N-Central Parameters\nparam(\n    [Parameter(Mandatory=$false, HelpMessage=\"Customer/Client name for the assessment (auto-generated from domain if not specified)\")]\n    [string]$CustomerName = \"\",\n    \n    [Parameter(Mandatory=$false, HelpMessage=\"Domain FQDN to assess (leave blank for current domain)\")]\n    [string]$DomainName = \"\",\n    \n    [Parameter(Mandatory=$false, HelpMessage=\"Engineer/Technician name\")]\n    [string]$EngineerName = \"N-Central RMS Assessment - $(Get-Date -Format 'yyyy-MM-dd HH:mm')\"\n)\n\n# Function to extract customer name from domain name\nfunction Get-CustomerNameFromDomain {\n    param([string]$DomainFQDN)\n    \n    if ([string]::IsNullOrWhiteSpace($DomainFQDN)) {\n        return \"\"\n    }\n    \n    # Common domain suffixes to remove\n    $suffixes = @(\n        '.local', '.co.za', '.com', '.net', '.org', '.co.uk', '.com.au', '.ca',\n        '.de', '.fr', '.it', '.nl', '.be', '.ch', '.at', '.se', '.no', '.dk',\n        '.fi', '.ie', '.pt', '.es', '.pl', '.cz', '.hu', '.sk', '.si', '.hr',\n        '.rs', '.bg', '.ro', '.gr', '.cy', '.mt', '.lu', '.li', '.mc', '.sm',\n        '.va', '.ad', '.int'\n    )\n    \n    $customerName = $DomainFQDN.ToLower()\n    \n    # Remove common suffixes\n    foreach ($suffix in $suffixes) {\n        if ($customerName.EndsWith($suffix)) {\n            $customerName = $customerName.Substring(0, $customerName.Length - $suffix.Length)\n            break\n        }\n    }\n    \n    # Handle multi-part domains (take first part before first dot if multiple dots remain)\n    if ($customerName.Contains('.')) {\n        $parts = $customerName.Split('.')\n        $customerName = $parts[0]\n    }\n    \n    # Capitalize first letter and clean up\n    if ($customerName.Length -gt 0) {\n        $customerName = $customerName.Substring(0,1).ToUpper() + $customerName.Substring(1)\n        # Replace hyphens/underscores with spaces for better formatting\n        $customerName = $customerName -replace '[-_]', ' '\n    }\n    \n    return $customerName\n}\n\n# N-Central Logging Function  \nfunction Write-NCentralLog {\n    param(\n        [string]$Message,\n        [ValidateSet(\"Info\", \"Warning\", \"Error\", \"Success\")]\n        [string]$Level = \"Info\"\n    )\n    \n    $timestamp = Get-Date -Format \"yyyy-MM-dd HH:mm:ss\"\n    $logMessage = \"[$timestamp] [$Level] $Message\"\n    \n    # Output to console for N-Central capture\n    switch ($Level) {\n        \"Error\" { Write-Error $logMessage }\n        \"Warning\" { Write-Warning $logMessage }\n        \"Success\" { Write-Host $logMessage -ForegroundColor Green }\n        default { Write-Host $logMessage -ForegroundColor Cyan }\n    }\n    \n    # Also write to log file\n    try {\n        $logPath = \"C:\\Temp\\NCentral_AD_Assessment_$(Get-Date -Format 'yyyyMMdd').log\"\n        \"$logMessage\" | Out-File -FilePath $logPath -Append -Encoding UTF8\n    } catch {\n        # Ignore logging errors to prevent script failure\n    }\n}\n\n# Initialize N-Central execution\n$StartTime = Get-Date\nWrite-NCentralLog \"Starting N-Central Complete AD Security Assessment\" -Level \"Info\"\n\n# Ensure C:\\Temp exists\nif (-not (Test-Path \"C:\\Temp\")) {\n    try {\n        New-Item -Path \"C:\\Temp\" -ItemType Directory -Force | Out-Null\n        Write-NCentralLog \"Created C:\\Temp directory\" -Level \"Info\"\n    } catch {\n        Write-NCentralLog \"Failed to create C:\\Temp directory: $($_.Exception.Message)\" -Level \"Error\"\n        exit 1\n    }\n}\n\n# Import required modules\ntry {\n    Import-Module ActiveDirectory -ErrorAction Stop\n    Write-NCentralLog \"Active Directory module imported successfully\" -Level \"Success\"\n} catch {\n    Write-NCentralLog \"Failed to import Active Directory module: $($_.Exception.Message)\" -Level \"Error\"\n    Write-NCentralLog \"Ensure RSAT-AD-PowerShell is installed\" -Level \"Error\"\n    exit 1\n}\n\n# Check for required assemblies for PDF generation\ntry {\n    Add-Type -AssemblyName System.Drawing\n    Add-Type -AssemblyName System.Windows.Forms\n    Add-Type -AssemblyName Microsoft.PowerShell.Commands.Utility\n    Write-Host \"PDF generation libraries loaded successfully\" -ForegroundColor Green\n}\ncatch {\n    Write-Warning \"Some PDF generation features may be limited. Continuing with HTML to PDF conversion.\"\n}\n\n# N-Central Automated Setup - No Interactive Prompts\nWrite-NCentralLog \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -Level \"Info\"\nWrite-NCentralLog \"N-Central Active Directory Security Assessment Tool v11.1 Complete\" -Level \"Info\"\nWrite-NCentralLog \"Comprehensive Privileged Groups & User Analysis (Automated)\" -Level \"Info\"\nWrite-NCentralLog \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -Level \"Info\"\n\n# Handle domain selection first\nif ([string]::IsNullOrWhiteSpace($DomainName)) {\n    try {\n        $Domain = Get-ADDomain\n        $DomainName = $Domain.DNSRoot\n        Write-NCentralLog \"Using current domain: $DomainName\" -Level \"Success\"\n    } catch {\n        Write-NCentralLog \"Unable to connect to current domain: $($_.Exception.Message)\" -Level \"Error\"\n        exit 1\n    }\n} else {\n    try {\n        $Domain = Get-ADDomain -Server $DomainName\n        $DomainName = $Domain.DNSRoot\n        Write-NCentralLog \"Connected to specified domain: $DomainName\" -Level \"Success\"\n    } catch {\n        Write-NCentralLog \"Unable to connect to domain '$DomainName': $($_.Exception.Message)\" -Level \"Error\"\n        exit 1\n    }\n}\n\n# Auto-generate customer name from domain if not provided\nif ([string]::IsNullOrWhiteSpace($CustomerName)) {\n    $CustomerName = Get-CustomerNameFromDomain -DomainFQDN $DomainName\n    Write-NCentralLog \"Auto-generated customer name from domain: '$CustomerName'\" -Level \"Info\"\n    \n    if ([string]::IsNullOrWhiteSpace($CustomerName)) {\n        Write-NCentralLog \"Unable to generate customer name from domain '$DomainName'. Using domain NetBIOS name as customer name.\" -Level \"Warning\"\n        $CustomerName = $Domain.NetBIOSName\n    }\n} else {\n    Write-NCentralLog \"Using provided customer name: '$CustomerName'\" -Level \"Info\"\n}\n\n# Validate final inputs\nif ([string]::IsNullOrWhiteSpace($CustomerName)) {\n    Write-NCentralLog \"Customer Name could not be determined\" -Level \"Error\"\n    exit 1\n}\n\nif ([string]::IsNullOrWhiteSpace($EngineerName)) {\n    Write-NCentralLog \"Engineer Name could not be determined\" -Level \"Error\" \n    exit 1\n}\n\n# Initialize variables with N-Central friendly naming\n$ReportDate = Get-Date -Format \"yyyy-MM-dd HH:mm:ss\"\n$SafeCustomerName = $CustomerName -replace '[^\\w\\s]', '' -replace '\\s+', '_'\n$Timestamp = Get-Date -Format 'yyyyMMdd_HHmmss'\n\n# N-Central file naming with NCentral prefix for easy identification\n$OutputPathHTML = \"C:\\Temp\\NCentral_AD_Security_Assessment_$($SafeCustomerName)_$($Domain.NetBIOSName)_$($Timestamp).html\"\n$OutputPathPDF = \"C:\\Temp\\NCentral_AD_Security_Assessment_$($SafeCustomerName)_$($Domain.NetBIOSName)_$($Timestamp).pdf\"\n$OutputPathUserHTML = \"C:\\Temp\\NCentral_AD_User_Analysis_$($SafeCustomerName)_$($Domain.NetBIOSName)_$($Timestamp).html\"\n$OutputPathUserPDF = \"C:\\Temp\\NCentral_AD_User_Analysis_$($SafeCustomerName)_$($Domain.NetBIOSName)_$($Timestamp).pdf\"\n$OutputPathCSV = \"C:\\Temp\\NCentral_AD_Complete_Assessment_$($SafeCustomerName)_$($Domain.NetBIOSName)_$($Timestamp)_Details.csv\"\n\nWrite-NCentralLog \"Starting comprehensive Active Directory Security Assessment\" -Level \"Success\"\nWrite-NCentralLog \"Customer: $CustomerName\" -Level \"Info\"\nWrite-NCentralLog \"Domain: $DomainName\" -Level \"Info\" \nWrite-NCentralLog \"Engineer: $EngineerName\" -Level \"Info\"\nWrite-NCentralLog \"Output files will be prefixed with: NCentral_AD_*_$($SafeCustomerName)_$($Domain.NetBIOSName)_$($Timestamp)\" -Level \"Info\"\n\n# Function to calculate risk score\nfunction Get-RiskLevel {\n    param($Score)\n    if ($Score -ge 80) { return 'Critical' }\n    elseif ($Score -ge 60) { return 'High' }\n    elseif ($Score -ge 40) { return 'Medium' }\n    elseif ($Score -ge 20) { return 'Low' }\n    else { return 'Info' }\n}\n\n# Function to get domain password policy with enhanced evaluation\nfunction Get-DomainPasswordPolicy {\n    param($DomainServer)\n    Write-Host \"Retrieving enhanced domain password policy...\" -ForegroundColor Yellow\n    \n    $Policy = if ($DomainServer) { \n        Get-ADDefaultDomainPasswordPolicy -Server $DomainServer \n    } else { \n        Get-ADDefaultDomainPasswordPolicy \n    }\n    \n    return @{\n        'ComplexityEnabled' = $Policy.ComplexityEnabled\n        'DistinguishedName' = $Policy.DistinguishedName\n        'LockoutDuration' = $Policy.LockoutDuration.TotalMinutes\n        'LockoutObservationWindow' = $Policy.LockoutObservationWindow.TotalMinutes\n        'LockoutThreshold' = $Policy.LockoutThreshold\n        'MaxPasswordAge' = $Policy.MaxPasswordAge.TotalDays\n        'MinPasswordAge' = $Policy.MinPasswordAge.TotalDays\n        'MinPasswordLength' = $Policy.MinPasswordLength\n        'PasswordHistoryCount' = $Policy.PasswordHistoryCount\n        'ReversibleEncryptionEnabled' = $Policy.ReversibleEncryptionEnabled\n    }\n}\n\n# Function to get fine-grained password policies\nfunction Get-FineGrainedPolicies {\n    param($DomainServer)\n    Write-Host \"Retrieving fine-grained password policies...\" -ForegroundColor Yellow\n    \n    try {\n        $FGPPs = if ($DomainServer) {\n            Get-ADFineGrainedPasswordPolicy -Filter * -Properties * -Server $DomainServer\n        } else {\n            Get-ADFineGrainedPasswordPolicy -Filter * -Properties *\n        }\n        \n        $FGPPDetails = @()\n        \n        foreach ($FGPP in $FGPPs) {\n            $AppliesTo = if ($DomainServer) {\n                (Get-ADFineGrainedPasswordPolicySubject -Identity $FGPP -Server $DomainServer).Name -join \", \"\n            } else {\n                (Get-ADFineGrainedPasswordPolicySubject -Identity $FGPP).Name -join \", \"\n            }\n            \n            $FGPPDetails += [PSCustomObject]@{\n                'Name' = $FGPP.Name\n                'Precedence' = $FGPP.Precedence\n                'ComplexityEnabled' = $FGPP.ComplexityEnabled\n                'LockoutDuration' = $FGPP.LockoutDuration.TotalMinutes\n                'LockoutObservationWindow' = $FGPP.LockoutObservationWindow.TotalMinutes\n                'LockoutThreshold' = $FGPP.LockoutThreshold\n                'MaxPasswordAge' = $FGPP.MaxPasswordAge.TotalDays\n                'MinPasswordAge' = $FGPP.MinPasswordAge.TotalDays\n                'MinPasswordLength' = $FGPP.MinPasswordLength\n                'PasswordHistoryCount' = $FGPP.PasswordHistoryCount\n                'ReversibleEncryptionEnabled' = $FGPP.ReversibleEncryptionEnabled\n                'AppliesTo' = $AppliesTo\n            }\n        }\n        \n        return $FGPPDetails\n    }\n    catch {\n        Write-Warning \"No fine-grained password policies found or insufficient permissions\"\n        return @()\n    }\n}\n\n# Enhanced function to analyze password policy compliance with new requirements\nfunction Test-PolicyCompliance {\n    param($Policy)\n    \n    $Issues = @()\n    $RiskScore = 0\n    \n    # Enhanced Microsoft Best Practices and Industry Standards\n    if (-not $Policy.ComplexityEnabled) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = 'Password complexity is disabled'\n            'Risk' = 'High'\n            'Recommendation' = 'Enable password complexity requirements'\n            'BestPractice' = 'Microsoft recommends enabling complexity for passwords'\n        }\n        $RiskScore += 20\n    }\n    \n    if ($Policy.MinPasswordLength -lt 14) {\n        $Risk = if ($Policy.MinPasswordLength -lt 8) { 'Critical' } \n               elseif ($Policy.MinPasswordLength -lt 12) { 'High' }\n               else { 'Medium' }\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Minimum password length is $($Policy.MinPasswordLength) characters\"\n            'Risk' = $Risk\n            'Recommendation' = 'Set minimum password length to 14+ characters per NIST SP 800-63B'\n            'BestPractice' = 'NIST SP 800-63B and Microsoft recommend 14+ character passwords for security'\n        }\n        $RiskScore += if ($Policy.MinPasswordLength -lt 8) { 30 } \n                     elseif ($Policy.MinPasswordLength -lt 12) { 20 } \n                     else { 15 }\n    }\n    \n    # Enhanced Minimum Password Age evaluation\n    if ($Policy.MinPasswordAge -lt 1) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Minimum password age is $($Policy.MinPasswordAge) days\"\n            'Risk' = 'High'\n            'Recommendation' = 'Set minimum password age to at least 1 day to prevent immediate password reuse'\n            'BestPractice' = 'Industry standard is 1-2 days to balance security with usability'\n        }\n        $RiskScore += 20\n    }\n    elseif ($Policy.MinPasswordAge -gt 2) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Minimum password age is $($Policy.MinPasswordAge) days\"\n            'Risk' = 'Low'\n            'Recommendation' = 'Consider reducing minimum password age to 1-2 days'\n            'BestPractice' = 'Industry standard is 1-2 days to balance security with usability'\n        }\n        $RiskScore += 5\n    }\n    \n    # Enhanced Maximum Password Age evaluation\n    if ($Policy.MaxPasswordAge -eq 0) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Maximum password age is set to never expire\"\n            'Risk' = 'Critical'\n            'Recommendation' = 'Set maximum password age to 60-365 days or implement alternative authentication'\n            'BestPractice' = 'Balance between security and usability - consider modern authentication methods'\n        }\n        $RiskScore += 35\n    }\n    elseif ($Policy.MaxPasswordAge -gt 365) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Maximum password age is $($Policy.MaxPasswordAge) days\"\n            'Risk' = 'Medium'\n            'Recommendation' = 'Consider reducing maximum password age to 365 days or less'\n            'BestPractice' = 'Regularly changed passwords reduce long-term exposure risk'\n        }\n        $RiskScore += 15\n    }\n    \n    if ($Policy.PasswordHistoryCount -lt 12) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Password history is set to $($Policy.PasswordHistoryCount) passwords\"\n            'Risk' = 'Medium'\n            'Recommendation' = 'Set password history to remember at least 12 passwords'\n            'BestPractice' = 'Prevents password reuse and cycling - Microsoft baseline recommendation'\n        }\n        $RiskScore += 10\n    }\n    \n    if ($Policy.LockoutThreshold -eq 0) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = 'Account lockout is disabled'\n            'Risk' = 'Critical'\n            'Recommendation' = 'Enable account lockout with threshold of 5-10 attempts'\n            'BestPractice' = 'Protects against brute force attacks while maintaining usability'\n        }\n        $RiskScore += 35\n    }\n    elseif ($Policy.LockoutThreshold -lt 5 -or $Policy.LockoutThreshold -gt 10) {\n        $Risk = if ($Policy.LockoutThreshold -lt 5) { 'Medium' } else { 'Low' }\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Account lockout threshold is $($Policy.LockoutThreshold) attempts\"\n            'Risk' = $Risk\n            'Recommendation' = 'Set lockout threshold to 5-10 failed attempts for optimal security'\n            'BestPractice' = 'Balance security protection with user experience'\n        }\n        $RiskScore += if ($Policy.LockoutThreshold -lt 5) { 15 } else { 5 }\n    }\n    \n    # Enhanced Lockout Duration evaluation\n    if ($Policy.LockoutDuration -lt 15) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Account lockout duration is $($Policy.LockoutDuration) minutes\"\n            'Risk' = 'High'\n            'Recommendation' = 'Set lockout duration to at least 15 minutes for optimal security'\n            'BestPractice' = 'Adequate lockout duration deters automated attacks while minimizing user impact'\n        }\n        $RiskScore += 20\n    }\n    elseif ($Policy.LockoutDuration -gt 60) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Account lockout duration is $($Policy.LockoutDuration) minutes\"\n            'Risk' = 'Low'\n            'Recommendation' = 'Consider reducing lockout duration to 15-60 minutes'\n            'BestPractice' = 'Adequate lockout duration deters automated attacks while minimizing user impact'\n        }\n        $RiskScore += 5\n    }\n    \n    # Enhanced Reset Account Lockout Counter evaluation\n    if ($Policy.LockoutObservationWindow -lt $Policy.LockoutDuration -and $Policy.LockoutThreshold -gt 0) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Reset account lockout counter ($($Policy.LockoutObservationWindow) min) is less than lockout duration ($($Policy.LockoutDuration) min)\"\n            'Risk' = 'High'\n            'Recommendation' = 'Set reset lockout counter equal to or greater than lockout duration'\n            'BestPractice' = 'Ensures proper lockout behavior and prevents premature counter resets'\n        }\n        $RiskScore += 20\n    }\n    \n    if ($Policy.ReversibleEncryptionEnabled) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = 'Reversible encryption is enabled'\n            'Risk' = 'Critical'\n            'Recommendation' = 'Disable reversible encryption immediately - CRITICAL SECURITY RISK'\n            'BestPractice' = 'Reversible encryption is equivalent to storing passwords in plain text'\n        }\n        $RiskScore += 35\n    }\n    \n    return @{\n        'Issues' = $Issues\n        'RiskScore' = $RiskScore\n        'RiskLevel' = Get-RiskLevel $RiskScore\n    }\n}\n\n# Enhanced function to get comprehensive privileged group analysis\nfunction Get-AllPrivilegedAccounts {\n    param($DomainServer)\n    Write-Host \"Performing comprehensive privileged group analysis...\" -ForegroundColor Yellow\n    \n    $PrivilegedGroups = @(\n        'Domain Admins',\n        'Enterprise Admins', \n        'Schema Admins',\n        'Administrators'\n    )\n    \n    $AllPrivilegedAccounts = @()\n    \n    foreach ($GroupName in $PrivilegedGroups) {\n        Write-Host \"  Analyzing group: $GroupName\" -ForegroundColor Cyan\n        \n        try {\n            # Get group with recursive membership\n            $Members = if ($DomainServer) {\n                Get-ADGroupMember $GroupName -Recursive -Server $DomainServer -ErrorAction SilentlyContinue\n            } else {\n                Get-ADGroupMember $GroupName -Recursive -ErrorAction SilentlyContinue\n            }\n            \n            foreach ($Member in $Members) {\n                if ($Member.objectClass -eq \"user\") {\n                    $User = if ($DomainServer) {\n                        Get-ADUser $Member.SamAccountName -Properties LastLogonDate, PasswordLastSet, Enabled, AccountExpirationDate, PasswordNeverExpires, MemberOf -Server $DomainServer\n                    } else {\n                        Get-ADUser $Member.SamAccountName -Properties LastLogonDate, PasswordLastSet, Enabled, AccountExpirationDate, PasswordNeverExpires, MemberOf\n                    }\n                    \n                    $LastLogon = if ($User.LastLogonDate) { $User.LastLogonDate } else { \"Never\" }\n                    $PasswordLastSet = if ($User.PasswordLastSet) { $User.PasswordLastSet } else { \"Never\" }\n                    \n                    # Calculate days since last logon and password change\n                    $DaysSinceLogon = if ($User.LastLogonDate) { (Get-Date) - $User.LastLogonDate | Select-Object -ExpandProperty Days } else { 9999 }\n                    $DaysSincePasswordChange = if ($User.PasswordLastSet) { (Get-Date) - $User.PasswordLastSet | Select-Object -ExpandProperty Days } else { 9999 }\n                    \n                    # Get all privileged groups this user belongs to\n                    $UserPrivilegedGroups = @()\n                    foreach ($CheckGroup in $PrivilegedGroups) {\n                        try {\n                            $GroupMembers = if ($DomainServer) {\n                                Get-ADGroupMember $CheckGroup -Recursive -Server $DomainServer -ErrorAction SilentlyContinue\n                            } else {\n                                Get-ADGroupMember $CheckGroup -Recursive -ErrorAction SilentlyContinue\n                            }\n                            if ($GroupMembers.SamAccountName -contains $User.SamAccountName) {\n                                $UserPrivilegedGroups += $CheckGroup\n                            }\n                        }\n                        catch {\n                            # Group might not exist in this domain\n                        }\n                    }\n                    \n                    # Enhanced risk assessment with multi-factor analysis\n                    $RiskFactors = @()\n                    $RiskScore = 0\n                    \n                    if (-not $User.Enabled) { \n                        $RiskFactors += \"Account Disabled\"\n                        $RiskScore += 0 # Disabled accounts are actually lower risk\n                    }\n                    \n                    if ($DaysSinceLogon -gt 180) { \n                        $RiskFactors += \"No logon for 180+ days\"\n                        $RiskScore += 30\n                    }\n                    elseif ($DaysSinceLogon -gt 90) { \n                        $RiskFactors += \"No logon for 90+ days\"\n                        $RiskScore += 20\n                    }\n                    elseif ($DaysSinceLogon -gt 30) { \n                        $RiskFactors += \"No logon for 30+ days\"\n                        $RiskScore += 40  # Changed to Critical for 30+ days\n                    }\n                    \n                    if ($LastLogon -eq \"Never\") {\n                        $RiskFactors += \"Never logged on\"\n                        $RiskScore += 40  # Changed to Critical\n                    }\n                    \n                    if ($DaysSincePasswordChange -gt 365) { \n                        $RiskFactors += \"Password older than 1 year\"\n                        $RiskScore += 30\n                    }\n                    elseif ($DaysSincePasswordChange -gt 180) { \n                        $RiskFactors += \"Password older than 6 months\"\n                        $RiskScore += 25  # Changed to High risk\n                    }\n                    \n                    if ($User.PasswordNeverExpires) { \n                        $RiskFactors += \"Password never expires\"\n                        $RiskScore += 30  # Changed to High risk\n                    }\n                    \n                    if ($PasswordLastSet -eq \"Never\") {\n                        $RiskFactors += \"Password never set\"\n                        $RiskScore += 40  # Changed to Critical\n                    }\n                    \n                    if ($UserPrivilegedGroups.Count -gt 1) {\n                        $RiskFactors += \"Multiple privileged group memberships\"\n                        $RiskScore += 5\n                    }\n                    \n                    # Check for default Administrator account\n                    if ($User.SamAccountName -eq \"Administrator\" -and $User.Enabled) {\n                        $RiskFactors += \"Default Administrator account is enabled\"\n                        $RiskScore += 40  # Changed to Critical\n                    }\n                    \n                    # Determine overall risk level\n                    $Risk = Get-RiskLevel $RiskScore\n                    if (-not $User.Enabled) { $Risk = 'Info' }\n                    \n                    $AllPrivilegedAccounts += [PSCustomObject]@{\n                        'Name' = $User.Name\n                        'SamAccountName' = $User.SamAccountName\n                        'PrimaryGroup' = $GroupName\n                        'AllPrivilegedGroups' = $UserPrivilegedGroups -join \"; \"\n                        'Enabled' = $User.Enabled\n                        'LastLogonDate' = $LastLogon\n                        'PasswordLastSet' = $PasswordLastSet\n                        'DaysSinceLogon' = $DaysSinceLogon\n                        'DaysSincePasswordChange' = $DaysSincePasswordChange\n                        'PasswordNeverExpires' = $User.PasswordNeverExpires\n                        'AccountExpirationDate' = $User.AccountExpirationDate\n                        'RiskFactors' = $RiskFactors -join \"; \"\n                        'RiskScore' = $RiskScore\n                        'Risk' = $Risk\n                    }\n                }\n            }\n        }\n        catch {\n            Write-Warning \"Unable to analyze group '$GroupName': $($_.Exception.Message)\"\n        }\n    }\n    \n    # Remove duplicates (users in multiple groups)\n    $UniqueAccounts = $AllPrivilegedAccounts | Sort-Object SamAccountName -Unique\n    \n    return $UniqueAccounts\n}\n\n# New function for comprehensive domain user analysis\nfunction Get-DomainUserAnalysis {\n    param($DomainServer)\n    Write-Host \"Performing comprehensive domain user analysis...\" -ForegroundColor Yellow\n    Write-Host \"  This may take several minutes for large domains...\" -ForegroundColor Cyan\n    \n    $AllUsers = if ($DomainServer) {\n        Get-ADUser -Filter * -Properties LastLogonDate, PasswordLastSet, Enabled, AccountExpirationDate, PasswordNeverExpires, Created, BadLogonCount -Server $DomainServer\n    } else {\n        Get-ADUser -Filter * -Properties LastLogonDate, PasswordLastSet, Enabled, AccountExpirationDate, PasswordNeverExpires, Created, BadLogonCount\n    }\n    \n    Write-Host \"  Analyzing $($AllUsers.Count) user accounts...\" -ForegroundColor Cyan\n    \n    $UserAnalysis = @()\n    $Counter = 0\n    \n    foreach ($User in $AllUsers) {\n        $Counter++\n        if ($Counter % 100 -eq 0) {\n            Write-Host \"    Processed $Counter of $($AllUsers.Count) users...\" -ForegroundColor Yellow\n        }\n        \n        $LastLogon = if ($User.LastLogonDate) { $User.LastLogonDate } else { \"Never\" }\n        $PasswordLastSet = if ($User.PasswordLastSet) { $User.PasswordLastSet } else { \"Never\" }\n        \n        # Calculate days since last logon and password change\n        $DaysSinceLogon = if ($User.LastLogonDate) { (Get-Date) - $User.LastLogonDate | Select-Object -ExpandProperty Days } else { 9999 }\n        $DaysSincePasswordChange = if ($User.PasswordLastSet) { (Get-Date) - $User.PasswordLastSet | Select-Object -ExpandProperty Days } else { 9999 }\n        $DaysSinceCreated = if ($User.Created) { (Get-Date) - $User.Created | Select-Object -ExpandProperty Days } else { 9999 }\n        \n        # Password and account risk assessment\n        $RiskFactors = @()\n        $RiskScore = 0\n        \n        # Account status risks\n        if (-not $User.Enabled) { \n            $RiskFactors += \"Account Disabled\"\n        }\n        \n        # Logon pattern risks\n        if ($LastLogon -eq \"Never\") {\n            $RiskFactors += \"Never logged on\"\n            $RiskScore += 25\n        }\n        elseif ($DaysSinceLogon -gt 365) { \n            $RiskFactors += \"No logon for 1+ years (Stale)\"\n            $RiskScore += 30\n        }\n        elseif ($DaysSinceLogon -gt 180) { \n            $RiskFactors += \"No logon for 6+ months\"\n            $RiskScore += 25\n        }\n        elseif ($DaysSinceLogon -gt 90) { \n            $RiskFactors += \"No logon for 3+ months\"\n            $RiskScore += 20\n        }\n        elseif ($DaysSinceLogon -gt 30) { \n            $RiskFactors += \"No logon for 30+ days\"\n            $RiskScore += 40  # Changed to Critical\n        }\n        \n        # Password security risks\n        if ($PasswordLastSet -eq \"Never\") {\n            $RiskFactors += \"Password never set\"\n            $RiskScore += 30\n        }\n        elseif ($DaysSincePasswordChange -gt 730) { \n            $RiskFactors += \"Password older than 2 years\"\n            $RiskScore += 30\n        }\n        elseif ($DaysSincePasswordChange -gt 365) { \n            $RiskFactors += \"Password older than 1 year\"\n            $RiskScore += 25\n        }\n        elseif ($DaysSincePasswordChange -gt 180) { \n            $RiskFactors += \"Password older than 6 months\"\n            $RiskScore += 20  # Changed to High risk\n        }\n        \n        if ($User.PasswordNeverExpires) { \n            $RiskFactors += \"Password never expires\"\n            $RiskScore += 25  # Changed to High risk\n        }\n        \n        # Account behavior risks\n        if ($User.BadLogonCount -gt 0) {\n            $RiskFactors += \"Recent failed logon attempts: $($User.BadLogonCount)\"\n            $RiskScore += 10\n        }\n        \n        # New account risks\n        if ($DaysSinceCreated -lt 30 -and $LastLogon -eq \"Never\") {\n            $RiskFactors += \"New account never used\"\n            $RiskScore += 15\n        }\n        \n        # Account expiration\n        if ($User.AccountExpirationDate -and $User.AccountExpirationDate -lt (Get-Date)) {\n            $RiskFactors += \"Account expired\"\n            $RiskScore += 5\n        }\n        \n        # Check for default Administrator account\n        if ($User.SamAccountName -eq \"Administrator\" -and $User.Enabled) {\n            $RiskFactors += \"Default Administrator account is enabled\"\n            $RiskScore += 40  # Changed to Critical\n        }\n        \n        # Determine overall risk level\n        $Risk = Get-RiskLevel $RiskScore\n        if (-not $User.Enabled) { $Risk = 'Info' }\n        \n        # Categorize user type\n        $UserType = \"Standard User\"\n        if ($User.SamAccountName -like \"*admin*\" -or $User.SamAccountName -like \"*svc*\" -or $User.SamAccountName -like \"*service*\") {\n            $UserType = \"Service/Admin Account\"\n        }\n        elseif ($User.SamAccountName -like \"*test*\" -or $User.SamAccountName -like \"*temp*\") {\n            $UserType = \"Test/Temp Account\"\n        }\n        \n        $UserAnalysis += [PSCustomObject]@{\n            'Name' = $User.Name\n            'SamAccountName' = $User.SamAccountName\n            'UserType' = $UserType\n            'Enabled' = $User.Enabled\n            'Created' = if ($User.Created) { $User.Created.ToString(\"yyyy-MM-dd\") } else { \"Unknown\" }\n            'LastLogonDate' = if ($LastLogon -eq \"Never\") { \"Never\" } else { $LastLogon.ToString(\"yyyy-MM-dd\") }\n            'PasswordLastSet' = if ($PasswordLastSet -eq \"Never\") { \"Never\" } else { $PasswordLastSet.ToString(\"yyyy-MM-dd\") }\n            'DaysSinceLogon' = $DaysSinceLogon\n            'DaysSincePasswordChange' = $DaysSincePasswordChange\n            'PasswordNeverExpires' = $User.PasswordNeverExpires\n            'AccountExpirationDate' = $User.AccountExpirationDate\n            'BadLogonCount' = $User.BadLogonCount\n            'RiskFactors' = if ($RiskFactors.Count -gt 0) { $RiskFactors -join \"; \" } else { \"None\" }\n            'RiskScore' = $RiskScore\n            'Risk' = $Risk\n        }\n    }\n    \n    Write-Host \"  User analysis completed!\" -ForegroundColor Green\n    return $UserAnalysis\n}\n\n# Enhanced function to generate professional HTML for main security assessment\nfunction New-SecurityAssessmentHTML {\n    param(\n        $DomainPolicy,\n        $FGPPs,\n        $PolicyCompliance,\n        $PrivilegedAccounts,\n        $CustomerName,\n        $DomainName,\n        $EngineerName\n    )\n    \n    # Calculate additional metrics\n    $StalePrivileged = $PrivilegedAccounts | Where-Object { $_.DaysSinceLogon -gt 90 -and $_.Enabled }\n    $CriticalIssues = $PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Critical' }\n    $HighIssues = $PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'High' }\n    $NeverLoggedOn = $PrivilegedAccounts | Where-Object { $_.LastLogonDate -eq 'Never' }\n    \n    $HTML = @\"\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <title>Active Directory Security Assessment Report</title>\n    <style>\n        @page {\n            margin: 0.5in;\n            @top-center {\n                content: \"Active Directory Security Assessment\";\n                font-family: 'Segoe UI', sans-serif;\n                font-size: 10px;\n                color: #666;\n            }\n            @bottom-center {\n                content: \"Page \" counter(page) \" of \" counter(pages);\n                font-family: 'Segoe UI', sans-serif;\n                font-size: 10px;\n                color: #666;\n            }\n        }\n        \n        body {\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n            margin: 0;\n            padding: 20px;\n            background-color: white;\n            line-height: 1.4;\n            font-size: 11px;\n        }\n        \n        .header {\n            text-align: center;\n            border-bottom: 3px solid #2E86AB;\n            padding-bottom: 15px;\n            margin-bottom: 20px;\n        }\n        \n        .customer-name {\n            font-size: 28px;\n            font-weight: bold;\n            color: #2E86AB;\n            margin-bottom: 5px;\n            text-transform: uppercase;\n        }\n        \n        .report-title {\n            font-size: 18px;\n            font-weight: bold;\n            color: #333;\n            margin-bottom: 15px;\n        }\n        \n        .header-info {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 20px;\n            margin-top: 15px;\n            font-size: 10px;\n        }\n        \n        .section {\n            margin-bottom: 20px;\n            page-break-inside: avoid;\n        }\n        \n        .section h2 {\n            background: linear-gradient(135deg, #2E86AB 0%, #1f5f99 100%);\n            color: white;\n            padding: 8px 15px;\n            margin: 0 0 10px 0;\n            font-size: 14px;\n            font-weight: bold;\n        }\n        \n        .section h3 {\n            color: #2E86AB;\n            font-size: 12px;\n            margin: 15px 0 8px 0;\n            border-bottom: 1px solid #ddd;\n            padding-bottom: 3px;\n        }\n        \n        .executive-summary {\n            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);\n            padding: 15px;\n            border-left: 4px solid #2E86AB;\n            margin-bottom: 20px;\n        }\n        \n        .metrics-grid {\n            display: grid;\n            grid-template-columns: repeat(4, 1fr);\n            gap: 15px;\n            margin: 15px 0;\n        }\n        \n        .metric-card {\n            text-align: center;\n            padding: 12px;\n            background: white;\n            border: 1px solid #ddd;\n            border-radius: 5px;\n        }\n        \n        .metric-value {\n            font-size: 18px;\n            font-weight: bold;\n            color: #2E86AB;\n        }\n        \n        .metric-label {\n            font-size: 10px;\n            color: #666;\n            margin-top: 5px;\n        }\n        \n        table {\n            width: 100%;\n            border-collapse: collapse;\n            margin: 10px 0;\n            font-size: 10px;\n        }\n        \n        th, td {\n            border: 1px solid #ddd;\n            padding: 6px;\n            text-align: left;\n        }\n        \n        th {\n            background-color: #f8f9fa;\n            font-weight: bold;\n            color: #2E86AB;\n        }\n        \n        .compliant {\n            background-color: #d4edda;\n            color: #155724;\n            font-weight: bold;\n        }\n        \n        .non-compliant {\n            background-color: #f8d7da;\n            color: #721c24;\n            font-weight: bold;\n        }\n        \n        .risk-critical {\n            background-color: #f8d7da;\n            border-left: 4px solid #dc3545;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-high {\n            background-color: #fff3cd;\n            border-left: 4px solid #ffc107;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-medium {\n            background-color: #d1ecf1;\n            border-left: 4px solid #17a2b8;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-low {\n            background-color: #d4edda;\n            border-left: 4px solid #28a745;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-badge {\n            padding: 3px 8px;\n            border-radius: 12px;\n            color: white;\n            font-weight: bold;\n            font-size: 9px;\n            text-transform: uppercase;\n        }\n        \n        .risk-critical .risk-badge { background-color: #dc3545; }\n        .risk-high .risk-badge { background-color: #ffc107; color: #333; }\n        .risk-medium .risk-badge { background-color: #17a2b8; }\n        .risk-low .risk-badge { background-color: #28a745; }\n        \n        .recommendation {\n            background-color: #f0f8ff;\n            border: 1px solid #b3d9ff;\n            padding: 12px;\n            margin: 10px 0;\n            border-radius: 5px;\n        }\n        \n        .recommendation h4 {\n            margin: 0 0 8px 0;\n            color: #2E86AB;\n            font-size: 11px;\n        }\n        \n        .footer {\n            border-top: 2px solid #2E86AB;\n            padding-top: 15px;\n            margin-top: 30px;\n            text-align: center;\n            font-size: 9px;\n            color: #666;\n        }\n        \n        .chart-container {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 20px;\n            margin: 15px 0;\n        }\n        \n        .chart-item {\n            background: white;\n            border: 1px solid #ddd;\n            padding: 10px;\n            border-radius: 5px;\n        }\n        \n        .progress-bar {\n            width: 100%;\n            height: 15px;\n            background-color: #e9ecef;\n            border-radius: 8px;\n            overflow: hidden;\n            margin: 5px 0;\n        }\n        \n        .progress-fill {\n            height: 100%;\n            border-radius: 8px;\n        }\n        \n        .no-break { page-break-inside: avoid; }\n        \n        .enhanced-metrics {\n            display: grid;\n            grid-template-columns: repeat(6, 1fr);\n            gap: 10px;\n            margin: 15px 0;\n        }\n        \n        .risk-distribution {\n            display: grid;\n            grid-template-columns: repeat(4, 1fr);\n            gap: 10px;\n            margin: 10px 0;\n        }\n        \n        .risk-item {\n            text-align: center;\n            padding: 8px;\n            border-radius: 5px;\n            color: white;\n            font-weight: bold;\n        }\n        \n        .risk-critical-bg { background-color: #dc3545; }\n        .risk-high-bg { background-color: #fd7e14; }\n        .risk-medium-bg { background-color: #ffc107; color: #333; }\n        .risk-low-bg { background-color: #28a745; }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <div class=\"customer-name\">$CustomerName</div>\n        <div class=\"report-title\">Active Directory Security Assessment Report</div>\n        <div style=\"font-size: 12px; color: #2E86AB; margin-top: 5px;\">Comprehensive Privileged Groups & Deafult Domain Password Policy Analysis</div>\n        \n        <div class=\"header-info\">\n            <div>\n                <strong>Customer:</strong> $CustomerName<br>\n                <strong>Domain:</strong> $DomainName<br>\n                <strong>Assessment Date:</strong> $ReportDate\n            </div>\n            <div>\n                <strong>Assessed By:</strong> $EngineerName<br>\n                <strong>Report Version:</strong> 11.0<br>\n                <strong>Classification:</strong> Domain Security\n            </div>\n        </div>\n    </div>\n\n    <div class=\"executive-summary no-break\">\n        <h2>Executive Summary</h2>\n        <p>This comprehensive assessment evaluates the Active Directory password policies, fine-grained policies, and <strong>all privileged group memberships</strong> (Domain Admins, Enterprise Admins, Schema Admins, Administrators) for <strong>$CustomerName</strong>. The evaluation compares current configurations against Microsoft security baselines, NIST SP 800-63B guidelines, and industry best practices to identify security risks and provide actionable recommendations.</p>\n        \n        <div class=\"enhanced-metrics\">\n            <div class=\"metric-card\">\n                <div class=\"metric-value\" style=\"color: $(\n                    switch ($PolicyCompliance.RiskLevel) {\n                        'Critical' { '#dc3545' }\n                        'High' { '#fd7e14' }\n                        'Medium' { '#ffc107' }\n                        'Low' { '#28a745' }\n                        default { '#17a2b8' }\n                    }\n                );\">$($PolicyCompliance.RiskLevel.ToUpper())</div>\n                <div class=\"metric-label\">Overall Risk Level</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$($PolicyCompliance.RiskScore)/100</div>\n                <div class=\"metric-label\">Policy Risk Score</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$($PolicyCompliance.Issues.Count)</div>\n                <div class=\"metric-label\">Policy Issues</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$($PrivilegedAccounts.Count)</div>\n                <div class=\"metric-label\">Privileged Accounts</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$($StalePrivileged.Count)</div>\n                <div class=\"metric-label\">Stale Privileged</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$($NeverLoggedOn.Count)</div>\n                <div class=\"metric-label\">Never Used</div>\n            </div>\n        </div>\n        \n        <div class=\"chart-container\">\n            <div class=\"chart-item\">\n                <h4>Security Compliance Score</h4>\n                <div class=\"progress-bar\">\n                    <div class=\"progress-fill\" style=\"width: $((100-$PolicyCompliance.RiskScore))%; background-color: $(\n                        if ((100-$PolicyCompliance.RiskScore) -ge 80) { '#28a745' }\n                        elseif ((100-$PolicyCompliance.RiskScore) -ge 60) { '#ffc107' }\n                        else { '#dc3545' }\n                    );\"></div>\n                </div>\n                <small>$((100-$PolicyCompliance.RiskScore))% Compliant</small>\n            </div>\n            <div class=\"chart-item\">\n                <h4>Privileged Account Health</h4>\n                <div class=\"progress-bar\">\n                    <div class=\"progress-fill\" style=\"width: $(\n                        if ($PrivilegedAccounts.Count -gt 0) {\n                            $HealthyPrivileged = $PrivilegedAccounts | Where-Object { $_.Risk -eq 'Low' -or $_.Risk -eq 'Info' }\n                            [math]::Round(($HealthyPrivileged.Count / $PrivilegedAccounts.Count) * 100, 0)\n                        } else { 0 }\n                    )%; background-color: #28a745;\"></div>\n                </div>\n                <small>$(\n                    if ($PrivilegedAccounts.Count -gt 0) {\n                        $HealthyPrivileged = $PrivilegedAccounts | Where-Object { $_.Risk -eq 'Low' -or $_.Risk -eq 'Info' }\n                        [math]::Round(($HealthyPrivileged.Count / $PrivilegedAccounts.Count) * 100, 0)\n                    } else { 0 }\n                )% Low Risk</small>\n            </div>\n        </div>\n        \n        <div class=\"risk-distribution\">\n            <div class=\"risk-item risk-critical-bg\">\n                <div>$(($PrivilegedAccounts | Where-Object { $_.Risk -eq 'Critical' }).Count)</div>\n                <div style=\"font-size: 9px;\">CRITICAL</div>\n            </div>\n            <div class=\"risk-item risk-high-bg\">\n                <div>$(($PrivilegedAccounts | Where-Object { $_.Risk -eq 'High' }).Count)</div>\n                <div style=\"font-size: 9px;\">HIGH</div>\n            </div>\n            <div class=\"risk-item risk-medium-bg\">\n                <div>$(($PrivilegedAccounts | Where-Object { $_.Risk -eq 'Medium' }).Count)</div>\n                <div style=\"font-size: 9px;\">MEDIUM</div>\n            </div>\n            <div class=\"risk-item risk-low-bg\">\n                <div>$(($PrivilegedAccounts | Where-Object { $_.Risk -eq 'Low' -or $_.Risk -eq 'Info' }).Count)</div>\n                <div style=\"font-size: 9px;\">LOW/INFO</div>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"section no-break\">\n        <h2>Domain Password Policy Assessment</h2>\n        <p>Current domain password policy configuration compared to Microsoft security baselines and NIST SP 800-63B guidelines:</p>\n        \n        <table>\n            <thead>\n                <tr>\n                    <th>Policy Setting</th>\n                    <th>Current Value</th>\n                    <th>Best Practice</th>\n                    <th>Compliance Status</th>\n                </tr>\n            </thead>\n            <tbody>\n                <tr>\n                    <td>Password Complexity</td>\n                    <td>$($DomainPolicy.ComplexityEnabled)</td>\n                    <td>Enabled</td>\n                    <td class=\"$(if($DomainPolicy.ComplexityEnabled){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.ComplexityEnabled){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Minimum Password Length</td>\n                    <td>$($DomainPolicy.MinPasswordLength) characters</td>\n                    <td>14+ characters (NIST SP 800-63B)</td>\n                    <td class=\"$(if($DomainPolicy.MinPasswordLength -ge 14){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.MinPasswordLength -ge 14){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Minimum Password Age</td>\n                    <td>$($DomainPolicy.MinPasswordAge) days</td>\n                    <td>1-2 days (prevents immediate reuse)</td>\n                    <td class=\"$(if($DomainPolicy.MinPasswordAge -ge 1 -and $DomainPolicy.MinPasswordAge -le 2){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.MinPasswordAge -ge 1 -and $DomainPolicy.MinPasswordAge -le 2){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Maximum Password Age</td>\n                    <td>$(if($DomainPolicy.MaxPasswordAge -eq 0){'Never expires'}else{\"$($DomainPolicy.MaxPasswordAge) days\"})</td>\n                    <td>60-365 days or modern auth</td>\n                    <td class=\"$(if(($DomainPolicy.MaxPasswordAge -ge 60 -and $DomainPolicy.MaxPasswordAge -le 365) -or $DomainPolicy.MaxPasswordAge -eq 0){'compliant'}else{'non-compliant'})\">\n                        $(if(($DomainPolicy.MaxPasswordAge -ge 60 -and $DomainPolicy.MaxPasswordAge -le 365) -or $DomainPolicy.MaxPasswordAge -eq 0){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Password History Count</td>\n                    <td>$($DomainPolicy.PasswordHistoryCount) passwords</td>\n                    <td>12+ passwords</td>\n                    <td class=\"$(if($DomainPolicy.PasswordHistoryCount -ge 12){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.PasswordHistoryCount -ge 12){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Account Lockout Threshold</td>\n                    <td>$($DomainPolicy.LockoutThreshold) attempts</td>\n                    <td>5-10 attempts</td>\n                    <td class=\"$(if($DomainPolicy.LockoutThreshold -ge 5 -and $DomainPolicy.LockoutThreshold -le 10){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.LockoutThreshold -ge 5 -and $DomainPolicy.LockoutThreshold -le 10){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Lockout Duration</td>\n                    <td>$($DomainPolicy.LockoutDuration) minutes</td>\n                    <td>15-60 minutes</td>\n                    <td class=\"$(if($DomainPolicy.LockoutDuration -ge 15 -and $DomainPolicy.LockoutDuration -le 60){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.LockoutDuration -ge 15 -and $DomainPolicy.LockoutDuration -le 60){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Reset Account Lockout Counter</td>\n                    <td>$($DomainPolicy.LockoutObservationWindow) minutes</td>\n                    <td>‚â• Lockout Duration ($($DomainPolicy.LockoutDuration) min)</td>\n                    <td class=\"$(if($DomainPolicy.LockoutObservationWindow -ge $DomainPolicy.LockoutDuration){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.LockoutObservationWindow -ge $DomainPolicy.LockoutDuration){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Reversible Encryption</td>\n                    <td>$($DomainPolicy.ReversibleEncryptionEnabled)</td>\n                    <td>Disabled (CRITICAL)</td>\n                    <td class=\"$(if(-not $DomainPolicy.ReversibleEncryptionEnabled){'compliant'}else{'non-compliant'})\">\n                        $(if(-not $DomainPolicy.ReversibleEncryptionEnabled){'‚úì Compliant'}else{'üî• CRITICAL NON-COMPLIANT'})\n                    </td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n\n    <div class=\"section\">\n        <h2>Comprehensive Privileged Group Analysis</h2>\n        <p>Analysis of ALL privileged groups with recursive nested membership support:</p>\n        \n        <h3>Privileged Group Summary</h3>\n        <div class=\"chart-container\">\n            <div class=\"chart-item\">\n                <h4>Group Membership Distribution</h4>\n\"@\n\n    # Calculate group distributions\n    $DomainAdminsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Domain Admins*\" }).Count\n    $EnterpriseAdminsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Enterprise Admins*\" }).Count\n    $SchemaAdminsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Schema Admins*\" }).Count\n    $AdministratorsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Administrators*\" }).Count\n    \n    $HTML += @\"\n                <p><strong>Domain Admins:</strong> $DomainAdminsCount</p>\n                <p><strong>Enterprise Admins:</strong> $EnterpriseAdminsCount</p>\n                <p><strong>Schema Admins:</strong> $SchemaAdminsCount</p>\n                <p><strong>Administrators:</strong> $AdministratorsCount</p>\n            </div>\n            <div class=\"chart-item\">\n                <h4>Risk Assessment Summary</h4>\n                <p><strong>Total Privileged Accounts:</strong> $($PrivilegedAccounts.Count)</p>\n                <p><strong>High Risk Accounts:</strong> $(($PrivilegedAccounts | Where-Object { $_.Risk -eq 'High' -or $_.Risk -eq 'Critical' }).Count)</p>\n                <p><strong>Stale Accounts (90+ days):</strong> $($StalePrivileged.Count)</p>\n                <p><strong>Never Logged On:</strong> $($NeverLoggedOn.Count)</p>\n            </div>\n        </div>\n        \n        <table>\n            <thead>\n                <tr>\n                    <th>Account Name</th>\n                    <th>Display Name</th>\n                    <th>All Privileged Groups</th>\n                    <th>Enabled</th>\n                    <th>Last Logon</th>\n                    <th>Password Age (Days)</th>\n                    <th>Risk Factors</th>\n                    <th>Risk Level</th>\n                </tr>\n            </thead>\n            <tbody>\n\"@\n\n    foreach ($Account in $PrivilegedAccounts) {\n        $RiskColor = switch ($Account.Risk) {\n            'Critical' { '#dc3545' }\n            'High' { '#fd7e14' }\n            'Medium' { '#ffc107' }\n            'Low' { '#28a745' }\n            default { '#17a2b8' }\n        }\n        \n        $LastLogon = if ($Account.LastLogonDate -eq \"Never\") { \"Never\" } else { $Account.LastLogonDate.ToString(\"yyyy-MM-dd\") }\n        $RiskFactorsDisplay = if ($Account.RiskFactors -eq \"\") { \"None\" } else { $Account.RiskFactors }\n        \n        $HTML += @\"\n<tr>\n    <td>$($Account.SamAccountName)</td>\n    <td>$($Account.Name)</td>\n    <td style=\"font-size: 9px;\">$($Account.AllPrivilegedGroups)</td>\n    <td>$($Account.Enabled)</td>\n    <td>$LastLogon</td>\n    <td>$($Account.DaysSincePasswordChange)</td>\n    <td style=\"font-size: 9px;\">$RiskFactorsDisplay</td>\n    <td><span style=\"color: $RiskColor; font-weight: bold;\">$($Account.Risk.ToUpper())</span></td>\n</tr>\n\"@\n    }\n\n    $HTML += @\"\n            </tbody>\n        </table>\n    </div>\n\n    <div class=\"section\">\n        <h2>Security Compliance Issues and Recommendations</h2>\n\"@\n    \n    if ($PolicyCompliance.Issues.Count -eq 0) {\n        $HTML += \"<div class='risk-low'><p><strong>‚úì Excellent:</strong> No policy compliance issues identified. Current configuration aligns with Microsoft security baselines and NIST SP 800-63B guidelines.</p></div>\"\n    }\n    else {\n        foreach ($Issue in $PolicyCompliance.Issues) {\n            $RiskClass = \"risk-$($Issue.Risk.ToLower())\"\n            $HTML += @\"\n        <div class=\"$RiskClass no-break\">\n            <h4>$($Issue.Issue) <span class=\"risk-badge\">$($Issue.Risk.ToUpper())</span></h4>\n            <p><strong>Recommendation:</strong> $($Issue.Recommendation)</p>\n            <p><strong>Best Practice:</strong> $($Issue.BestPractice)</p>\n        </div>\n\"@\n        }\n    }\n\n    # Add Fine-Grained Password Policies section if any exist\n    if ($FGPPs.Count -gt 0) {\n        $HTML += @\"\n    </div>\n\n    <div class=\"section\">\n        <h2>Fine-Grained Password Policies Analysis</h2>\n        <p>The following fine-grained password policies are configured in the domain:</p>\n        <table>\n            <thead>\n                <tr>\n                    <th>Policy Name</th>\n                    <th>Precedence</th>\n                    <th>Min Length</th>\n                    <th>Complexity</th>\n                    <th>Max Age (Days)</th>\n                    <th>Min Age (Days)</th>\n                    <th>Lockout Threshold</th>\n                    <th>Applies To</th>\n                </tr>\n            </thead>\n            <tbody>\n\"@\n        foreach ($FGPP in $FGPPs) {\n            $HTML += \"<tr><td>$($FGPP.Name)</td><td>$($FGPP.Precedence)</td><td>$($FGPP.MinPasswordLength)</td><td>$($FGPP.ComplexityEnabled)</td><td>$($FGPP.MaxPasswordAge)</td><td>$($FGPP.MinPasswordAge)</td><td>$($FGPP.LockoutThreshold)</td><td style='font-size: 9px;'>$($FGPP.AppliesTo)</td></tr>\"\n        }\n        $HTML += @\"\n            </tbody>\n        </table>\n\"@\n    }\n\n    $HTML += @\"\n    </div>\n\n    <div class=\"section\">\n        <h2>Risk Assessment Summary</h2>\n        \n        <div class=\"chart-container\">\n            <div class=\"chart-item\">\n                <h4>Policy Compliance Risk Distribution</h4>\n\"@\n\n    $TotalIssues = $PolicyCompliance.Issues.Count\n    if ($TotalIssues -gt 0) {\n        $CriticalCount = ($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Critical' }).Count\n        $HighCount = ($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'High' }).Count\n        $MediumCount = ($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Medium' }).Count\n        $LowCount = ($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Low' }).Count\n        \n        $HTML += @\"\n                <p><span style=\"color: #dc3545;\">‚óè Critical:</span> $CriticalCount ($([math]::Round(($CriticalCount/$TotalIssues)*100,1))%)</p>\n                <p><span style=\"color: #fd7e14;\">‚óè High:</span> $HighCount ($([math]::Round(($HighCount/$TotalIssues)*100,1))%)</p>\n                <p><span style=\"color: #ffc107;\">‚óè Medium:</span> $MediumCount ($([math]::Round(($MediumCount/$TotalIssues)*100,1))%)</p>\n                <p><span style=\"color: #28a745;\">‚óè Low:</span> $LowCount ($([math]::Round(($LowCount/$TotalIssues)*100,1))%)</p>\n\"@\n    } else {\n        $HTML += \"<p style='color: #28a745; font-weight: bold;'>‚úì No compliance issues identified</p>\"\n    }\n\n    $HTML += @\"\n            </div>\n            <div class=\"chart-item\">\n                <h4>Overall Security Posture</h4>\n                <p><strong>Compliance Score:</strong> $((100-$PolicyCompliance.RiskScore))/100</p>\n                <p><strong>Risk Level:</strong> <span style=\"color: $(\n                    switch ($PolicyCompliance.RiskLevel) {\n                        'Critical' { '#dc3545' }\n                        'High' { '#fd7e14' }\n                        'Medium' { '#ffc107' }\n                        'Low' { '#28a745' }\n                        default { '#17a2b8' }\n                    }\n                );\">$($PolicyCompliance.RiskLevel.ToUpper())</span></p>\n                <p><strong>Total Issues:</strong> $($PolicyCompliance.Issues.Count)</p>\n                <p><strong>Privileged Accounts:</strong> $($PrivilegedAccounts.Count)</p>\n                <p><strong>Stale Privileged:</strong> $($StalePrivileged.Count)</p>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"section\">\n        <h2>Strategic Recommendations and Implementation Roadmap</h2>\n        \n        <div class=\"recommendation\">\n            <h4>üö® IMMEDIATE ACTIONS REQUIRED (0-30 days)</h4>\n            <ul>\n\"@\n\n    # Add specific immediate recommendations\n    if ($CriticalIssues.Count -gt 0) {\n        $HTML += \"<li><strong>CRITICAL PRIORITY:</strong> Immediately address $($CriticalIssues.Count) critical security issues identified in this assessment</li>\"\n    }\n    \n    if ($StalePrivileged.Count -gt 0) {\n        $HTML += \"<li><strong>HIGH PRIORITY:</strong> Review and disable $($StalePrivileged.Count) stale privileged accounts that haven't been used in 90+ days</li>\"\n    }\n    \n    if ($NeverLoggedOn.Count -gt 0) {\n        $HTML += \"<li><strong>HIGH PRIORITY:</strong> Review $($NeverLoggedOn.Count) privileged accounts that have never been used</li>\"\n    }\n    \n    if ($DomainPolicy.MinPasswordLength -lt 14) {\n        $HTML += \"<li>Increase minimum password length requirement to 14+ characters per NIST SP 800-63B guidelines</li>\"\n    }\n    \n    if (-not $DomainPolicy.ComplexityEnabled) {\n        $HTML += \"<li>Enable password complexity requirements to strengthen password security</li>\"\n    }\n\n    if ($DomainPolicy.LockoutThreshold -eq 0) {\n        $HTML += \"<li>Implement account lockout protection with 5-10 failed attempt threshold to prevent brute force attacks</li>\"\n    }\n\n    if ($DomainPolicy.ReversibleEncryptionEnabled) {\n        $HTML += \"<li><strong>CRITICAL:</strong> Disable reversible encryption immediately - passwords are stored in plain text equivalent</li>\"\n    }\n\n    $HTML += @\"\n            </ul>\n        </div>\n        \n        <div class=\"recommendation\">\n            <h4>üìà SHORT-TERM IMPROVEMENTS (1-3 months)</h4>\n            <ul>\n                <li>Deploy multi-factor authentication (MFA) for all privileged accounts across all groups</li>\n                <li>Implement Privileged Access Management (PAM) solution for elevated account management</li>\n                <li>Establish monthly privileged account access reviews for all groups (Domain Admins, Enterprise Admins, Schema Admins, Administrators)</li>\n                <li>Deploy advanced monitoring and alerting for privileged account activities</li>\n                <li>Implement Azure AD Password Protection for enhanced password policy enforcement</li>\n                <li>Establish administrative workstation security baselines with privileged access workstations (PAWs)</li>\n                <li>Implement fine-grained password policies for privileged accounts with stricter requirements</li>\n            </ul>\n        </div>\n        \n        <div class=\"recommendation\">\n            <h4>üéØ LONG-TERM STRATEGIC ENHANCEMENTS (3-6 months)</h4>\n            <ul>\n                <li>Deploy Just-In-Time (JIT) administrative access model for all privileged groups</li>\n                <li>Implement Microsoft's enhanced administrative tier model (Tier 0, 1, 2 separation)</li>\n                <li>Establish continuous security monitoring with SIEM integration for privileged account activities</li>\n                <li>Deploy Privileged Identity Management (PIM) for cloud-hybrid environments</li>\n                <li>Implement regular penetration testing and security assessments focusing on privileged escalation</li>\n                <li>Establish comprehensive security awareness training program with privileged user focus</li>\n                <li>Consider migration to Azure AD Premium for advanced security features and conditional access</li>\n                <li>Implement break-glass emergency access procedures with proper monitoring</li>\n            </ul>\n        </div>\n    </div>\n\n    <div class=\"section\">\n        <h2>Compliance Framework Alignment</h2>\n        <p>This assessment aligns with the following industry standards and frameworks:</p>\n        \n        <table>\n            <thead>\n                <tr>\n                    <th>Framework/Standard</th>\n                    <th>Relevant Controls</th>\n                    <th>Compliance Status</th>\n                    <th>Recommendations</th>\n                </tr>\n            </thead>\n            <tbody>\n                <tr>\n                    <td>Microsoft Security Baseline</td>\n                    <td>Password Policy, Privileged Account Management</td>\n                    <td class=\"$(if($PolicyCompliance.RiskScore -lt 40){'compliant'}else{'non-compliant'})\">\n                        $(if($PolicyCompliance.RiskScore -lt 40){'Aligned'}else{'Requires Attention'})\n                    </td>\n                    <td>$(if($PolicyCompliance.RiskScore -ge 40){'Address identified policy gaps'}else{'Maintain current standards'})</td>\n                </tr>\n                <tr>\n                    <td>NIST Cybersecurity Framework</td>\n                    <td>PR.AC-1, PR.AC-4, PR.AC-7, DE.CM-3</td>\n                    <td class=\"$(if($PolicyCompliance.RiskScore -lt 30){'compliant'}else{'non-compliant'})\">\n                        $(if($PolicyCompliance.RiskScore -lt 30){'Compliant'}else{'Partial Compliance'})\n                    </td>\n                    <td>$(if($PolicyCompliance.RiskScore -ge 30){'Enhance detection and protection controls'}else{'Continue monitoring'})</td>\n                </tr>\n                <tr>\n                    <td>NIST SP 800-63B</td>\n                    <td>Password Length, Complexity, Verification</td>\n                    <td class=\"$(if($DomainPolicy.MinPasswordLength -ge 14){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.MinPasswordLength -ge 14){'Compliant'}else{'Non-Compliant'})\n                    </td>\n                    <td>$(if($DomainPolicy.MinPasswordLength -lt 14){'Increase minimum password length to 14+ characters'}else{'Maintain current standards'})</td>\n                </tr>\n                <tr>\n                    <td>CIS Controls v8</td>\n                    <td>Control 5: Account Management, Control 6: Access Control</td>\n                    <td class=\"$(if($StalePrivileged.Count -eq 0){'compliant'}else{'non-compliant'})\">\n                        $(if($StalePrivileged.Count -eq 0){'Compliant'}else{'Improvement Needed'})\n                    </td>\n                    <td>$(if($StalePrivileged.Count -gt 0){'Remove or disable stale privileged accounts'}else{'Continue regular reviews'})</td>\n                </tr>\n                <tr>\n                    <td>ISO 27001:2022</td>\n                    <td>A.9.2.1, A.9.2.2, A.9.4.3, A.18.1.4</td>\n                    <td class=\"$(if($PolicyCompliance.Issues.Count -lt 3){'compliant'}else{'non-compliant'})\">\n                        $(if($PolicyCompliance.Issues.Count -lt 3){'Satisfactory'}else{'Requires Remediation'})\n                    </td>\n                    <td>$(if($PolicyCompliance.Issues.Count -ge 3){'Address policy compliance gaps'}else{'Maintain documentation'})</td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n\n    <div class=\"footer\">\n        <p><strong>First Technology: RMS SECURITY ASSESSMENT REPORT</strong></p>\n        <p>Prepared by: $EngineerName</p>\n        <p>Assessment Tool: AD Security Assessment v11.0 | Generated: $ReportDate</p>\n        <p>Customer: $CustomerName | Domain: $DomainName</p>\n        <p>Next Recommended Review: $(((Get-Date).AddMonths(3)).ToString('yyyy-MM-dd'))</p>\n        <hr>\n        <p style=\"font-size: 8px;\">This report contains sensitive security information and should be distributed only to authorized personnel.\n        Report includes analysis of Domain Admins, Enterprise Admins, Schema Admins, and Administrators groups with recursive membership evaluation.</p>\n    </div>\n\n</body>\n</html>\n\"@\n\n    return $HTML\n}\n\n# New function to generate comprehensive user analysis HTML report\nfunction New-UserAnalysisHTML {\n    param(\n        $UserAnalysis,\n        $CustomerName,\n        $DomainName,\n        $EngineerName\n    )\n    \n    # Calculate user analysis metrics\n    $TotalUsers = $UserAnalysis.Count\n    $EnabledUsers = ($UserAnalysis | Where-Object { $_.Enabled }).Count\n    $DisabledUsers = $TotalUsers - $EnabledUsers\n    $StaleUsers = ($UserAnalysis | Where-Object { $_.DaysSinceLogon -gt 90 -and $_.Enabled }).Count\n    $NeverLoggedOnUsers = ($UserAnalysis | Where-Object { $_.LastLogonDate -eq 'Never' -and $_.Enabled }).Count\n    $PasswordNeverExpiresUsers = ($UserAnalysis | Where-Object { $_.PasswordNeverExpires -and $_.Enabled }).Count\n    $HighRiskUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'High' -or $_.Risk -eq 'Critical' }).Count\n    \n    $CriticalUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'Critical' }).Count\n    $HighUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'High' }).Count\n    $MediumUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'Medium' }).Count\n    $LowUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'Low' }).Count\n    $InfoUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'Info' }).Count\n    \n    $HTML = @\"\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <title>Domain User Analysis Report</title>\n    <style>\n        @page {\n            margin: 0.5in;\n            @top-center {\n                content: \"Domain User Analysis Report\";\n                font-family: 'Segoe UI', sans-serif;\n                font-size: 10px;\n                color: #666;\n            }\n            @bottom-center {\n                content: \"Page \" counter(page) \" of \" counter(pages);\n                font-family: 'Segoe UI', sans-serif;\n                font-size: 10px;\n                color: #666;\n            }\n        }\n        \n        body {\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n            margin: 0;\n            padding: 20px;\n            background-color: white;\n            line-height: 1.4;\n            font-size: 11px;\n        }\n        \n        .header {\n            text-align: center;\n            border-bottom: 3px solid #28a745;\n            padding-bottom: 15px;\n            margin-bottom: 20px;\n        }\n        \n        .customer-name {\n            font-size: 28px;\n            font-weight: bold;\n            color: #28a745;\n            margin-bottom: 5px;\n            text-transform: uppercase;\n        }\n        \n        .report-title {\n            font-size: 18px;\n            font-weight: bold;\n            color: #333;\n            margin-bottom: 15px;\n        }\n        \n        .header-info {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 20px;\n            margin-top: 15px;\n            font-size: 10px;\n        }\n        \n        .section {\n            margin-bottom: 20px;\n            page-break-inside: avoid;\n        }\n        \n        .section h2 {\n            background: linear-gradient(135deg, #28a745 0%, #1e7e34 100%);\n            color: white;\n            padding: 8px 15px;\n            margin: 0 0 10px 0;\n            font-size: 14px;\n            font-weight: bold;\n        }\n        \n        .section h3 {\n            color: #28a745;\n            font-size: 12px;\n            margin: 15px 0 8px 0;\n            border-bottom: 1px solid #ddd;\n            padding-bottom: 3px;\n        }\n        \n        .executive-summary {\n            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);\n            padding: 15px;\n            border-left: 4px solid #28a745;\n            margin-bottom: 20px;\n        }\n        \n        .metrics-grid {\n            display: grid;\n            grid-template-columns: repeat(6, 1fr);\n            gap: 10px;\n            margin: 15px 0;\n        }\n        \n        .metric-card {\n            text-align: center;\n            padding: 12px;\n            background: white;\n            border: 1px solid #ddd;\n            border-radius: 5px;\n        }\n        \n        .metric-value {\n            font-size: 18px;\n            font-weight: bold;\n            color: #28a745;\n        }\n        \n        .metric-label {\n            font-size: 10px;\n            color: #666;\n            margin-top: 5px;\n        }\n        \n        table {\n            width: 100%;\n            border-collapse: collapse;\n            margin: 10px 0;\n            font-size: 9px;\n        }\n        \n        th, td {\n            border: 1px solid #ddd;\n            padding: 4px;\n            text-align: left;\n        }\n        \n        th {\n            background-color: #f8f9fa;\n            font-weight: bold;\n            color: #28a745;\n        }\n        \n        .risk-critical {\n            background-color: #f8d7da;\n            border-left: 4px solid #dc3545;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-high {\n            background-color: #fff3cd;\n            border-left: 4px solid #ffc107;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-medium {\n            background-color: #d1ecf1;\n            border-left: 4px solid #17a2b8;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-low {\n            background-color: #d4edda;\n            border-left: 4px solid #28a745;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .footer {\n            border-top: 2px solid #28a745;\n            padding-top: 15px;\n            margin-top: 30px;\n            text-align: center;\n            font-size: 9px;\n            color: #666;\n        }\n        \n        .chart-container {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 20px;\n            margin: 15px 0;\n        }\n        \n        .chart-item {\n            background: white;\n            border: 1px solid #ddd;\n            padding: 10px;\n            border-radius: 5px;\n        }\n        \n        .progress-bar {\n            width: 100%;\n            height: 15px;\n            background-color: #e9ecef;\n            border-radius: 8px;\n            overflow: hidden;\n            margin: 5px 0;\n        }\n        \n        .progress-fill {\n            height: 100%;\n            border-radius: 8px;\n        }\n        \n        .no-break { page-break-inside: avoid; }\n        \n        .risk-distribution {\n            display: grid;\n            grid-template-columns: repeat(5, 1fr);\n            gap: 10px;\n            margin: 10px 0;\n        }\n        \n        .risk-item {\n            text-align: center;\n            padding: 8px;\n            border-radius: 5px;\n            color: white;\n            font-weight: bold;\n        }\n        \n        .risk-critical-bg { background-color: #dc3545; }\n        .risk-high-bg { background-color: #fd7e14; }\n        .risk-medium-bg { background-color: #ffc107; color: #333; }\n        .risk-low-bg { background-color: #28a745; }\n        .risk-info-bg { background-color: #17a2b8; }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <div class=\"customer-name\">$CustomerName</div>\n        <div class=\"report-title\">Domain User Analysis Report</div>\n        <div style=\"font-size: 12px; color: #28a745; margin-top: 5px;\">Complete Domain User Security Risk Assessment</div>\n        \n        <div class=\"header-info\">\n            <div>\n                <strong>Customer:</strong> $CustomerName<br>\n                <strong>Domain:</strong> $DomainName<br>\n                <strong>Assessment Date:</strong> $((Get-Date).ToString(\"yyyy-MM-dd HH:mm:ss\"))\n            </div>\n            <div>\n                <strong>Assessed By:</strong> $EngineerName<br>\n                <strong>Report Version:</strong> 11.0<br>\n                <strong>Classification:</strong> Domain Security\n            </div>\n        </div>\n    </div>\n\n    <div class=\"executive-summary no-break\">\n        <h2>Executive Summary - Domain User Analysis</h2>\n        <p>This comprehensive user analysis evaluates <strong>all $TotalUsers domain user accounts</strong> for <strong>$CustomerName</strong> to identify password security risks, stale accounts, and potential security threats. The analysis focuses on user account hygiene, password policies, and access patterns to provide actionable security recommendations.</p>\n        \n        <div class=\"metrics-grid\">\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$TotalUsers</div>\n                <div class=\"metric-label\">Total Users</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$EnabledUsers</div>\n                <div class=\"metric-label\">Enabled Users</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$StaleUsers</div>\n                <div class=\"metric-label\">Stale Users (90+ days)</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$NeverLoggedOnUsers</div>\n                <div class=\"metric-label\">Never Logged On</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$PasswordNeverExpiresUsers</div>\n                <div class=\"metric-label\">Password Never Expires</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$HighRiskUsers</div>\n                <div class=\"metric-label\">High Risk Users</div>\n            </div>\n        </div>\n        \n        <div class=\"risk-distribution\">\n            <div class=\"risk-item risk-critical-bg\">\n                <div>$CriticalUsers</div>\n                <div style=\"font-size: 9px;\">CRITICAL</div>\n            </div>\n            <div class=\"risk-item risk-high-bg\">\n                <div>$HighUsers</div>\n                <div style=\"font-size: 9px;\">HIGH</div>\n            </div>\n            <div class=\"risk-item risk-medium-bg\">\n                <div>$MediumUsers</div>\n                <div style=\"font-size: 9px;\">MEDIUM</div>\n            </div>\n            <div class=\"risk-item risk-low-bg\">\n                <div>$LowUsers</div>\n                <div style=\"font-size: 9px;\">LOW</div>\n            </div>\n            <div class=\"risk-item risk-info-bg\">\n                <div>$InfoUsers</div>\n                <div style=\"font-size: 9px;\">INFO</div>\n            </div>\n        </div>\n        \n        <div class=\"chart-container\">\n            <div class=\"chart-item\">\n                <h4>Account Health Status</h4>\n                <div class=\"progress-bar\">\n                    <div class=\"progress-fill\" style=\"width: $(if($TotalUsers -gt 0){[math]::Round(($EnabledUsers/$TotalUsers)*100,0)}else{0})%; background-color: #28a745;\"></div>\n                </div>\n                <small>$(if($TotalUsers -gt 0){[math]::Round(($EnabledUsers/$TotalUsers)*100,0)}else{0})% Enabled Accounts</small>\n            </div>\n            <div class=\"chart-item\">\n                <h4>Security Risk Level</h4>\n                <div class=\"progress-bar\">\n                    <div class=\"progress-fill\" style=\"width: $(if($EnabledUsers -gt 0){[math]::Round((($EnabledUsers-$HighRiskUsers)/$EnabledUsers)*100,0)}else{100})%; background-color: $(if($HighRiskUsers -eq 0){'#28a745'}else{'#ffc107'});\"></div>\n                </div>\n                <small>$(if($EnabledUsers -gt 0){[math]::Round((($EnabledUsers-$HighRiskUsers)/$EnabledUsers)*100,0)}else{100})% Low Risk</small>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"section no-break\">\n        <h2>Critical and High Risk User Accounts</h2>\n        <p>Immediate attention required for the following high-risk user accounts:</p>\n\"@\n\n    $HighRiskAccounts = $UserAnalysis | Where-Object { $_.Risk -eq 'Critical' -or $_.Risk -eq 'High' } | Sort-Object RiskScore -Descending\n\n    if ($HighRiskAccounts.Count -eq 0) {\n        $HTML += \"<div class='risk-low'><p><strong>‚úì Excellent:</strong> No critical or high-risk user accounts identified.</p></div>\"\n    } else {\n        $HTML += @\"\n        <table>\n            <thead>\n                <tr>\n                    <th>Account Name</th>\n                    <th>Display Name</th>\n                    <th>User Type</th>\n                    <th>Enabled</th>\n                    <th>Last Logon</th>\n                    <th>Password Age (Days)</th>\n                    <th>Risk Factors</th>\n                    <th>Risk</th>\n                </tr>\n            </thead>\n            <tbody>\n\"@\n        \n        foreach ($User in $HighRiskAccounts) {\n            $RiskColor = switch ($User.Risk) {\n                'Critical' { '#dc3545' }\n                'High' { '#fd7e14' }\n                default { '#ffc107' }\n            }\n            \n            $HTML += @\"\n<tr>\n    <td>$($User.SamAccountName)</td>\n    <td>$($User.Name)</td>\n    <td>$($User.UserType)</td>\n    <td>$($User.Enabled)</td>\n    <td>$($User.LastLogonDate)</td>\n    <td>$($User.DaysSincePasswordChange)</td>\n    <td style=\"font-size: 8px;\">$($User.RiskFactors)</td>\n    <td><span style=\"color: $RiskColor; font-weight: bold;\">$($User.Risk.ToUpper())</span></td>\n</tr>\n\"@\n        }\n        \n        $HTML += \"</tbody></table>\"\n    }\n\n    $HTML += @\"\n    </div>\n\n    <div class=\"section\">\n        <h2>Stale Account Analysis</h2>\n        <p>Analysis of accounts that haven't been used recently (potential security risks):</p>\n        \n        <div class=\"chart-container\">\n            <div class=\"chart-item\">\n                <h4>Stale Account Categories</h4>\n                <p><strong>1+ Year Stale:</strong> $(($UserAnalysis | Where-Object { $_.DaysSinceLogon -gt 365 -and $_.Enabled }).Count)</p>\n                <p><strong>6+ Months Stale:</strong> $(($UserAnalysis | Where-Object { $_.DaysSinceLogon -gt 180 -and $_.DaysSinceLogon -le 365 -and $_.Enabled }).Count)</p>\n                <p><strong>3+ Months Stale:</strong> $(($UserAnalysis | Where-Object { $_.DaysSinceLogon -gt 90 -and $_.DaysSinceLogon -le 180 -and $_.Enabled }).Count)</p>\n                <p><strong>Never Logged On:</strong> $NeverLoggedOnUsers</p>\n            </div>\n            <div class=\"chart-item\">\n                <h4>Password Security Issues</h4>\n                <p><strong>Password Never Expires:</strong> $PasswordNeverExpiresUsers</p>\n                <p><strong>Password 1+ Year Old:</strong> $(($UserAnalysis | Where-Object { $_.DaysSincePasswordChange -gt 365 -and $_.Enabled }).Count)</p>\n                <p><strong>Password Never Set:</strong> $(($UserAnalysis | Where-Object { $_.PasswordLastSet -eq 'Never' -and $_.Enabled }).Count)</p>\n                <p><strong>Failed Logon Attempts:</strong> $(($UserAnalysis | Where-Object { $_.BadLogonCount -gt 0 }).Count)</p>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"section\">\n        <h2>User Account Recommendations</h2>\n        \n        <div class=\"risk-critical\">\n            <h4>üö® IMMEDIATE ACTIONS REQUIRED</h4>\n            <ul>\n\"@\n\n    if ($CriticalUsers -gt 0) {\n        $HTML += \"<li><strong>CRITICAL PRIORITY:</strong> Review and remediate $CriticalUsers accounts with critical security risks</li>\"\n    }\n    \n    if ($HighUsers -gt 0) {\n        $HTML += \"<li><strong>HIGH PRIORITY:</strong> Address $HighUsers accounts with high security risks</li>\"\n    }\n    \n    if ($NeverLoggedOnUsers -gt 0) {\n        $HTML += \"<li>Review $NeverLoggedOnUsers enabled accounts that have never been used - consider disabling</li>\"\n    }\n    \n    if ($StaleUsers -gt 0) {\n        $HTML += \"<li>Audit $StaleUsers stale accounts (90+ days inactive) for potential deactivation</li>\"\n    }\n\n    $HTML += @\"\n            </ul>\n        </div>\n        \n        <div class=\"risk-medium\">\n            <h4>üìã MEDIUM PRIORITY ACTIONS</h4>\n            <ul>\n                <li>Implement automated account lifecycle management processes</li>\n                <li>Establish quarterly user access reviews with managers</li>\n                <li>Deploy user activity monitoring for anomaly detection</li>\n                <li>Implement self-service password reset capabilities</li>\n                <li>Review and update password policies based on user behavior patterns</li>\n            </ul>\n        </div>\n        \n        <div class=\"risk-low\">\n            <h4>üéØ LONG-TERM IMPROVEMENTS</h4>\n            <ul>\n                <li>Deploy advanced threat protection for user accounts</li>\n                <li>Implement risk-based authentication policies</li>\n                <li>Establish comprehensive user security training programs</li>\n                <li>Deploy privileged access management for elevated operations</li>\n                <li>Implement continuous compliance monitoring</li>\n            </ul>\n        </div>\n    </div>\n\n    <div class=\"footer\">\n        <p><strong>CONFIDENTIAL USER ANALYSIS REPORT</strong></p>\n        <p>Prepared by: $EngineerName</p>\n        <p>Assessment Tool: User Analysis v11.0 | Generated: $((Get-Date).ToString(\"yyyy-MM-dd HH:mm:ss\"))</p>\n        <p>Customer: $CustomerName | Domain: $DomainName | Users Analyzed: $TotalUsers</p>\n        <p>Next Recommended Review: $(((Get-Date).AddMonths(6)).ToString('yyyy-MM-dd'))</p>\n        <hr>\n        <p style=\"font-size: 8px;\">This user analysis report contains sensitive security information and should be distributed only to authorized personnel.</p>\n    </div>\n\n</body>\n</html>\n\"@\n\n    return $HTML\n}\n\n# Function to convert HTML to PDF using system tools\nfunction Convert-HTMLToPDF {\n    param(\n        [string]$HTMLPath,\n        [string]$PDFPath\n    )\n    \n    Write-Host \"Converting HTML to PDF...\" -ForegroundColor Yellow\n    \n    try {\n        # Try using Microsoft Edge (if available)\n        $EdgePath = \"${env:ProgramFiles(x86)}\\Microsoft\\Edge\\Application\\msedge.exe\"\n        if (-not (Test-Path $EdgePath)) {\n            $EdgePath = \"${env:ProgramFiles}\\Microsoft\\Edge\\Application\\msedge.exe\"\n        }\n        \n        if (Test-Path $EdgePath) {\n            Write-Host \"Using Microsoft Edge for PDF conversion...\" -ForegroundColor Green\n            $Arguments = @(\n                \"--headless\"\n                \"--disable-gpu\"\n                \"--run-all-compositor-stages-before-draw\"\n                \"--disable-extensions\"\n                \"--disable-plugins\"\n                \"--no-sandbox\"\n                \"--print-to-pdf=`\"$PDFPath`\"\"\n                \"`\"$HTMLPath`\"\"\n            )\n            \n            Start-Process -FilePath $EdgePath -ArgumentList $Arguments -Wait -NoNewWindow\n            \n            if (Test-Path $PDFPath) {\n                Write-Host \"PDF generated successfully using Edge!\" -ForegroundColor Green\n                return $true\n            }\n        }\n        \n        # Fallback: Try Chrome\n        $ChromePaths = @(\n            \"${env:ProgramFiles}\\Google\\Chrome\\Application\\chrome.exe\",\n            \"${env:ProgramFiles(x86)}\\Google\\Chrome\\Application\\chrome.exe\",\n            \"${env:LOCALAPPDATA}\\Google\\Chrome\\Application\\chrome.exe\"\n        )\n        \n        $ChromePath = $ChromePaths | Where-Object { Test-Path $_ } | Select-Object -First 1\n        \n        if ($ChromePath) {\n            Write-Host \"Using Google Chrome for PDF conversion...\" -ForegroundColor Green\n            $Arguments = @(\n                \"--headless\"\n                \"--disable-gpu\"\n                \"--run-all-compositor-stages-before-draw\"\n                \"--print-to-pdf=`\"$PDFPath`\"\"\n                \"`\"$HTMLPath`\"\"\n            )\n            \n            Start-Process -FilePath $ChromePath -ArgumentList $Arguments -Wait -NoNewWindow\n            \n            if (Test-Path $PDFPath) {\n                Write-Host \"PDF generated successfully using Chrome!\" -ForegroundColor Green\n                return $true\n            }\n        }\n        \n        Write-Warning \"No suitable PDF converter found. HTML report will be available for manual conversion.\"\n        return $false\n        \n    }\n    catch {\n        Write-Warning \"PDF conversion failed: $($_.Exception.Message)\"\n        return $false\n    }\n}\n\n# Main execution\ntry {\n    $StartTime = Get-Date\n    \n    # Ensure output directory exists\n    $OutputDir = Split-Path $OutputPathPDF -Parent\n    if (-not (Test-Path $OutputDir)) {\n        New-Item -Path $OutputDir -ItemType Directory -Force | Out-Null\n        Write-Host \"Created output directory: $OutputDir\" -ForegroundColor Green\n    }\n\n    # Gather enhanced assessment data\n    Write-Host \"\"\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Yellow\n    Write-Host \"                            GATHERING ASSESSMENT DATA\" -ForegroundColor Yellow\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Yellow\n    \n    $DomainServer = if ($Domain.DNSRoot -ne (Get-ADDomain).DNSRoot) { $Domain.DNSRoot } else { $null }\n    $DomainPolicy = Get-DomainPasswordPolicy -DomainServer $DomainServer\n    $FGPPs = Get-FineGrainedPolicies -DomainServer $DomainServer\n    $PolicyCompliance = Test-PolicyCompliance -Policy $DomainPolicy\n    $PrivilegedAccounts = Get-AllPrivilegedAccounts -DomainServer $DomainServer\n    \n    Write-Host \"\"\n    Write-Host \"Starting comprehensive domain user analysis...\" -ForegroundColor Yellow\n    $UserAnalysis = Get-DomainUserAnalysis -DomainServer $DomainServer\n\n    # Generate Main Security Assessment Report\n    Write-Host \"\"\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Green\n    Write-Host \"                        GENERATING SECURITY ASSESSMENT REPORT\" -ForegroundColor Green\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Green\n    \n    Write-Host \"Generating security assessment HTML report...\" -ForegroundColor Yellow\n    $SecurityHTMLContent = New-SecurityAssessmentHTML -DomainPolicy $DomainPolicy -FGPPs $FGPPs -PolicyCompliance $PolicyCompliance -PrivilegedAccounts $PrivilegedAccounts -CustomerName $CustomerName -DomainName $DomainName -EngineerName $EngineerName\n    $SecurityHTMLContent | Out-File -FilePath $OutputPathHTML -Encoding UTF8\n\n    # Convert Security Assessment to PDF\n    $SecurityPDFCreated = Convert-HTMLToPDF -HTMLPath $OutputPathHTML -PDFPath $OutputPathPDF\n    \n    # Generate User Analysis Report\n    Write-Host \"\"\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Green\n    Write-Host \"                         GENERATING USER ANALYSIS REPORT\" -ForegroundColor Green\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Green\n    \n    Write-Host \"Generating comprehensive user analysis HTML report...\" -ForegroundColor Yellow\n    $UserHTMLContent = New-UserAnalysisHTML -UserAnalysis $UserAnalysis -CustomerName $CustomerName -DomainName $DomainName -EngineerName $EngineerName\n    $UserHTMLContent | Out-File -FilePath $OutputPathUserHTML -Encoding UTF8\n\n    # Convert User Analysis to PDF\n    $UserPDFCreated = Convert-HTMLToPDF -HTMLPath $OutputPathUserHTML -PDFPath $OutputPathUserPDF\n    \n    # Export comprehensive data to CSV\n    Write-Host \"Exporting comprehensive assessment data to CSV...\" -ForegroundColor Yellow\n    $AllData = @()\n    \n    # Add policy compliance data\n    foreach ($Issue in $PolicyCompliance.Issues) {\n        $AllData += [PSCustomObject]@{\n            'Assessment_Date' = $ReportDate\n            'Customer' = $CustomerName\n            'Domain' = $DomainName\n            'Category' = 'Policy Compliance'\n            'Finding' = $Issue.Issue\n            'Risk_Level' = $Issue.Risk\n            'Recommendation' = $Issue.Recommendation\n            'Best_Practice' = $Issue.BestPractice\n            'Status' = 'Non-Compliant'\n            'Account_Name' = 'N/A'\n            'Account_Type' = 'N/A'\n        }\n    }\n    \n    # Add privileged account data\n    foreach ($Account in $PrivilegedAccounts) {\n        $AllData += [PSCustomObject]@{\n            'Assessment_Date' = $ReportDate\n            'Customer' = $CustomerName\n            'Domain' = $DomainName\n            'Category' = 'Privileged Account'\n            'Finding' = \"$($Account.SamAccountName) - $($Account.Name)\"\n            'Risk_Level' = $Account.Risk\n            'Recommendation' = switch ($Account.Risk) {\n                'Critical' { 'Immediate attention required - critical security risk' }\n                'High' { 'Review account usage and disable if unused' }\n                'Medium' { 'Monitor regularly and consider access review' }\n                default { 'Continue monitoring with regular reviews' }\n            }\n            'Best_Practice' = 'Regular review of privileged accounts with quarterly access assessments'\n            'Status' = if ($Account.Enabled) { 'Enabled' } else { 'Disabled' }\n            'Account_Name' = $Account.SamAccountName\n            'Account_Type' = 'Privileged'\n        }\n    }\n    \n    # Add high-risk user data (only Critical and High risk to keep CSV manageable)\n    $HighRiskUsers = $UserAnalysis | Where-Object { $_.Risk -eq 'Critical' -or $_.Risk -eq 'High' }\n    foreach ($User in $HighRiskUsers) {\n        $AllData += [PSCustomObject]@{\n            'Assessment_Date' = $ReportDate\n            'Customer' = $CustomerName\n            'Domain' = $DomainName\n            'Category' = 'High Risk User'\n            'Finding' = \"$($User.SamAccountName) - $($User.Name)\"\n            'Risk_Level' = $User.Risk\n            'Recommendation' = switch ($User.Risk) {\n                'Critical' { 'Immediate review and remediation required' }\n                'High' { 'Review account and address security risks' }\n                default { 'Monitor and review regularly' }\n            }\n            'Best_Practice' = 'Regular user access reviews and account lifecycle management'\n            'Status' = if ($User.Enabled) { 'Enabled' } else { 'Disabled' }\n            'Account_Name' = $User.SamAccountName\n            'Account_Type' = $User.UserType\n        }\n    }\n    \n    $AllData | Export-Csv -Path $OutputPathCSV -NoTypeInformation\n\n    # Display comprehensive results\n    Clear-Host\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Green\n    Write-Host \"                 ACTIVE DIRECTORY SECURITY ASSESSMENT COMPLETED\" -ForegroundColor Green\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Green\n    Write-Host \"\"\n    \n    Write-Host \"üìä ASSESSMENT SUMMARY\" -ForegroundColor Cyan\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    Write-Host \"Customer:                 $CustomerName\" -ForegroundColor White\n    Write-Host \"Domain:                   $DomainName\" -ForegroundColor White\n    Write-Host \"Assessed By:              $EngineerName\" -ForegroundColor White\n    Write-Host \"Assessment Date:          $ReportDate\" -ForegroundColor White\n    Write-Host \"Assessment Duration:      $([math]::Round(((Get-Date) - $StartTime).TotalMinutes, 1)) minutes\" -ForegroundColor White\n    Write-Host \"\"\n    \n    Write-Host \"üö® SECURITY RISK ANALYSIS\" -ForegroundColor Yellow\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    Write-Host \"Overall Risk Level:       $($PolicyCompliance.RiskLevel)\" -ForegroundColor $(\n        switch ($PolicyCompliance.RiskLevel) {\n            'Critical' { 'Red' }\n            'High' { 'Red' }\n            'Medium' { 'Yellow' }\n            'Low' { 'Green' }\n            default { 'Cyan' }\n        }\n    )\n    Write-Host \"Policy Risk Score:        $($PolicyCompliance.RiskScore)/100\" -ForegroundColor White\n    Write-Host \"Policy Compliance:        $((100-$PolicyCompliance.RiskScore))/100\" -ForegroundColor $(if((100-$PolicyCompliance.RiskScore) -ge 70){'Green'}else{'Red'})\n    Write-Host \"Policy Issues Found:      $($PolicyCompliance.Issues.Count)\" -ForegroundColor $(if($PolicyCompliance.Issues.Count -eq 0){'Green'}else{'Red'})\n    Write-Host \"\"\n    \n    Write-Host \"üë• PRIVILEGED ACCOUNT ANALYSIS\" -ForegroundColor Magenta\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    Write-Host \"Total Privileged Accounts: $($PrivilegedAccounts.Count)\" -ForegroundColor White\n    \n    $DomainAdminsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Domain Admins*\" }).Count\n    $EnterpriseAdminsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Enterprise Admins*\" }).Count\n    $SchemaAdminsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Schema Admins*\" }).Count\n    $AdministratorsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Administrators*\" }).Count\n    \n    Write-Host \"  Domain Admins:          $DomainAdminsCount\" -ForegroundColor Cyan\n    Write-Host \"  Enterprise Admins:      $EnterpriseAdminsCount\" -ForegroundColor Cyan\n    Write-Host \"  Schema Admins:          $SchemaAdminsCount\" -ForegroundColor Cyan\n    Write-Host \"  Administrators:         $AdministratorsCount\" -ForegroundColor Cyan\n    Write-Host \"\"\n    \n    $StalePrivileged = $PrivilegedAccounts | Where-Object { $_.DaysSinceLogon -gt 90 -and $_.Enabled }\n    $HighRiskPrivileged = $PrivilegedAccounts | Where-Object { $_.Risk -eq 'High' -or $_.Risk -eq 'Critical' }\n    $NeverLoggedOnPrivileged = $PrivilegedAccounts | Where-Object { $_.LastLogonDate -eq 'Never' }\n    \n    Write-Host \"Stale Privileged (90+ days): $($StalePrivileged.Count)\" -ForegroundColor $(if($StalePrivileged.Count -eq 0){'Green'}else{'Red'})\n    Write-Host \"High-Risk Privileged:     $($HighRiskPrivileged.Count)\" -ForegroundColor $(if($HighRiskPrivileged.Count -eq 0){'Green'}else{'Red'})\n    Write-Host \"Never Used Privileged:    $($NeverLoggedOnPrivileged.Count)\" -ForegroundColor $(if($NeverLoggedOnPrivileged.Count -eq 0){'Green'}else{'Red'})\n    Write-Host \"\"\n    \n    Write-Host \"üë§ DOMAIN USER ANALYSIS\" -ForegroundColor Blue\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    \n    $TotalUsers = $UserAnalysis.Count\n    $EnabledUsers = ($UserAnalysis | Where-Object { $_.Enabled }).Count\n    $StaleUsers = ($UserAnalysis | Where-Object { $_.DaysSinceLogon -gt 90 -and $_.Enabled }).Count\n    $NeverLoggedOnUsers = ($UserAnalysis | Where-Object { $_.LastLogonDate -eq 'Never' -and $_.Enabled }).Count\n    $HighRiskUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'High' -or $_.Risk -eq 'Critical' }).Count\n    $CriticalUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'Critical' }).Count\n    \n    Write-Host \"Total Domain Users:       $TotalUsers\" -ForegroundColor White\n    Write-Host \"Enabled Users:            $EnabledUsers\" -ForegroundColor White\n    Write-Host \"Stale Users (90+ days):   $StaleUsers\" -ForegroundColor $(if($StaleUsers -eq 0){'Green'}else{'Yellow'})\n    Write-Host \"Never Logged On Users:    $NeverLoggedOnUsers\" -ForegroundColor $(if($NeverLoggedOnUsers -eq 0){'Green'}else{'Yellow'})\n    Write-Host \"High-Risk Users:          $HighRiskUsers\" -ForegroundColor $(if($HighRiskUsers -eq 0){'Green'}else{'Red'})\n    Write-Host \"Critical Risk Users:      $CriticalUsers\" -ForegroundColor $(if($CriticalUsers -eq 0){'Green'}else{'Red'})\n    Write-Host \"\"\n    \n    Write-Host \"‚ö†Ô∏è  CRITICAL FINDINGS\" -ForegroundColor Red\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    $CriticalIssues = $PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Critical' }\n    if ($CriticalIssues.Count -eq 0 -and $CriticalUsers -eq 0 -and $HighRiskPrivileged.Count -eq 0) {\n        Write-Host \"‚úÖ No critical security issues identified\" -ForegroundColor Green\n    } else {\n        if ($CriticalIssues.Count -gt 0) {\n            Write-Host \"üî• Policy Issues:\" -ForegroundColor Red\n            foreach ($Issue in $CriticalIssues) {\n                Write-Host \"   ‚Ä¢ $($Issue.Issue)\" -ForegroundColor Red\n            }\n        }\n        if ($CriticalUsers -gt 0) {\n            Write-Host \"üî• $CriticalUsers critical risk user accounts require immediate attention\" -ForegroundColor Red\n        }\n        if ($HighRiskPrivileged.Count -gt 0) {\n            Write-Host \"üî• $($HighRiskPrivileged.Count) high-risk privileged accounts require review\" -ForegroundColor Red\n        }\n    }\n    \n    Write-Host \"\"\n    Write-Host \"üìÑ GENERATED REPORTS\" -ForegroundColor Green\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    \n    if ($SecurityPDFCreated) {\n        Write-Host \"‚úÖ Security Assessment PDF:  $OutputPathPDF\" -ForegroundColor Green\n    } else {\n        Write-Host \"‚ö†Ô∏è  Security PDF Failed:     Manual conversion required\" -ForegroundColor Yellow\n    }\n    Write-Host \"‚úÖ Security HTML Report:     $OutputPathHTML\" -ForegroundColor Green\n    \n    if ($UserPDFCreated) {\n        Write-Host \"‚úÖ User Analysis PDF:        $OutputPathUserPDF\" -ForegroundColor Green\n    } else {\n        Write-Host \"‚ö†Ô∏è  User Analysis PDF Failed: Manual conversion required\" -ForegroundColor Yellow\n    }\n    Write-Host \"‚úÖ User Analysis HTML:       $OutputPathUserHTML\" -ForegroundColor Green\n    Write-Host \"‚úÖ Comprehensive CSV Data:   $OutputPathCSV\" -ForegroundColor Green\n    \n    Write-Host \"\"\n    Write-Host \"üéØ RECOMMENDED NEXT STEPS\" -ForegroundColor Magenta\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    Write-Host \"1. Review both comprehensive reports with customer stakeholders\" -ForegroundColor White\n    Write-Host \"2. Address Critical and High-risk findings within 30 days\" -ForegroundColor White\n    Write-Host \"3. Implement privileged account management improvements\" -ForegroundColor White\n    Write-Host \"4. Establish user lifecycle management processes\" -ForegroundColor White\n    Write-Host \"5. Schedule quarterly follow-up assessments\" -ForegroundColor White\n    \n    # N-Central Summary and Exit Handling (Do not open reports automatically)\n    Write-NCentralLog \"\"\n    Write-NCentralLog \"N-Central Assessment Completed Successfully\" -Level \"Success\"\n    Write-NCentralLog \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\"\n    Write-NCentralLog \"Customer: $CustomerName | Domain: $DomainName | Engineer: $EngineerName\" -Level \"Info\"\n    Write-NCentralLog \"Assessment Duration: $([math]::Round(((Get-Date) - $StartTime).TotalMinutes, 1)) minutes\" -Level \"Info\"\n    Write-NCentralLog \"Overall Risk Level: $($PolicyCompliance.RiskLevel) | Risk Score: $($PolicyCompliance.RiskScore)/100\" -Level \"Info\"\n    Write-NCentralLog \"Total Users: $TotalUsers | Privileged Accounts: $($PrivilegedAccounts.Count) | High Risk Users: $HighRiskUsers\" -Level \"Info\"\n    \n    # Create N-Central summary file\n    try {\n        $ncentralSummaryPath = \"C:\\Temp\\NCentral_AD_Assessment_Summary_$($SafeCustomerName)_$($Timestamp).txt\"\n        $ncentralSummary = @\"\nN-CENTRAL AD SECURITY ASSESSMENT SUMMARY\n=========================================\n\nCustomer: $CustomerName\nDomain: $DomainName  \nAssessment Date: $ReportDate\nExecution Time: $([math]::Round(((Get-Date) - $StartTime).TotalMinutes, 1)) minutes\n\nRISK ASSESSMENT:\nOverall Risk Level: $($PolicyCompliance.RiskLevel)\nRisk Score: $($PolicyCompliance.RiskScore)/100\nCompliance Score: $((100-$PolicyCompliance.RiskScore))/100\nTotal Issues Found: $($PolicyCompliance.Issues.Count)\n\nPRIVILEGED ACCOUNTS:\nTotal Privileged: $($PrivilegedAccounts.Count)\nHigh Risk Privileged: $($HighRiskPrivileged.Count)\n\nUSER ANALYSIS:\nTotal Users: $TotalUsers\nEnabled Users: $EnabledUsers\nHigh Risk Users: $HighRiskUsers\nCritical Risk Users: $CriticalUsers\n\nISSUE BREAKDOWN:\nCritical Issues: $(($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Critical' }).Count + $CriticalUsers + $($HighRiskPrivileged.Count))\nHigh Issues: $(($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'High' }).Count)\nMedium Issues: $(($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Medium' }).Count)\nLow Issues: $(($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Low' }).Count)\n\nFILES GENERATED:\n- Security Assessment HTML: $OutputPathHTML\n- Security Assessment PDF: $OutputPathPDF  \n- User Analysis HTML: $OutputPathUserHTML\n- User Analysis PDF: $OutputPathUserPDF\n- Complete CSV Data: $OutputPathCSV\n\nSTATUS: $( if ($PolicyCompliance.RiskScore -ge 60) { \"REQUIRES IMMEDIATE ATTENTION\" } \n          elseif ($PolicyCompliance.RiskScore -ge 40) { \"NEEDS IMPROVEMENT\" }\n          elseif ($PolicyCompliance.RiskScore -ge 20) { \"ACCEPTABLE WITH MINOR ISSUES\" }\n          else { \"GOOD SECURITY POSTURE\" } )\n\nNext Recommended Assessment: $(((Get-Date).AddMonths(3)).ToString('yyyy-MM-dd'))\n\nN-Central RMS Active Directory Security Assessment Tool v11.1 Complete\nGenerated by: $EngineerName\n\"@\n        $ncentralSummary | Out-File -FilePath $ncentralSummaryPath -Encoding UTF8\n        Write-NCentralLog \"N-Central summary file created: $ncentralSummaryPath\" -Level \"Success\"\n    } catch {\n        Write-NCentralLog \"Failed to create N-Central summary file: $($_.Exception.Message)\" -Level \"Warning\"\n    }\n    \n    Write-NCentralLog \"\"\n    Write-NCentralLog \"Files Generated Successfully:\" -Level \"Success\"\n    Write-NCentralLog \"- Security Assessment HTML: $OutputPathHTML\" -Level \"Info\"\n    Write-NCentralLog \"- Security Assessment PDF: $OutputPathPDF\" -Level \"Info\"\n    Write-NCentralLog \"- User Analysis HTML: $OutputPathUserHTML\" -Level \"Info\"  \n    Write-NCentralLog \"- User Analysis PDF: $OutputPathUserPDF\" -Level \"Info\"\n    Write-NCentralLog \"- Complete CSV Data: $OutputPathCSV\" -Level \"Info\"\n    Write-NCentralLog \"- N-Central Summary: $ncentralSummaryPath\" -Level \"Info\"\n    \n    Write-NCentralLog \"\"\n    Write-NCentralLog \"N-Central AD Security Assessment Tool v11.1 Complete - Assessment Finished\" -Level \"Success\"\n    \n    # N-Central Exit Codes for Monitoring/Alerting\n    $criticalFindings = ($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Critical' }).Count + $CriticalUsers + $($HighRiskPrivileged.Count)\n    $highFindings = ($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'High' }).Count\n    \n    if ($criticalFindings -gt 0) {\n        Write-NCentralLog \"Exiting with error code 2 (Critical security findings detected)\" -Level \"Error\"\n        exit 2\n    } elseif ($PolicyCompliance.RiskScore -ge 60 -or $highFindings -gt 3) {\n        Write-NCentralLog \"Exiting with warning code 1 (High risk level or multiple high findings)\" -Level \"Warning\"\n        exit 1\n    } else {\n        Write-NCentralLog \"Exiting with success code 0 (Acceptable security posture)\" -Level \"Success\"\n        exit 0\n    }\n\n}\ncatch {\n    Write-NCentralLog \"\"\n    Write-NCentralLog \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -Level \"Error\"\n    Write-NCentralLog \"üö® N-CENTRAL AD SECURITY ASSESSMENT ERROR üö®\" -Level \"Error\"\n    Write-NCentralLog \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -Level \"Error\"\n    Write-NCentralLog \"Assessment failed: $($_.Exception.Message)\" -Level \"Error\"\n    Write-NCentralLog \"Stack trace: $($_.ScriptStackTrace)\" -Level \"Error\"\n    Write-NCentralLog \"\"\n    Write-NCentralLog \"TROUBLESHOOTING CHECKLIST:\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ Verify Active Directory PowerShell module is installed (Install-WindowsFeature RSAT-AD-PowerShell)\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ Confirm sufficient domain permissions (Domain Users minimum for read-only assessment)\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ Check network connectivity to domain controllers\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ Ensure C:\\Temp directory exists and is writable\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ Verify Microsoft Edge or Chrome is installed for PDF generation\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ For large domains, ensure adequate memory and processing time\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ Check if domain controllers are reachable and responsive\" -Level \"Warning\"\n    Write-NCentralLog \"\"\n    Write-NCentralLog \"N-Central Assessment Failed - Exiting with error code 3\" -Level \"Error\"\n    exit 3\n}\n\n# End of Active Directory Security Assessment Tool v11.0",
          "versions": [
            {
              "id": "ver-1755457361065",
              "content": "# PowerShell Script\n# Created in Nishen's AI Workspace\n# File: N1_Rms_PP_ADUsers_Security_Ass4NC.ps1\n\n#Requires -Modules ActiveDirectory\n<#\n.SYNOPSIS\n    N1_Rms_PassPolicy_ADUsers_Security_Assessment4NCentral :\n    Active Directory Security Assessment Tool - N-Central Complete Automated Version\n    \n.DESCRIPTION\n    N-Central compatible version of the comprehensive audit script that:\n    - Reports current domain password policy with enhanced best practice evaluation\n    - Identifies fine-grained password policies with risk assessment\n    - Analyzes ALL privileged groups (Domain Admins, Enterprise Admins, Schema Admins, Administrators)\n    - Handles recursive nested group memberships automatically\n    - Comprehensive analysis of ALL domain users with password security risks\n    - Enhanced risk assessment with multi-factor analysis\n    - Generates dual professional PDF reports (Security Assessment + User Analysis)\n    - Professional presentation-ready format for customer delivery\n    - AUTOMATED: No interactive prompts - auto-generates customer name from domain\n    \n.PARAMETER CustomerName\n    Name of the customer/client (optional - auto-generated from domain if not specified)\n    Auto-extracts customer name from domain by removing suffixes (.local, .co.za, .com, etc.)\n    \n.PARAMETER DomainName\n    FQDN of domain to assess (optional - uses current domain if not specified)\n    \n.PARAMETER EngineerName\n    Name of engineer/technician running assessment (optional)\n    Defaults to \"N-Central RMS Assessment\" with timestamp\n    \n.AUTHOR\n    Nishen Harichunder L4 RMS Senior Systems Engineer\n    Modified for N-Central Complete Automation\n    \n.VERSION\n    12.0 - N-Central Complete Automated Version (Full Functionality)\n    \n.DATE\n    August 2025\n    \n.EXAMPLE\n    # Simplest execution - auto-generates customer name from domain\n    .\\N1_Rms_PassPolicy_ADUsers_Security_Assessment4NCentral.ps1\n    \n.EXAMPLE\n    # N-Central execution - fully automated (no parameters needed)  \n    powershell.exe -ExecutionPolicy Bypass -File \"C:\\Scripts\\N1_Rms_PassPolicy_ADUsers_Security_Assessment4NCentral.ps1\"\n\n.NOTES\n    N-Central Deployment Instructions:\n    1. Deploy script to C:\\Scripts\\ on target servers\n    2. Create scheduled task - NO PARAMETERS REQUIRED:\n       Command: powershell.exe\n       Arguments: -ExecutionPolicy Bypass -WindowStyle Hidden -File \"C:\\Scripts\\N1_Rms_PassPolicy_ADUsers_Security_Assessment4NCentral.ps1\"\n    3. Customer name automatically extracted from domain (e.g., \"acme.local\" becomes \"Acme\")\n    4. Reports generated in C:\\Temp\\ with auto-generated customer name and timestamp\n    5. Use AMP or file retrieval to collect reports\n    6. Generates full HTML/PDF reports + CSV data + N-Central summary files\n    \n    Requirements:\n    - Domain-joined server with AD PowerShell module\n    - Read access to Active Directory\n    - Local admin rights for report generation\n    \nScript Overview\n\n  This is a comprehensive Active Directory security assessment tool (Version 12.0) that generates\n  professional PDF reports for client security audits. The script analyzes domain security posture and\n  produces dual reports: a main security assessment and a detailed user analysis.\n\n  What the Script Does\n\n  1. Domain Password Policy Analysis: Evaluates password policies against Microsoft best practices and NIST      \n  SP 800-63B standards\n  2. Privileged Account Assessment: Analyzes Domain Admins, Enterprise Admins, Schema Admins, and local\n  Administrators groups with recursive nested membership support\n  3. Complete User Analysis: Reviews ALL domain users for password and account security risks\n  4. Compliance Mapping: Maps findings to Microsoft Security Baseline, NIST Cybersecurity Framework, and\n  NIST SP 800-63B\n  5. Report Generation: Creates HTML and PDF reports with professional formatting, charts, and metrics\n  6. Data Export: Generates CSV files with detailed findings for further analysis\n\n  Risk Scoring Methodology\n\n  Overall Risk Levels\n\n  - Critical: 80-100 points\n  - High: 60-79 points\n  - Medium: 40-59 points\n  - Low: 20-39 points\n  - Info: <20 points (for disabled accounts)\n\n  Password Policy Risk Scoring\n\n  - No complexity enabled: +20 points\n  - Password length < 14 chars: +15-30 points (scaled by severity)\n  - Min password age issues: +5-20 points\n  - Max password age > 365 days: +15-35 points\n  - Password history < 12: +10 points\n  - No account lockout: +35 points\n  - Lockout threshold issues: +5-15 points\n  - Lockout duration issues: +5-20 points\n  - Reversible encryption enabled: +35 points (critical)\n\n  User Account Risk Scoring\n\n  - Never logged on: +25-40 points\n  - No logon 30+ days: +40 points (critical)\n  - No logon 90+ days: +20 points\n  - No logon 180+ days: +30 points\n  - Password never set: +30-40 points\n  - Password > 6 months old: +20-30 points\n  - Password never expires: +25-30 points\n  - Default Administrator enabled: +40 points (critical)\n  - Multiple privileged memberships: +5 points\n\n  The compliance score is calculated as (100 - RiskScore), providing a percentage-based security posture\n  rating. The script produces actionable recommendations prioritized by risk level for immediate\n  remediation.\n\n#>\n\n# Instructions , Can be run on any Server thats on the domain , because we only capturing and quering AD - read only access is more than sufficient. \n# Reports are created on c:\\temp - copy this over to your machine and store centraly on sharepoint /SDMs to access.\n\n# N-Central Parameters\nparam(\n    [Parameter(Mandatory=$false, HelpMessage=\"Customer/Client name for the assessment (auto-generated from domain if not specified)\")]\n    [string]$CustomerName = \"\",\n    \n    [Parameter(Mandatory=$false, HelpMessage=\"Domain FQDN to assess (leave blank for current domain)\")]\n    [string]$DomainName = \"\",\n    \n    [Parameter(Mandatory=$false, HelpMessage=\"Engineer/Technician name\")]\n    [string]$EngineerName = \"N-Central RMS Assessment - $(Get-Date -Format 'yyyy-MM-dd HH:mm')\"\n)\n\n# Function to extract customer name from domain name\nfunction Get-CustomerNameFromDomain {\n    param([string]$DomainFQDN)\n    \n    if ([string]::IsNullOrWhiteSpace($DomainFQDN)) {\n        return \"\"\n    }\n    \n    # Common domain suffixes to remove\n    $suffixes = @(\n        '.local', '.co.za', '.com', '.net', '.org', '.co.uk', '.com.au', '.ca',\n        '.de', '.fr', '.it', '.nl', '.be', '.ch', '.at', '.se', '.no', '.dk',\n        '.fi', '.ie', '.pt', '.es', '.pl', '.cz', '.hu', '.sk', '.si', '.hr',\n        '.rs', '.bg', '.ro', '.gr', '.cy', '.mt', '.lu', '.li', '.mc', '.sm',\n        '.va', '.ad', '.int'\n    )\n    \n    $customerName = $DomainFQDN.ToLower()\n    \n    # Remove common suffixes\n    foreach ($suffix in $suffixes) {\n        if ($customerName.EndsWith($suffix)) {\n            $customerName = $customerName.Substring(0, $customerName.Length - $suffix.Length)\n            break\n        }\n    }\n    \n    # Handle multi-part domains (take first part before first dot if multiple dots remain)\n    if ($customerName.Contains('.')) {\n        $parts = $customerName.Split('.')\n        $customerName = $parts[0]\n    }\n    \n    # Capitalize first letter and clean up\n    if ($customerName.Length -gt 0) {\n        $customerName = $customerName.Substring(0,1).ToUpper() + $customerName.Substring(1)\n        # Replace hyphens/underscores with spaces for better formatting\n        $customerName = $customerName -replace '[-_]', ' '\n    }\n    \n    return $customerName\n}\n\n# N-Central Logging Function  \nfunction Write-NCentralLog {\n    param(\n        [string]$Message,\n        [ValidateSet(\"Info\", \"Warning\", \"Error\", \"Success\")]\n        [string]$Level = \"Info\"\n    )\n    \n    $timestamp = Get-Date -Format \"yyyy-MM-dd HH:mm:ss\"\n    $logMessage = \"[$timestamp] [$Level] $Message\"\n    \n    # Output to console for N-Central capture\n    switch ($Level) {\n        \"Error\" { Write-Error $logMessage }\n        \"Warning\" { Write-Warning $logMessage }\n        \"Success\" { Write-Host $logMessage -ForegroundColor Green }\n        default { Write-Host $logMessage -ForegroundColor Cyan }\n    }\n    \n    # Also write to log file\n    try {\n        $logPath = \"C:\\Temp\\NCentral_AD_Assessment_$(Get-Date -Format 'yyyyMMdd').log\"\n        \"$logMessage\" | Out-File -FilePath $logPath -Append -Encoding UTF8\n    } catch {\n        # Ignore logging errors to prevent script failure\n    }\n}\n\n# Initialize N-Central execution\n$StartTime = Get-Date\nWrite-NCentralLog \"Starting N-Central Complete AD Security Assessment\" -Level \"Info\"\n\n# Ensure C:\\Temp exists\nif (-not (Test-Path \"C:\\Temp\")) {\n    try {\n        New-Item -Path \"C:\\Temp\" -ItemType Directory -Force | Out-Null\n        Write-NCentralLog \"Created C:\\Temp directory\" -Level \"Info\"\n    } catch {\n        Write-NCentralLog \"Failed to create C:\\Temp directory: $($_.Exception.Message)\" -Level \"Error\"\n        exit 1\n    }\n}\n\n# Import required modules\ntry {\n    Import-Module ActiveDirectory -ErrorAction Stop\n    Write-NCentralLog \"Active Directory module imported successfully\" -Level \"Success\"\n} catch {\n    Write-NCentralLog \"Failed to import Active Directory module: $($_.Exception.Message)\" -Level \"Error\"\n    Write-NCentralLog \"Ensure RSAT-AD-PowerShell is installed\" -Level \"Error\"\n    exit 1\n}\n\n# Check for required assemblies for PDF generation\ntry {\n    Add-Type -AssemblyName System.Drawing\n    Add-Type -AssemblyName System.Windows.Forms\n    Add-Type -AssemblyName Microsoft.PowerShell.Commands.Utility\n    Write-Host \"PDF generation libraries loaded successfully\" -ForegroundColor Green\n}\ncatch {\n    Write-Warning \"Some PDF generation features may be limited. Continuing with HTML to PDF conversion.\"\n}\n\n# N-Central Automated Setup - No Interactive Prompts\nWrite-NCentralLog \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -Level \"Info\"\nWrite-NCentralLog \"N-Central Active Directory Security Assessment Tool v11.1 Complete\" -Level \"Info\"\nWrite-NCentralLog \"Comprehensive Privileged Groups & User Analysis (Automated)\" -Level \"Info\"\nWrite-NCentralLog \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -Level \"Info\"\n\n# Handle domain selection first\nif ([string]::IsNullOrWhiteSpace($DomainName)) {\n    try {\n        $Domain = Get-ADDomain\n        $DomainName = $Domain.DNSRoot\n        Write-NCentralLog \"Using current domain: $DomainName\" -Level \"Success\"\n    } catch {\n        Write-NCentralLog \"Unable to connect to current domain: $($_.Exception.Message)\" -Level \"Error\"\n        exit 1\n    }\n} else {\n    try {\n        $Domain = Get-ADDomain -Server $DomainName\n        $DomainName = $Domain.DNSRoot\n        Write-NCentralLog \"Connected to specified domain: $DomainName\" -Level \"Success\"\n    } catch {\n        Write-NCentralLog \"Unable to connect to domain '$DomainName': $($_.Exception.Message)\" -Level \"Error\"\n        exit 1\n    }\n}\n\n# Auto-generate customer name from domain if not provided\nif ([string]::IsNullOrWhiteSpace($CustomerName)) {\n    $CustomerName = Get-CustomerNameFromDomain -DomainFQDN $DomainName\n    Write-NCentralLog \"Auto-generated customer name from domain: '$CustomerName'\" -Level \"Info\"\n    \n    if ([string]::IsNullOrWhiteSpace($CustomerName)) {\n        Write-NCentralLog \"Unable to generate customer name from domain '$DomainName'. Using domain NetBIOS name as customer name.\" -Level \"Warning\"\n        $CustomerName = $Domain.NetBIOSName\n    }\n} else {\n    Write-NCentralLog \"Using provided customer name: '$CustomerName'\" -Level \"Info\"\n}\n\n# Validate final inputs\nif ([string]::IsNullOrWhiteSpace($CustomerName)) {\n    Write-NCentralLog \"Customer Name could not be determined\" -Level \"Error\"\n    exit 1\n}\n\nif ([string]::IsNullOrWhiteSpace($EngineerName)) {\n    Write-NCentralLog \"Engineer Name could not be determined\" -Level \"Error\" \n    exit 1\n}\n\n# Initialize variables with N-Central friendly naming\n$ReportDate = Get-Date -Format \"yyyy-MM-dd HH:mm:ss\"\n$SafeCustomerName = $CustomerName -replace '[^\\w\\s]', '' -replace '\\s+', '_'\n$Timestamp = Get-Date -Format 'yyyyMMdd_HHmmss'\n\n# N-Central file naming with NCentral prefix for easy identification\n$OutputPathHTML = \"C:\\Temp\\NCentral_AD_Security_Assessment_$($SafeCustomerName)_$($Domain.NetBIOSName)_$($Timestamp).html\"\n$OutputPathPDF = \"C:\\Temp\\NCentral_AD_Security_Assessment_$($SafeCustomerName)_$($Domain.NetBIOSName)_$($Timestamp).pdf\"\n$OutputPathUserHTML = \"C:\\Temp\\NCentral_AD_User_Analysis_$($SafeCustomerName)_$($Domain.NetBIOSName)_$($Timestamp).html\"\n$OutputPathUserPDF = \"C:\\Temp\\NCentral_AD_User_Analysis_$($SafeCustomerName)_$($Domain.NetBIOSName)_$($Timestamp).pdf\"\n$OutputPathCSV = \"C:\\Temp\\NCentral_AD_Complete_Assessment_$($SafeCustomerName)_$($Domain.NetBIOSName)_$($Timestamp)_Details.csv\"\n\nWrite-NCentralLog \"Starting comprehensive Active Directory Security Assessment\" -Level \"Success\"\nWrite-NCentralLog \"Customer: $CustomerName\" -Level \"Info\"\nWrite-NCentralLog \"Domain: $DomainName\" -Level \"Info\" \nWrite-NCentralLog \"Engineer: $EngineerName\" -Level \"Info\"\nWrite-NCentralLog \"Output files will be prefixed with: NCentral_AD_*_$($SafeCustomerName)_$($Domain.NetBIOSName)_$($Timestamp)\" -Level \"Info\"\n\n# Function to calculate risk score\nfunction Get-RiskLevel {\n    param($Score)\n    if ($Score -ge 80) { return 'Critical' }\n    elseif ($Score -ge 60) { return 'High' }\n    elseif ($Score -ge 40) { return 'Medium' }\n    elseif ($Score -ge 20) { return 'Low' }\n    else { return 'Info' }\n}\n\n# Function to get domain password policy with enhanced evaluation\nfunction Get-DomainPasswordPolicy {\n    param($DomainServer)\n    Write-Host \"Retrieving enhanced domain password policy...\" -ForegroundColor Yellow\n    \n    $Policy = if ($DomainServer) { \n        Get-ADDefaultDomainPasswordPolicy -Server $DomainServer \n    } else { \n        Get-ADDefaultDomainPasswordPolicy \n    }\n    \n    return @{\n        'ComplexityEnabled' = $Policy.ComplexityEnabled\n        'DistinguishedName' = $Policy.DistinguishedName\n        'LockoutDuration' = $Policy.LockoutDuration.TotalMinutes\n        'LockoutObservationWindow' = $Policy.LockoutObservationWindow.TotalMinutes\n        'LockoutThreshold' = $Policy.LockoutThreshold\n        'MaxPasswordAge' = $Policy.MaxPasswordAge.TotalDays\n        'MinPasswordAge' = $Policy.MinPasswordAge.TotalDays\n        'MinPasswordLength' = $Policy.MinPasswordLength\n        'PasswordHistoryCount' = $Policy.PasswordHistoryCount\n        'ReversibleEncryptionEnabled' = $Policy.ReversibleEncryptionEnabled\n    }\n}\n\n# Function to get fine-grained password policies\nfunction Get-FineGrainedPolicies {\n    param($DomainServer)\n    Write-Host \"Retrieving fine-grained password policies...\" -ForegroundColor Yellow\n    \n    try {\n        $FGPPs = if ($DomainServer) {\n            Get-ADFineGrainedPasswordPolicy -Filter * -Properties * -Server $DomainServer\n        } else {\n            Get-ADFineGrainedPasswordPolicy -Filter * -Properties *\n        }\n        \n        $FGPPDetails = @()\n        \n        foreach ($FGPP in $FGPPs) {\n            $AppliesTo = if ($DomainServer) {\n                (Get-ADFineGrainedPasswordPolicySubject -Identity $FGPP -Server $DomainServer).Name -join \", \"\n            } else {\n                (Get-ADFineGrainedPasswordPolicySubject -Identity $FGPP).Name -join \", \"\n            }\n            \n            $FGPPDetails += [PSCustomObject]@{\n                'Name' = $FGPP.Name\n                'Precedence' = $FGPP.Precedence\n                'ComplexityEnabled' = $FGPP.ComplexityEnabled\n                'LockoutDuration' = $FGPP.LockoutDuration.TotalMinutes\n                'LockoutObservationWindow' = $FGPP.LockoutObservationWindow.TotalMinutes\n                'LockoutThreshold' = $FGPP.LockoutThreshold\n                'MaxPasswordAge' = $FGPP.MaxPasswordAge.TotalDays\n                'MinPasswordAge' = $FGPP.MinPasswordAge.TotalDays\n                'MinPasswordLength' = $FGPP.MinPasswordLength\n                'PasswordHistoryCount' = $FGPP.PasswordHistoryCount\n                'ReversibleEncryptionEnabled' = $FGPP.ReversibleEncryptionEnabled\n                'AppliesTo' = $AppliesTo\n            }\n        }\n        \n        return $FGPPDetails\n    }\n    catch {\n        Write-Warning \"No fine-grained password policies found or insufficient permissions\"\n        return @()\n    }\n}\n\n# Enhanced function to analyze password policy compliance with new requirements\nfunction Test-PolicyCompliance {\n    param($Policy)\n    \n    $Issues = @()\n    $RiskScore = 0\n    \n    # Enhanced Microsoft Best Practices and Industry Standards\n    if (-not $Policy.ComplexityEnabled) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = 'Password complexity is disabled'\n            'Risk' = 'High'\n            'Recommendation' = 'Enable password complexity requirements'\n            'BestPractice' = 'Microsoft recommends enabling complexity for passwords'\n        }\n        $RiskScore += 20\n    }\n    \n    if ($Policy.MinPasswordLength -lt 14) {\n        $Risk = if ($Policy.MinPasswordLength -lt 8) { 'Critical' } \n               elseif ($Policy.MinPasswordLength -lt 12) { 'High' }\n               else { 'Medium' }\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Minimum password length is $($Policy.MinPasswordLength) characters\"\n            'Risk' = $Risk\n            'Recommendation' = 'Set minimum password length to 14+ characters per NIST SP 800-63B'\n            'BestPractice' = 'NIST SP 800-63B and Microsoft recommend 14+ character passwords for security'\n        }\n        $RiskScore += if ($Policy.MinPasswordLength -lt 8) { 30 } \n                     elseif ($Policy.MinPasswordLength -lt 12) { 20 } \n                     else { 15 }\n    }\n    \n    # Enhanced Minimum Password Age evaluation\n    if ($Policy.MinPasswordAge -lt 1) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Minimum password age is $($Policy.MinPasswordAge) days\"\n            'Risk' = 'High'\n            'Recommendation' = 'Set minimum password age to at least 1 day to prevent immediate password reuse'\n            'BestPractice' = 'Industry standard is 1-2 days to balance security with usability'\n        }\n        $RiskScore += 20\n    }\n    elseif ($Policy.MinPasswordAge -gt 2) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Minimum password age is $($Policy.MinPasswordAge) days\"\n            'Risk' = 'Low'\n            'Recommendation' = 'Consider reducing minimum password age to 1-2 days'\n            'BestPractice' = 'Industry standard is 1-2 days to balance security with usability'\n        }\n        $RiskScore += 5\n    }\n    \n    # Enhanced Maximum Password Age evaluation\n    if ($Policy.MaxPasswordAge -eq 0) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Maximum password age is set to never expire\"\n            'Risk' = 'Critical'\n            'Recommendation' = 'Set maximum password age to 60-365 days or implement alternative authentication'\n            'BestPractice' = 'Balance between security and usability - consider modern authentication methods'\n        }\n        $RiskScore += 35\n    }\n    elseif ($Policy.MaxPasswordAge -gt 365) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Maximum password age is $($Policy.MaxPasswordAge) days\"\n            'Risk' = 'Medium'\n            'Recommendation' = 'Consider reducing maximum password age to 365 days or less'\n            'BestPractice' = 'Regularly changed passwords reduce long-term exposure risk'\n        }\n        $RiskScore += 15\n    }\n    \n    if ($Policy.PasswordHistoryCount -lt 12) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Password history is set to $($Policy.PasswordHistoryCount) passwords\"\n            'Risk' = 'Medium'\n            'Recommendation' = 'Set password history to remember at least 12 passwords'\n            'BestPractice' = 'Prevents password reuse and cycling - Microsoft baseline recommendation'\n        }\n        $RiskScore += 10\n    }\n    \n    if ($Policy.LockoutThreshold -eq 0) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = 'Account lockout is disabled'\n            'Risk' = 'Critical'\n            'Recommendation' = 'Enable account lockout with threshold of 5-10 attempts'\n            'BestPractice' = 'Protects against brute force attacks while maintaining usability'\n        }\n        $RiskScore += 35\n    }\n    elseif ($Policy.LockoutThreshold -lt 5 -or $Policy.LockoutThreshold -gt 10) {\n        $Risk = if ($Policy.LockoutThreshold -lt 5) { 'Medium' } else { 'Low' }\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Account lockout threshold is $($Policy.LockoutThreshold) attempts\"\n            'Risk' = $Risk\n            'Recommendation' = 'Set lockout threshold to 5-10 failed attempts for optimal security'\n            'BestPractice' = 'Balance security protection with user experience'\n        }\n        $RiskScore += if ($Policy.LockoutThreshold -lt 5) { 15 } else { 5 }\n    }\n    \n    # Enhanced Lockout Duration evaluation\n    if ($Policy.LockoutDuration -lt 15) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Account lockout duration is $($Policy.LockoutDuration) minutes\"\n            'Risk' = 'High'\n            'Recommendation' = 'Set lockout duration to at least 15 minutes for optimal security'\n            'BestPractice' = 'Adequate lockout duration deters automated attacks while minimizing user impact'\n        }\n        $RiskScore += 20\n    }\n    elseif ($Policy.LockoutDuration -gt 60) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Account lockout duration is $($Policy.LockoutDuration) minutes\"\n            'Risk' = 'Low'\n            'Recommendation' = 'Consider reducing lockout duration to 15-60 minutes'\n            'BestPractice' = 'Adequate lockout duration deters automated attacks while minimizing user impact'\n        }\n        $RiskScore += 5\n    }\n    \n    # Enhanced Reset Account Lockout Counter evaluation\n    if ($Policy.LockoutObservationWindow -lt $Policy.LockoutDuration -and $Policy.LockoutThreshold -gt 0) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Reset account lockout counter ($($Policy.LockoutObservationWindow) min) is less than lockout duration ($($Policy.LockoutDuration) min)\"\n            'Risk' = 'High'\n            'Recommendation' = 'Set reset lockout counter equal to or greater than lockout duration'\n            'BestPractice' = 'Ensures proper lockout behavior and prevents premature counter resets'\n        }\n        $RiskScore += 20\n    }\n    \n    if ($Policy.ReversibleEncryptionEnabled) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = 'Reversible encryption is enabled'\n            'Risk' = 'Critical'\n            'Recommendation' = 'Disable reversible encryption immediately - CRITICAL SECURITY RISK'\n            'BestPractice' = 'Reversible encryption is equivalent to storing passwords in plain text'\n        }\n        $RiskScore += 35\n    }\n    \n    return @{\n        'Issues' = $Issues\n        'RiskScore' = $RiskScore\n        'RiskLevel' = Get-RiskLevel $RiskScore\n    }\n}\n\n# Enhanced function to get comprehensive privileged group analysis\nfunction Get-AllPrivilegedAccounts {\n    param($DomainServer)\n    Write-Host \"Performing comprehensive privileged group analysis...\" -ForegroundColor Yellow\n    \n    $PrivilegedGroups = @(\n        'Domain Admins',\n        'Enterprise Admins', \n        'Schema Admins',\n        'Administrators'\n    )\n    \n    $AllPrivilegedAccounts = @()\n    \n    foreach ($GroupName in $PrivilegedGroups) {\n        Write-Host \"  Analyzing group: $GroupName\" -ForegroundColor Cyan\n        \n        try {\n            # Get group with recursive membership\n            $Members = if ($DomainServer) {\n                Get-ADGroupMember $GroupName -Recursive -Server $DomainServer -ErrorAction SilentlyContinue\n            } else {\n                Get-ADGroupMember $GroupName -Recursive -ErrorAction SilentlyContinue\n            }\n            \n            foreach ($Member in $Members) {\n                if ($Member.objectClass -eq \"user\") {\n                    $User = if ($DomainServer) {\n                        Get-ADUser $Member.SamAccountName -Properties LastLogonDate, PasswordLastSet, Enabled, AccountExpirationDate, PasswordNeverExpires, MemberOf -Server $DomainServer\n                    } else {\n                        Get-ADUser $Member.SamAccountName -Properties LastLogonDate, PasswordLastSet, Enabled, AccountExpirationDate, PasswordNeverExpires, MemberOf\n                    }\n                    \n                    $LastLogon = if ($User.LastLogonDate) { $User.LastLogonDate } else { \"Never\" }\n                    $PasswordLastSet = if ($User.PasswordLastSet) { $User.PasswordLastSet } else { \"Never\" }\n                    \n                    # Calculate days since last logon and password change\n                    $DaysSinceLogon = if ($User.LastLogonDate) { (Get-Date) - $User.LastLogonDate | Select-Object -ExpandProperty Days } else { 9999 }\n                    $DaysSincePasswordChange = if ($User.PasswordLastSet) { (Get-Date) - $User.PasswordLastSet | Select-Object -ExpandProperty Days } else { 9999 }\n                    \n                    # Get all privileged groups this user belongs to\n                    $UserPrivilegedGroups = @()\n                    foreach ($CheckGroup in $PrivilegedGroups) {\n                        try {\n                            $GroupMembers = if ($DomainServer) {\n                                Get-ADGroupMember $CheckGroup -Recursive -Server $DomainServer -ErrorAction SilentlyContinue\n                            } else {\n                                Get-ADGroupMember $CheckGroup -Recursive -ErrorAction SilentlyContinue\n                            }\n                            if ($GroupMembers.SamAccountName -contains $User.SamAccountName) {\n                                $UserPrivilegedGroups += $CheckGroup\n                            }\n                        }\n                        catch {\n                            # Group might not exist in this domain\n                        }\n                    }\n                    \n                    # Enhanced risk assessment with multi-factor analysis\n                    $RiskFactors = @()\n                    $RiskScore = 0\n                    \n                    if (-not $User.Enabled) { \n                        $RiskFactors += \"Account Disabled\"\n                        $RiskScore += 0 # Disabled accounts are actually lower risk\n                    }\n                    \n                    if ($DaysSinceLogon -gt 180) { \n                        $RiskFactors += \"No logon for 180+ days\"\n                        $RiskScore += 30\n                    }\n                    elseif ($DaysSinceLogon -gt 90) { \n                        $RiskFactors += \"No logon for 90+ days\"\n                        $RiskScore += 20\n                    }\n                    elseif ($DaysSinceLogon -gt 30) { \n                        $RiskFactors += \"No logon for 30+ days\"\n                        $RiskScore += 40  # Changed to Critical for 30+ days\n                    }\n                    \n                    if ($LastLogon -eq \"Never\") {\n                        $RiskFactors += \"Never logged on\"\n                        $RiskScore += 40  # Changed to Critical\n                    }\n                    \n                    if ($DaysSincePasswordChange -gt 365) { \n                        $RiskFactors += \"Password older than 1 year\"\n                        $RiskScore += 30\n                    }\n                    elseif ($DaysSincePasswordChange -gt 180) { \n                        $RiskFactors += \"Password older than 6 months\"\n                        $RiskScore += 25  # Changed to High risk\n                    }\n                    \n                    if ($User.PasswordNeverExpires) { \n                        $RiskFactors += \"Password never expires\"\n                        $RiskScore += 30  # Changed to High risk\n                    }\n                    \n                    if ($PasswordLastSet -eq \"Never\") {\n                        $RiskFactors += \"Password never set\"\n                        $RiskScore += 40  # Changed to Critical\n                    }\n                    \n                    if ($UserPrivilegedGroups.Count -gt 1) {\n                        $RiskFactors += \"Multiple privileged group memberships\"\n                        $RiskScore += 5\n                    }\n                    \n                    # Check for default Administrator account\n                    if ($User.SamAccountName -eq \"Administrator\" -and $User.Enabled) {\n                        $RiskFactors += \"Default Administrator account is enabled\"\n                        $RiskScore += 40  # Changed to Critical\n                    }\n                    \n                    # Determine overall risk level\n                    $Risk = Get-RiskLevel $RiskScore\n                    if (-not $User.Enabled) { $Risk = 'Info' }\n                    \n                    $AllPrivilegedAccounts += [PSCustomObject]@{\n                        'Name' = $User.Name\n                        'SamAccountName' = $User.SamAccountName\n                        'PrimaryGroup' = $GroupName\n                        'AllPrivilegedGroups' = $UserPrivilegedGroups -join \"; \"\n                        'Enabled' = $User.Enabled\n                        'LastLogonDate' = $LastLogon\n                        'PasswordLastSet' = $PasswordLastSet\n                        'DaysSinceLogon' = $DaysSinceLogon\n                        'DaysSincePasswordChange' = $DaysSincePasswordChange\n                        'PasswordNeverExpires' = $User.PasswordNeverExpires\n                        'AccountExpirationDate' = $User.AccountExpirationDate\n                        'RiskFactors' = $RiskFactors -join \"; \"\n                        'RiskScore' = $RiskScore\n                        'Risk' = $Risk\n                    }\n                }\n            }\n        }\n        catch {\n            Write-Warning \"Unable to analyze group '$GroupName': $($_.Exception.Message)\"\n        }\n    }\n    \n    # Remove duplicates (users in multiple groups)\n    $UniqueAccounts = $AllPrivilegedAccounts | Sort-Object SamAccountName -Unique\n    \n    return $UniqueAccounts\n}\n\n# New function for comprehensive domain user analysis\nfunction Get-DomainUserAnalysis {\n    param($DomainServer)\n    Write-Host \"Performing comprehensive domain user analysis...\" -ForegroundColor Yellow\n    Write-Host \"  This may take several minutes for large domains...\" -ForegroundColor Cyan\n    \n    $AllUsers = if ($DomainServer) {\n        Get-ADUser -Filter * -Properties LastLogonDate, PasswordLastSet, Enabled, AccountExpirationDate, PasswordNeverExpires, Created, BadLogonCount -Server $DomainServer\n    } else {\n        Get-ADUser -Filter * -Properties LastLogonDate, PasswordLastSet, Enabled, AccountExpirationDate, PasswordNeverExpires, Created, BadLogonCount\n    }\n    \n    Write-Host \"  Analyzing $($AllUsers.Count) user accounts...\" -ForegroundColor Cyan\n    \n    $UserAnalysis = @()\n    $Counter = 0\n    \n    foreach ($User in $AllUsers) {\n        $Counter++\n        if ($Counter % 100 -eq 0) {\n            Write-Host \"    Processed $Counter of $($AllUsers.Count) users...\" -ForegroundColor Yellow\n        }\n        \n        $LastLogon = if ($User.LastLogonDate) { $User.LastLogonDate } else { \"Never\" }\n        $PasswordLastSet = if ($User.PasswordLastSet) { $User.PasswordLastSet } else { \"Never\" }\n        \n        # Calculate days since last logon and password change\n        $DaysSinceLogon = if ($User.LastLogonDate) { (Get-Date) - $User.LastLogonDate | Select-Object -ExpandProperty Days } else { 9999 }\n        $DaysSincePasswordChange = if ($User.PasswordLastSet) { (Get-Date) - $User.PasswordLastSet | Select-Object -ExpandProperty Days } else { 9999 }\n        $DaysSinceCreated = if ($User.Created) { (Get-Date) - $User.Created | Select-Object -ExpandProperty Days } else { 9999 }\n        \n        # Password and account risk assessment\n        $RiskFactors = @()\n        $RiskScore = 0\n        \n        # Account status risks\n        if (-not $User.Enabled) { \n            $RiskFactors += \"Account Disabled\"\n        }\n        \n        # Logon pattern risks\n        if ($LastLogon -eq \"Never\") {\n            $RiskFactors += \"Never logged on\"\n            $RiskScore += 25\n        }\n        elseif ($DaysSinceLogon -gt 365) { \n            $RiskFactors += \"No logon for 1+ years (Stale)\"\n            $RiskScore += 30\n        }\n        elseif ($DaysSinceLogon -gt 180) { \n            $RiskFactors += \"No logon for 6+ months\"\n            $RiskScore += 25\n        }\n        elseif ($DaysSinceLogon -gt 90) { \n            $RiskFactors += \"No logon for 3+ months\"\n            $RiskScore += 20\n        }\n        elseif ($DaysSinceLogon -gt 30) { \n            $RiskFactors += \"No logon for 30+ days\"\n            $RiskScore += 40  # Changed to Critical\n        }\n        \n        # Password security risks\n        if ($PasswordLastSet -eq \"Never\") {\n            $RiskFactors += \"Password never set\"\n            $RiskScore += 30\n        }\n        elseif ($DaysSincePasswordChange -gt 730) { \n            $RiskFactors += \"Password older than 2 years\"\n            $RiskScore += 30\n        }\n        elseif ($DaysSincePasswordChange -gt 365) { \n            $RiskFactors += \"Password older than 1 year\"\n            $RiskScore += 25\n        }\n        elseif ($DaysSincePasswordChange -gt 180) { \n            $RiskFactors += \"Password older than 6 months\"\n            $RiskScore += 20  # Changed to High risk\n        }\n        \n        if ($User.PasswordNeverExpires) { \n            $RiskFactors += \"Password never expires\"\n            $RiskScore += 25  # Changed to High risk\n        }\n        \n        # Account behavior risks\n        if ($User.BadLogonCount -gt 0) {\n            $RiskFactors += \"Recent failed logon attempts: $($User.BadLogonCount)\"\n            $RiskScore += 10\n        }\n        \n        # New account risks\n        if ($DaysSinceCreated -lt 30 -and $LastLogon -eq \"Never\") {\n            $RiskFactors += \"New account never used\"\n            $RiskScore += 15\n        }\n        \n        # Account expiration\n        if ($User.AccountExpirationDate -and $User.AccountExpirationDate -lt (Get-Date)) {\n            $RiskFactors += \"Account expired\"\n            $RiskScore += 5\n        }\n        \n        # Check for default Administrator account\n        if ($User.SamAccountName -eq \"Administrator\" -and $User.Enabled) {\n            $RiskFactors += \"Default Administrator account is enabled\"\n            $RiskScore += 40  # Changed to Critical\n        }\n        \n        # Determine overall risk level\n        $Risk = Get-RiskLevel $RiskScore\n        if (-not $User.Enabled) { $Risk = 'Info' }\n        \n        # Categorize user type\n        $UserType = \"Standard User\"\n        if ($User.SamAccountName -like \"*admin*\" -or $User.SamAccountName -like \"*svc*\" -or $User.SamAccountName -like \"*service*\") {\n            $UserType = \"Service/Admin Account\"\n        }\n        elseif ($User.SamAccountName -like \"*test*\" -or $User.SamAccountName -like \"*temp*\") {\n            $UserType = \"Test/Temp Account\"\n        }\n        \n        $UserAnalysis += [PSCustomObject]@{\n            'Name' = $User.Name\n            'SamAccountName' = $User.SamAccountName\n            'UserType' = $UserType\n            'Enabled' = $User.Enabled\n            'Created' = if ($User.Created) { $User.Created.ToString(\"yyyy-MM-dd\") } else { \"Unknown\" }\n            'LastLogonDate' = if ($LastLogon -eq \"Never\") { \"Never\" } else { $LastLogon.ToString(\"yyyy-MM-dd\") }\n            'PasswordLastSet' = if ($PasswordLastSet -eq \"Never\") { \"Never\" } else { $PasswordLastSet.ToString(\"yyyy-MM-dd\") }\n            'DaysSinceLogon' = $DaysSinceLogon\n            'DaysSincePasswordChange' = $DaysSincePasswordChange\n            'PasswordNeverExpires' = $User.PasswordNeverExpires\n            'AccountExpirationDate' = $User.AccountExpirationDate\n            'BadLogonCount' = $User.BadLogonCount\n            'RiskFactors' = if ($RiskFactors.Count -gt 0) { $RiskFactors -join \"; \" } else { \"None\" }\n            'RiskScore' = $RiskScore\n            'Risk' = $Risk\n        }\n    }\n    \n    Write-Host \"  User analysis completed!\" -ForegroundColor Green\n    return $UserAnalysis\n}\n\n# Enhanced function to generate professional HTML for main security assessment\nfunction New-SecurityAssessmentHTML {\n    param(\n        $DomainPolicy,\n        $FGPPs,\n        $PolicyCompliance,\n        $PrivilegedAccounts,\n        $CustomerName,\n        $DomainName,\n        $EngineerName\n    )\n    \n    # Calculate additional metrics\n    $StalePrivileged = $PrivilegedAccounts | Where-Object { $_.DaysSinceLogon -gt 90 -and $_.Enabled }\n    $CriticalIssues = $PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Critical' }\n    $HighIssues = $PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'High' }\n    $NeverLoggedOn = $PrivilegedAccounts | Where-Object { $_.LastLogonDate -eq 'Never' }\n    \n    $HTML = @\"\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <title>Active Directory Security Assessment Report</title>\n    <style>\n        @page {\n            margin: 0.5in;\n            @top-center {\n                content: \"Active Directory Security Assessment\";\n                font-family: 'Segoe UI', sans-serif;\n                font-size: 10px;\n                color: #666;\n            }\n            @bottom-center {\n                content: \"Page \" counter(page) \" of \" counter(pages);\n                font-family: 'Segoe UI', sans-serif;\n                font-size: 10px;\n                color: #666;\n            }\n        }\n        \n        body {\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n            margin: 0;\n            padding: 20px;\n            background-color: white;\n            line-height: 1.4;\n            font-size: 11px;\n        }\n        \n        .header {\n            text-align: center;\n            border-bottom: 3px solid #2E86AB;\n            padding-bottom: 15px;\n            margin-bottom: 20px;\n        }\n        \n        .customer-name {\n            font-size: 28px;\n            font-weight: bold;\n            color: #2E86AB;\n            margin-bottom: 5px;\n            text-transform: uppercase;\n        }\n        \n        .report-title {\n            font-size: 18px;\n            font-weight: bold;\n            color: #333;\n            margin-bottom: 15px;\n        }\n        \n        .header-info {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 20px;\n            margin-top: 15px;\n            font-size: 10px;\n        }\n        \n        .section {\n            margin-bottom: 20px;\n            page-break-inside: avoid;\n        }\n        \n        .section h2 {\n            background: linear-gradient(135deg, #2E86AB 0%, #1f5f99 100%);\n            color: white;\n            padding: 8px 15px;\n            margin: 0 0 10px 0;\n            font-size: 14px;\n            font-weight: bold;\n        }\n        \n        .section h3 {\n            color: #2E86AB;\n            font-size: 12px;\n            margin: 15px 0 8px 0;\n            border-bottom: 1px solid #ddd;\n            padding-bottom: 3px;\n        }\n        \n        .executive-summary {\n            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);\n            padding: 15px;\n            border-left: 4px solid #2E86AB;\n            margin-bottom: 20px;\n        }\n        \n        .metrics-grid {\n            display: grid;\n            grid-template-columns: repeat(4, 1fr);\n            gap: 15px;\n            margin: 15px 0;\n        }\n        \n        .metric-card {\n            text-align: center;\n            padding: 12px;\n            background: white;\n            border: 1px solid #ddd;\n            border-radius: 5px;\n        }\n        \n        .metric-value {\n            font-size: 18px;\n            font-weight: bold;\n            color: #2E86AB;\n        }\n        \n        .metric-label {\n            font-size: 10px;\n            color: #666;\n            margin-top: 5px;\n        }\n        \n        table {\n            width: 100%;\n            border-collapse: collapse;\n            margin: 10px 0;\n            font-size: 10px;\n        }\n        \n        th, td {\n            border: 1px solid #ddd;\n            padding: 6px;\n            text-align: left;\n        }\n        \n        th {\n            background-color: #f8f9fa;\n            font-weight: bold;\n            color: #2E86AB;\n        }\n        \n        .compliant {\n            background-color: #d4edda;\n            color: #155724;\n            font-weight: bold;\n        }\n        \n        .non-compliant {\n            background-color: #f8d7da;\n            color: #721c24;\n            font-weight: bold;\n        }\n        \n        .risk-critical {\n            background-color: #f8d7da;\n            border-left: 4px solid #dc3545;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-high {\n            background-color: #fff3cd;\n            border-left: 4px solid #ffc107;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-medium {\n            background-color: #d1ecf1;\n            border-left: 4px solid #17a2b8;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-low {\n            background-color: #d4edda;\n            border-left: 4px solid #28a745;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-badge {\n            padding: 3px 8px;\n            border-radius: 12px;\n            color: white;\n            font-weight: bold;\n            font-size: 9px;\n            text-transform: uppercase;\n        }\n        \n        .risk-critical .risk-badge { background-color: #dc3545; }\n        .risk-high .risk-badge { background-color: #ffc107; color: #333; }\n        .risk-medium .risk-badge { background-color: #17a2b8; }\n        .risk-low .risk-badge { background-color: #28a745; }\n        \n        .recommendation {\n            background-color: #f0f8ff;\n            border: 1px solid #b3d9ff;\n            padding: 12px;\n            margin: 10px 0;\n            border-radius: 5px;\n        }\n        \n        .recommendation h4 {\n            margin: 0 0 8px 0;\n            color: #2E86AB;\n            font-size: 11px;\n        }\n        \n        .footer {\n            border-top: 2px solid #2E86AB;\n            padding-top: 15px;\n            margin-top: 30px;\n            text-align: center;\n            font-size: 9px;\n            color: #666;\n        }\n        \n        .chart-container {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 20px;\n            margin: 15px 0;\n        }\n        \n        .chart-item {\n            background: white;\n            border: 1px solid #ddd;\n            padding: 10px;\n            border-radius: 5px;\n        }\n        \n        .progress-bar {\n            width: 100%;\n            height: 15px;\n            background-color: #e9ecef;\n            border-radius: 8px;\n            overflow: hidden;\n            margin: 5px 0;\n        }\n        \n        .progress-fill {\n            height: 100%;\n            border-radius: 8px;\n        }\n        \n        .no-break { page-break-inside: avoid; }\n        \n        .enhanced-metrics {\n            display: grid;\n            grid-template-columns: repeat(6, 1fr);\n            gap: 10px;\n            margin: 15px 0;\n        }\n        \n        .risk-distribution {\n            display: grid;\n            grid-template-columns: repeat(4, 1fr);\n            gap: 10px;\n            margin: 10px 0;\n        }\n        \n        .risk-item {\n            text-align: center;\n            padding: 8px;\n            border-radius: 5px;\n            color: white;\n            font-weight: bold;\n        }\n        \n        .risk-critical-bg { background-color: #dc3545; }\n        .risk-high-bg { background-color: #fd7e14; }\n        .risk-medium-bg { background-color: #ffc107; color: #333; }\n        .risk-low-bg { background-color: #28a745; }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <div class=\"customer-name\">$CustomerName</div>\n        <div class=\"report-title\">Active Directory Security Assessment Report</div>\n        <div style=\"font-size: 12px; color: #2E86AB; margin-top: 5px;\">Comprehensive Privileged Groups & Deafult Domain Password Policy Analysis</div>\n        \n        <div class=\"header-info\">\n            <div>\n                <strong>Customer:</strong> $CustomerName<br>\n                <strong>Domain:</strong> $DomainName<br>\n                <strong>Assessment Date:</strong> $ReportDate\n            </div>\n            <div>\n                <strong>Assessed By:</strong> $EngineerName<br>\n                <strong>Report Version:</strong> 11.0<br>\n                <strong>Classification:</strong> Domain Security\n            </div>\n        </div>\n    </div>\n\n    <div class=\"executive-summary no-break\">\n        <h2>Executive Summary</h2>\n        <p>This comprehensive assessment evaluates the Active Directory password policies, fine-grained policies, and <strong>all privileged group memberships</strong> (Domain Admins, Enterprise Admins, Schema Admins, Administrators) for <strong>$CustomerName</strong>. The evaluation compares current configurations against Microsoft security baselines, NIST SP 800-63B guidelines, and industry best practices to identify security risks and provide actionable recommendations.</p>\n        \n        <div class=\"enhanced-metrics\">\n            <div class=\"metric-card\">\n                <div class=\"metric-value\" style=\"color: $(\n                    switch ($PolicyCompliance.RiskLevel) {\n                        'Critical' { '#dc3545' }\n                        'High' { '#fd7e14' }\n                        'Medium' { '#ffc107' }\n                        'Low' { '#28a745' }\n                        default { '#17a2b8' }\n                    }\n                );\">$($PolicyCompliance.RiskLevel.ToUpper())</div>\n                <div class=\"metric-label\">Overall Risk Level</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$($PolicyCompliance.RiskScore)/100</div>\n                <div class=\"metric-label\">Policy Risk Score</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$($PolicyCompliance.Issues.Count)</div>\n                <div class=\"metric-label\">Policy Issues</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$($PrivilegedAccounts.Count)</div>\n                <div class=\"metric-label\">Privileged Accounts</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$($StalePrivileged.Count)</div>\n                <div class=\"metric-label\">Stale Privileged</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$($NeverLoggedOn.Count)</div>\n                <div class=\"metric-label\">Never Used</div>\n            </div>\n        </div>\n        \n        <div class=\"chart-container\">\n            <div class=\"chart-item\">\n                <h4>Security Compliance Score</h4>\n                <div class=\"progress-bar\">\n                    <div class=\"progress-fill\" style=\"width: $((100-$PolicyCompliance.RiskScore))%; background-color: $(\n                        if ((100-$PolicyCompliance.RiskScore) -ge 80) { '#28a745' }\n                        elseif ((100-$PolicyCompliance.RiskScore) -ge 60) { '#ffc107' }\n                        else { '#dc3545' }\n                    );\"></div>\n                </div>\n                <small>$((100-$PolicyCompliance.RiskScore))% Compliant</small>\n            </div>\n            <div class=\"chart-item\">\n                <h4>Privileged Account Health</h4>\n                <div class=\"progress-bar\">\n                    <div class=\"progress-fill\" style=\"width: $(\n                        if ($PrivilegedAccounts.Count -gt 0) {\n                            $HealthyPrivileged = $PrivilegedAccounts | Where-Object { $_.Risk -eq 'Low' -or $_.Risk -eq 'Info' }\n                            [math]::Round(($HealthyPrivileged.Count / $PrivilegedAccounts.Count) * 100, 0)\n                        } else { 0 }\n                    )%; background-color: #28a745;\"></div>\n                </div>\n                <small>$(\n                    if ($PrivilegedAccounts.Count -gt 0) {\n                        $HealthyPrivileged = $PrivilegedAccounts | Where-Object { $_.Risk -eq 'Low' -or $_.Risk -eq 'Info' }\n                        [math]::Round(($HealthyPrivileged.Count / $PrivilegedAccounts.Count) * 100, 0)\n                    } else { 0 }\n                )% Low Risk</small>\n            </div>\n        </div>\n        \n        <div class=\"risk-distribution\">\n            <div class=\"risk-item risk-critical-bg\">\n                <div>$(($PrivilegedAccounts | Where-Object { $_.Risk -eq 'Critical' }).Count)</div>\n                <div style=\"font-size: 9px;\">CRITICAL</div>\n            </div>\n            <div class=\"risk-item risk-high-bg\">\n                <div>$(($PrivilegedAccounts | Where-Object { $_.Risk -eq 'High' }).Count)</div>\n                <div style=\"font-size: 9px;\">HIGH</div>\n            </div>\n            <div class=\"risk-item risk-medium-bg\">\n                <div>$(($PrivilegedAccounts | Where-Object { $_.Risk -eq 'Medium' }).Count)</div>\n                <div style=\"font-size: 9px;\">MEDIUM</div>\n            </div>\n            <div class=\"risk-item risk-low-bg\">\n                <div>$(($PrivilegedAccounts | Where-Object { $_.Risk -eq 'Low' -or $_.Risk -eq 'Info' }).Count)</div>\n                <div style=\"font-size: 9px;\">LOW/INFO</div>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"section no-break\">\n        <h2>Domain Password Policy Assessment</h2>\n        <p>Current domain password policy configuration compared to Microsoft security baselines and NIST SP 800-63B guidelines:</p>\n        \n        <table>\n            <thead>\n                <tr>\n                    <th>Policy Setting</th>\n                    <th>Current Value</th>\n                    <th>Best Practice</th>\n                    <th>Compliance Status</th>\n                </tr>\n            </thead>\n            <tbody>\n                <tr>\n                    <td>Password Complexity</td>\n                    <td>$($DomainPolicy.ComplexityEnabled)</td>\n                    <td>Enabled</td>\n                    <td class=\"$(if($DomainPolicy.ComplexityEnabled){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.ComplexityEnabled){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Minimum Password Length</td>\n                    <td>$($DomainPolicy.MinPasswordLength) characters</td>\n                    <td>14+ characters (NIST SP 800-63B)</td>\n                    <td class=\"$(if($DomainPolicy.MinPasswordLength -ge 14){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.MinPasswordLength -ge 14){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Minimum Password Age</td>\n                    <td>$($DomainPolicy.MinPasswordAge) days</td>\n                    <td>1-2 days (prevents immediate reuse)</td>\n                    <td class=\"$(if($DomainPolicy.MinPasswordAge -ge 1 -and $DomainPolicy.MinPasswordAge -le 2){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.MinPasswordAge -ge 1 -and $DomainPolicy.MinPasswordAge -le 2){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Maximum Password Age</td>\n                    <td>$(if($DomainPolicy.MaxPasswordAge -eq 0){'Never expires'}else{\"$($DomainPolicy.MaxPasswordAge) days\"})</td>\n                    <td>60-365 days or modern auth</td>\n                    <td class=\"$(if(($DomainPolicy.MaxPasswordAge -ge 60 -and $DomainPolicy.MaxPasswordAge -le 365) -or $DomainPolicy.MaxPasswordAge -eq 0){'compliant'}else{'non-compliant'})\">\n                        $(if(($DomainPolicy.MaxPasswordAge -ge 60 -and $DomainPolicy.MaxPasswordAge -le 365) -or $DomainPolicy.MaxPasswordAge -eq 0){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Password History Count</td>\n                    <td>$($DomainPolicy.PasswordHistoryCount) passwords</td>\n                    <td>12+ passwords</td>\n                    <td class=\"$(if($DomainPolicy.PasswordHistoryCount -ge 12){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.PasswordHistoryCount -ge 12){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Account Lockout Threshold</td>\n                    <td>$($DomainPolicy.LockoutThreshold) attempts</td>\n                    <td>5-10 attempts</td>\n                    <td class=\"$(if($DomainPolicy.LockoutThreshold -ge 5 -and $DomainPolicy.LockoutThreshold -le 10){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.LockoutThreshold -ge 5 -and $DomainPolicy.LockoutThreshold -le 10){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Lockout Duration</td>\n                    <td>$($DomainPolicy.LockoutDuration) minutes</td>\n                    <td>15-60 minutes</td>\n                    <td class=\"$(if($DomainPolicy.LockoutDuration -ge 15 -and $DomainPolicy.LockoutDuration -le 60){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.LockoutDuration -ge 15 -and $DomainPolicy.LockoutDuration -le 60){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Reset Account Lockout Counter</td>\n                    <td>$($DomainPolicy.LockoutObservationWindow) minutes</td>\n                    <td>‚â• Lockout Duration ($($DomainPolicy.LockoutDuration) min)</td>\n                    <td class=\"$(if($DomainPolicy.LockoutObservationWindow -ge $DomainPolicy.LockoutDuration){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.LockoutObservationWindow -ge $DomainPolicy.LockoutDuration){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Reversible Encryption</td>\n                    <td>$($DomainPolicy.ReversibleEncryptionEnabled)</td>\n                    <td>Disabled (CRITICAL)</td>\n                    <td class=\"$(if(-not $DomainPolicy.ReversibleEncryptionEnabled){'compliant'}else{'non-compliant'})\">\n                        $(if(-not $DomainPolicy.ReversibleEncryptionEnabled){'‚úì Compliant'}else{'üî• CRITICAL NON-COMPLIANT'})\n                    </td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n\n    <div class=\"section\">\n        <h2>Comprehensive Privileged Group Analysis</h2>\n        <p>Analysis of ALL privileged groups with recursive nested membership support:</p>\n        \n        <h3>Privileged Group Summary</h3>\n        <div class=\"chart-container\">\n            <div class=\"chart-item\">\n                <h4>Group Membership Distribution</h4>\n\"@\n\n    # Calculate group distributions\n    $DomainAdminsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Domain Admins*\" }).Count\n    $EnterpriseAdminsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Enterprise Admins*\" }).Count\n    $SchemaAdminsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Schema Admins*\" }).Count\n    $AdministratorsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Administrators*\" }).Count\n    \n    $HTML += @\"\n                <p><strong>Domain Admins:</strong> $DomainAdminsCount</p>\n                <p><strong>Enterprise Admins:</strong> $EnterpriseAdminsCount</p>\n                <p><strong>Schema Admins:</strong> $SchemaAdminsCount</p>\n                <p><strong>Administrators:</strong> $AdministratorsCount</p>\n            </div>\n            <div class=\"chart-item\">\n                <h4>Risk Assessment Summary</h4>\n                <p><strong>Total Privileged Accounts:</strong> $($PrivilegedAccounts.Count)</p>\n                <p><strong>High Risk Accounts:</strong> $(($PrivilegedAccounts | Where-Object { $_.Risk -eq 'High' -or $_.Risk -eq 'Critical' }).Count)</p>\n                <p><strong>Stale Accounts (90+ days):</strong> $($StalePrivileged.Count)</p>\n                <p><strong>Never Logged On:</strong> $($NeverLoggedOn.Count)</p>\n            </div>\n        </div>\n        \n        <table>\n            <thead>\n                <tr>\n                    <th>Account Name</th>\n                    <th>Display Name</th>\n                    <th>All Privileged Groups</th>\n                    <th>Enabled</th>\n                    <th>Last Logon</th>\n                    <th>Password Age (Days)</th>\n                    <th>Risk Factors</th>\n                    <th>Risk Level</th>\n                </tr>\n            </thead>\n            <tbody>\n\"@\n\n    foreach ($Account in $PrivilegedAccounts) {\n        $RiskColor = switch ($Account.Risk) {\n            'Critical' { '#dc3545' }\n            'High' { '#fd7e14' }\n            'Medium' { '#ffc107' }\n            'Low' { '#28a745' }\n            default { '#17a2b8' }\n        }\n        \n        $LastLogon = if ($Account.LastLogonDate -eq \"Never\") { \"Never\" } else { $Account.LastLogonDate.ToString(\"yyyy-MM-dd\") }\n        $RiskFactorsDisplay = if ($Account.RiskFactors -eq \"\") { \"None\" } else { $Account.RiskFactors }\n        \n        $HTML += @\"\n<tr>\n    <td>$($Account.SamAccountName)</td>\n    <td>$($Account.Name)</td>\n    <td style=\"font-size: 9px;\">$($Account.AllPrivilegedGroups)</td>\n    <td>$($Account.Enabled)</td>\n    <td>$LastLogon</td>\n    <td>$($Account.DaysSincePasswordChange)</td>\n    <td style=\"font-size: 9px;\">$RiskFactorsDisplay</td>\n    <td><span style=\"color: $RiskColor; font-weight: bold;\">$($Account.Risk.ToUpper())</span></td>\n</tr>\n\"@\n    }\n\n    $HTML += @\"\n            </tbody>\n        </table>\n    </div>\n\n    <div class=\"section\">\n        <h2>Security Compliance Issues and Recommendations</h2>\n\"@\n    \n    if ($PolicyCompliance.Issues.Count -eq 0) {\n        $HTML += \"<div class='risk-low'><p><strong>‚úì Excellent:</strong> No policy compliance issues identified. Current configuration aligns with Microsoft security baselines and NIST SP 800-63B guidelines.</p></div>\"\n    }\n    else {\n        foreach ($Issue in $PolicyCompliance.Issues) {\n            $RiskClass = \"risk-$($Issue.Risk.ToLower())\"\n            $HTML += @\"\n        <div class=\"$RiskClass no-break\">\n            <h4>$($Issue.Issue) <span class=\"risk-badge\">$($Issue.Risk.ToUpper())</span></h4>\n            <p><strong>Recommendation:</strong> $($Issue.Recommendation)</p>\n            <p><strong>Best Practice:</strong> $($Issue.BestPractice)</p>\n        </div>\n\"@\n        }\n    }\n\n    # Add Fine-Grained Password Policies section if any exist\n    if ($FGPPs.Count -gt 0) {\n        $HTML += @\"\n    </div>\n\n    <div class=\"section\">\n        <h2>Fine-Grained Password Policies Analysis</h2>\n        <p>The following fine-grained password policies are configured in the domain:</p>\n        <table>\n            <thead>\n                <tr>\n                    <th>Policy Name</th>\n                    <th>Precedence</th>\n                    <th>Min Length</th>\n                    <th>Complexity</th>\n                    <th>Max Age (Days)</th>\n                    <th>Min Age (Days)</th>\n                    <th>Lockout Threshold</th>\n                    <th>Applies To</th>\n                </tr>\n            </thead>\n            <tbody>\n\"@\n        foreach ($FGPP in $FGPPs) {\n            $HTML += \"<tr><td>$($FGPP.Name)</td><td>$($FGPP.Precedence)</td><td>$($FGPP.MinPasswordLength)</td><td>$($FGPP.ComplexityEnabled)</td><td>$($FGPP.MaxPasswordAge)</td><td>$($FGPP.MinPasswordAge)</td><td>$($FGPP.LockoutThreshold)</td><td style='font-size: 9px;'>$($FGPP.AppliesTo)</td></tr>\"\n        }\n        $HTML += @\"\n            </tbody>\n        </table>\n\"@\n    }\n\n    $HTML += @\"\n    </div>\n\n    <div class=\"section\">\n        <h2>Risk Assessment Summary</h2>\n        \n        <div class=\"chart-container\">\n            <div class=\"chart-item\">\n                <h4>Policy Compliance Risk Distribution</h4>\n\"@\n\n    $TotalIssues = $PolicyCompliance.Issues.Count\n    if ($TotalIssues -gt 0) {\n        $CriticalCount = ($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Critical' }).Count\n        $HighCount = ($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'High' }).Count\n        $MediumCount = ($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Medium' }).Count\n        $LowCount = ($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Low' }).Count\n        \n        $HTML += @\"\n                <p><span style=\"color: #dc3545;\">‚óè Critical:</span> $CriticalCount ($([math]::Round(($CriticalCount/$TotalIssues)*100,1))%)</p>\n                <p><span style=\"color: #fd7e14;\">‚óè High:</span> $HighCount ($([math]::Round(($HighCount/$TotalIssues)*100,1))%)</p>\n                <p><span style=\"color: #ffc107;\">‚óè Medium:</span> $MediumCount ($([math]::Round(($MediumCount/$TotalIssues)*100,1))%)</p>\n                <p><span style=\"color: #28a745;\">‚óè Low:</span> $LowCount ($([math]::Round(($LowCount/$TotalIssues)*100,1))%)</p>\n\"@\n    } else {\n        $HTML += \"<p style='color: #28a745; font-weight: bold;'>‚úì No compliance issues identified</p>\"\n    }\n\n    $HTML += @\"\n            </div>\n            <div class=\"chart-item\">\n                <h4>Overall Security Posture</h4>\n                <p><strong>Compliance Score:</strong> $((100-$PolicyCompliance.RiskScore))/100</p>\n                <p><strong>Risk Level:</strong> <span style=\"color: $(\n                    switch ($PolicyCompliance.RiskLevel) {\n                        'Critical' { '#dc3545' }\n                        'High' { '#fd7e14' }\n                        'Medium' { '#ffc107' }\n                        'Low' { '#28a745' }\n                        default { '#17a2b8' }\n                    }\n                );\">$($PolicyCompliance.RiskLevel.ToUpper())</span></p>\n                <p><strong>Total Issues:</strong> $($PolicyCompliance.Issues.Count)</p>\n                <p><strong>Privileged Accounts:</strong> $($PrivilegedAccounts.Count)</p>\n                <p><strong>Stale Privileged:</strong> $($StalePrivileged.Count)</p>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"section\">\n        <h2>Strategic Recommendations and Implementation Roadmap</h2>\n        \n        <div class=\"recommendation\">\n            <h4>üö® IMMEDIATE ACTIONS REQUIRED (0-30 days)</h4>\n            <ul>\n\"@\n\n    # Add specific immediate recommendations\n    if ($CriticalIssues.Count -gt 0) {\n        $HTML += \"<li><strong>CRITICAL PRIORITY:</strong> Immediately address $($CriticalIssues.Count) critical security issues identified in this assessment</li>\"\n    }\n    \n    if ($StalePrivileged.Count -gt 0) {\n        $HTML += \"<li><strong>HIGH PRIORITY:</strong> Review and disable $($StalePrivileged.Count) stale privileged accounts that haven't been used in 90+ days</li>\"\n    }\n    \n    if ($NeverLoggedOn.Count -gt 0) {\n        $HTML += \"<li><strong>HIGH PRIORITY:</strong> Review $($NeverLoggedOn.Count) privileged accounts that have never been used</li>\"\n    }\n    \n    if ($DomainPolicy.MinPasswordLength -lt 14) {\n        $HTML += \"<li>Increase minimum password length requirement to 14+ characters per NIST SP 800-63B guidelines</li>\"\n    }\n    \n    if (-not $DomainPolicy.ComplexityEnabled) {\n        $HTML += \"<li>Enable password complexity requirements to strengthen password security</li>\"\n    }\n\n    if ($DomainPolicy.LockoutThreshold -eq 0) {\n        $HTML += \"<li>Implement account lockout protection with 5-10 failed attempt threshold to prevent brute force attacks</li>\"\n    }\n\n    if ($DomainPolicy.ReversibleEncryptionEnabled) {\n        $HTML += \"<li><strong>CRITICAL:</strong> Disable reversible encryption immediately - passwords are stored in plain text equivalent</li>\"\n    }\n\n    $HTML += @\"\n            </ul>\n        </div>\n        \n        <div class=\"recommendation\">\n            <h4>üìà SHORT-TERM IMPROVEMENTS (1-3 months)</h4>\n            <ul>\n                <li>Deploy multi-factor authentication (MFA) for all privileged accounts across all groups</li>\n                <li>Implement Privileged Access Management (PAM) solution for elevated account management</li>\n                <li>Establish monthly privileged account access reviews for all groups (Domain Admins, Enterprise Admins, Schema Admins, Administrators)</li>\n                <li>Deploy advanced monitoring and alerting for privileged account activities</li>\n                <li>Implement Azure AD Password Protection for enhanced password policy enforcement</li>\n                <li>Establish administrative workstation security baselines with privileged access workstations (PAWs)</li>\n                <li>Implement fine-grained password policies for privileged accounts with stricter requirements</li>\n            </ul>\n        </div>\n        \n        <div class=\"recommendation\">\n            <h4>üéØ LONG-TERM STRATEGIC ENHANCEMENTS (3-6 months)</h4>\n            <ul>\n                <li>Deploy Just-In-Time (JIT) administrative access model for all privileged groups</li>\n                <li>Implement Microsoft's enhanced administrative tier model (Tier 0, 1, 2 separation)</li>\n                <li>Establish continuous security monitoring with SIEM integration for privileged account activities</li>\n                <li>Deploy Privileged Identity Management (PIM) for cloud-hybrid environments</li>\n                <li>Implement regular penetration testing and security assessments focusing on privileged escalation</li>\n                <li>Establish comprehensive security awareness training program with privileged user focus</li>\n                <li>Consider migration to Azure AD Premium for advanced security features and conditional access</li>\n                <li>Implement break-glass emergency access procedures with proper monitoring</li>\n            </ul>\n        </div>\n    </div>\n\n    <div class=\"section\">\n        <h2>Compliance Framework Alignment</h2>\n        <p>This assessment aligns with the following industry standards and frameworks:</p>\n        \n        <table>\n            <thead>\n                <tr>\n                    <th>Framework/Standard</th>\n                    <th>Relevant Controls</th>\n                    <th>Compliance Status</th>\n                    <th>Recommendations</th>\n                </tr>\n            </thead>\n            <tbody>\n                <tr>\n                    <td>Microsoft Security Baseline</td>\n                    <td>Password Policy, Privileged Account Management</td>\n                    <td class=\"$(if($PolicyCompliance.RiskScore -lt 40){'compliant'}else{'non-compliant'})\">\n                        $(if($PolicyCompliance.RiskScore -lt 40){'Aligned'}else{'Requires Attention'})\n                    </td>\n                    <td>$(if($PolicyCompliance.RiskScore -ge 40){'Address identified policy gaps'}else{'Maintain current standards'})</td>\n                </tr>\n                <tr>\n                    <td>NIST Cybersecurity Framework</td>\n                    <td>PR.AC-1, PR.AC-4, PR.AC-7, DE.CM-3</td>\n                    <td class=\"$(if($PolicyCompliance.RiskScore -lt 30){'compliant'}else{'non-compliant'})\">\n                        $(if($PolicyCompliance.RiskScore -lt 30){'Compliant'}else{'Partial Compliance'})\n                    </td>\n                    <td>$(if($PolicyCompliance.RiskScore -ge 30){'Enhance detection and protection controls'}else{'Continue monitoring'})</td>\n                </tr>\n                <tr>\n                    <td>NIST SP 800-63B</td>\n                    <td>Password Length, Complexity, Verification</td>\n                    <td class=\"$(if($DomainPolicy.MinPasswordLength -ge 14){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.MinPasswordLength -ge 14){'Compliant'}else{'Non-Compliant'})\n                    </td>\n                    <td>$(if($DomainPolicy.MinPasswordLength -lt 14){'Increase minimum password length to 14+ characters'}else{'Maintain current standards'})</td>\n                </tr>\n                <tr>\n                    <td>CIS Controls v8</td>\n                    <td>Control 5: Account Management, Control 6: Access Control</td>\n                    <td class=\"$(if($StalePrivileged.Count -eq 0){'compliant'}else{'non-compliant'})\">\n                        $(if($StalePrivileged.Count -eq 0){'Compliant'}else{'Improvement Needed'})\n                    </td>\n                    <td>$(if($StalePrivileged.Count -gt 0){'Remove or disable stale privileged accounts'}else{'Continue regular reviews'})</td>\n                </tr>\n                <tr>\n                    <td>ISO 27001:2022</td>\n                    <td>A.9.2.1, A.9.2.2, A.9.4.3, A.18.1.4</td>\n                    <td class=\"$(if($PolicyCompliance.Issues.Count -lt 3){'compliant'}else{'non-compliant'})\">\n                        $(if($PolicyCompliance.Issues.Count -lt 3){'Satisfactory'}else{'Requires Remediation'})\n                    </td>\n                    <td>$(if($PolicyCompliance.Issues.Count -ge 3){'Address policy compliance gaps'}else{'Maintain documentation'})</td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n\n    <div class=\"footer\">\n        <p><strong>First Technology: RMS SECURITY ASSESSMENT REPORT</strong></p>\n        <p>Prepared by: $EngineerName</p>\n        <p>Assessment Tool: AD Security Assessment v11.0 | Generated: $ReportDate</p>\n        <p>Customer: $CustomerName | Domain: $DomainName</p>\n        <p>Next Recommended Review: $(((Get-Date).AddMonths(3)).ToString('yyyy-MM-dd'))</p>\n        <hr>\n        <p style=\"font-size: 8px;\">This report contains sensitive security information and should be distributed only to authorized personnel.\n        Report includes analysis of Domain Admins, Enterprise Admins, Schema Admins, and Administrators groups with recursive membership evaluation.</p>\n    </div>\n\n</body>\n</html>\n\"@\n\n    return $HTML\n}\n\n# New function to generate comprehensive user analysis HTML report\nfunction New-UserAnalysisHTML {\n    param(\n        $UserAnalysis,\n        $CustomerName,\n        $DomainName,\n        $EngineerName\n    )\n    \n    # Calculate user analysis metrics\n    $TotalUsers = $UserAnalysis.Count\n    $EnabledUsers = ($UserAnalysis | Where-Object { $_.Enabled }).Count\n    $DisabledUsers = $TotalUsers - $EnabledUsers\n    $StaleUsers = ($UserAnalysis | Where-Object { $_.DaysSinceLogon -gt 90 -and $_.Enabled }).Count\n    $NeverLoggedOnUsers = ($UserAnalysis | Where-Object { $_.LastLogonDate -eq 'Never' -and $_.Enabled }).Count\n    $PasswordNeverExpiresUsers = ($UserAnalysis | Where-Object { $_.PasswordNeverExpires -and $_.Enabled }).Count\n    $HighRiskUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'High' -or $_.Risk -eq 'Critical' }).Count\n    \n    $CriticalUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'Critical' }).Count\n    $HighUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'High' }).Count\n    $MediumUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'Medium' }).Count\n    $LowUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'Low' }).Count\n    $InfoUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'Info' }).Count\n    \n    $HTML = @\"\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <title>Domain User Analysis Report</title>\n    <style>\n        @page {\n            margin: 0.5in;\n            @top-center {\n                content: \"Domain User Analysis Report\";\n                font-family: 'Segoe UI', sans-serif;\n                font-size: 10px;\n                color: #666;\n            }\n            @bottom-center {\n                content: \"Page \" counter(page) \" of \" counter(pages);\n                font-family: 'Segoe UI', sans-serif;\n                font-size: 10px;\n                color: #666;\n            }\n        }\n        \n        body {\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n            margin: 0;\n            padding: 20px;\n            background-color: white;\n            line-height: 1.4;\n            font-size: 11px;\n        }\n        \n        .header {\n            text-align: center;\n            border-bottom: 3px solid #28a745;\n            padding-bottom: 15px;\n            margin-bottom: 20px;\n        }\n        \n        .customer-name {\n            font-size: 28px;\n            font-weight: bold;\n            color: #28a745;\n            margin-bottom: 5px;\n            text-transform: uppercase;\n        }\n        \n        .report-title {\n            font-size: 18px;\n            font-weight: bold;\n            color: #333;\n            margin-bottom: 15px;\n        }\n        \n        .header-info {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 20px;\n            margin-top: 15px;\n            font-size: 10px;\n        }\n        \n        .section {\n            margin-bottom: 20px;\n            page-break-inside: avoid;\n        }\n        \n        .section h2 {\n            background: linear-gradient(135deg, #28a745 0%, #1e7e34 100%);\n            color: white;\n            padding: 8px 15px;\n            margin: 0 0 10px 0;\n            font-size: 14px;\n            font-weight: bold;\n        }\n        \n        .section h3 {\n            color: #28a745;\n            font-size: 12px;\n            margin: 15px 0 8px 0;\n            border-bottom: 1px solid #ddd;\n            padding-bottom: 3px;\n        }\n        \n        .executive-summary {\n            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);\n            padding: 15px;\n            border-left: 4px solid #28a745;\n            margin-bottom: 20px;\n        }\n        \n        .metrics-grid {\n            display: grid;\n            grid-template-columns: repeat(6, 1fr);\n            gap: 10px;\n            margin: 15px 0;\n        }\n        \n        .metric-card {\n            text-align: center;\n            padding: 12px;\n            background: white;\n            border: 1px solid #ddd;\n            border-radius: 5px;\n        }\n        \n        .metric-value {\n            font-size: 18px;\n            font-weight: bold;\n            color: #28a745;\n        }\n        \n        .metric-label {\n            font-size: 10px;\n            color: #666;\n            margin-top: 5px;\n        }\n        \n        table {\n            width: 100%;\n            border-collapse: collapse;\n            margin: 10px 0;\n            font-size: 9px;\n        }\n        \n        th, td {\n            border: 1px solid #ddd;\n            padding: 4px;\n            text-align: left;\n        }\n        \n        th {\n            background-color: #f8f9fa;\n            font-weight: bold;\n            color: #28a745;\n        }\n        \n        .risk-critical {\n            background-color: #f8d7da;\n            border-left: 4px solid #dc3545;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-high {\n            background-color: #fff3cd;\n            border-left: 4px solid #ffc107;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-medium {\n            background-color: #d1ecf1;\n            border-left: 4px solid #17a2b8;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-low {\n            background-color: #d4edda;\n            border-left: 4px solid #28a745;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .footer {\n            border-top: 2px solid #28a745;\n            padding-top: 15px;\n            margin-top: 30px;\n            text-align: center;\n            font-size: 9px;\n            color: #666;\n        }\n        \n        .chart-container {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 20px;\n            margin: 15px 0;\n        }\n        \n        .chart-item {\n            background: white;\n            border: 1px solid #ddd;\n            padding: 10px;\n            border-radius: 5px;\n        }\n        \n        .progress-bar {\n            width: 100%;\n            height: 15px;\n            background-color: #e9ecef;\n            border-radius: 8px;\n            overflow: hidden;\n            margin: 5px 0;\n        }\n        \n        .progress-fill {\n            height: 100%;\n            border-radius: 8px;\n        }\n        \n        .no-break { page-break-inside: avoid; }\n        \n        .risk-distribution {\n            display: grid;\n            grid-template-columns: repeat(5, 1fr);\n            gap: 10px;\n            margin: 10px 0;\n        }\n        \n        .risk-item {\n            text-align: center;\n            padding: 8px;\n            border-radius: 5px;\n            color: white;\n            font-weight: bold;\n        }\n        \n        .risk-critical-bg { background-color: #dc3545; }\n        .risk-high-bg { background-color: #fd7e14; }\n        .risk-medium-bg { background-color: #ffc107; color: #333; }\n        .risk-low-bg { background-color: #28a745; }\n        .risk-info-bg { background-color: #17a2b8; }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <div class=\"customer-name\">$CustomerName</div>\n        <div class=\"report-title\">Domain User Analysis Report</div>\n        <div style=\"font-size: 12px; color: #28a745; margin-top: 5px;\">Complete Domain User Security Risk Assessment</div>\n        \n        <div class=\"header-info\">\n            <div>\n                <strong>Customer:</strong> $CustomerName<br>\n                <strong>Domain:</strong> $DomainName<br>\n                <strong>Assessment Date:</strong> $((Get-Date).ToString(\"yyyy-MM-dd HH:mm:ss\"))\n            </div>\n            <div>\n                <strong>Assessed By:</strong> $EngineerName<br>\n                <strong>Report Version:</strong> 11.0<br>\n                <strong>Classification:</strong> Domain Security\n            </div>\n        </div>\n    </div>\n\n    <div class=\"executive-summary no-break\">\n        <h2>Executive Summary - Domain User Analysis</h2>\n        <p>This comprehensive user analysis evaluates <strong>all $TotalUsers domain user accounts</strong> for <strong>$CustomerName</strong> to identify password security risks, stale accounts, and potential security threats. The analysis focuses on user account hygiene, password policies, and access patterns to provide actionable security recommendations.</p>\n        \n        <div class=\"metrics-grid\">\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$TotalUsers</div>\n                <div class=\"metric-label\">Total Users</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$EnabledUsers</div>\n                <div class=\"metric-label\">Enabled Users</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$StaleUsers</div>\n                <div class=\"metric-label\">Stale Users (90+ days)</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$NeverLoggedOnUsers</div>\n                <div class=\"metric-label\">Never Logged On</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$PasswordNeverExpiresUsers</div>\n                <div class=\"metric-label\">Password Never Expires</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$HighRiskUsers</div>\n                <div class=\"metric-label\">High Risk Users</div>\n            </div>\n        </div>\n        \n        <div class=\"risk-distribution\">\n            <div class=\"risk-item risk-critical-bg\">\n                <div>$CriticalUsers</div>\n                <div style=\"font-size: 9px;\">CRITICAL</div>\n            </div>\n            <div class=\"risk-item risk-high-bg\">\n                <div>$HighUsers</div>\n                <div style=\"font-size: 9px;\">HIGH</div>\n            </div>\n            <div class=\"risk-item risk-medium-bg\">\n                <div>$MediumUsers</div>\n                <div style=\"font-size: 9px;\">MEDIUM</div>\n            </div>\n            <div class=\"risk-item risk-low-bg\">\n                <div>$LowUsers</div>\n                <div style=\"font-size: 9px;\">LOW</div>\n            </div>\n            <div class=\"risk-item risk-info-bg\">\n                <div>$InfoUsers</div>\n                <div style=\"font-size: 9px;\">INFO</div>\n            </div>\n        </div>\n        \n        <div class=\"chart-container\">\n            <div class=\"chart-item\">\n                <h4>Account Health Status</h4>\n                <div class=\"progress-bar\">\n                    <div class=\"progress-fill\" style=\"width: $(if($TotalUsers -gt 0){[math]::Round(($EnabledUsers/$TotalUsers)*100,0)}else{0})%; background-color: #28a745;\"></div>\n                </div>\n                <small>$(if($TotalUsers -gt 0){[math]::Round(($EnabledUsers/$TotalUsers)*100,0)}else{0})% Enabled Accounts</small>\n            </div>\n            <div class=\"chart-item\">\n                <h4>Security Risk Level</h4>\n                <div class=\"progress-bar\">\n                    <div class=\"progress-fill\" style=\"width: $(if($EnabledUsers -gt 0){[math]::Round((($EnabledUsers-$HighRiskUsers)/$EnabledUsers)*100,0)}else{100})%; background-color: $(if($HighRiskUsers -eq 0){'#28a745'}else{'#ffc107'});\"></div>\n                </div>\n                <small>$(if($EnabledUsers -gt 0){[math]::Round((($EnabledUsers-$HighRiskUsers)/$EnabledUsers)*100,0)}else{100})% Low Risk</small>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"section no-break\">\n        <h2>Critical and High Risk User Accounts</h2>\n        <p>Immediate attention required for the following high-risk user accounts:</p>\n\"@\n\n    $HighRiskAccounts = $UserAnalysis | Where-Object { $_.Risk -eq 'Critical' -or $_.Risk -eq 'High' } | Sort-Object RiskScore -Descending\n\n    if ($HighRiskAccounts.Count -eq 0) {\n        $HTML += \"<div class='risk-low'><p><strong>‚úì Excellent:</strong> No critical or high-risk user accounts identified.</p></div>\"\n    } else {\n        $HTML += @\"\n        <table>\n            <thead>\n                <tr>\n                    <th>Account Name</th>\n                    <th>Display Name</th>\n                    <th>User Type</th>\n                    <th>Enabled</th>\n                    <th>Last Logon</th>\n                    <th>Password Age (Days)</th>\n                    <th>Risk Factors</th>\n                    <th>Risk</th>\n                </tr>\n            </thead>\n            <tbody>\n\"@\n        \n        foreach ($User in $HighRiskAccounts) {\n            $RiskColor = switch ($User.Risk) {\n                'Critical' { '#dc3545' }\n                'High' { '#fd7e14' }\n                default { '#ffc107' }\n            }\n            \n            $HTML += @\"\n<tr>\n    <td>$($User.SamAccountName)</td>\n    <td>$($User.Name)</td>\n    <td>$($User.UserType)</td>\n    <td>$($User.Enabled)</td>\n    <td>$($User.LastLogonDate)</td>\n    <td>$($User.DaysSincePasswordChange)</td>\n    <td style=\"font-size: 8px;\">$($User.RiskFactors)</td>\n    <td><span style=\"color: $RiskColor; font-weight: bold;\">$($User.Risk.ToUpper())</span></td>\n</tr>\n\"@\n        }\n        \n        $HTML += \"</tbody></table>\"\n    }\n\n    $HTML += @\"\n    </div>\n\n    <div class=\"section\">\n        <h2>Stale Account Analysis</h2>\n        <p>Analysis of accounts that haven't been used recently (potential security risks):</p>\n        \n        <div class=\"chart-container\">\n            <div class=\"chart-item\">\n                <h4>Stale Account Categories</h4>\n                <p><strong>1+ Year Stale:</strong> $(($UserAnalysis | Where-Object { $_.DaysSinceLogon -gt 365 -and $_.Enabled }).Count)</p>\n                <p><strong>6+ Months Stale:</strong> $(($UserAnalysis | Where-Object { $_.DaysSinceLogon -gt 180 -and $_.DaysSinceLogon -le 365 -and $_.Enabled }).Count)</p>\n                <p><strong>3+ Months Stale:</strong> $(($UserAnalysis | Where-Object { $_.DaysSinceLogon -gt 90 -and $_.DaysSinceLogon -le 180 -and $_.Enabled }).Count)</p>\n                <p><strong>Never Logged On:</strong> $NeverLoggedOnUsers</p>\n            </div>\n            <div class=\"chart-item\">\n                <h4>Password Security Issues</h4>\n                <p><strong>Password Never Expires:</strong> $PasswordNeverExpiresUsers</p>\n                <p><strong>Password 1+ Year Old:</strong> $(($UserAnalysis | Where-Object { $_.DaysSincePasswordChange -gt 365 -and $_.Enabled }).Count)</p>\n                <p><strong>Password Never Set:</strong> $(($UserAnalysis | Where-Object { $_.PasswordLastSet -eq 'Never' -and $_.Enabled }).Count)</p>\n                <p><strong>Failed Logon Attempts:</strong> $(($UserAnalysis | Where-Object { $_.BadLogonCount -gt 0 }).Count)</p>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"section\">\n        <h2>User Account Recommendations</h2>\n        \n        <div class=\"risk-critical\">\n            <h4>üö® IMMEDIATE ACTIONS REQUIRED</h4>\n            <ul>\n\"@\n\n    if ($CriticalUsers -gt 0) {\n        $HTML += \"<li><strong>CRITICAL PRIORITY:</strong> Review and remediate $CriticalUsers accounts with critical security risks</li>\"\n    }\n    \n    if ($HighUsers -gt 0) {\n        $HTML += \"<li><strong>HIGH PRIORITY:</strong> Address $HighUsers accounts with high security risks</li>\"\n    }\n    \n    if ($NeverLoggedOnUsers -gt 0) {\n        $HTML += \"<li>Review $NeverLoggedOnUsers enabled accounts that have never been used - consider disabling</li>\"\n    }\n    \n    if ($StaleUsers -gt 0) {\n        $HTML += \"<li>Audit $StaleUsers stale accounts (90+ days inactive) for potential deactivation</li>\"\n    }\n\n    $HTML += @\"\n            </ul>\n        </div>\n        \n        <div class=\"risk-medium\">\n            <h4>üìã MEDIUM PRIORITY ACTIONS</h4>\n            <ul>\n                <li>Implement automated account lifecycle management processes</li>\n                <li>Establish quarterly user access reviews with managers</li>\n                <li>Deploy user activity monitoring for anomaly detection</li>\n                <li>Implement self-service password reset capabilities</li>\n                <li>Review and update password policies based on user behavior patterns</li>\n            </ul>\n        </div>\n        \n        <div class=\"risk-low\">\n            <h4>üéØ LONG-TERM IMPROVEMENTS</h4>\n            <ul>\n                <li>Deploy advanced threat protection for user accounts</li>\n                <li>Implement risk-based authentication policies</li>\n                <li>Establish comprehensive user security training programs</li>\n                <li>Deploy privileged access management for elevated operations</li>\n                <li>Implement continuous compliance monitoring</li>\n            </ul>\n        </div>\n    </div>\n\n    <div class=\"footer\">\n        <p><strong>CONFIDENTIAL USER ANALYSIS REPORT</strong></p>\n        <p>Prepared by: $EngineerName</p>\n        <p>Assessment Tool: User Analysis v11.0 | Generated: $((Get-Date).ToString(\"yyyy-MM-dd HH:mm:ss\"))</p>\n        <p>Customer: $CustomerName | Domain: $DomainName | Users Analyzed: $TotalUsers</p>\n        <p>Next Recommended Review: $(((Get-Date).AddMonths(6)).ToString('yyyy-MM-dd'))</p>\n        <hr>\n        <p style=\"font-size: 8px;\">This user analysis report contains sensitive security information and should be distributed only to authorized personnel.</p>\n    </div>\n\n</body>\n</html>\n\"@\n\n    return $HTML\n}\n\n# Function to convert HTML to PDF using system tools\nfunction Convert-HTMLToPDF {\n    param(\n        [string]$HTMLPath,\n        [string]$PDFPath\n    )\n    \n    Write-Host \"Converting HTML to PDF...\" -ForegroundColor Yellow\n    \n    try {\n        # Try using Microsoft Edge (if available)\n        $EdgePath = \"${env:ProgramFiles(x86)}\\Microsoft\\Edge\\Application\\msedge.exe\"\n        if (-not (Test-Path $EdgePath)) {\n            $EdgePath = \"${env:ProgramFiles}\\Microsoft\\Edge\\Application\\msedge.exe\"\n        }\n        \n        if (Test-Path $EdgePath) {\n            Write-Host \"Using Microsoft Edge for PDF conversion...\" -ForegroundColor Green\n            $Arguments = @(\n                \"--headless\"\n                \"--disable-gpu\"\n                \"--run-all-compositor-stages-before-draw\"\n                \"--disable-extensions\"\n                \"--disable-plugins\"\n                \"--no-sandbox\"\n                \"--print-to-pdf=`\"$PDFPath`\"\"\n                \"`\"$HTMLPath`\"\"\n            )\n            \n            Start-Process -FilePath $EdgePath -ArgumentList $Arguments -Wait -NoNewWindow\n            \n            if (Test-Path $PDFPath) {\n                Write-Host \"PDF generated successfully using Edge!\" -ForegroundColor Green\n                return $true\n            }\n        }\n        \n        # Fallback: Try Chrome\n        $ChromePaths = @(\n            \"${env:ProgramFiles}\\Google\\Chrome\\Application\\chrome.exe\",\n            \"${env:ProgramFiles(x86)}\\Google\\Chrome\\Application\\chrome.exe\",\n            \"${env:LOCALAPPDATA}\\Google\\Chrome\\Application\\chrome.exe\"\n        )\n        \n        $ChromePath = $ChromePaths | Where-Object { Test-Path $_ } | Select-Object -First 1\n        \n        if ($ChromePath) {\n            Write-Host \"Using Google Chrome for PDF conversion...\" -ForegroundColor Green\n            $Arguments = @(\n                \"--headless\"\n                \"--disable-gpu\"\n                \"--run-all-compositor-stages-before-draw\"\n                \"--print-to-pdf=`\"$PDFPath`\"\"\n                \"`\"$HTMLPath`\"\"\n            )\n            \n            Start-Process -FilePath $ChromePath -ArgumentList $Arguments -Wait -NoNewWindow\n            \n            if (Test-Path $PDFPath) {\n                Write-Host \"PDF generated successfully using Chrome!\" -ForegroundColor Green\n                return $true\n            }\n        }\n        \n        Write-Warning \"No suitable PDF converter found. HTML report will be available for manual conversion.\"\n        return $false\n        \n    }\n    catch {\n        Write-Warning \"PDF conversion failed: $($_.Exception.Message)\"\n        return $false\n    }\n}\n\n# Main execution\ntry {\n    $StartTime = Get-Date\n    \n    # Ensure output directory exists\n    $OutputDir = Split-Path $OutputPathPDF -Parent\n    if (-not (Test-Path $OutputDir)) {\n        New-Item -Path $OutputDir -ItemType Directory -Force | Out-Null\n        Write-Host \"Created output directory: $OutputDir\" -ForegroundColor Green\n    }\n\n    # Gather enhanced assessment data\n    Write-Host \"\"\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Yellow\n    Write-Host \"                            GATHERING ASSESSMENT DATA\" -ForegroundColor Yellow\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Yellow\n    \n    $DomainServer = if ($Domain.DNSRoot -ne (Get-ADDomain).DNSRoot) { $Domain.DNSRoot } else { $null }\n    $DomainPolicy = Get-DomainPasswordPolicy -DomainServer $DomainServer\n    $FGPPs = Get-FineGrainedPolicies -DomainServer $DomainServer\n    $PolicyCompliance = Test-PolicyCompliance -Policy $DomainPolicy\n    $PrivilegedAccounts = Get-AllPrivilegedAccounts -DomainServer $DomainServer\n    \n    Write-Host \"\"\n    Write-Host \"Starting comprehensive domain user analysis...\" -ForegroundColor Yellow\n    $UserAnalysis = Get-DomainUserAnalysis -DomainServer $DomainServer\n\n    # Generate Main Security Assessment Report\n    Write-Host \"\"\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Green\n    Write-Host \"                        GENERATING SECURITY ASSESSMENT REPORT\" -ForegroundColor Green\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Green\n    \n    Write-Host \"Generating security assessment HTML report...\" -ForegroundColor Yellow\n    $SecurityHTMLContent = New-SecurityAssessmentHTML -DomainPolicy $DomainPolicy -FGPPs $FGPPs -PolicyCompliance $PolicyCompliance -PrivilegedAccounts $PrivilegedAccounts -CustomerName $CustomerName -DomainName $DomainName -EngineerName $EngineerName\n    $SecurityHTMLContent | Out-File -FilePath $OutputPathHTML -Encoding UTF8\n\n    # Convert Security Assessment to PDF\n    $SecurityPDFCreated = Convert-HTMLToPDF -HTMLPath $OutputPathHTML -PDFPath $OutputPathPDF\n    \n    # Generate User Analysis Report\n    Write-Host \"\"\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Green\n    Write-Host \"                         GENERATING USER ANALYSIS REPORT\" -ForegroundColor Green\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Green\n    \n    Write-Host \"Generating comprehensive user analysis HTML report...\" -ForegroundColor Yellow\n    $UserHTMLContent = New-UserAnalysisHTML -UserAnalysis $UserAnalysis -CustomerName $CustomerName -DomainName $DomainName -EngineerName $EngineerName\n    $UserHTMLContent | Out-File -FilePath $OutputPathUserHTML -Encoding UTF8\n\n    # Convert User Analysis to PDF\n    $UserPDFCreated = Convert-HTMLToPDF -HTMLPath $OutputPathUserHTML -PDFPath $OutputPathUserPDF\n    \n    # Export comprehensive data to CSV\n    Write-Host \"Exporting comprehensive assessment data to CSV...\" -ForegroundColor Yellow\n    $AllData = @()\n    \n    # Add policy compliance data\n    foreach ($Issue in $PolicyCompliance.Issues) {\n        $AllData += [PSCustomObject]@{\n            'Assessment_Date' = $ReportDate\n            'Customer' = $CustomerName\n            'Domain' = $DomainName\n            'Category' = 'Policy Compliance'\n            'Finding' = $Issue.Issue\n            'Risk_Level' = $Issue.Risk\n            'Recommendation' = $Issue.Recommendation\n            'Best_Practice' = $Issue.BestPractice\n            'Status' = 'Non-Compliant'\n            'Account_Name' = 'N/A'\n            'Account_Type' = 'N/A'\n        }\n    }\n    \n    # Add privileged account data\n    foreach ($Account in $PrivilegedAccounts) {\n        $AllData += [PSCustomObject]@{\n            'Assessment_Date' = $ReportDate\n            'Customer' = $CustomerName\n            'Domain' = $DomainName\n            'Category' = 'Privileged Account'\n            'Finding' = \"$($Account.SamAccountName) - $($Account.Name)\"\n            'Risk_Level' = $Account.Risk\n            'Recommendation' = switch ($Account.Risk) {\n                'Critical' { 'Immediate attention required - critical security risk' }\n                'High' { 'Review account usage and disable if unused' }\n                'Medium' { 'Monitor regularly and consider access review' }\n                default { 'Continue monitoring with regular reviews' }\n            }\n            'Best_Practice' = 'Regular review of privileged accounts with quarterly access assessments'\n            'Status' = if ($Account.Enabled) { 'Enabled' } else { 'Disabled' }\n            'Account_Name' = $Account.SamAccountName\n            'Account_Type' = 'Privileged'\n        }\n    }\n    \n    # Add high-risk user data (only Critical and High risk to keep CSV manageable)\n    $HighRiskUsers = $UserAnalysis | Where-Object { $_.Risk -eq 'Critical' -or $_.Risk -eq 'High' }\n    foreach ($User in $HighRiskUsers) {\n        $AllData += [PSCustomObject]@{\n            'Assessment_Date' = $ReportDate\n            'Customer' = $CustomerName\n            'Domain' = $DomainName\n            'Category' = 'High Risk User'\n            'Finding' = \"$($User.SamAccountName) - $($User.Name)\"\n            'Risk_Level' = $User.Risk\n            'Recommendation' = switch ($User.Risk) {\n                'Critical' { 'Immediate review and remediation required' }\n                'High' { 'Review account and address security risks' }\n                default { 'Monitor and review regularly' }\n            }\n            'Best_Practice' = 'Regular user access reviews and account lifecycle management'\n            'Status' = if ($User.Enabled) { 'Enabled' } else { 'Disabled' }\n            'Account_Name' = $User.SamAccountName\n            'Account_Type' = $User.UserType\n        }\n    }\n    \n    $AllData | Export-Csv -Path $OutputPathCSV -NoTypeInformation\n\n    # Display comprehensive results\n    Clear-Host\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Green\n    Write-Host \"                 ACTIVE DIRECTORY SECURITY ASSESSMENT COMPLETED\" -ForegroundColor Green\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Green\n    Write-Host \"\"\n    \n    Write-Host \"üìä ASSESSMENT SUMMARY\" -ForegroundColor Cyan\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    Write-Host \"Customer:                 $CustomerName\" -ForegroundColor White\n    Write-Host \"Domain:                   $DomainName\" -ForegroundColor White\n    Write-Host \"Assessed By:              $EngineerName\" -ForegroundColor White\n    Write-Host \"Assessment Date:          $ReportDate\" -ForegroundColor White\n    Write-Host \"Assessment Duration:      $([math]::Round(((Get-Date) - $StartTime).TotalMinutes, 1)) minutes\" -ForegroundColor White\n    Write-Host \"\"\n    \n    Write-Host \"üö® SECURITY RISK ANALYSIS\" -ForegroundColor Yellow\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    Write-Host \"Overall Risk Level:       $($PolicyCompliance.RiskLevel)\" -ForegroundColor $(\n        switch ($PolicyCompliance.RiskLevel) {\n            'Critical' { 'Red' }\n            'High' { 'Red' }\n            'Medium' { 'Yellow' }\n            'Low' { 'Green' }\n            default { 'Cyan' }\n        }\n    )\n    Write-Host \"Policy Risk Score:        $($PolicyCompliance.RiskScore)/100\" -ForegroundColor White\n    Write-Host \"Policy Compliance:        $((100-$PolicyCompliance.RiskScore))/100\" -ForegroundColor $(if((100-$PolicyCompliance.RiskScore) -ge 70){'Green'}else{'Red'})\n    Write-Host \"Policy Issues Found:      $($PolicyCompliance.Issues.Count)\" -ForegroundColor $(if($PolicyCompliance.Issues.Count -eq 0){'Green'}else{'Red'})\n    Write-Host \"\"\n    \n    Write-Host \"üë• PRIVILEGED ACCOUNT ANALYSIS\" -ForegroundColor Magenta\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    Write-Host \"Total Privileged Accounts: $($PrivilegedAccounts.Count)\" -ForegroundColor White\n    \n    $DomainAdminsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Domain Admins*\" }).Count\n    $EnterpriseAdminsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Enterprise Admins*\" }).Count\n    $SchemaAdminsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Schema Admins*\" }).Count\n    $AdministratorsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Administrators*\" }).Count\n    \n    Write-Host \"  Domain Admins:          $DomainAdminsCount\" -ForegroundColor Cyan\n    Write-Host \"  Enterprise Admins:      $EnterpriseAdminsCount\" -ForegroundColor Cyan\n    Write-Host \"  Schema Admins:          $SchemaAdminsCount\" -ForegroundColor Cyan\n    Write-Host \"  Administrators:         $AdministratorsCount\" -ForegroundColor Cyan\n    Write-Host \"\"\n    \n    $StalePrivileged = $PrivilegedAccounts | Where-Object { $_.DaysSinceLogon -gt 90 -and $_.Enabled }\n    $HighRiskPrivileged = $PrivilegedAccounts | Where-Object { $_.Risk -eq 'High' -or $_.Risk -eq 'Critical' }\n    $NeverLoggedOnPrivileged = $PrivilegedAccounts | Where-Object { $_.LastLogonDate -eq 'Never' }\n    \n    Write-Host \"Stale Privileged (90+ days): $($StalePrivileged.Count)\" -ForegroundColor $(if($StalePrivileged.Count -eq 0){'Green'}else{'Red'})\n    Write-Host \"High-Risk Privileged:     $($HighRiskPrivileged.Count)\" -ForegroundColor $(if($HighRiskPrivileged.Count -eq 0){'Green'}else{'Red'})\n    Write-Host \"Never Used Privileged:    $($NeverLoggedOnPrivileged.Count)\" -ForegroundColor $(if($NeverLoggedOnPrivileged.Count -eq 0){'Green'}else{'Red'})\n    Write-Host \"\"\n    \n    Write-Host \"üë§ DOMAIN USER ANALYSIS\" -ForegroundColor Blue\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    \n    $TotalUsers = $UserAnalysis.Count\n    $EnabledUsers = ($UserAnalysis | Where-Object { $_.Enabled }).Count\n    $StaleUsers = ($UserAnalysis | Where-Object { $_.DaysSinceLogon -gt 90 -and $_.Enabled }).Count\n    $NeverLoggedOnUsers = ($UserAnalysis | Where-Object { $_.LastLogonDate -eq 'Never' -and $_.Enabled }).Count\n    $HighRiskUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'High' -or $_.Risk -eq 'Critical' }).Count\n    $CriticalUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'Critical' }).Count\n    \n    Write-Host \"Total Domain Users:       $TotalUsers\" -ForegroundColor White\n    Write-Host \"Enabled Users:            $EnabledUsers\" -ForegroundColor White\n    Write-Host \"Stale Users (90+ days):   $StaleUsers\" -ForegroundColor $(if($StaleUsers -eq 0){'Green'}else{'Yellow'})\n    Write-Host \"Never Logged On Users:    $NeverLoggedOnUsers\" -ForegroundColor $(if($NeverLoggedOnUsers -eq 0){'Green'}else{'Yellow'})\n    Write-Host \"High-Risk Users:          $HighRiskUsers\" -ForegroundColor $(if($HighRiskUsers -eq 0){'Green'}else{'Red'})\n    Write-Host \"Critical Risk Users:      $CriticalUsers\" -ForegroundColor $(if($CriticalUsers -eq 0){'Green'}else{'Red'})\n    Write-Host \"\"\n    \n    Write-Host \"‚ö†Ô∏è  CRITICAL FINDINGS\" -ForegroundColor Red\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    $CriticalIssues = $PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Critical' }\n    if ($CriticalIssues.Count -eq 0 -and $CriticalUsers -eq 0 -and $HighRiskPrivileged.Count -eq 0) {\n        Write-Host \"‚úÖ No critical security issues identified\" -ForegroundColor Green\n    } else {\n        if ($CriticalIssues.Count -gt 0) {\n            Write-Host \"üî• Policy Issues:\" -ForegroundColor Red\n            foreach ($Issue in $CriticalIssues) {\n                Write-Host \"   ‚Ä¢ $($Issue.Issue)\" -ForegroundColor Red\n            }\n        }\n        if ($CriticalUsers -gt 0) {\n            Write-Host \"üî• $CriticalUsers critical risk user accounts require immediate attention\" -ForegroundColor Red\n        }\n        if ($HighRiskPrivileged.Count -gt 0) {\n            Write-Host \"üî• $($HighRiskPrivileged.Count) high-risk privileged accounts require review\" -ForegroundColor Red\n        }\n    }\n    \n    Write-Host \"\"\n    Write-Host \"üìÑ GENERATED REPORTS\" -ForegroundColor Green\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    \n    if ($SecurityPDFCreated) {\n        Write-Host \"‚úÖ Security Assessment PDF:  $OutputPathPDF\" -ForegroundColor Green\n    } else {\n        Write-Host \"‚ö†Ô∏è  Security PDF Failed:     Manual conversion required\" -ForegroundColor Yellow\n    }\n    Write-Host \"‚úÖ Security HTML Report:     $OutputPathHTML\" -ForegroundColor Green\n    \n    if ($UserPDFCreated) {\n        Write-Host \"‚úÖ User Analysis PDF:        $OutputPathUserPDF\" -ForegroundColor Green\n    } else {\n        Write-Host \"‚ö†Ô∏è  User Analysis PDF Failed: Manual conversion required\" -ForegroundColor Yellow\n    }\n    Write-Host \"‚úÖ User Analysis HTML:       $OutputPathUserHTML\" -ForegroundColor Green\n    Write-Host \"‚úÖ Comprehensive CSV Data:   $OutputPathCSV\" -ForegroundColor Green\n    \n    Write-Host \"\"\n    Write-Host \"üéØ RECOMMENDED NEXT STEPS\" -ForegroundColor Magenta\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    Write-Host \"1. Review both comprehensive reports with customer stakeholders\" -ForegroundColor White\n    Write-Host \"2. Address Critical and High-risk findings within 30 days\" -ForegroundColor White\n    Write-Host \"3. Implement privileged account management improvements\" -ForegroundColor White\n    Write-Host \"4. Establish user lifecycle management processes\" -ForegroundColor White\n    Write-Host \"5. Schedule quarterly follow-up assessments\" -ForegroundColor White\n    \n    # N-Central Summary and Exit Handling (Do not open reports automatically)\n    Write-NCentralLog \"\"\n    Write-NCentralLog \"N-Central Assessment Completed Successfully\" -Level \"Success\"\n    Write-NCentralLog \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\"\n    Write-NCentralLog \"Customer: $CustomerName | Domain: $DomainName | Engineer: $EngineerName\" -Level \"Info\"\n    Write-NCentralLog \"Assessment Duration: $([math]::Round(((Get-Date) - $StartTime).TotalMinutes, 1)) minutes\" -Level \"Info\"\n    Write-NCentralLog \"Overall Risk Level: $($PolicyCompliance.RiskLevel) | Risk Score: $($PolicyCompliance.RiskScore)/100\" -Level \"Info\"\n    Write-NCentralLog \"Total Users: $TotalUsers | Privileged Accounts: $($PrivilegedAccounts.Count) | High Risk Users: $HighRiskUsers\" -Level \"Info\"\n    \n    # Create N-Central summary file\n    try {\n        $ncentralSummaryPath = \"C:\\Temp\\NCentral_AD_Assessment_Summary_$($SafeCustomerName)_$($Timestamp).txt\"\n        $ncentralSummary = @\"\nN-CENTRAL AD SECURITY ASSESSMENT SUMMARY\n=========================================\n\nCustomer: $CustomerName\nDomain: $DomainName  \nAssessment Date: $ReportDate\nExecution Time: $([math]::Round(((Get-Date) - $StartTime).TotalMinutes, 1)) minutes\n\nRISK ASSESSMENT:\nOverall Risk Level: $($PolicyCompliance.RiskLevel)\nRisk Score: $($PolicyCompliance.RiskScore)/100\nCompliance Score: $((100-$PolicyCompliance.RiskScore))/100\nTotal Issues Found: $($PolicyCompliance.Issues.Count)\n\nPRIVILEGED ACCOUNTS:\nTotal Privileged: $($PrivilegedAccounts.Count)\nHigh Risk Privileged: $($HighRiskPrivileged.Count)\n\nUSER ANALYSIS:\nTotal Users: $TotalUsers\nEnabled Users: $EnabledUsers\nHigh Risk Users: $HighRiskUsers\nCritical Risk Users: $CriticalUsers\n\nISSUE BREAKDOWN:\nCritical Issues: $(($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Critical' }).Count + $CriticalUsers + $($HighRiskPrivileged.Count))\nHigh Issues: $(($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'High' }).Count)\nMedium Issues: $(($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Medium' }).Count)\nLow Issues: $(($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Low' }).Count)\n\nFILES GENERATED:\n- Security Assessment HTML: $OutputPathHTML\n- Security Assessment PDF: $OutputPathPDF  \n- User Analysis HTML: $OutputPathUserHTML\n- User Analysis PDF: $OutputPathUserPDF\n- Complete CSV Data: $OutputPathCSV\n\nSTATUS: $( if ($PolicyCompliance.RiskScore -ge 60) { \"REQUIRES IMMEDIATE ATTENTION\" } \n          elseif ($PolicyCompliance.RiskScore -ge 40) { \"NEEDS IMPROVEMENT\" }\n          elseif ($PolicyCompliance.RiskScore -ge 20) { \"ACCEPTABLE WITH MINOR ISSUES\" }\n          else { \"GOOD SECURITY POSTURE\" } )\n\nNext Recommended Assessment: $(((Get-Date).AddMonths(3)).ToString('yyyy-MM-dd'))\n\nN-Central RMS Active Directory Security Assessment Tool v11.1 Complete\nGenerated by: $EngineerName\n\"@\n        $ncentralSummary | Out-File -FilePath $ncentralSummaryPath -Encoding UTF8\n        Write-NCentralLog \"N-Central summary file created: $ncentralSummaryPath\" -Level \"Success\"\n    } catch {\n        Write-NCentralLog \"Failed to create N-Central summary file: $($_.Exception.Message)\" -Level \"Warning\"\n    }\n    \n    Write-NCentralLog \"\"\n    Write-NCentralLog \"Files Generated Successfully:\" -Level \"Success\"\n    Write-NCentralLog \"- Security Assessment HTML: $OutputPathHTML\" -Level \"Info\"\n    Write-NCentralLog \"- Security Assessment PDF: $OutputPathPDF\" -Level \"Info\"\n    Write-NCentralLog \"- User Analysis HTML: $OutputPathUserHTML\" -Level \"Info\"  \n    Write-NCentralLog \"- User Analysis PDF: $OutputPathUserPDF\" -Level \"Info\"\n    Write-NCentralLog \"- Complete CSV Data: $OutputPathCSV\" -Level \"Info\"\n    Write-NCentralLog \"- N-Central Summary: $ncentralSummaryPath\" -Level \"Info\"\n    \n    Write-NCentralLog \"\"\n    Write-NCentralLog \"N-Central AD Security Assessment Tool v11.1 Complete - Assessment Finished\" -Level \"Success\"\n    \n    # N-Central Exit Codes for Monitoring/Alerting\n    $criticalFindings = ($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Critical' }).Count + $CriticalUsers + $($HighRiskPrivileged.Count)\n    $highFindings = ($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'High' }).Count\n    \n    if ($criticalFindings -gt 0) {\n        Write-NCentralLog \"Exiting with error code 2 (Critical security findings detected)\" -Level \"Error\"\n        exit 2\n    } elseif ($PolicyCompliance.RiskScore -ge 60 -or $highFindings -gt 3) {\n        Write-NCentralLog \"Exiting with warning code 1 (High risk level or multiple high findings)\" -Level \"Warning\"\n        exit 1\n    } else {\n        Write-NCentralLog \"Exiting with success code 0 (Acceptable security posture)\" -Level \"Success\"\n        exit 0\n    }\n\n}\ncatch {\n    Write-NCentralLog \"\"\n    Write-NCentralLog \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -Level \"Error\"\n    Write-NCentralLog \"üö® N-CENTRAL AD SECURITY ASSESSMENT ERROR üö®\" -Level \"Error\"\n    Write-NCentralLog \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -Level \"Error\"\n    Write-NCentralLog \"Assessment failed: $($_.Exception.Message)\" -Level \"Error\"\n    Write-NCentralLog \"Stack trace: $($_.ScriptStackTrace)\" -Level \"Error\"\n    Write-NCentralLog \"\"\n    Write-NCentralLog \"TROUBLESHOOTING CHECKLIST:\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ Verify Active Directory PowerShell module is installed (Install-WindowsFeature RSAT-AD-PowerShell)\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ Confirm sufficient domain permissions (Domain Users minimum for read-only assessment)\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ Check network connectivity to domain controllers\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ Ensure C:\\Temp directory exists and is writable\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ Verify Microsoft Edge or Chrome is installed for PDF generation\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ For large domains, ensure adequate memory and processing time\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ Check if domain controllers are reachable and responsive\" -Level \"Warning\"\n    Write-NCentralLog \"\"\n    Write-NCentralLog \"N-Central Assessment Failed - Exiting with error code 3\" -Level \"Error\"\n    exit 3\n}\n\n# End of Active Directory Security Assessment Tool v11.0",
              "timestamp": "2025-08-17T19:02:41.065Z",
              "description": "baseline4 ncentral repo"
            }
          ],
          "created": "2025-08-17T19:01:58.278Z",
          "modified": "2025-08-17T19:02:41.066Z",
          "timeSpent": 0
        },
        {
          "id": "file-1756688692905",
          "name": "test_why ",
          "type": "html",
          "category": "General",
          "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>test_why </title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            margin: 0;\n            padding: 20px;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n            min-height: 100vh;\n        }\n        .container {\n            max-width: 800px;\n            margin: 0 auto;\n            background: rgba(255, 255, 255, 0.1);\n            padding: 30px;\n            border-radius: 15px;\n            backdrop-filter: blur(10px);\n            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);\n        }\n        h1 {\n            color: #fff;\n            text-align: center;\n            margin-bottom: 30px;\n        }\n        .feature {\n            background: rgba(255, 255, 255, 0.1);\n            padding: 20px;\n            margin: 15px 0;\n            border-radius: 10px;\n            border-left: 4px solid #ff073a;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>üöÄ test_why </h1>\n        <div class=\"feature\">\n            <h3>‚ú® Welcome to your new HTML file!</h3>\n            <p>This HTML file was created in Nishen's AI Workspace. You can:</p>\n            <ul>\n                <li>Edit the content using the editor</li>\n                <li>Preview it live using the Preview button</li>\n                <li>Save versions for backup</li>\n                <li>Track time spent working on it</li>\n            </ul>\n        </div>\n        <div class=\"feature\">\n            <h3>üé® Styling</h3>\n            <p>This template includes some modern CSS with glassmorphism effects, gradients, and responsive design.</p>\n        </div>\n        <div class=\"feature\">\n            <h3>üîß Ready to customize</h3>\n            <p>Start building your tool, report, or application!</p>\n        </div>\n    </div>\n    \n    <script>\n        console.log('HTML file loaded in Nishen\\'s AI Workspace!');\n        // Add your JavaScript here\n    </script>\n</body>\n</html>",
          "versions": [],
          "created": "2025-09-01T01:04:52.905Z",
          "modified": "2025-09-01T01:04:52.905Z",
          "timeSpent": 0
        }
      ],
      "totalTimeSpent": 0,
      "created": "2025-08-07T09:38:41.998Z",
      "isTimerRunning": false
    }
  ],
  "nishen-workspace-file-browser": [
    {
      "id": "1",
      "name": "Documents",
      "type": "folder",
      "path": "/Documents",
      "size": 0,
      "modified": "2025-08-06T11:27:52.273Z"
    },
    {
      "id": "2",
      "name": "Projects",
      "type": "folder",
      "path": "/Projects",
      "size": 0,
      "modified": "2025-08-06T11:27:52.273Z"
    },
    {
      "id": "3",
      "name": "Notes Export",
      "type": "folder",
      "path": "/Notes Export",
      "size": 0,
      "modified": "2025-08-06T11:27:52.273Z"
    },
    {
      "id": "4",
      "name": "Welcome.txt",
      "type": "file",
      "path": "/Welcome.txt",
      "size": 284,
      "modified": "2025-08-06T11:27:52.273Z",
      "content": "Welcome to Nishen's AI Workspace File Browser!\n\nThis virtual file system allows you to:\n‚Ä¢ Create and organize files and folders\n‚Ä¢ Edit text files with the built-in editor\n‚Ä¢ Manage your workspace documents\n‚Ä¢ Import/export content between modules\n\nYour files are automatically saved and will persist between sessions.\n\nTry creating a new file or folder to get started!"
    },
    {
      "id": "1754846734165",
      "name": "testme.md",
      "type": "file",
      "path": "/Documents/testme.md",
      "size": 985,
      "modified": "2025-08-10T17:25:41.414Z",
      "content": "The Big Prompt\nSet up a Next.js 15 project with Tailwind v4 and shadcn for any component you require. Do not get confused with Tailwind v3. Use defaults without requiring user input, and set the project up in the root folder without creating a new project folder. Once set up, pull in the Vercel AI SDK and create a modern, ChatGPT-like interface that allows the user to chat with GPT-4. Context of the messages must persist throughout the conversation, so that if I for example start with ‚ÄúHey there, my name is Robin, who are you?‚Äù and ask send a follow up later asking ‚ÄúDo you remember my name?‚Äù, AI SDK must have the required data in its context. Do not persist the messages beyond the current browser session. Do not use local storage or cookies. On reload, all messages should be lost and a new session must begin. Conduct a web search on best practices, how to do this best, and then create a detailed task list to help you accomplish everything that is required for this task.\n"
    },
    {
      "id": "1754846798309",
      "name": "persistant test.docx",
      "type": "file",
      "path": "/Projects/persistant test.docx",
      "size": 985,
      "modified": "2025-08-10T17:26:46.043Z",
      "content": "The Big Prompt\nSet up a Next.js 15 project with Tailwind v4 and shadcn for any component you require. Do not get confused with Tailwind v3. Use defaults without requiring user input, and set the project up in the root folder without creating a new project folder. Once set up, pull in the Vercel AI SDK and create a modern, ChatGPT-like interface that allows the user to chat with GPT-4. Context of the messages must persist throughout the conversation, so that if I for example start with ‚ÄúHey there, my name is Robin, who are you?‚Äù and ask send a follow up later asking ‚ÄúDo you remember my name?‚Äù, AI SDK must have the required data in its context. Do not persist the messages beyond the current browser session. Do not use local storage or cookies. On reload, all messages should be lost and a new session must begin. Conduct a web search on best practices, how to do this best, and then create a detailed task list to help you accomplish everything that is required for this task.\n"
    },
    {
      "id": "1755168812919",
      "name": "AD Security assessment Risk Scoring logic.md",
      "type": "file",
      "path": "/Documents/AD Security assessment Risk Scoring logic.md",
      "size": 0,
      "modified": "2025-08-14T10:53:32.919Z",
      "content": ""
    },
    {
      "id": "1755455721823",
      "name": "RPA - Course Docs",
      "type": "folder",
      "path": "/RPA - Course Docs",
      "size": 0,
      "modified": "2025-08-17T18:35:21.823Z"
    },
    {
      "id": "1755455762825",
      "name": "test.docx",
      "type": "file",
      "path": "/test.docx",
      "size": 0,
      "modified": "2025-08-17T18:36:02.825Z",
      "content": ""
    },
    {
      "id": "1755455841233",
      "name": "RPA511-Formative Assessment 2_20250805_1000a.md",
      "type": "file",
      "path": "/RPA511-Formative Assessment 2_20250805_1000a.md",
      "size": 12952,
      "modified": "2025-08-17T18:37:38.568Z",
      "content": "OCC: Robotic Processing Automation Developer\n\n**YEAR 1**\n\nSAQA ID 119242\n\n**NQF 5**\n\nOverview of Robotic Processing Automation\n\nRPA511\n\nFormative Assessment 2\n\n2025\n\nTable of Contents\n\n[Declaration of authenticity 3](#_Toc205213444)\n\n[Qualification AND ASSESSMENT Details 4](#_Toc205213445)\n\n[instructions 5](#_Toc205213446)\n\n[ASSESSMENT OUTCOME 6](#_Toc205213447)\n\n[QUESTION 1 10 MARKS 7](#_Toc205213448)\n\n[QUESTION 2 10 marks 7](#_Toc205213449)\n\n[QUESTION 3 10 marks 7](#_Toc205213450)\n\n[QUESTION 4 30 Marks 7](#_Toc205213451)\n\n[QUESTION 5 35 marks 10](#_Toc205213452)\n\n[Mark Allocation 13](#_Toc205213453)\n\n[Learning outcomes integrated questions cross-mapping grid 14](#_Toc205213454)\n\n# Declaration of authenticity\n\nI **Click or tap to Enter your Full Name** (FULL NAME)\n\nhereby declare that the contents of this assessment is entirely my own work, completed by me without any paraphrasing/copying, or presented as my own work accessed from any **AI Apps, example ChatGPT, Co-pilot, Perplexity, or any other App**.\n\n**Signature(**Insert Image Signature or Sign**): ![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGIAAABiAgMAAADWy+6dAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJUExURe3z/ejw/ezz/aYd1R8AAAAJcEhZcwAAIdUAACHVAQSctJ0AAAAqSURBVEjHYxANxQ4SGHBIhAaMyozKjMqMyozKjMqMyozKjMoMShmcLTsA8tcrXs/+6rgAAAAASUVORK5CYII=)**\n\n**Date: Click or tap to the Date**\n\n**Qualification AND ASSESSMENT Details**\n\n| **Programme Title** | **OCC: Robotic Processing Automation Developer** |\n| --- | --- |\n| **Module Title** | **Overview of Robotic Processing** |\n| **Module Code** | **RPA511** |\n| **NQF Level** | **5** |\n| **Assessment** | **Formative Assessment 2** |\n| **Hand Out Date** | **4-Aug-25** |\n| **Hand in Date** | **13-Aug-25** |\n| **Total Marks** | **100** |\n| **Developer** | **Mr Newman B. Dube** |\n| **Internal Moderator** | **Mrs Lerato Tsoehlisi** |\n| **Internal Moderator** |     |\n| **External Moderator** |     |\n\n| **Student Name and Surname** | **Click or tap to Enter your Full Name** |\n| --- | --- |\n| **Student Number** | **Click or tap to Enter Student Number** |\n\n# instructions\n\n- Read each question carefully and consider the mark allocation before answering.\n- Ensure you answer all questions.\n- For final submission, include the Declaration of Authenticity, Pre-Assessment Document, Assessment Document, and all the relevant files required to answer the questions **either in a zip folder, if separate, or combine into 1 PDF document**.\n- Only a .zip will be allowed for zipped folders\n- Please include relevant images, tables and charts in your answers for each question to help illustrate and support your response where required.\n- Font style to be used Arial Black 12pt, unless stated otherwise by a question\n- References must be done using Harvard Style including intext citations(This is not optional).\n- Minimum of 5 References are required\n- You are also evaluated on writing skills and grammar.\n- Use the **marking rubric** to understand how marks are allocated\n\n# ASSESSMENT OUTCOME\n\n**KM01 KT02**\n\n- KT0202 ‚Äì RPA vendors\n- KT0203 ‚Äì RPA components\n- KT0205 ‚Äì RPA implementation lifecycle\n- KT0207 ‚Äì RPA security\n\n**KM06 KT01**\n\n- KT0101 ‚Äì Various toolkits in the market\n- KT0102 ‚Äì Toolkit/platform to plan, build, run, measure automation\n- KT0103 ‚Äì Robots and their types\n- KT0104 ‚Äì Workflow development tools overview\n- KT0107 ‚Äì User Interface (UI)\n- KT0108 ‚Äì Software Development Life Cycle (SDLC)\n- KT0109 ‚Äì Understanding specific vendor platforms\n\n# QUESTION 1 10 MARKS\n\nChoose a specific RPA vendor (e.g., UiPath, Blue Prism, Automation Anywhere) and describe its main components. How do its tools support both developers and business users? \\[10 Marks\\]\n\nAnswer Here\n\n# QUESTION 2 10 marks\n\nMap the stages of SDLC to the phases of RPA bot development. For each stage (e.g., planning, design, development), provide one corresponding activity in an RPA context. \\[10 Marks\\]\n\nAnswer Here\n\n# QUESTION 3 10 marks\n\nExplain how a full automation platform (such as UiPath or Automation Anywhere) supports the entire automation lifecycle: planning, building, running, and measuring.\n\nUse a practical example to support your answer. \\[10 Marks\\]\n\nAnswer Here\n\n# QUESTION 4 30 Marks\n\n1. You need to build a bot that scrapes prices from a website. It should open the browser, go to a product page, extract the price, check if the price is less than R100, and log a \"Buy\" message if true. If the price is above R100, log \"Too expensive\". The process should repeat for 10 products.  \n\nDesign a flowchart representing the bot‚Äôs loop, decision-making, and logging process. (Insert Flowchart Image below) \\[15 Marks\\]\n\n![A white square with a blue border\n\nAI-generated content may be incorrect.](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAIAAAAiOjnJAAAAAXNSR0IArs4c6QAAAAlwSFlzAAASdAAAEnQB3mYfeAAAA5dJREFUeF7t0rEVgkAAREG4BgjpvzvJsAA9DSiBHzFbwAb/zTrnPN7fxRS4r8C+jfV1fu479KTAVWAooUBRAKyiqs8FLAiSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSYOwbW0nZJ5/+Uf0Ahm8Ksdfm760AAAAASUVORK5CYII=)\n\n1. You are creating a bot that logs into an email account and checks unread messages. If a message has the subject line \"Invoice\", it should download the attachment and save it to a folder called \"Invoices\". If the email has no attachments, it should skip to the next one.\n\nDraw a flowchart to represent this bot's logic, including loops and conditionals. (Insert Flowchart Image below)\n\n\\[15 marks\\]\n\n![A white square with a blue border\n\nAI-generated content may be incorrect.](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAIAAAAiOjnJAAAAAXNSR0IArs4c6QAAAAlwSFlzAAASdAAAEnQB3mYfeAAAA5dJREFUeF7t0rEVgkAAREG4BgjpvzvJsAA9DSiBHzFbwAb/zTrnPN7fxRS4r8C+jfV1fu479KTAVWAooUBRAKyiqs8FLAiSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSYOwbW0nZJ5/+Uf0Ahm8Ksdfm760AAAAASUVORK5CYII=)\n\n# QUESTION 5 35 marks\n\nDesign a workflow (not a full bot yet) for an RPA process that:\n\n1. Opens a browser\n2. Logs into a web portal\n3. Navigates to a user dashboard\n4. Extracts user data (e.g., name, ID, status)\n5. Logs or stores the extracted data\n6. Identify all required steps and draw a workflow design. Include reusable components, variables, and logging. \\[10 Marks\\]\n\n![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAIAAAAiOjnJAAAAAXNSR0IArs4c6QAAAAlwSFlzAAASdAAAEnQB3mYfeAAAA5dJREFUeF7t0rEVgkAAREG4BgjpvzvJsAA9DSiBHzFbwAb/zTrnPN7fxRS4r8C+jfV1fu479KTAVWAooUBRAKyiqs8FLAiSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSAKwkq1OwGEgKgJVkdQoWA0kBsJKsTsFiICkAVpLVKVgMJAXASrI6BYuBpABYSVanYDGQFAAryeoULAaSAmAlWZ2CxUBSYOwbW0nZJ5/+Uf0Ahm8Ksdfm760AAAAASUVORK5CYII=)\n\n1. Explain how you ensured secure handling of login credentials in your workflow. \\[5 Marks\\]\n\nAnswer Here\n\n1. Discuss the role of selectors in your workflow. How did you ensure the bot consistently interacts with the correct UI elements? \\[10 Marks\\]\n\nAnswer Here\n\n1. Explain where and why you would use variables in this workflow. Provide examples of at least two variables and define their scope. \\[10 Marks\\]\n\nAnswer Here\n\n**End of Assessment**\n\n**MARK ALLOCATION**\n\n| **Question** | **Topic** | **Criteria** | **Marks** | **Guidelines for Full Marks** |\n| --- | --- | --- | --- | --- |\n| **Q1** | RPA Vendor & Components | Identify vendor, describe components, support for dev & business users | 10  | Correct vendor; Studio/Orchestrator/Recorder explained; relevance to both user types shown |\n| **Q2** | SDLC Mapping in RPA | Link SDLC stages to RPA with examples | 10  | At least 5 SDLC stages mapped with accurate, relevant RPA activities |\n| **Q3** | Automation Lifecycle | Explain plan, build, run, measure + example | 10  | Each stage explained with a relevant, real-world RPA example |\n| **Q4a** | Flowchart: Price Bot | Loop, condition (<R100), log actions | 15  | Correct use of loops, IF logic, clear decision branches, \"Buy\"/\"Too expensive\" logging shown |\n| **Q4b** | Flowchart: Email Bot | Loop unread emails, check subject, download/save attachments | 15  | Loop structure, condition on \"Invoice\", save action correctly mapped |\n| **Q5a** | Workflow Design | Open browser, login, navigate, extract, log; reusable parts, variables | 10  | All steps included in logical order; components and variables clearly labeled |\n| **Q5b** | Secure Credentials | Credential security methods | 5   | Use of Credential Manager, secure input, or encrypted storage |\n| **Q5c** | Selectors | Selector usage and reliability | 10  | Selectors explained with dynamic/anchor techniques to avoid failure |\n| **Q5d** | Variables & Scope | Variable use, types, and scope examples | 10  | Clear explanation with at least 2 variable examples and scoped properly |\n|     |     | **TOTAL** | **100** |     |\n\n# Mark Allocation\n\n| **Task** | **Marks** | **Student Marks** |\n| --- | --- | --- |\n| References | 5   |     |\n| Question 1 | 10  |     |\n| Question 2 | 10  |     |\n| Question 3 | 10  |     |\n| Question 4 | 30  |     |\n| Question 5 | 35  |     |\n| Total | 100 |     |\n\nLearning outcomes integrated questions cross-mapping grid\n\n| **LO No.** | **Learning Outcome Description** | **Question** | **Marks** |\n| --- | --- | --- | --- |\n| **KT0202** | **RPA vendors** | **Q1** | **10** |\n| **KT0108** | **Software Development Life Cycle (SDLC)** | **Q2** | **10** |\n| **KT0102** | **Toolkit/platform to plan, build, run, measure automation** | **Q3** | **10** |\n| **KT0104** | **Workflow development tools overview** | **Q4a** | **15** |\n| **KT0103** | **Robots and their types** | **Q4b** | **15** |\n| **KT0101** | **Various toolkits in the market** | **Q5a** | **10** |\n| **KT0207** | **RPA security** | **Q5b** | **5** |\n| **KT0107** | **User Interface (UI)** | **Q5c** | **10** |\n| **KT0203** | **RPA components** | **Q5d** | **10** |\n| **Referencing** |     | **Referencing** | **5** |\n|     |     |     |     |\n| **TOTAL MARKS** |     |     | **100** |"
    },
    {
      "id": "1755455908122",
      "name": "RPA511-Answers-Formative Assessment 2_20250805_1000a.md",
      "type": "file",
      "path": "/RPA511-Answers-Formative Assessment 2_20250805_1000a.md",
      "size": 0,
      "modified": "2025-08-17T18:38:28.122Z",
      "content": ""
    }
  ],
  "nishen-workspace-prod_REDUNDANT": {
    "data": [
      {
        "id": "proj-1",
        "name": "Production RMS Tools",
        "description": "Live production system administration tools and scripts",
        "files": [
          {
            "id": "file-1",
            "name": "live-monitor.ps1",
            "type": "script",
            "category": "Monitoring",
            "content": "# Production Live Monitor Script\n# Author: Nishen Harichunder\n# WARNING: This script runs in production environment\n\nParam(\n    [string]$Environment = \"PRODUCTION\",\n    [switch]$AlertMode = $true\n)\n\nWrite-Host \"Starting production monitor for environment: $Environment\" -ForegroundColor Red\n\n# Production monitoring logic here\nif ($AlertMode) {\n    Write-Host \"ALERT MODE ENABLED - Will send notifications on issues\" -ForegroundColor Yellow\n}\n\n# Add your production monitoring logic here",
            "versions": [],
            "created": "2025-05-01T00:00:00.000Z",
            "modified": "2025-07-08T00:00:00.000Z",
            "timeSpent": 14400
          },
          {
            "id": "file-2",
            "name": "prod-status-dashboard.html",
            "type": "html",
            "category": "Dashboard",
            "content": "<!DOCTYPE html>\n<html>\n<head>\n    <title>Production Status Dashboard</title>\n    <style>\n        body { font-family: Arial, sans-serif; background: #000; color: #fff; }\n        .header { background: #ff073a; color: white; padding: 20px; text-align: center; }\n        .status-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; padding: 20px; }\n        .status-card { background: #1a1a1a; border: 1px solid #333; border-radius: 8px; padding: 20px; }\n        .status-green { border-left: 4px solid #00ff00; }\n        .status-red { border-left: 4px solid #ff0000; }\n        .status-yellow { border-left: 4px solid #ffff00; }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <h1>üöÄ Production Status Dashboard</h1>\n        <p>Live system monitoring for RMS Production Environment</p>\n    </div>\n    <div class=\"status-grid\">\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Web Services</h3>\n            <p>All services operational</p>\n            <small>Last check: 2 minutes ago</small>\n        </div>\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Database</h3>\n            <p>Performance optimal</p>\n            <small>Response time: 45ms</small>\n        </div>\n        <div class=\"status-card status-yellow\">\n            <h3>‚ö†Ô∏è Storage</h3>\n            <p>85% capacity used</p>\n            <small>Monitoring closely</small>\n        </div>\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Security</h3>\n            <p>No threats detected</p>\n            <small>Last scan: 1 hour ago</small>\n        </div>\n    </div>\n</body>\n</html>",
            "versions": [],
            "created": "2025-05-15T00:00:00.000Z",
            "modified": "2025-07-08T00:00:00.000Z",
            "timeSpent": 7200
          }
        ],
        "totalTimeSpent": 21600,
        "created": "2025-05-01T00:00:00.000Z",
        "isTimerRunning": false
      },
      {
        "id": "proj-1754641340163",
        "name": "RMS Security Assessments Scripts & Reports",
        "description": "Collection of Scripts in Production",
        "files": [
          {
            "id": "file-1754641865329",
            "name": "Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1",
            "type": "script",
            "category": "Security, Assessment, AD, PAssword",
            "content": "# Production PowerShell Script\n# Created in Nishen's AI Workspace - PRODUCTION ENVIRONMENT\n# File: Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1\n# WARNING: This script will run in production - use extreme caution\n\nparam(\n    [string]$Environment = \"PRODUCTION\",\n    [switch]$DryRun = $false\n)\n\n# Production safety check\nif ($Environment -eq \"PRODUCTION\" -and -not $DryRun) {\n    Write-Host \"‚ö†Ô∏è  PRODUCTION MODE ENABLED - This will affect live systems!\" -ForegroundColor Red\n    $confirm = Read-Host \"Are you sure you want to continue? (yes/no)\"\n    if ($confirm -ne \"yes\") {\n        Write-Host \"Operation cancelled.\" -ForegroundColor Yellow\n        exit 0\n    }\n}\n\nWrite-Host \"Starting production script: Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1\" -ForegroundColor Green\n\ntry {\n    # Add your production script logic here\n    Write-Host \"Production script execution completed successfully!\" -ForegroundColor Green\n}\ncatch {\n    Write-Error \"Production script failed: $_\"\n    # Add production error handling/alerting here\n    exit 1\n}",
            "versions": [],
            "created": "2025-08-08T08:31:05.329Z",
            "modified": "2025-08-08T08:31:05.329Z",
            "timeSpent": 0
          }
        ],
        "totalTimeSpent": 0,
        "created": "2025-08-08T08:22:20.163Z",
        "isTimerRunning": false
      }
    ],
    "timestamp": "2025-09-29T01:06:08.136Z",
    "operation": "AUTO_SAVE",
    "component": "PROD"
  },
  "nishen-workspace-prod": [
    {
      "id": "proj-1",
      "name": "Production RMS Tools",
      "description": "Live production system administration tools and scripts",
      "files": [
        {
          "id": "file-1",
          "name": "live-monitor.ps1",
          "type": "script",
          "category": "Monitoring",
          "content": "# Production Live Monitor Script\n# Author: Nishen Harichunder\n# WARNING: This script runs in production environment\n\nParam(\n    [string]$Environment = \"PRODUCTION\",\n    [switch]$AlertMode = $true\n)\n\nWrite-Host \"Starting production monitor for environment: $Environment\" -ForegroundColor Red\n\n# Production monitoring logic here\nif ($AlertMode) {\n    Write-Host \"ALERT MODE ENABLED - Will send notifications on issues\" -ForegroundColor Yellow\n}\n\n# Add your production monitoring logic here",
          "versions": [],
          "created": "2025-05-01T00:00:00.000Z",
          "modified": "2025-07-08T00:00:00.000Z",
          "timeSpent": 14400
        },
        {
          "id": "file-2",
          "name": "prod-status-dashboard.html",
          "type": "html",
          "category": "Dashboard",
          "content": "<!DOCTYPE html>\n<html>\n<head>\n    <title>Production Status Dashboard</title>\n    <style>\n        body { font-family: Arial, sans-serif; background: #000; color: #fff; }\n        .header { background: #ff073a; color: white; padding: 20px; text-align: center; }\n        .status-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; padding: 20px; }\n        .status-card { background: #1a1a1a; border: 1px solid #333; border-radius: 8px; padding: 20px; }\n        .status-green { border-left: 4px solid #00ff00; }\n        .status-red { border-left: 4px solid #ff0000; }\n        .status-yellow { border-left: 4px solid #ffff00; }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <h1>üöÄ Production Status Dashboard</h1>\n        <p>Live system monitoring for RMS Production Environment</p>\n    </div>\n    <div class=\"status-grid\">\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Web Services</h3>\n            <p>All services operational</p>\n            <small>Last check: 2 minutes ago</small>\n        </div>\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Database</h3>\n            <p>Performance optimal</p>\n            <small>Response time: 45ms</small>\n        </div>\n        <div class=\"status-card status-yellow\">\n            <h3>‚ö†Ô∏è Storage</h3>\n            <p>85% capacity used</p>\n            <small>Monitoring closely</small>\n        </div>\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Security</h3>\n            <p>No threats detected</p>\n            <small>Last scan: 1 hour ago</small>\n        </div>\n    </div>\n</body>\n</html>",
          "versions": [],
          "created": "2025-05-15T00:00:00.000Z",
          "modified": "2025-07-08T00:00:00.000Z",
          "timeSpent": 7200
        }
      ],
      "totalTimeSpent": 21600,
      "created": "2025-05-01T00:00:00.000Z",
      "isTimerRunning": false
    },
    {
      "id": "proj-1754641340163",
      "name": "RMS Security Assessments Scripts & Reports",
      "description": "Collection of Scripts in Production",
      "files": [
        {
          "id": "file-1754641865329",
          "name": "Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1",
          "type": "script",
          "category": "Security, Assessment, AD, PAssword",
          "content": "# Production PowerShell Script\n# Created in Nishen's AI Workspace - PRODUCTION ENVIRONMENT\n# File: Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1\n# WARNING: This script will run in production - use extreme caution\n\nparam(\n    [string]$Environment = \"PRODUCTION\",\n    [switch]$DryRun = $false\n)\n\n# Production safety check\nif ($Environment -eq \"PRODUCTION\" -and -not $DryRun) {\n    Write-Host \"‚ö†Ô∏è  PRODUCTION MODE ENABLED - This will affect live systems!\" -ForegroundColor Red\n    $confirm = Read-Host \"Are you sure you want to continue? (yes/no)\"\n    if ($confirm -ne \"yes\") {\n        Write-Host \"Operation cancelled.\" -ForegroundColor Yellow\n        exit 0\n    }\n}\n\nWrite-Host \"Starting production script: Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1\" -ForegroundColor Green\n\ntry {\n    # Add your production script logic here\n    Write-Host \"Production script execution completed successfully!\" -ForegroundColor Green\n}\ncatch {\n    Write-Error \"Production script failed: $_\"\n    # Add production error handling/alerting here\n    exit 1\n}",
          "versions": [],
          "created": "2025-08-08T08:31:05.329Z",
          "modified": "2025-08-08T08:31:05.329Z",
          "timeSpent": 0
        }
      ],
      "totalTimeSpent": 0,
      "created": "2025-08-08T08:22:20.163Z",
      "isTimerRunning": false
    }
  ],
  "nishen-workspace-categories": [
    {
      "id": "cat-1",
      "name": "System Admin",
      "color": "#ff073a",
      "count": 2
    },
    {
      "id": "cat-2",
      "name": "Development",
      "color": "#cc5500",
      "count": 3
    },
    {
      "id": "cat-3",
      "name": "Documentation",
      "color": "#0ea5e9",
      "count": 6
    },
    {
      "id": "cat-4",
      "name": "Ideas",
      "color": "#10b981",
      "count": 0
    },
    {
      "id": "cat-5",
      "name": "Personal",
      "color": "#8B9499",
      "count": 1
    },
    {
      "id": "cat-1757453442298",
      "name": "Setup Scripts -1installer",
      "color": "#8b5cf6",
      "count": 1
    },
    {
      "id": "cat-1759096366386",
      "name": "HTML Tools",
      "color": "#ff073a",
      "count": 3
    }
  ],
  "nishen-workspace-prod_BACKUP": [
    {
      "id": "proj-1",
      "name": "Production RMS Tools",
      "description": "Live production system administration tools and scripts",
      "files": [
        {
          "id": "file-1",
          "name": "live-monitor.ps1",
          "type": "script",
          "category": "Monitoring",
          "content": "# Production Live Monitor Script\n# Author: Nishen Harichunder\n# WARNING: This script runs in production environment\n\nParam(\n    [string]$Environment = \"PRODUCTION\",\n    [switch]$AlertMode = $true\n)\n\nWrite-Host \"Starting production monitor for environment: $Environment\" -ForegroundColor Red\n\n# Production monitoring logic here\nif ($AlertMode) {\n    Write-Host \"ALERT MODE ENABLED - Will send notifications on issues\" -ForegroundColor Yellow\n}\n\n# Add your production monitoring logic here",
          "versions": [],
          "created": "2025-05-01T00:00:00.000Z",
          "modified": "2025-07-08T00:00:00.000Z",
          "timeSpent": 14400
        },
        {
          "id": "file-2",
          "name": "prod-status-dashboard.html",
          "type": "html",
          "category": "Dashboard",
          "content": "<!DOCTYPE html>\n<html>\n<head>\n    <title>Production Status Dashboard</title>\n    <style>\n        body { font-family: Arial, sans-serif; background: #000; color: #fff; }\n        .header { background: #ff073a; color: white; padding: 20px; text-align: center; }\n        .status-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; padding: 20px; }\n        .status-card { background: #1a1a1a; border: 1px solid #333; border-radius: 8px; padding: 20px; }\n        .status-green { border-left: 4px solid #00ff00; }\n        .status-red { border-left: 4px solid #ff0000; }\n        .status-yellow { border-left: 4px solid #ffff00; }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <h1>üöÄ Production Status Dashboard</h1>\n        <p>Live system monitoring for RMS Production Environment</p>\n    </div>\n    <div class=\"status-grid\">\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Web Services</h3>\n            <p>All services operational</p>\n            <small>Last check: 2 minutes ago</small>\n        </div>\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Database</h3>\n            <p>Performance optimal</p>\n            <small>Response time: 45ms</small>\n        </div>\n        <div class=\"status-card status-yellow\">\n            <h3>‚ö†Ô∏è Storage</h3>\n            <p>85% capacity used</p>\n            <small>Monitoring closely</small>\n        </div>\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Security</h3>\n            <p>No threats detected</p>\n            <small>Last scan: 1 hour ago</small>\n        </div>\n    </div>\n</body>\n</html>",
          "versions": [],
          "created": "2025-05-15T00:00:00.000Z",
          "modified": "2025-07-08T00:00:00.000Z",
          "timeSpent": 7200
        }
      ],
      "totalTimeSpent": 21600,
      "created": "2025-05-01T00:00:00.000Z",
      "isTimerRunning": false
    },
    {
      "id": "proj-1754641340163",
      "name": "RMS Security Assessments Scripts & Reports",
      "description": "Collection of Scripts in Production",
      "files": [
        {
          "id": "file-1754641865329",
          "name": "Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1",
          "type": "script",
          "category": "Security, Assessment, AD, PAssword",
          "content": "# Production PowerShell Script\n# Created in Nishen's AI Workspace - PRODUCTION ENVIRONMENT\n# File: Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1\n# WARNING: This script will run in production - use extreme caution\n\nparam(\n    [string]$Environment = \"PRODUCTION\",\n    [switch]$DryRun = $false\n)\n\n# Production safety check\nif ($Environment -eq \"PRODUCTION\" -and -not $DryRun) {\n    Write-Host \"‚ö†Ô∏è  PRODUCTION MODE ENABLED - This will affect live systems!\" -ForegroundColor Red\n    $confirm = Read-Host \"Are you sure you want to continue? (yes/no)\"\n    if ($confirm -ne \"yes\") {\n        Write-Host \"Operation cancelled.\" -ForegroundColor Yellow\n        exit 0\n    }\n}\n\nWrite-Host \"Starting production script: Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1\" -ForegroundColor Green\n\ntry {\n    # Add your production script logic here\n    Write-Host \"Production script execution completed successfully!\" -ForegroundColor Green\n}\ncatch {\n    Write-Error \"Production script failed: $_\"\n    # Add production error handling/alerting here\n    exit 1\n}",
          "versions": [],
          "created": "2025-08-08T08:31:05.329Z",
          "modified": "2025-08-08T08:31:05.329Z",
          "timeSpent": 0
        }
      ],
      "totalTimeSpent": 0,
      "created": "2025-08-08T08:22:20.163Z",
      "isTimerRunning": false
    }
  ],
  "nishen-workspace-notes_BACKUP": [
    {
      "id": "note-1759098468379",
      "title": "Task Tracker",
      "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Task Tracker</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            margin: 0;\n            padding: 20px;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n            min-height: 100vh;\n        }\n        .container {\n            max-width: 800px;\n            margin: 0 auto;\n            background: rgba(255, 255, 255, 0.1);\n            padding: 30px;\n            border-radius: 15px;\n            backdrop-filter: blur(10px);\n        }\n        h1 { color: #fff; text-align: center; margin-bottom: 30px; }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>üöÄ Task Tracker</h1>\n        <p>Start building your HTML content here...</p>\n    </div>\n</body>\n</html>",
      "category": "HTML Tools",
      "tags": [
        "tasks"
      ],
      "created": "2025-09-28T22:27:48.379Z",
      "modified": "2025-09-28T22:27:48.379Z",
      "isPinned": false,
      "isArchived": false,
      "type": "html"
    },
    {
      "id": "note-1759098334978",
      "title": "Budget Tracker",
      "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Budget Tracker</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            margin: 0;\n            padding: 20px;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n            min-height: 100vh;\n        }\n        .container {\n            max-width: 800px;\n            margin: 0 auto;\n            background: rgba(255, 255, 255, 0.1);\n            padding: 30px;\n            border-radius: 15px;\n            backdrop-filter: blur(10px);\n        }\n        h1 { color: #fff; text-align: center; margin-bottom: 30px; }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>üöÄ Budget Tracker</h1>\n        <p>Start building your HTML content here...</p>\n    </div>\n</body>\n</html>",
      "category": "HTML Tools",
      "tags": [
        "budget"
      ],
      "created": "2025-09-28T22:25:34.978Z",
      "modified": "2025-09-28T22:25:34.978Z",
      "isPinned": false,
      "isArchived": false,
      "type": "html"
    },
    {
      "id": "note-1759096483129",
      "title": "Nishen's Engineer Dashboard",
      "content": "<!DOCTYPE html>\n<!-- saved from url=(0081)file:///X:/ClaudeCode/eNGINEdashBoard_Tasks/Nishen'sTask_Notes_FileDashboard.html -->\n<html lang=\"en\"><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\n    \n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Nishen's Engineer Dashboard</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        body {\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);\n            color: #ffffff;\n            min-height: 100vh;\n            padding: 15px;\n        }\n\n        .header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 20px;\n            padding: 15px 20px;\n            background: rgba(255, 255, 255, 0.1);\n            border-radius: 12px;\n            backdrop-filter: blur(10px);\n            gap: 20px;\n            height: 120px;\n        }\n\n        .header-left {\n            flex: 0 0 200px;\n        }\n\n        .header-center {\n            flex: 1;\n            text-align: center;\n        }\n\n        .header-right {\n            flex: 0 0 250px;\n            display: flex;\n            flex-direction: column;\n            align-items: flex-end;\n            gap: 10px;\n        }\n\n        .header-center h1 {\n            font-size: 1.8em;\n            margin-bottom: 8px;\n            color: #ffffff;\n            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);\n        }\n\n        /* Navigation Tabs */\n        .nav-tabs {\n            display: flex;\n            background: rgba(255, 255, 255, 0.1);\n            border-radius: 8px;\n            padding: 4px;\n            margin-top: 8px;\n            backdrop-filter: blur(10px);\n            justify-content: center;\n        }\n\n        .nav-tab {\n            background: transparent;\n            border: none;\n            color: rgba(255, 255, 255, 0.7);\n            padding: 8px 20px;\n            border-radius: 6px;\n            cursor: pointer;\n            font-size: 0.9em;\n            font-weight: 500;\n            transition: all 0.3s ease;\n            margin: 0 2px;\n        }\n\n        .nav-tab:hover {\n            color: #ffffff;\n            background: rgba(255, 255, 255, 0.1);\n        }\n\n        .nav-tab.active {\n            background: rgba(255, 255, 255, 0.2);\n            color: #ffffff;\n            font-weight: 600;\n            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\n        }\n\n        .header-center p {\n            font-size: 1em;\n            opacity: 0.9;\n        }\n\n        /* DateTime Display Styles */\n        .datetime-display {\n            text-align: right;\n            margin-bottom: 10px;\n        }\n\n        .current-time {\n            font-size: 1.6em;\n            font-weight: bold;\n            color: #ffffff;\n            font-family: 'Courier New', monospace;\n            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);\n        }\n\n        .current-date {\n            font-size: 0.85em;\n            color: #b8d4f0;\n            margin-top: 5px;\n        }\n\n        /* Config Controls Styles */\n        .config-controls {\n            display: flex;\n            gap: 10px;\n        }\n\n        .control-btn {\n            background: rgba(255, 255, 255, 0.2);\n            color: white;\n            border: none;\n            padding: 8px 15px;\n            border-radius: 8px;\n            cursor: pointer;\n            font-size: 0.85em;\n            transition: all 0.3s ease;\n            backdrop-filter: blur(5px);\n        }\n\n        .control-btn:hover {\n            background: rgba(255, 255, 255, 0.3);\n            transform: translateY(-2px);\n        }\n\n        .export-btn:hover {\n            background: rgba(76, 175, 80, 0.6);\n        }\n\n        .import-btn:hover {\n            background: rgba(33, 150, 243, 0.6);\n        }\n\n        /* Hidden file input for import */\n        #importFileInput {\n            display: none;\n        }\n\n        .grid-container {\n            display: grid;\n            grid-template-columns: repeat(3, 1fr);\n            grid-template-rows: repeat(2, 1fr);\n            gap: 20px;\n            height: calc(100vh - 200px);\n            min-height: 600px;\n        }\n\n        .folder-panel {\n            border-radius: 15px;\n            padding: 20px;\n            backdrop-filter: blur(10px);\n            border: 1px solid rgba(255, 255, 255, 0.2);\n            display: flex;\n            flex-direction: column;\n            transition: all 0.3s ease;\n        }\n\n        /* Unique colors for each panel */\n        .folder-panel:nth-child(1) { background: linear-gradient(135deg, rgba(46, 125, 50, 0.4), rgba(76, 175, 80, 0.3)); }\n        .folder-panel:nth-child(2) { background: linear-gradient(135deg, rgba(25, 118, 210, 0.4), rgba(33, 150, 243, 0.3)); }\n        .folder-panel:nth-child(3) { background: linear-gradient(135deg, rgba(156, 39, 176, 0.4), rgba(233, 30, 99, 0.3)); }\n        .folder-panel:nth-child(4) { background: linear-gradient(135deg, rgba(255, 111, 0, 0.4), rgba(255, 152, 0, 0.3)); }\n        .folder-panel:nth-child(5) { background: linear-gradient(135deg, rgba(244, 67, 54, 0.4), rgba(239, 83, 80, 0.3)); }\n        .folder-panel:nth-child(6) { background: linear-gradient(135deg, rgba(0, 150, 136, 0.4), rgba(77, 182, 172, 0.3)); }\n\n        .folder-panel:hover {\n            transform: translateY(-5px);\n            box-shadow: 0 10px 30px rgba(0,0,0,0.3);\n        }\n\n        .panel-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 15px;\n            padding-bottom: 10px;\n            border-bottom: 1px solid rgba(255, 255, 255, 0.2);\n        }\n\n        .btn-group-header {\n            display: flex;\n            gap: 5px;\n        }\n\n        .panel-title {\n            font-size: 1.1em;\n            font-weight: bold;\n            color: #ffffff;\n        }\n\n        .folder-path {\n            font-size: 0.8em;\n            color: #b8d4f0;\n            margin-bottom: 10px;\n            word-break: break-all;\n        }\n\n        .config-btn {\n            background: #4CAF50;\n            color: white;\n            border: none;\n            padding: 5px 10px;\n            border-radius: 5px;\n            cursor: pointer;\n            font-size: 0.8em;\n            transition: background 0.3s;\n        }\n\n        .config-btn:hover {\n            background: #45a049;\n        }\n\n        .reset-btn {\n            background: #f44336;\n            color: white;\n            border: none;\n            padding: 5px 10px;\n            border-radius: 5px;\n            cursor: pointer;\n            font-size: 0.8em;\n            transition: background 0.3s;\n        }\n\n        .reset-btn:hover {\n            background: #d32f2f;\n        }\n\n        .file-list {\n            flex: 1;\n            overflow-y: auto;\n            max-height: calc(100% - 80px);\n        }\n\n        .file-item {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 8px 12px;\n            margin: 5px 0;\n            background: rgba(255, 255, 255, 0.1);\n            border-radius: 8px;\n            cursor: pointer;\n            transition: all 0.2s ease;\n            border-left: 4px solid transparent;\n        }\n\n        .file-item:hover {\n            background: rgba(255, 255, 255, 0.2);\n            transform: translateX(5px);\n        }\n\n        .file-item.ps1 { border-left-color: #1f4e79; }\n        .file-item.html { border-left-color: #e34c26; }\n        .file-item.txt { border-left-color: #6c757d; }\n        .file-item.docx { border-left-color: #2b579a; }\n        .file-item.xlsx { border-left-color: #217346; }\n        .file-item.pdf { border-left-color: #dc3545; }\n\n        .file-name {\n            font-size: 0.9em;\n            color: #ffffff;\n            flex: 1;\n            margin-right: 10px;\n            white-space: nowrap;\n            overflow: hidden;\n            text-overflow: ellipsis;\n        }\n\n        .file-ext {\n            background: rgba(255, 255, 255, 0.2);\n            padding: 2px 6px;\n            border-radius: 4px;\n            font-size: 0.7em;\n            font-weight: bold;\n            margin-right: 8px;\n        }\n\n        .file-date {\n            font-size: 0.7em;\n            color: #b8d4f0;\n        }\n\n        .modal {\n            display: none;\n            position: fixed;\n            z-index: 1000;\n            left: 0;\n            top: 0;\n            width: 100%;\n            height: 100%;\n            background-color: rgba(0,0,0,0.5);\n        }\n\n        .modal-content {\n            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);\n            margin: 15% auto;\n            padding: 30px;\n            border-radius: 15px;\n            width: 50%;\n            max-width: 500px;\n            color: white;\n            box-shadow: 0 20px 60px rgba(0,0,0,0.5);\n        }\n\n        .modal h2 {\n            margin-bottom: 20px;\n            color: #ffffff;\n        }\n\n        .form-group {\n            margin-bottom: 20px;\n        }\n\n        .form-group label {\n            display: block;\n            margin-bottom: 8px;\n            font-weight: bold;\n        }\n\n        .form-group input {\n            width: 100%;\n            padding: 12px;\n            border: none;\n            border-radius: 8px;\n            background: rgba(255, 255, 255, 0.1);\n            color: white;\n            font-size: 1em;\n        }\n\n        .form-group input::placeholder {\n            color: rgba(255, 255, 255, 0.6);\n        }\n\n        .btn-group {\n            display: flex;\n            gap: 10px;\n            justify-content: flex-end;\n        }\n\n        .btn {\n            padding: 12px 24px;\n            border: none;\n            border-radius: 8px;\n            cursor: pointer;\n            font-size: 1em;\n            transition: all 0.3s ease;\n        }\n\n        .btn-primary {\n            background: #4CAF50;\n            color: white;\n        }\n\n        .btn-primary:hover {\n            background: #45a049;\n        }\n\n        .btn-secondary {\n            background: rgba(255, 255, 255, 0.2);\n            color: white;\n        }\n\n        .btn-secondary:hover {\n            background: rgba(255, 255, 255, 0.3);\n        }\n\n        .refresh-btn {\n            position: fixed;\n            bottom: 30px;\n            right: 30px;\n            background: #2196F3;\n            color: white;\n            border: none;\n            padding: 15px;\n            border-radius: 50%;\n            cursor: pointer;\n            font-size: 1.2em;\n            box-shadow: 0 5px 15px rgba(0,0,0,0.3);\n            transition: all 0.3s ease;\n        }\n\n        .refresh-btn:hover {\n            transform: scale(1.1);\n            background: #1976D2;\n        }\n\n        .empty-panel {\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n            color: rgba(255, 255, 255, 0.6);\n            text-align: center;\n        }\n\n        .empty-panel i {\n            font-size: 3em;\n            margin-bottom: 15px;\n            opacity: 0.5;\n        }\n\n        .file-list::-webkit-scrollbar {\n            width: 6px;\n        }\n\n        .file-list::-webkit-scrollbar-track {\n            background: rgba(255, 255, 255, 0.1);\n            border-radius: 3px;\n        }\n\n        .file-list::-webkit-scrollbar-thumb {\n            background: rgba(255, 255, 255, 0.3);\n            border-radius: 3px;\n        }\n\n        .file-list::-webkit-scrollbar-thumb:hover {\n            background: rgba(255, 255, 255, 0.5);\n        }\n\n        /* Task Tracker Specific Styles */\n        .task-tracker {\n            background: rgba(255, 255, 255, 0.98);\n            border-radius: 12px;\n            box-shadow: 0 25px 50px rgba(0,0,0,0.15);\n            overflow: hidden;\n            backdrop-filter: blur(10px);\n            margin: 0;\n            height: calc(100vh - 180px);\n            min-height: 650px;\n        }\n        \n        .task-header {\n            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);\n            color: white;\n            padding: 12px 25px;\n            position: relative;\n            text-align: center;\n        }\n        \n        .task-header h2 {\n            font-size: 1.3em;\n            margin-bottom: 3px;\n            color: #ecf0f1;\n            text-shadow: 1px 1px 3px rgba(0,0,0,0.3);\n        }\n        \n        .task-header p {\n            opacity: 0.85;\n            font-size: 0.85em;\n            color: #bdc3c7;\n        }\n        \n        .task-main-content {\n            display: grid;\n            grid-template-columns: 320px 1fr 300px;\n            gap: 0;\n            height: calc(100% - 65px);\n        }\n        \n        .task-sidebar {\n            background: #f8fafc;\n            padding: 15px;\n            border-right: 1px solid #e2e8f0;\n            overflow-y: auto;\n        }\n        \n        .task-area {\n            padding: 15px;\n            overflow-y: auto;\n            background: #ffffff;\n        }\n\n        .task-calendar-sidebar {\n            background: #f1f5f9;\n            padding: 15px;\n            border-left: 1px solid #e2e8f0;\n            overflow-y: auto;\n        }\n        \n        .form-section {\n            background: white;\n            border-radius: 6px;\n            padding: 15px;\n            margin-bottom: 15px;\n            box-shadow: 0 1px 4px rgba(0,0,0,0.08);\n            border: 1px solid #e2e8f0;\n        }\n        \n        .form-section h3 {\n            color: #2d3748;\n            margin-bottom: 12px;\n            font-size: 1em;\n            border-bottom: 2px solid #3182ce;\n            padding-bottom: 6px;\n        }\n        \n        .form-group {\n            margin-bottom: 10px;\n        }\n        \n        .form-group label {\n            display: block;\n            margin-bottom: 3px;\n            font-weight: 600;\n            color: #4a5568;\n            font-size: 12px;\n        }\n        \n        .form-group input, .form-group select, .form-group textarea {\n            width: 100%;\n            padding: 6px 10px;\n            border: 1px solid #e2e8f0;\n            border-radius: 4px;\n            font-size: 12px;\n            transition: all 0.2s ease;\n        }\n        \n        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {\n            outline: none;\n            border-color: #3182ce;\n            box-shadow: 0 0 0 2px rgba(49, 130, 206, 0.1);\n        }\n        \n        .form-group textarea {\n            resize: vertical;\n            min-height: 50px;\n        }\n        \n        .form-row {\n            display: grid;\n            grid-template-columns: 1fr 70px;\n            gap: 8px;\n            align-items: end;\n        }\n        \n        .btn {\n            background: linear-gradient(135deg, #3182ce 0%, #2c5282 100%);\n            color: white;\n            border: none;\n            padding: 8px 16px;\n            border-radius: 4px;\n            cursor: pointer;\n            font-size: 12px;\n            font-weight: 600;\n            transition: all 0.2s ease;\n            width: 100%;\n        }\n        \n        .btn:hover {\n            transform: translateY(-1px);\n            box-shadow: 0 3px 8px rgba(49, 130, 206, 0.3);\n        }\n        \n        .task-stats {\n            background: linear-gradient(135deg, #4c51bf 0%, #553c9a 100%);\n            color: white;\n            border-radius: 6px;\n            padding: 12px;\n            margin-bottom: 12px;\n            box-shadow: 0 2px 8px rgba(76, 81, 191, 0.15);\n        }\n        \n        .task-stats h3 {\n            margin-bottom: 10px;\n            font-size: 0.9em;\n        }\n        \n        .stats-grid {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 8px;\n        }\n        \n        .stat-item {\n            text-align: center;\n            padding: 8px;\n            border-radius: 4px;\n            background: rgba(255, 255, 255, 0.15);\n        }\n        \n        .stat-number {\n            font-size: 1.3em;\n            font-weight: bold;\n        }\n        \n        .stat-label {\n            font-size: 0.75em;\n            opacity: 0.9;\n            margin-top: 2px;\n        }\n        \n        .task-card {\n            background: white;\n            border-radius: 6px;\n            padding: 10px;\n            margin-bottom: 6px;\n            box-shadow: 0 1px 4px rgba(0,0,0,0.08);\n            border-left: 3px solid #3182ce;\n            transition: all 0.2s ease;\n            border: 1px solid #e2e8f0;\n        }\n        \n        .task-card:hover {\n            transform: translateY(-1px);\n            box-shadow: 0 2px 8px rgba(0,0,0,0.12);\n        }\n        \n        .task-header-card {\n            display: flex;\n            justify-content: space-between;\n            align-items: start;\n            margin-bottom: 6px;\n        }\n        \n        .task-title {\n            font-size: 1em;\n            font-weight: 600;\n            color: #2d3748;\n            margin-bottom: 3px;\n            line-height: 1.3;\n        }\n        \n        .task-meta {\n            display: flex;\n            gap: 4px;\n            flex-wrap: wrap;\n            margin-bottom: 5px;\n        }\n        \n        .task-badge {\n            padding: 3px 10px;\n            border-radius: 12px;\n            font-size: 0.7em;\n            font-weight: 600;\n            text-transform: uppercase;\n            letter-spacing: 0.5px;\n            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n        }\n        \n        .priority-high {\n            background: linear-gradient(135deg, #ffffff 0%, #fef5f5 100%);\n            color: #c53030;\n            border-left: 4px solid #dc2626;\n            box-shadow: 0 2px 8px rgba(220, 38, 38, 0.15);\n        }\n\n        .priority-medium {\n            background: linear-gradient(135deg, #ffffff 0%, #fffbf0 100%);\n            color: #d69e2e;\n            border-left: 4px solid #f59e0b;\n            box-shadow: 0 2px 8px rgba(245, 158, 11, 0.15);\n        }\n\n        .priority-low {\n            background: linear-gradient(135deg, #ffffff 0%, #f0fff4 100%);\n            color: #38a169;\n            border-left: 4px solid #10b981;\n            box-shadow: 0 2px 8px rgba(16, 185, 129, 0.15);\n        }\n        \n        .task-badge.priority-high {\n            background: linear-gradient(135deg, #dc2626, #ef4444);\n            color: white;\n        }\n\n        .task-badge.priority-medium {\n            background: linear-gradient(135deg, #f59e0b, #fbbf24);\n            color: white;\n        }\n\n        .task-badge.priority-low {\n            background: linear-gradient(135deg, #10b981, #34d399);\n            color: white;\n        }\n\n        .category-badge {\n            background: linear-gradient(135deg, #6366f1, #8b5cf6);\n            color: white;\n            padding: 3px 10px;\n            border-radius: 12px;\n            font-size: 0.7em;\n            font-weight: 600;\n            letter-spacing: 0.5px;\n            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n        }\n        \n        .status-badge {\n            padding: 3px 10px;\n            border-radius: 12px;\n            font-size: 0.7em;\n            font-weight: 600;\n            letter-spacing: 0.5px;\n            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n        }\n\n        .status-pending {\n            background: linear-gradient(135deg, #f59e0b, #fbbf24);\n            color: white;\n        }\n\n        .status-in-progress {\n            background: linear-gradient(135deg, #3b82f6, #60a5fa);\n            color: white;\n        }\n\n        .status-completed {\n            background: linear-gradient(135deg, #10b981, #34d399);\n            color: white;\n        }\n\n        .status-overdue {\n            background: linear-gradient(135deg, #dc2626, #ef4444);\n            color: white;\n        }\n        \n        .task-description {\n            color: #718096;\n            margin-bottom: 6px;\n            line-height: 1.3;\n            font-size: 0.85em;\n        }\n        \n        .task-footer {\n            display: grid;\n            grid-template-columns: 1fr auto auto;\n            gap: 10px;\n            align-items: center;\n            padding-top: 6px;\n            border-top: 1px solid #f7fafc;\n            font-size: 0.8em;\n        }\n        \n        .task-due {\n            color: #718096;\n        }\n        \n        .task-time {\n            color: #3182ce;\n            font-weight: 600;\n        }\n        \n        .task-actions {\n            display: flex;\n            gap: 3px;\n        }\n        \n        .action-btn {\n            padding: 6px 10px;\n            border: none;\n            border-radius: 6px;\n            cursor: pointer;\n            font-size: 11px;\n            font-weight: 600;\n            transition: all 0.2s ease;\n            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n        }\n\n        .edit-btn {\n            background: linear-gradient(135deg, #3b82f6, #60a5fa);\n            color: white;\n        }\n\n        .edit-btn:hover {\n            background: linear-gradient(135deg, #2563eb, #3b82f6);\n            transform: translateY(-1px);\n            box-shadow: 0 4px 8px rgba(59, 130, 246, 0.3);\n        }\n\n        .delete-btn {\n            background: linear-gradient(135deg, #dc2626, #ef4444);\n            color: white;\n        }\n\n        .delete-btn:hover {\n            background: linear-gradient(135deg, #b91c1c, #dc2626);\n            transform: translateY(-1px);\n            box-shadow: 0 4px 8px rgba(220, 38, 38, 0.3);\n        }\n\n        .complete-btn {\n            background: linear-gradient(135deg, #10b981, #34d399);\n            color: white;\n        }\n\n        .complete-btn:hover {\n            background: linear-gradient(135deg, #059669, #10b981);\n            transform: translateY(-1px);\n            box-shadow: 0 4px 8px rgba(16, 185, 129, 0.3);\n        }\n\n        .timer-btn {\n            background: linear-gradient(135deg, #dc2626, #ef4444);\n            color: white;\n            border: none;\n            padding: 6px 12px;\n            border-radius: 6px;\n            cursor: pointer;\n            font-size: 11px;\n            font-weight: 600;\n            transition: all 0.2s ease;\n            box-shadow: 0 2px 4px rgba(220, 38, 38, 0.2);\n            margin-left: 8px;\n        }\n\n        .timer-btn:hover {\n            background: linear-gradient(135deg, #b91c1c, #dc2626);\n            transform: translateY(-1px);\n            box-shadow: 0 4px 8px rgba(220, 38, 38, 0.3);\n        }\n\n        .timer-btn.running {\n            background: linear-gradient(135deg, #059669, #10b981);\n            animation: pulse 2s infinite;\n        }\n\n        @keyframes pulse {\n            0% { transform: scale(1); }\n            50% { transform: scale(1.05); }\n            100% { transform: scale(1); }\n        }\n        \n        .empty-state {\n            text-align: center;\n            padding: 30px 15px;\n            color: #718096;\n        }\n        \n        .empty-state h3 {\n            color: #a0aec0;\n            margin-bottom: 6px;\n        }\n\n        /* Calendar Widget Styles for Task Tracker */\n        .calendar-widget {\n            background: rgba(255, 255, 255, 0.9);\n            border-radius: 8px;\n            padding: 12px;\n            border: 1px solid rgba(0, 0, 0, 0.1);\n            margin-bottom: 15px;\n        }\n\n        .calendar-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 8px;\n        }\n\n        .calendar-title {\n            font-weight: bold;\n            font-size: 0.85em;\n            color: #2d3748;\n        }\n\n        .calendar-nav {\n            background: #e2e8f0;\n            border: none;\n            color: #4a5568;\n            padding: 4px 6px;\n            border-radius: 4px;\n            cursor: pointer;\n            font-size: 0.75em;\n            transition: background 0.3s;\n        }\n\n        .calendar-nav:hover {\n            background: #cbd5e0;\n        }\n\n        .calendar-grid {\n            display: grid;\n            grid-template-columns: repeat(7, 1fr);\n            gap: 1px;\n        }\n\n        .calendar-day {\n            text-align: center;\n            padding: 3px 1px;\n            font-size: 0.7em;\n            color: #4a5568;\n            border-radius: 2px;\n            cursor: pointer;\n            transition: all 0.2s;\n        }\n\n        .calendar-day:hover {\n            background: #e2e8f0;\n        }\n\n        .calendar-day.today {\n            background: #3182ce;\n            color: white;\n            font-weight: bold;\n        }\n\n        .calendar-day.other-month {\n            opacity: 0.4;\n        }\n\n        .calendar-day-header {\n            font-weight: bold;\n            color: #2d3748;\n            font-size: 0.65em;\n            padding: 2px;\n            text-align: center;\n        }\n\n        /* Quick Links Section */\n        .quick-links {\n            background: rgba(255, 255, 255, 0.9);\n            border-radius: 8px;\n            padding: 12px;\n            border: 1px solid rgba(0, 0, 0, 0.1);\n            margin-bottom: 15px;\n        }\n\n        .quick-links h4 {\n            color: #2d3748;\n            margin-bottom: 8px;\n            font-size: 0.9em;\n            border-bottom: 1px solid #e2e8f0;\n            padding-bottom: 4px;\n        }\n\n        .quick-link {\n            display: block;\n            padding: 6px 8px;\n            margin-bottom: 3px;\n            color: #4a5568;\n            text-decoration: none;\n            font-size: 0.8em;\n            border-radius: 4px;\n            transition: all 0.2s;\n        }\n\n        .quick-link:hover {\n            background: #e2e8f0;\n            color: #2d3748;\n        }\n\n        .quick-link i {\n            margin-right: 6px;\n            color: #3182ce;\n        }\n\n        /* Quick Notes Styles */\n        .note-item {\n            background: rgba(255, 255, 255, 0.7);\n            border: 1px solid #e2e8f0;\n            border-radius: 4px;\n            padding: 6px 8px;\n            margin-bottom: 4px;\n            font-size: 0.75em;\n            line-height: 1.3;\n            position: relative;\n            word-wrap: break-word;\n        }\n\n        .note-content {\n            color: #2d3748;\n            margin-bottom: 4px;\n        }\n\n        .note-meta {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            font-size: 0.65em;\n            color: #718096;\n            border-top: 1px solid #f1f5f9;\n            padding-top: 3px;\n        }\n\n        .note-actions {\n            display: flex;\n            gap: 3px;\n        }\n\n        .note-btn {\n            background: none;\n            border: none;\n            cursor: pointer;\n            padding: 2px 4px;\n            border-radius: 2px;\n            font-size: 0.7em;\n            transition: all 0.2s;\n        }\n\n        .note-btn:hover {\n            background: #e2e8f0;\n        }\n\n        .note-btn.convert {\n            color: #3182ce;\n        }\n\n        .note-btn.delete {\n            color: #e53e3e;\n        }\n\n        .note-timestamp {\n            font-size: 0.6em;\n            color: #a0aec0;\n        }\n    </style>\n    <link rel=\"stylesheet\" href=\"./Nishen's Engineer Dashboard/all.min.css\">\n</head>\n<body>\n    <div class=\"header\">\n        <div class=\"header-left\">\n            <!-- Empty space where calendar used to be -->\n        </div>\n        \n        <div class=\"header-center\">\n            <h1><i class=\"fas fa-server\"></i> Nishen's Engineer Dashboard</h1>\n            <p>Integrated File Browser &amp; Task Management Portal</p>\n            <div class=\"nav-tabs\">\n                <button class=\"nav-tab\" onclick=\"switchTab(&#39;files&#39;)\">\n                    <i class=\"fas fa-folder\"></i> File Browser\n                </button>\n                <button class=\"nav-tab active\" onclick=\"switchTab(&#39;tasks&#39;)\">\n                    <i class=\"fas fa-tasks\"></i> Task Tracker\n                </button>\n            </div>\n        </div>\n        \n        <div class=\"header-right\">\n            <div class=\"datetime-display\">\n                <div class=\"current-time\" id=\"currentTime\">05:10:51</div>\n                <div class=\"current-date\" id=\"currentDate\">Monday, September 22, 2025</div>\n            </div>\n            <div class=\"config-controls\">\n                <button class=\"control-btn export-btn\" onclick=\"exportConfig()\" title=\"Export Configuration\">\n                    <i class=\"fas fa-download\"></i> Export\n                </button>\n                <button class=\"control-btn import-btn\" onclick=\"importConfig()\" title=\"Import Configuration\">\n                    <i class=\"fas fa-upload\"></i> Import\n                </button>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"grid-container\" id=\"gridContainer\" style=\"display: none;\">\n        <div class=\"folder-panel\">\n            <div class=\"panel-header\">\n                <div class=\"panel-title\" id=\"panelTitle0\">Claude Dev</div>\n                <div class=\"btn-group-header\">\n                    <button class=\"config-btn\" onclick=\"openConfigModal(0)\" title=\"Configure Panel\">\n                        <i class=\"fas fa-cog\"></i>\n                    </button>\n                    <button class=\"reset-btn\" onclick=\"resetPanel(0)\" title=\"Reset Panel\">\n                        <i class=\"fas fa-trash-alt\"></i>\n                    </button>\n                </div>\n            </div>\n            <div class=\"folder-path\" id=\"folderPath0\">X:\\ClaudeCode</div>\n            <div class=\"file-list\" id=\"fileList0\">\n                <div class=\"file-item ps1\" onclick=\"openFile(&#39;script1.ps1&#39;, &#39;ps1&#39;)\">\n                    <div class=\"file-name\" title=\"script1.ps1\">script1.ps1</div>\n                    <div class=\"file-ext\">PS1</div>\n                    <div class=\"file-date\">Today</div>\n                </div>\n            \n                <div class=\"file-item xml\" onclick=\"openFile(&#39;config.xml&#39;, &#39;xml&#39;)\">\n                    <div class=\"file-name\" title=\"config.xml\">config.xml</div>\n                    <div class=\"file-ext\">XML</div>\n                    <div class=\"file-date\">Today</div>\n                </div>\n            \n                <div class=\"file-item html\" onclick=\"openFile(&#39;report.html&#39;, &#39;html&#39;)\">\n                    <div class=\"file-name\" title=\"report.html\">report.html</div>\n                    <div class=\"file-ext\">HTML</div>\n                    <div class=\"file-date\">Today</div>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"folder-panel\">\n            <div class=\"panel-header\">\n                <div class=\"panel-title\" id=\"panelTitle1\">Panel 2</div>\n                <div class=\"btn-group-header\">\n                    <button class=\"config-btn\" onclick=\"openConfigModal(1)\" title=\"Configure Panel\">\n                        <i class=\"fas fa-cog\"></i>\n                    </button>\n                    <button class=\"reset-btn\" onclick=\"resetPanel(1)\" title=\"Reset Panel\">\n                        <i class=\"fas fa-trash-alt\"></i>\n                    </button>\n                </div>\n            </div>\n            <div class=\"folder-path\" id=\"folderPath1\">No path configured</div>\n            <div class=\"file-list\" id=\"fileList1\">\n                <div class=\"empty-panel\">\n                    <i class=\"fas fa-folder-open\"></i>\n                    <div>Configure a folder path to view files</div>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"folder-panel\">\n            <div class=\"panel-header\">\n                <div class=\"panel-title\" id=\"panelTitle2\">Panel 3</div>\n                <div class=\"btn-group-header\">\n                    <button class=\"config-btn\" onclick=\"openConfigModal(2)\" title=\"Configure Panel\">\n                        <i class=\"fas fa-cog\"></i>\n                    </button>\n                    <button class=\"reset-btn\" onclick=\"resetPanel(2)\" title=\"Reset Panel\">\n                        <i class=\"fas fa-trash-alt\"></i>\n                    </button>\n                </div>\n            </div>\n            <div class=\"folder-path\" id=\"folderPath2\">No path configured</div>\n            <div class=\"file-list\" id=\"fileList2\">\n                <div class=\"empty-panel\">\n                    <i class=\"fas fa-folder-open\"></i>\n                    <div>Configure a folder path to view files</div>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"folder-panel\">\n            <div class=\"panel-header\">\n                <div class=\"panel-title\" id=\"panelTitle3\">Panel 4</div>\n                <div class=\"btn-group-header\">\n                    <button class=\"config-btn\" onclick=\"openConfigModal(3)\" title=\"Configure Panel\">\n                        <i class=\"fas fa-cog\"></i>\n                    </button>\n                    <button class=\"reset-btn\" onclick=\"resetPanel(3)\" title=\"Reset Panel\">\n                        <i class=\"fas fa-trash-alt\"></i>\n                    </button>\n                </div>\n            </div>\n            <div class=\"folder-path\" id=\"folderPath3\">No path configured</div>\n            <div class=\"file-list\" id=\"fileList3\">\n                <div class=\"empty-panel\">\n                    <i class=\"fas fa-folder-open\"></i>\n                    <div>Configure a folder path to view files</div>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"folder-panel\">\n            <div class=\"panel-header\">\n                <div class=\"panel-title\" id=\"panelTitle4\">Panel 5</div>\n                <div class=\"btn-group-header\">\n                    <button class=\"config-btn\" onclick=\"openConfigModal(4)\" title=\"Configure Panel\">\n                        <i class=\"fas fa-cog\"></i>\n                    </button>\n                    <button class=\"reset-btn\" onclick=\"resetPanel(4)\" title=\"Reset Panel\">\n                        <i class=\"fas fa-trash-alt\"></i>\n                    </button>\n                </div>\n            </div>\n            <div class=\"folder-path\" id=\"folderPath4\">No path configured</div>\n            <div class=\"file-list\" id=\"fileList4\">\n                <div class=\"empty-panel\">\n                    <i class=\"fas fa-folder-open\"></i>\n                    <div>Configure a folder path to view files</div>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"folder-panel\">\n            <div class=\"panel-header\">\n                <div class=\"panel-title\" id=\"panelTitle5\">Panel 6</div>\n                <div class=\"btn-group-header\">\n                    <button class=\"config-btn\" onclick=\"openConfigModal(5)\" title=\"Configure Panel\">\n                        <i class=\"fas fa-cog\"></i>\n                    </button>\n                    <button class=\"reset-btn\" onclick=\"resetPanel(5)\" title=\"Reset Panel\">\n                        <i class=\"fas fa-trash-alt\"></i>\n                    </button>\n                </div>\n            </div>\n            <div class=\"folder-path\" id=\"folderPath5\">No path configured</div>\n            <div class=\"file-list\" id=\"fileList5\">\n                <div class=\"empty-panel\">\n                    <i class=\"fas fa-folder-open\"></i>\n                    <div>Configure a folder path to view files</div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <!-- Task Tracker Section -->\n    <div id=\"taskTrackerSection\" style=\"display: block;\">\n        <div class=\"task-tracker\">\n            <div class=\"task-header\">\n                <h2><i class=\"fas fa-tasks\"></i> Professional Task Tracker</h2>\n                <p>Enterprise task management with cloud synchronization</p>\n            </div>\n            \n            <div class=\"task-main-content\">\n                <div class=\"task-sidebar\">\n                    <!-- Task Filters -->\n                    <div class=\"form-section\">\n                        <h3>üîç Filters</h3>\n                        <div class=\"form-group\">\n                            <label for=\"filterStatus\">Status</label>\n                            <select id=\"filterStatus\" onchange=\"applyFilters()\">\n                                <option value=\"\">All Status</option>\n                                <option value=\"pending\">Pending</option>\n                                <option value=\"in-progress\">In Progress</option>\n                                <option value=\"completed\">Completed</option>\n                                <option value=\"overdue\">Overdue</option>\n                            </select>\n                        </div>\n                        <div class=\"form-group\">\n                            <label for=\"filterPriority\">Priority</label>\n                            <select id=\"filterPriority\" onchange=\"applyFilters()\">\n                                <option value=\"\">All Priorities</option>\n                                <option value=\"High\">High</option>\n                                <option value=\"Medium\">Medium</option>\n                                <option value=\"Low\">Low</option>\n                            </select>\n                        </div>\n                        <div class=\"form-group\">\n                            <label for=\"filterCategory\">Category</label>\n                            <select id=\"filterCategory\" onchange=\"applyFilters()\">\n                                <option value=\"\">All Categories</option>\n                                <option value=\"Work\">Work</option>\n                                <option value=\"Personal\">Personal</option>\n                                <option value=\"Project\">Project</option>\n                                <option value=\"Meeting\">Meeting</option>\n                                <option value=\"Admin\">Admin</option>\n                                <option value=\"Learning\">Learning</option>\n                                <option value=\"Review\">Review</option>\n                            </select>\n                        </div>\n                        <div class=\"form-group\">\n                            <button onclick=\"clearFilters()\" class=\"btn\" style=\"background: #6b7280; font-size: 11px; padding: 6px 12px;\">Clear Filters</button>\n                        </div>\n                    </div>\n\n                    <!-- Task Statistics -->\n                    <div class=\"task-stats\">\n                        <h3>üìä Overview</h3>\n                        <div class=\"stats-grid\">\n                            <div class=\"stat-item\">\n                                <div class=\"stat-number\" id=\"totalTasks\">7</div>\n                                <div class=\"stat-label\">Total</div>\n                            </div>\n                            <div class=\"stat-item\">\n                                <div class=\"stat-number\" id=\"completedTasks\">1</div>\n                                <div class=\"stat-label\">Done</div>\n                            </div>\n                            <div class=\"stat-item\">\n                                <div class=\"stat-number\" id=\"pendingTasks\">3</div>\n                                <div class=\"stat-label\">Pending</div>\n                            </div>\n                            <div class=\"stat-item\">\n                                <div class=\"stat-number\" id=\"overdueTasks\">3</div>\n                                <div class=\"stat-label\">Overdue</div>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Add New Task Form -->\n                    <div class=\"form-section\">\n                        <h3>‚ûï New Task</h3>\n                        <form id=\"taskForm\">\n                            <div class=\"form-group\">\n                                <label for=\"taskTitle\">Title</label>\n                                <input type=\"text\" id=\"taskTitle\" required=\"\" placeholder=\"Task title...\">\n                            </div>\n                            \n                            <div class=\"form-group\">\n                                <label for=\"taskDescription\">Description</label>\n                                <textarea id=\"taskDescription\" placeholder=\"Task details...\"></textarea>\n                            </div>\n                            \n                            <div class=\"form-row\">\n                                <div class=\"form-group\">\n                                    <label for=\"taskCategory\">Category</label>\n                                    <select id=\"taskCategory\" required=\"\">\n                                        <option value=\"\">Select...</option>\n                                        <option value=\"Work\">Work</option>\n                                        <option value=\"Personal\">Personal</option>\n                                        <option value=\"Project\">Project</option>\n                                        <option value=\"Meeting\">Meeting</option>\n                                        <option value=\"Admin\">Admin</option>\n                                        <option value=\"Learning\">Learning</option>\n                                        <option value=\"Review\">Review</option>\n                                    </select>\n                                </div>\n                                <div class=\"form-group\">\n                                    <label for=\"taskHours\">Hours</label>\n                                    <input type=\"number\" id=\"taskHours\" step=\"0.5\" min=\"0\" placeholder=\"0\">\n                                </div>\n                            </div>\n                            \n                            <div class=\"form-row\">\n                                <div class=\"form-group\">\n                                    <label for=\"taskPriority\">Priority</label>\n                                    <select id=\"taskPriority\" required=\"\">\n                                        <option value=\"\">Select...</option>\n                                        <option value=\"High\">High</option>\n                                        <option value=\"Medium\">Medium</option>\n                                        <option value=\"Low\">Low</option>\n                                    </select>\n                                </div>\n                                <div class=\"form-group\">\n                                    <label for=\"taskDueDate\">Due Date</label>\n                                    <input type=\"date\" id=\"taskDueDate\" required=\"\" min=\"2025-09-22\">\n                                </div>\n                            </div>\n                            \n                            <button type=\"submit\" class=\"btn\">Add Task</button>\n                        </form>\n                    </div>\n                </div>\n                \n                <div class=\"task-area\">\n                    <div id=\"tasksList\">\n                        <div class=\"task-card priority-high\">\n                            <div class=\"task-header-card\">\n                                <div>\n                                    <div class=\"task-title\">Evo security</div>\n                                    <div class=\"task-meta\">\n                                        <span class=\"task-badge priority-high\">High</span>\n                                        <span class=\"category-badge\">Project</span>\n                                        <span class=\"status-badge status-pending\">Pending</span>\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"task-description\">Configure Solution (on)</div>\n                            \n                            <div class=\"task-footer\">\n                                <div class=\"task-due\">Due: 2025/09/24 (5 days)</div>\n                                <div class=\"task-time\">2h</div>\n                                <div class=\"task-actions\">\n                                    <button class=\"action-btn edit-btn\" onclick=\"editTask(1757329106448)\" title=\"Edit task\">‚úè</button>\n                                    <button class=\"action-btn complete-btn\" onclick=\"toggleTaskStatus(1757329106448)\" title=\"Mark as completed\">\n                                        ‚úì\n                                    </button>\n                                    <button class=\"action-btn delete-btn\" onclick=\"deleteTask(1757329106448)\" title=\"Delete task\">‚úï</button>\n                                </div>\n                            </div>\n                        </div>\n                    \n                        <div class=\"task-card priority-medium\">\n                            <div class=\"task-header-card\">\n                                <div>\n                                    <div class=\"task-title\">Sql Server Upgrade /Optimization -Pather &amp; Pather</div>\n                                    <div class=\"task-meta\">\n                                        <span class=\"task-badge priority-medium\">Medium</span>\n                                        <span class=\"category-badge\">Project</span>\n                                        <span class=\"status-badge status-pending\">Pending</span>\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"task-description\">Upgrade SQL EXPRESS TO SQL 2019 , PROVISION NEW DISKS FOR db's , LOGS, oPTIMIZE 12H QUOTED</div>\n                            \n                            <div class=\"task-footer\">\n                                <div class=\"task-due\">Due: 2025/09/20 (Tomorrow)</div>\n                                <div class=\"task-time\"></div>\n                                <div class=\"task-actions\">\n                                    <button class=\"action-btn edit-btn\" onclick=\"editTask(1758269150099)\" title=\"Edit task\">‚úè</button>\n                                    <button class=\"action-btn complete-btn\" onclick=\"toggleTaskStatus(1758269150099)\" title=\"Mark as completed\">\n                                        ‚úì\n                                    </button>\n                                    <button class=\"action-btn delete-btn\" onclick=\"deleteTask(1758269150099)\" title=\"Delete task\">‚úï</button>\n                                </div>\n                            </div>\n                        </div>\n                    \n                        <div class=\"task-card priority-medium\">\n                            <div class=\"task-header-card\">\n                                <div>\n                                    <div class=\"task-title\">Kanga SQL Optimization Assessment /Optimization</div>\n                                    <div class=\"task-meta\">\n                                        <span class=\"task-badge priority-medium\">Medium</span>\n                                        <span class=\"category-badge\">Project</span>\n                                        <span class=\"status-badge status-pending\">Pending</span>\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"task-description\">provide full assessment , SOW, project plan, Dude Monday 22 September</div>\n                            \n                            <div class=\"task-footer\">\n                                <div class=\"task-due\">Due: 2025/09/22 (3 days)</div>\n                                <div class=\"task-time\"></div>\n                                <div class=\"task-actions\">\n                                    <button class=\"action-btn edit-btn\" onclick=\"editTask(1758269289951)\" title=\"Edit task\">‚úè</button>\n                                    <button class=\"action-btn complete-btn\" onclick=\"toggleTaskStatus(1758269289951)\" title=\"Mark as completed\">\n                                        ‚úì\n                                    </button>\n                                    <button class=\"action-btn delete-btn\" onclick=\"deleteTask(1758269289951)\" title=\"Delete task\">‚úï</button>\n                                </div>\n                            </div>\n                        </div>\n                    \n                        <div class=\"task-card priority-low\">\n                            <div class=\"task-header-card\">\n                                <div>\n                                    <div class=\"task-title\">Shiplakes AD Remediation</div>\n                                    <div class=\"task-meta\">\n                                        <span class=\"task-badge priority-low\">Low</span>\n                                        <span class=\"category-badge\">Project</span>\n                                        <span class=\"status-badge status-pending\">Pending</span>\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"task-description\">Assessment - Tasks Fine Grain policy ClEANUPS</div>\n                            \n                            <div class=\"task-footer\">\n                                <div class=\"task-due\">Due: 2025/09/29 (10 days)</div>\n                                <div class=\"task-time\"></div>\n                                <div class=\"task-actions\">\n                                    <button class=\"action-btn edit-btn\" onclick=\"editTask(1758269394393)\" title=\"Edit task\">‚úè</button>\n                                    <button class=\"action-btn complete-btn\" onclick=\"toggleTaskStatus(1758269394393)\" title=\"Mark as completed\">\n                                        ‚úì\n                                    </button>\n                                    <button class=\"action-btn delete-btn\" onclick=\"deleteTask(1758269394393)\" title=\"Delete task\">‚úï</button>\n                                </div>\n                            </div>\n                        </div>\n                    \n                        <div class=\"task-card priority-low\">\n                            <div class=\"task-header-card\">\n                                <div>\n                                    <div class=\"task-title\">Ashtons AD Cleanup - Remediation</div>\n                                    <div class=\"task-meta\">\n                                        <span class=\"task-badge priority-low\">Low</span>\n                                        <span class=\"category-badge\">Project</span>\n                                        <span class=\"status-badge status-pending\">Pending</span>\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"task-description\">follow up on outstanding items , AD cleanup</div>\n                            \n                            <div class=\"task-footer\">\n                                <div class=\"task-due\">Due: 2025/10/03 (14 days)</div>\n                                <div class=\"task-time\"></div>\n                                <div class=\"task-actions\">\n                                    <button class=\"action-btn edit-btn\" onclick=\"editTask(1758269467247)\" title=\"Edit task\">‚úè</button>\n                                    <button class=\"action-btn complete-btn\" onclick=\"toggleTaskStatus(1758269467247)\" title=\"Mark as completed\">\n                                        ‚úì\n                                    </button>\n                                    <button class=\"action-btn delete-btn\" onclick=\"deleteTask(1758269467247)\" title=\"Delete task\">‚úï</button>\n                                </div>\n                            </div>\n                        </div>\n                    \n                        <div class=\"task-card priority-high\">\n                            <div class=\"task-header-card\">\n                                <div>\n                                    <div class=\"task-title\">SFTP Project  pather n pather</div>\n                                    <div class=\"task-meta\">\n                                        <span class=\"task-badge priority-high\">High</span>\n                                        <span class=\"category-badge\">Project</span>\n                                        <span class=\"status-badge status-in-progress\">In Progress</span>\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"task-description\">assess, scope, quote , implement</div>\n                            \n                            <div class=\"task-footer\">\n                                <div class=\"task-due\">Due: 2025/09/21 (2 days)</div>\n                                <div class=\"task-time\">5h</div>\n                                <div class=\"task-actions\">\n                                    <button class=\"action-btn edit-btn\" onclick=\"editTask(1757335217307)\" title=\"Edit task\">‚úè</button>\n                                    <button class=\"timer-btn\" onclick=\"toggleTimer(1757335217307)\" title=\"Start/Stop Timer\" id=\"timer-1757335217307\">‚ñ∂ Start</button>\n                                    <button class=\"action-btn complete-btn\" onclick=\"toggleTaskStatus(1757335217307)\" title=\"Mark as completed\">\n                                        ‚úì\n                                    </button>\n                                    <button class=\"action-btn delete-btn\" onclick=\"deleteTask(1757335217307)\" title=\"Delete task\">‚úï</button>\n                                </div>\n                            </div>\n                        </div>\n                    \n                        <div class=\"task-card priority-high\">\n                            <div class=\"task-header-card\">\n                                <div>\n                                    <div class=\"task-title\">RPA - align -Exam assignment issue</div>\n                                    <div class=\"task-meta\">\n                                        <span class=\"task-badge priority-high\">High</span>\n                                        <span class=\"category-badge\">Learning</span>\n                                        <span class=\"status-badge status-completed\">Completed</span>\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"task-description\">Exam assignment issue</div>\n                            \n                            <div class=\"task-footer\">\n                                <div class=\"task-due\">Due: 2025/09/19 (Today)</div>\n                                <div class=\"task-time\"></div>\n                                <div class=\"task-actions\">\n                                    <button class=\"action-btn edit-btn\" onclick=\"editTask(1757335298723)\" title=\"Edit task\">‚úè</button>\n                                    <button class=\"action-btn complete-btn\" onclick=\"toggleTaskStatus(1757335298723)\" title=\"Mark as pending\">\n                                        ‚Ü©\n                                    </button>\n                                    <button class=\"action-btn delete-btn\" onclick=\"deleteTask(1757335298723)\" title=\"Delete task\">‚úï</button>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <div class=\"task-calendar-sidebar\">\n                    <!-- Calendar Widget -->\n                    <div class=\"calendar-widget\" id=\"calendarWidget\">\n                        <div class=\"calendar-header\">\n                            <button class=\"calendar-nav\" onclick=\"previousMonth()\">&lt;</button>\n                            <div class=\"calendar-title\" id=\"calendarTitle\">September 2025</div>\n                            <button class=\"calendar-nav\" onclick=\"nextMonth()\">&gt;</button>\n                        </div>\n                        <div class=\"calendar-grid\" id=\"calendarGrid\"><div class=\"calendar-day-header\">Su</div><div class=\"calendar-day-header\">Mo</div><div class=\"calendar-day-header\">Tu</div><div class=\"calendar-day-header\">We</div><div class=\"calendar-day-header\">Th</div><div class=\"calendar-day-header\">Fr</div><div class=\"calendar-day-header\">Sa</div><div class=\"calendar-day other-month\">31</div><div class=\"calendar-day\">1</div><div class=\"calendar-day\">2</div><div class=\"calendar-day\">3</div><div class=\"calendar-day\">4</div><div class=\"calendar-day\">5</div><div class=\"calendar-day\">6</div><div class=\"calendar-day\">7</div><div class=\"calendar-day\">8</div><div class=\"calendar-day\">9</div><div class=\"calendar-day\">10</div><div class=\"calendar-day\">11</div><div class=\"calendar-day\">12</div><div class=\"calendar-day\">13</div><div class=\"calendar-day\">14</div><div class=\"calendar-day\">15</div><div class=\"calendar-day\">16</div><div class=\"calendar-day\">17</div><div class=\"calendar-day\">18</div><div class=\"calendar-day\">19</div><div class=\"calendar-day\">20</div><div class=\"calendar-day\">21</div><div class=\"calendar-day today\">22</div><div class=\"calendar-day\">23</div><div class=\"calendar-day\">24</div><div class=\"calendar-day\">25</div><div class=\"calendar-day\">26</div><div class=\"calendar-day\">27</div><div class=\"calendar-day\">28</div><div class=\"calendar-day\">29</div><div class=\"calendar-day\">30</div><div class=\"calendar-day other-month\">1</div><div class=\"calendar-day other-month\">2</div><div class=\"calendar-day other-month\">3</div><div class=\"calendar-day other-month\">4</div></div>\n                    </div>\n\n                    <!-- Quick Notes Section -->\n                    <div class=\"quick-links\">\n                        <h4><i class=\"fas fa-sticky-note\"></i> Quick Notes</h4>\n                        <div style=\"margin-bottom: 12px;\">\n                            <textarea id=\"quickNoteInput\" placeholder=\"Jot down a quick note...\" style=\"width: 100%; height: 100px; padding: 12px; border: 1px solid #e2e8f0; border-radius: 8px; font-size: 0.9em; resize: vertical; font-family: inherit; line-height: 1.4;\"></textarea>\n                            <div style=\"display: flex; gap: 4px; margin-top: 4px;\">\n                                <button onclick=\"addQuickNote()\" style=\"background: #3182ce; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer; font-size: 0.75em; flex: 1;\">Add Note</button>\n                                <button onclick=\"clearQuickNotes()\" style=\"background: #e53e3e; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer; font-size: 0.75em;\">Clear All</button>\n                            </div>\n                        </div>\n                        <div id=\"quickNotesList\" style=\"max-height: 300px; overflow-y: auto;\"><div style=\"text-align: center; color: #a0aec0; font-size: 0.75em; padding: 10px;\">No notes yet</div></div>\n                    </div>\n\n                    <!-- Quick Links Section -->\n                    <div class=\"quick-links\">\n                        <h4><i class=\"fas fa-link\"></i> Quick Links</h4>\n                        <a href=\"file:///X:/ClaudeCode/eNGINEdashBoard_Tasks/Nishen&#39;sTask_Notes_FileDashboard.html#\" class=\"quick-link\"><i class=\"fas fa-server\"></i> Server Management</a>\n                        <a href=\"file:///X:/ClaudeCode/eNGINEdashBoard_Tasks/Nishen&#39;sTask_Notes_FileDashboard.html#\" class=\"quick-link\"><i class=\"fas fa-database\"></i> SQL Server Tools</a>\n                        <a href=\"file:///X:/ClaudeCode/eNGINEdashBoard_Tasks/Nishen&#39;sTask_Notes_FileDashboard.html#\" class=\"quick-link\"><i class=\"fas fa-shield-alt\"></i> Security Center</a>\n                        <a href=\"file:///X:/ClaudeCode/eNGINEdashBoard_Tasks/Nishen&#39;sTask_Notes_FileDashboard.html#\" class=\"quick-link\"><i class=\"fas fa-users-cog\"></i> Active Directory</a>\n                        <a href=\"file:///X:/ClaudeCode/eNGINEdashBoard_Tasks/Nishen&#39;sTask_Notes_FileDashboard.html#\" class=\"quick-link\"><i class=\"fas fa-chart-line\"></i> Performance Monitor</a>\n                        <a href=\"file:///X:/ClaudeCode/eNGINEdashBoard_Tasks/Nishen&#39;sTask_Notes_FileDashboard.html#\" class=\"quick-link\"><i class=\"fas fa-file-alt\"></i> Documentation</a>\n                    </div>\n\n                    <!-- System Status -->\n                    <div class=\"quick-links\">\n                        <h4><i class=\"fas fa-heartbeat\"></i> System Status</h4>\n                        <div style=\"padding: 8px; font-size: 0.8em;\">\n                            <div style=\"display: flex; justify-content: space-between; margin-bottom: 4px;\">\n                                <span>Domain Controllers</span>\n                                <span style=\"color: #28a745;\">‚óèOnline</span>\n                            </div>\n                            <div style=\"display: flex; justify-content: space-between; margin-bottom: 4px;\">\n                                <span>SQL Servers</span>\n                                <span style=\"color: #28a745;\">‚óèOnline</span>\n                            </div>\n                            <div style=\"display: flex; justify-content: space-between; margin-bottom: 4px;\">\n                                <span>File Servers</span>\n                                <span style=\"color: #ffc107;\">‚óèWarning</span>\n                            </div>\n                            <div style=\"display: flex; justify-content: space-between;\">\n                                <span>Backup Status</span>\n                                <span style=\"color: #28a745;\">‚óèGood</span>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <button class=\"refresh-btn\" onclick=\"refreshAllPanels()\" title=\"Refresh All Panels\" style=\"display: none;\">\n        <i class=\"fas fa-sync-alt\"></i>\n    </button>\n\n    <!-- Hidden file input for import -->\n    <input type=\"file\" id=\"importFileInput\" accept=\".json\" onchange=\"handleImportFile(event)\">\n\n    <!-- Task Edit Modal -->\n    <div id=\"taskEditModal\" class=\"modal\" style=\"display: none;\">\n        <div class=\"modal-content\">\n            <h2><i class=\"fas fa-edit\"></i> Edit Task</h2>\n            <form id=\"taskEditForm\">\n                <div class=\"form-group\">\n                    <label for=\"editTaskTitle\">Title</label>\n                    <input type=\"text\" id=\"editTaskTitle\" required=\"\" placeholder=\"Task title...\">\n                </div>\n\n                <div class=\"form-group\">\n                    <label for=\"editTaskDescription\">Description</label>\n                    <textarea id=\"editTaskDescription\" placeholder=\"Task details...\"></textarea>\n                </div>\n\n                <div style=\"display: grid; grid-template-columns: 1fr 1fr; gap: 15px;\">\n                    <div class=\"form-group\">\n                        <label for=\"editTaskCategory\">Category</label>\n                        <select id=\"editTaskCategory\" required=\"\">\n                            <option value=\"\">Select...</option>\n                            <option value=\"Work\">Work</option>\n                            <option value=\"Personal\">Personal</option>\n                            <option value=\"Project\">Project</option>\n                            <option value=\"Meeting\">Meeting</option>\n                            <option value=\"Admin\">Admin</option>\n                            <option value=\"Learning\">Learning</option>\n                            <option value=\"Review\">Review</option>\n                        </select>\n                    </div>\n                    <div class=\"form-group\">\n                        <label for=\"editTaskHours\">Hours</label>\n                        <input type=\"number\" id=\"editTaskHours\" step=\"0.5\" min=\"0\" placeholder=\"0\">\n                    </div>\n                </div>\n\n                <div style=\"display: grid; grid-template-columns: 1fr 1fr; gap: 15px;\">\n                    <div class=\"form-group\">\n                        <label for=\"editTaskPriority\">Priority</label>\n                        <select id=\"editTaskPriority\" required=\"\">\n                            <option value=\"\">Select...</option>\n                            <option value=\"High\">High</option>\n                            <option value=\"Medium\">Medium</option>\n                            <option value=\"Low\">Low</option>\n                        </select>\n                    </div>\n                    <div class=\"form-group\">\n                        <label for=\"editTaskDueDate\">Due Date</label>\n                        <input type=\"date\" id=\"editTaskDueDate\" required=\"\" min=\"2025-09-22\">\n                    </div>\n                </div>\n\n                <div class=\"btn-group\">\n                    <button type=\"button\" class=\"btn btn-secondary\" onclick=\"closeTaskEditModal()\">Cancel</button>\n                    <button type=\"submit\" class=\"btn btn-primary\">Save Changes</button>\n                </div>\n            </form>\n        </div>\n    </div>\n\n    <!-- Configuration Modal -->\n    <div id=\"configModal\" class=\"modal\" style=\"display: none;\">\n        <div class=\"modal-content\">\n            <h2><i class=\"fas fa-cog\"></i> Configure Folder Path</h2>\n            <div class=\"form-group\">\n                <label for=\"panelTitle\">Panel Title:</label>\n                <input type=\"text\" id=\"panelTitle\" placeholder=\"e.g., PowerShell Scripts\">\n            </div>\n            <div class=\"form-group\">\n                <label for=\"folderPath\">Folder Path:</label>\n                <input type=\"text\" id=\"folderPath\" placeholder=\"e.g., C:\\Scripts\\PowerShell\">\n            </div>\n            <div class=\"btn-group\">\n                <button class=\"btn btn-secondary\" onclick=\"closeModal()\">Cancel</button>\n                <button class=\"btn btn-primary\" onclick=\"savePanelConfig()\">Save</button>\n            </div>\n        </div>\n    </div>\n\n    <script>\n        let panels = [];\n        let currentPanelIndex = -1;\n        let currentDate = new Date();\n\n        // Initialize everything when DOM is loaded\n        document.addEventListener('DOMContentLoaded', function() {\n            console.log('DOM loaded, initializing...');\n            \n            setTimeout(() => {\n                try {\n                    loadConfiguration();\n                    initializePanels();\n                    initializeDateTime();\n                    initializeCalendar();\n                    refreshAllPanels();\n                    console.log('Initialization complete');\n                } catch (error) {\n                    console.error('Initialization error:', error);\n                }\n            }, 100);\n        });\n\n        function initializePanels() {\n            const container = document.getElementById('gridContainer');\n            if (!container) {\n                console.error('Grid container not found');\n                return;\n            }\n            \n            updatePanelDisplays();\n            console.log('Panels initialized');\n        }\n\n        function updatePanelDisplays() {\n            for (let i = 0; i < 6; i++) {\n                const panel = panels[i];\n                const titleElement = document.getElementById(`panelTitle${i}`);\n                const pathElement = document.getElementById(`folderPath${i}`);\n\n                if (titleElement && pathElement) {\n                    if (panel) {\n                        titleElement.textContent = panel.title;\n                        pathElement.textContent = panel.path;\n                    } else {\n                        titleElement.textContent = `Panel ${i + 1}`;\n                        pathElement.textContent = 'No path configured';\n                    }\n                }\n            }\n        }\n\n        function openConfigModal(panelIndex) {\n            currentPanelIndex = panelIndex;\n            const panel = panels[panelIndex] || {};\n            \n            const titleInput = document.getElementById('panelTitle');\n            const pathInput = document.getElementById('folderPath');\n            const modal = document.getElementById('configModal');\n            \n            if (titleInput) titleInput.value = panel.title || `Panel ${panelIndex + 1}`;\n            if (pathInput) pathInput.value = panel.path || '';\n            if (modal) modal.style.display = 'block';\n        }\n\n        function closeModal() {\n            const modal = document.getElementById('configModal');\n            if (modal) modal.style.display = 'none';\n            currentPanelIndex = -1;\n        }\n\n        function savePanelConfig() {\n            if (currentPanelIndex === -1) return;\n\n            const titleInput = document.getElementById('panelTitle');\n            const pathInput = document.getElementById('folderPath');\n            \n            const title = titleInput ? titleInput.value : '';\n            const path = pathInput ? pathInput.value : '';\n\n            if (!title || !path) {\n                alert('Please fill in both title and folder path');\n                return;\n            }\n\n            panels[currentPanelIndex] = { title, path };\n            saveConfiguration();\n            updatePanelDisplays();\n            refreshPanel(currentPanelIndex);\n            closeModal();\n        }\n\n        function resetPanel(panelIndex) {\n            if (confirm(`Are you sure you want to reset Panel ${panelIndex + 1}? This will clear all configuration and files.`)) {\n                delete panels[panelIndex];\n                \n                const titleElement = document.getElementById(`panelTitle${panelIndex}`);\n                const pathElement = document.getElementById(`folderPath${panelIndex}`);\n                const fileListElement = document.getElementById(`fileList${panelIndex}`);\n                \n                if (titleElement) titleElement.textContent = `Panel ${panelIndex + 1}`;\n                if (pathElement) pathElement.textContent = 'No path configured';\n                if (fileListElement) {\n                    fileListElement.innerHTML = `\n                        <div class=\"empty-panel\">\n                            <i class=\"fas fa-folder-open\"></i>\n                            <div>Configure a folder path to view files</div>\n                        </div>\n                    `;\n                }\n                \n                saveConfiguration();\n            }\n        }\n\n        async function refreshPanel(panelIndex) {\n            const panel = panels[panelIndex];\n            if (!panel) return;\n\n            const fileListElement = document.getElementById(`fileList${panelIndex}`);\n            if (!fileListElement) return;\n            \n            try {\n                const files = await readRealFiles(panel.path);\n                displayFiles(fileListElement, files);\n            } catch (error) {\n                fileListElement.innerHTML = `\n                    <div class=\"empty-panel\">\n                        <i class=\"fas fa-exclamation-triangle\"></i>\n                        <div>Error reading folder: ${error.message}</div>\n                        <div style=\"font-size: 0.8em; margin-top: 10px;\">\n                            Check if the folder path exists and is accessible.\n                        </div>\n                    </div>\n                `;\n            }\n        }\n\n        async function readRealFiles(folderPath) {\n            // Mock data for demonstration\n            return [\n                { name: 'script1.ps1', ext: 'ps1', modified: new Date() },\n                { name: 'config.xml', ext: 'xml', modified: new Date() },\n                { name: 'report.html', ext: 'html', modified: new Date() }\n            ];\n        }\n\n        function displayFiles(container, files) {\n            if (!container) return;\n            \n            if (files.length === 0) {\n                container.innerHTML = `\n                    <div class=\"empty-panel\">\n                        <i class=\"fas fa-folder-open\"></i>\n                        <div>No files found in this directory</div>\n                    </div>\n                `;\n                return;\n            }\n\n            container.innerHTML = files.map(file => `\n                <div class=\"file-item ${file.ext}\" onclick=\"openFile('${file.name}', '${file.ext}')\">\n                    <div class=\"file-name\" title=\"${file.name}\">${file.name}</div>\n                    <div class=\"file-ext\">${file.ext.toUpperCase()}</div>\n                    <div class=\"file-date\">${formatDate(file.modified)}</div>\n                </div>\n            `).join('');\n        }\n\n        function openFile(fileName, extension) {\n            alert(`Opening ${fileName} (${extension.toUpperCase()}) - File handling functionality preserved from original`);\n        }\n\n        function formatDate(date) {\n            const now = new Date();\n            const diffTime = now - date;\n            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));\n\n            if (diffDays === 0) {\n                return 'Today';\n            } else if (diffDays === 1) {\n                return 'Yesterday';\n            } else if (diffDays < 7) {\n                return `${diffDays} days ago`;\n            } else {\n                return date.toLocaleDateString();\n            }\n        }\n\n        function refreshAllPanels() {\n            for (let i = 0; i < 6; i++) {\n                if (panels[i]) {\n                    refreshPanel(i);\n                }\n            }\n        }\n\n        function saveConfiguration() {\n            localStorage.setItem('fileBrowserPanels', JSON.stringify(panels));\n        }\n\n        function loadConfiguration() {\n            try {\n                const saved = localStorage.getItem('fileBrowserPanels');\n                if (saved) {\n                    panels = JSON.parse(saved);\n                }\n            } catch (error) {\n                console.error('Load configuration error:', error);\n                panels = [];\n            }\n        }\n\n        // DateTime functions\n        function initializeDateTime() {\n            updateDateTime();\n            setInterval(updateDateTime, 1000);\n        }\n\n        function updateDateTime() {\n            const now = new Date();\n            const timeOptions = { \n                hour12: false, \n                hour: '2-digit', \n                minute: '2-digit', \n                second: '2-digit' \n            };\n            const dateOptions = { \n                weekday: 'long', \n                year: 'numeric', \n                month: 'long', \n                day: 'numeric' \n            };\n\n            const timeElement = document.getElementById('currentTime');\n            const dateElement = document.getElementById('currentDate');\n            \n            if (timeElement) {\n                timeElement.textContent = now.toLocaleTimeString('en-US', timeOptions);\n            }\n            if (dateElement) {\n                dateElement.textContent = now.toLocaleDateString('en-US', dateOptions);\n            }\n        }\n\n        // Calendar functions\n        function initializeCalendar() {\n            renderCalendar();\n        }\n\n        function renderCalendar() {\n            const year = currentDate.getFullYear();\n            const month = currentDate.getMonth();\n            \n            const monthNames = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\n                \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\n            \n            const titleElement = document.getElementById('calendarTitle');\n            if (titleElement) {\n                titleElement.textContent = `${monthNames[month]} ${year}`;\n            }\n\n            const calendarGrid = document.getElementById('calendarGrid');\n            if (!calendarGrid) return;\n            \n            calendarGrid.innerHTML = '';\n\n            // Add day headers\n            const dayHeaders = ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'];\n            dayHeaders.forEach(day => {\n                const dayHeader = document.createElement('div');\n                dayHeader.className = 'calendar-day-header';\n                dayHeader.textContent = day;\n                calendarGrid.appendChild(dayHeader);\n            });\n\n            // Get first day of month and number of days\n            const firstDay = new Date(year, month, 1);\n            const lastDay = new Date(year, month + 1, 0);\n            const firstDayOfWeek = firstDay.getDay();\n            const daysInMonth = lastDay.getDate();\n\n            // Add empty cells for days before month starts\n            for (let i = 0; i < firstDayOfWeek; i++) {\n                const emptyDay = document.createElement('div');\n                emptyDay.className = 'calendar-day other-month';\n                const prevMonthDay = new Date(year, month, 0 - (firstDayOfWeek - 1 - i));\n                emptyDay.textContent = prevMonthDay.getDate();\n                calendarGrid.appendChild(emptyDay);\n            }\n\n            // Add days of current month\n            const today = new Date();\n            for (let day = 1; day <= daysInMonth; day++) {\n                const dayElement = document.createElement('div');\n                dayElement.className = 'calendar-day';\n                dayElement.textContent = day;\n                \n                // Highlight today\n                if (year === today.getFullYear() && \n                    month === today.getMonth() && \n                    day === today.getDate()) {\n                    dayElement.classList.add('today');\n                }\n                \n                calendarGrid.appendChild(dayElement);\n            }\n\n            // Add empty cells for days after month ends\n            const totalCells = calendarGrid.children.length;\n            const remainingCells = 42 - totalCells;\n            for (let i = 1; i <= remainingCells && i <= 14; i++) {\n                const nextMonthDay = document.createElement('div');\n                nextMonthDay.className = 'calendar-day other-month';\n                nextMonthDay.textContent = i;\n                calendarGrid.appendChild(nextMonthDay);\n            }\n        }\n\n        function previousMonth() {\n            currentDate.setMonth(currentDate.getMonth() - 1);\n            renderCalendar();\n        }\n\n        function nextMonth() {\n            currentDate.setMonth(currentDate.getMonth() + 1);\n            renderCalendar();\n        }\n\n        // Export/Import functions\n        function exportConfig() {\n            try {\n                const config = {\n                    panels: panels,\n                    exportDate: new Date().toISOString(),\n                    version: \"1.0\",\n                    application: \"Senior Systems Engineer File Browser\"\n                };\n\n                const dataStr = JSON.stringify(config, null, 2);\n                const dataBlob = new Blob([dataStr], { type: 'application/json' });\n                \n                const link = document.createElement('a');\n                link.href = URL.createObjectURL(dataBlob);\n                link.download = `file-browser-config-${new Date().toISOString().split('T')[0]}.json`;\n                document.body.appendChild(link);\n                link.click();\n                document.body.removeChild(link);\n                \n                alert('Configuration exported successfully!');\n            } catch (error) {\n                console.error('Export error:', error);\n                alert('Error exporting configuration: ' + error.message);\n            }\n        }\n\n        function importConfig() {\n            try {\n                const fileInput = document.getElementById('importFileInput');\n                if (fileInput) {\n                    fileInput.click();\n                }\n            } catch (error) {\n                console.error('Import error:', error);\n                alert('Error opening file dialog: ' + error.message);\n            }\n        }\n\n        function handleImportFile(event) {\n            try {\n                const file = event.target.files[0];\n                if (!file) return;\n\n                const reader = new FileReader();\n                reader.onload = function(e) {\n                    try {\n                        const config = JSON.parse(e.target.result);\n                        \n                        if (!config.panels || !Array.isArray(config.panels)) {\n                            throw new Error('Invalid configuration format');\n                        }\n\n                        const exportDate = config.exportDate ? new Date(config.exportDate).toLocaleDateString() : 'Unknown';\n                        const confirmMessage = `Import configuration exported on ${exportDate}?\\n\\nThis will replace your current configuration.`;\n                        if (confirm(confirmMessage)) {\n                            panels = config.panels;\n                            saveConfiguration();\n                            updatePanelDisplays();\n                            refreshAllPanels();\n                            alert('Configuration imported successfully!');\n                        }\n                    } catch (error) {\n                        alert(`Error importing configuration: ${error.message}`);\n                    }\n                };\n                reader.readAsText(file);\n                \n                event.target.value = '';\n            } catch (error) {\n                console.error('Handle import file error:', error);\n                alert('Error handling import file: ' + error.message);\n            }\n        }\n\n        // Tab switching functionality\n        function switchTab(tab) {\n            const fileBrowserSection = document.getElementById('gridContainer');\n            const taskTrackerSection = document.getElementById('taskTrackerSection');\n            const refreshBtn = document.querySelector('.refresh-btn');\n            const tabs = document.querySelectorAll('.nav-tab');\n            \n            // Update tab states\n            tabs.forEach(t => t.classList.remove('active'));\n            event.target.classList.add('active');\n            \n            if (tab === 'files') {\n                fileBrowserSection.style.display = 'grid';\n                taskTrackerSection.style.display = 'none';\n                refreshBtn.style.display = 'block';\n            } else if (tab === 'tasks') {\n                fileBrowserSection.style.display = 'none';\n                taskTrackerSection.style.display = 'block';\n                refreshBtn.style.display = 'none';\n                initializeTaskTracker();\n            }\n        }\n        \n        function initializeTaskTracker() {\n            // Task management variables\n            let tasks = [\n                {\n                    id: 1757329106448,\n                    title: \"Evo security\",\n                    description: \"Configure Solution (on)\",\n                    category: \"Project\",\n                    priority: \"High\",\n                    dueDate: \"2025-09-24\",\n                    hours: 2,\n                    status: \"pending\",\n                    createdAt: \"2025-09-19T10:00:00Z\",\n                    completedAt: null\n                },\n                {\n                    id: 1758269150099,\n                    title: \"Sql Server Upgrade /Optimization -Pather & Pather\",\n                    description: \"Upgrade SQL EXPRESS TO SQL 2019 , PROVISION NEW DISKS FOR db's , LOGS, oPTIMIZE 12H QUOTED\",\n                    category: \"Project\",\n                    priority: \"Medium\",\n                    dueDate: \"2025-09-20\",\n                    hours: 0,\n                    status: \"pending\",\n                    createdAt: \"2025-09-19T10:00:00Z\",\n                    completedAt: null\n                }\n            ];\n\n            // Quick Notes management\n            let quickNotes = [];\n\n            // Timer management\n            let taskTimers = {};\n            let currentEditTaskId = null;\n            \n            // Load tasks from localStorage\n            function loadTasks() {\n                try {\n                    const saved = localStorage.getItem('taskTracker_tasks');\n                    if (saved) {\n                        tasks = JSON.parse(saved);\n                    }\n                } catch (error) {\n                    console.error('Error loading saved tasks:', error);\n                }\n            }\n            \n            // Save tasks to localStorage\n            function saveTasks() {\n                try {\n                    localStorage.setItem('taskTracker_tasks', JSON.stringify(tasks));\n                } catch (error) {\n                    console.error('Error saving tasks:', error);\n                }\n            }\n\n            // Load notes from localStorage\n            function loadQuickNotes() {\n                try {\n                    const saved = localStorage.getItem('taskTracker_quickNotes');\n                    if (saved) {\n                        quickNotes = JSON.parse(saved);\n                    }\n                } catch (error) {\n                    console.error('Error loading saved notes:', error);\n                }\n            }\n            \n            // Save notes to localStorage\n            function saveQuickNotes() {\n                try {\n                    localStorage.setItem('taskTracker_quickNotes', JSON.stringify(quickNotes));\n                } catch (error) {\n                    console.error('Error saving notes:', error);\n                }\n            }\n\n            // Render quick notes\n            function renderQuickNotes() {\n                const notesList = document.getElementById('quickNotesList');\n                if (!notesList) return;\n\n                if (quickNotes.length === 0) {\n                    notesList.innerHTML = '<div style=\"text-align: center; color: #a0aec0; font-size: 0.75em; padding: 10px;\">No notes yet</div>';\n                    return;\n                }\n\n                notesList.innerHTML = quickNotes.map(note => `\n                    <div class=\"note-item\">\n                        <div class=\"note-content\">${escapeHtml(note.content)}</div>\n                        <div class=\"note-meta\">\n                            <span class=\"note-timestamp\">${formatNoteDate(note.createdAt)}</span>\n                            <div class=\"note-actions\">\n                                <button class=\"note-btn convert\" onclick=\"convertNoteToTask(${note.id})\" title=\"Convert to Task\">\n                                    <i class=\"fas fa-arrow-right\"></i>\n                                </button>\n                                <button class=\"note-btn delete\" onclick=\"deleteQuickNote(${note.id})\" title=\"Delete Note\">\n                                    <i class=\"fas fa-times\"></i>\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                `).join('');\n            }\n\n            // Add quick note function\n            window.addQuickNote = function() {\n                const input = document.getElementById('quickNoteInput');\n                if (!input) return;\n\n                const content = input.value.trim();\n                if (!content) {\n                    alert('Please enter a note before adding');\n                    return;\n                }\n\n                const note = {\n                    id: Date.now(),\n                    content: content,\n                    createdAt: new Date().toISOString()\n                };\n\n                quickNotes.unshift(note); // Add to beginning of array\n                saveQuickNotes();\n                renderQuickNotes();\n                input.value = ''; // Clear input\n            };\n\n            // Delete quick note function\n            window.deleteQuickNote = function(id) {\n                quickNotes = quickNotes.filter(note => note.id !== id);\n                saveQuickNotes();\n                renderQuickNotes();\n            };\n\n            // Clear all notes function\n            window.clearQuickNotes = function() {\n                if (quickNotes.length === 0) {\n                    alert('No notes to clear');\n                    return;\n                }\n\n                if (confirm(`Are you sure you want to delete all ${quickNotes.length} notes?`)) {\n                    quickNotes = [];\n                    saveQuickNotes();\n                    renderQuickNotes();\n                }\n            };\n\n            // Convert note to task function\n            window.convertNoteToTask = function(noteId) {\n                const note = quickNotes.find(n => n.id === noteId);\n                if (!note) return;\n\n                // Pre-fill the task form with note content\n                const titleInput = document.getElementById('taskTitle');\n                const descriptionInput = document.getElementById('taskDescription');\n                \n                if (titleInput) {\n                    // Use first 50 characters as title, or full content if shorter\n                    titleInput.value = note.content.length > 50 ? \n                        note.content.substring(0, 50) + '...' : \n                        note.content;\n                }\n                \n                if (descriptionInput) {\n                    descriptionInput.value = note.content;\n                }\n\n                // Set default values for new task\n                const categoryInput = document.getElementById('taskCategory');\n                const priorityInput = document.getElementById('taskPriority');\n                const dueDateInput = document.getElementById('taskDueDate');\n\n                if (categoryInput) categoryInput.value = 'Work';\n                if (priorityInput) priorityInput.value = 'Medium';\n                if (dueDateInput) {\n                    // Set due date to tomorrow\n                    const tomorrow = new Date();\n                    tomorrow.setDate(tomorrow.getDate() + 1);\n                    dueDateInput.value = tomorrow.toISOString().split('T')[0];\n                }\n\n                // Ask if user wants to delete the note after conversion\n                if (confirm('Note content copied to task form. Delete the original note?')) {\n                    deleteQuickNote(noteId);\n                }\n\n                // Scroll to task form\n                const taskForm = document.getElementById('taskForm');\n                if (taskForm) {\n                    taskForm.scrollIntoView({ behavior: 'smooth', block: 'start' });\n                }\n            };\n\n            // Format note date\n            function formatNoteDate(dateString) {\n                const date = new Date(dateString);\n                const now = new Date();\n                const diffMs = now - date;\n                const diffMins = Math.floor(diffMs / (1000 * 60));\n                const diffHours = Math.floor(diffMs / (1000 * 60 * 60));\n                const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));\n\n                if (diffMins < 1) return 'Just now';\n                if (diffMins < 60) return `${diffMins}m ago`;\n                if (diffHours < 24) return `${diffHours}h ago`;\n                if (diffDays < 7) return `${diffDays}d ago`;\n                return date.toLocaleDateString();\n            }\n\n            // Add Enter key support for quick note input\n            document.getElementById('quickNoteInput')?.addEventListener('keydown', function(e) {\n                if (e.key === 'Enter' && !e.shiftKey) {\n                    e.preventDefault();\n                    addQuickNote();\n                }\n            });\n            \n            // Update statistics\n            function updateStats() {\n                const total = tasks.length;\n                const completed = tasks.filter(t => t.status === 'completed').length;\n                const pending = tasks.filter(t => getTaskStatus(t) === 'pending').length;\n                const overdue = tasks.filter(t => getTaskStatus(t) === 'overdue').length;\n                \n                const totalEl = document.getElementById('totalTasks');\n                const completedEl = document.getElementById('completedTasks');\n                const pendingEl = document.getElementById('pendingTasks');\n                const overdueEl = document.getElementById('overdueTasks');\n                \n                if (totalEl) totalEl.textContent = total;\n                if (completedEl) completedEl.textContent = completed;\n                if (pendingEl) pendingEl.textContent = pending;\n                if (overdueEl) overdueEl.textContent = overdue;\n            }\n            \n            // Get task status\n            function getTaskStatus(task) {\n                if (task.status === 'completed') return 'completed';\n                \n                const today = new Date();\n                const dueDate = new Date(task.dueDate);\n                \n                if (dueDate < today) return 'overdue';\n                return task.status;\n            }\n\n            // Helper function to escape HTML\n            function escapeHtml(text) {\n                const div = document.createElement('div');\n                div.textContent = text;\n                return div.innerHTML;\n            }\n            \n            // Toggle task status\n            window.toggleTaskStatus = function(id) {\n                const task = tasks.find(t => t.id === id);\n                if (!task) return;\n                \n                if (task.status === 'completed') {\n                    task.status = 'pending';\n                    task.completedAt = null;\n                } else {\n                    task.status = 'completed';\n                    task.completedAt = new Date().toISOString();\n                }\n                \n                saveTasks();\n                updateStats();\n            };\n            \n            // Delete task\n            window.deleteTask = function(id) {\n                if (confirm('Are you sure you want to delete this task?')) {\n                    tasks = tasks.filter(t => t.id !== id);\n                    saveTasks();\n                    updateStats();\n                }\n            };\n\n            // Edit task function\n            window.editTask = function(id) {\n                const task = tasks.find(t => t.id === id);\n                if (!task) return;\n\n                currentEditTaskId = id;\n\n                // Populate edit form\n                document.getElementById('editTaskTitle').value = task.title;\n                document.getElementById('editTaskDescription').value = task.description;\n                document.getElementById('editTaskCategory').value = task.category;\n                document.getElementById('editTaskPriority').value = task.priority;\n                document.getElementById('editTaskDueDate').value = task.dueDate;\n                document.getElementById('editTaskHours').value = task.hours || 0;\n\n                // Show modal\n                document.getElementById('taskEditModal').style.display = 'block';\n            };\n\n            // Close task edit modal\n            window.closeTaskEditModal = function() {\n                document.getElementById('taskEditModal').style.display = 'none';\n                currentEditTaskId = null;\n            };\n\n            // Timer functions\n            window.toggleTimer = function(id) {\n                const timerBtn = document.getElementById(`timer-${id}`);\n                if (!timerBtn) return;\n\n                if (taskTimers[id]) {\n                    // Stop timer\n                    const startTime = taskTimers[id];\n                    const elapsedMs = Date.now() - startTime;\n                    const elapsedHours = elapsedMs / (1000 * 60 * 60);\n\n                    // Update task hours\n                    const task = tasks.find(t => t.id === id);\n                    if (task) {\n                        task.hours = (task.hours || 0) + elapsedHours;\n                        task.hours = Math.round(task.hours * 100) / 100; // Round to 2 decimal places\n                        saveTasks();\n                    }\n\n                    delete taskTimers[id];\n                    timerBtn.textContent = '‚ñ∂ Start';\n                    timerBtn.classList.remove('running');\n                } else {\n                    // Start timer\n                    taskTimers[id] = Date.now();\n                    timerBtn.textContent = '‚è∏ Stop';\n                    timerBtn.classList.add('running');\n                }\n            };\n\n            // Filter functions\n            window.applyFilters = function() {\n                const statusFilter = document.getElementById('filterStatus').value;\n                const priorityFilter = document.getElementById('filterPriority').value;\n                const categoryFilter = document.getElementById('filterCategory').value;\n\n                // This would normally filter the displayed tasks\n                // For now, we'll just show an alert\n                console.log('Applying filters:', { statusFilter, priorityFilter, categoryFilter });\n            };\n\n            window.clearFilters = function() {\n                document.getElementById('filterStatus').value = '';\n                document.getElementById('filterPriority').value = '';\n                document.getElementById('filterCategory').value = '';\n                applyFilters();\n            };\n            \n            // Add task form handler\n            const taskForm = document.getElementById('taskForm');\n            if (taskForm) {\n                taskForm.addEventListener('submit', function(e) {\n                    e.preventDefault();\n                    \n                    const title = document.getElementById('taskTitle').value.trim();\n                    const description = document.getElementById('taskDescription').value.trim();\n                    const category = document.getElementById('taskCategory').value;\n                    const priority = document.getElementById('taskPriority').value;\n                    const dueDate = document.getElementById('taskDueDate').value;\n                    const hours = parseFloat(document.getElementById('taskHours').value) || 0;\n                    \n                    if (!title || !category || !priority || !dueDate) {\n                        alert('Please fill in all required fields');\n                        return;\n                    }\n                    \n                    const task = {\n                        id: Date.now(),\n                        title: title,\n                        description: description,\n                        category: category,\n                        priority: priority,\n                        dueDate: dueDate,\n                        hours: hours,\n                        status: 'pending',\n                        createdAt: new Date().toISOString(),\n                        completedAt: null\n                    };\n                    \n                    tasks.push(task);\n                    saveTasks();\n                    updateStats();\n                    \n                    // Reset form\n                    taskForm.reset();\n                });\n            }\n            \n            // Edit task form handler\n            const taskEditForm = document.getElementById('taskEditForm');\n            if (taskEditForm) {\n                taskEditForm.addEventListener('submit', function(e) {\n                    e.preventDefault();\n\n                    if (!currentEditTaskId) return;\n\n                    const title = document.getElementById('editTaskTitle').value.trim();\n                    const description = document.getElementById('editTaskDescription').value.trim();\n                    const category = document.getElementById('editTaskCategory').value;\n                    const priority = document.getElementById('editTaskPriority').value;\n                    const dueDate = document.getElementById('editTaskDueDate').value;\n                    const hours = parseFloat(document.getElementById('editTaskHours').value) || 0;\n\n                    if (!title || !category || !priority || !dueDate) {\n                        alert('Please fill in all required fields');\n                        return;\n                    }\n\n                    // Find and update task\n                    const taskIndex = tasks.findIndex(t => t.id === currentEditTaskId);\n                    if (taskIndex !== -1) {\n                        tasks[taskIndex] = {\n                            ...tasks[taskIndex],\n                            title: title,\n                            description: description,\n                            category: category,\n                            priority: priority,\n                            dueDate: dueDate,\n                            hours: hours\n                        };\n\n                        saveTasks();\n                        updateStats();\n                        closeTaskEditModal();\n\n                        // In a real implementation, you would re-render the tasks list here\n                        alert('Task updated successfully! Please refresh to see changes.');\n                    }\n                });\n            }\n\n            // Set minimum date to today\n            const today = new Date().toISOString().split('T')[0];\n            const dueDateInput = document.getElementById('taskDueDate');\n            if (dueDateInput) {\n                dueDateInput.setAttribute('min', today);\n            }\n\n            const editDueDateInput = document.getElementById('editTaskDueDate');\n            if (editDueDateInput) {\n                editDueDateInput.setAttribute('min', today);\n            }\n            \n            // Initialize\n            loadTasks();\n            loadQuickNotes();\n            updateStats();\n            renderQuickNotes();\n        }\n\n        // Event handlers\n        window.onclick = function(event) {\n            const configModal = document.getElementById('configModal');\n            const taskEditModal = document.getElementById('taskEditModal');\n\n            if (event.target === configModal) {\n                closeModal();\n            }\n            if (event.target === taskEditModal) {\n                closeTaskEditModal();\n            }\n        }\n\n        document.addEventListener('keydown', function(event) {\n            const modal = document.getElementById('configModal');\n            if (event.key === 'Enter' && modal && modal.style.display === 'block') {\n                savePanelConfig();\n            }\n        });\n    </script>\n\n\n</body></html>",
      "category": "HTML Tools",
      "tags": [
        "Engineer",
        "Dashboard",
        "tasktracker"
      ],
      "created": "2025-09-28T21:54:43.129Z",
      "modified": "2025-09-28T21:58:41.334Z",
      "isPinned": false,
      "isArchived": false,
      "type": "html"
    },
    {
      "id": "note-1757846283968",
      "title": "UI Designing AI-Driven Terms",
      "content": "Here's a breakdown of key UI building terms for AI modernization:\n\nAI-Driven Design:\n\nGenerative AI (GenAI):\nUsing AI to create design elements, suggest layouts, and generate components based on historical data and real-time feedback. \n\nAI-Generated User Interfaces (AIGUI):\nDynamic designs created on the fly by AI companions or other AI-powered systems. \nAI-Powered Prototyping Tools:\nTools that leverage AI to suggest design elements and interaction patterns during the prototyping phase. \nModern UI/UX Principles:\nResponsiveness:\nDesigns that adapt to different screen sizes and devices, ensuring a consistent experience across platforms. \nInteraction Design:\nDesigning intuitive and smooth user interactions with elements like buttons, forms, and animations. \nBehavioral Design:\nFocusing on understanding and influencing user behavior through design to guide their actions within the interface. \nUsability:\nThe ease with which users can achieve their goals using the interface. \nAccessibility:\nDesigning interfaces that are usable by everyone, including people with disabilities. \nAI Integration into the UI:\nAI Interfaces and Presence:\nThe overall experience of interacting with AI within a digital interface, encompassing both functionality and aesthetics. \n\nContextual AI:\nAI that understands and adapts to the user's context, providing relevant information and features when needed. \n\nUnderlying Processes:\nPrototyping:\nCreating detailed representations of the final product to test and refine design concepts before full development. \n\nTest Automation:\nUsing automated tools to test user interfaces, improving development speed and reliability. ",
      "category": "Development",
      "tags": [
        "ui",
        "ai",
        "gui design"
      ],
      "created": "2025-09-14T10:38:03.968Z",
      "modified": "2025-09-14T10:41:23.991Z",
      "isPinned": true,
      "isArchived": false,
      "type": "document"
    },
    {
      "id": "note-1757453538331",
      "title": "UbUNTU Setup",
      "content": "iNSTALL uBUNTU 1ST , Launch terminal and update Ubuntu\n\n#!/bin/bash\nset -e\n\necho \"Starting Ubuntu configuration for Claude Code...\"\n\n# Update package lists\nsudo apt update && sudo apt upgrade -y\n\n# Install essential packages\nsudo apt install -y curl wget git build-essential python3 python3-pip nodejs npm\n\n# Install Node.js LTS via NodeSource\ncurl -fsSL https://deb.nodesource.com/setup_lts.x | sudo -E bash -\nsudo apt-get install -y nodejs\n\n# Verify installations\necho \"Node.js version: \\\"\necho \"npm version: \\\"\necho \"Python version: \\\"\n\n# Install Claude Code\necho \"Installing Claude Code...\"\nnpm install -g @anthropic-ai/claude-code\n\n# Verify Claude Code installation\nif command -v claude-code &> /dev/null; then\n    echo \"Claude Code installed successfully!\"\n    echo \"Version: \\\"\nelse\n    echo \"Claude Code installation failed!\"\n    exit 1\nfi\n\n# Set up git configuration prompts\necho \"Setting up Git configuration...\"\necho \"Please configure Git with your details:\"\nread -p \"Enter your Git username: \" git_username\nread -p \"Enter your Git email: \" git_email\n\ngit config --global user.name \"\\\"\ngit config --global user.email \"\\\"\n\n# Create workspace directory\nmkdir -p ~/workspace/claude-projects\ncd ~/workspace/claude-projects\n\necho \"Setup complete! You can now use Claude Code.\"\necho \"Run 'claude-code --help' to get started.\"\necho \"Workspace created at: ~/workspace/claude-projects\"\n",
      "category": "Setup Scripts -1installer",
      "tags": [
        "Ubuntu Setup",
        "Claude",
        "WSL"
      ],
      "created": "2025-09-09T21:32:18.331Z",
      "modified": "2025-09-09T21:34:22.558Z",
      "isPinned": false,
      "isArchived": false,
      "type": "code"
    },
    {
      "id": "note-1756884962650",
      "title": "Standby Email Template -Disk Alerts ",
      "content": "Standby Email Template -Disk Alerts \n====================================\n\nCreated in Nishen's AI Workspace on 2025/09/03\n\nOverview:\n---------\nDocument description here.\n\nContents:\n---------\n- Section 1\n- Section 2\n- Section 3\n\nNotes:\n------\nAdd your documentation content here.",
      "category": "Documentation",
      "tags": [
        "standby",
        "template"
      ],
      "created": "2025-09-03T07:36:02.650Z",
      "modified": "2025-09-03T07:36:02.650Z",
      "isPinned": false,
      "isArchived": false,
      "type": "document"
    },
    {
      "id": "note-1756884603452",
      "title": "Standby Template Failed Disk Alerts",
      "content": "Standby Template Failed Disk Alerts\n===================================\n\nCreated in Nishen's AI Workspace on 2025/09/03\n\nOverview:\n---------\nDocument description here.\n\nContents:\n---------\n- Section 1\n- Section 2\n- Section 3\n\nNotes:\n------\nAdd your documentation content here.",
      "category": "Documentation",
      "tags": [
        "standby",
        "template",
        ""
      ],
      "created": "2025-09-03T07:30:03.452Z",
      "modified": "2025-09-03T07:30:03.452Z",
      "isPinned": false,
      "isArchived": false,
      "type": "document"
    },
    {
      "id": "note-1755651165564",
      "title": "evo security",
      "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>evo security</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            margin: 0;\n            padding: 20px;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n            min-height: 100vh;\n        }\n        .container {\n            max-width: 800px;\n            margin: 0 auto;\n            background: rgba(255, 255, 255, 0.1);\n            padding: 30px;\n            border-radius: 15px;\n            backdrop-filter: blur(10px);\n        }\n        h1 { color: #fff; text-align: center; margin-bottom: 30px; }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>üöÄ evo security</h1>\n        <p>EVO Cloud\nFor the below we‚Äôre going to add a simple\n Evo Cloud Directory-as-a-Service (DaaS). Unlike the other directory types, an Evo Cloud directory doesn‚Äôt sync users, once the directory is created, you‚Äôll need to add users directly to Evo.\n1. From the left navigation menu, select My Company. Alternatively, select Customers and choose a customer from the list.\n2. From the side navigation, click Directories.\n3. Select the Evo Cloud tab.\n4. Click the Add New Directory\n5. Enter a name for the directory.\n6. Click Create Directory.\nAt this point, users will automatically start to populate into the People section of the Evo portal if you have setup one of the sync options.\n\nStep 3. User Licensing\nOnce you have users syncing and showing up in the People section, the next step is to assign those user licenses. To enable features like MFA, SSO, or Elevated Access, all users must have an Evo license assigned to them. \n1. Expand the below section to see instructions on how to assign licenses to users:\n\n\nAssigning Licenses\n1. On the People screen, select the user(s) using the checkbox on the left.\n2. Click Actions ‚Üí Assign Licenses ‚Üí EVO Standard.\n\n\n1. The license for the user now shows EVO Standard\n\n\n\nStep 4. Converting Users to Admins\nThe next step is to convert users to admins. When you or your technicians need to manage customers, need to have privileges within the Evo portal or use Elevated Access/Shared accounts, their user will need to be converted into an Admin. \nConverting a user to an admin does not give them additional privileges or access. That is configured separately in subsequent steps.\n1. Expand the below section to see instructions on how to convert users to admins:\n\nConverting Users into Evo Admins\n1. Select People from the left navigation menu.\n2. In the displayed list of users, click on the user you want to edit.\n3. Click Convert to Admin.\n\n\n4. Click Yes.\n\nStep 5. Setting Up EVO Portal Admins\nEVO Portal Admins are users that will have administrative access to your EVO MSP portal.\n\nRole-Based Permission Groups\nRole-Based Permissions are permission groups.\n5. Expand the below section to see instructions on how to create a permission group:\n\n\nCreating Role-Based Permission Groups & Assigning Users\n6. From the dashboard, click Access.\n7. Click Role-Based Permissions.\n8. Click Create New Permission Group.\n9. Enter a name for the new group (EVO Admins) for example, and optionally a description.\n\n\n10. Click Next.\n11. Check Select All Roles\n\n\n12. If creating a group for restricted permissions (Technician access for example), you can use the ‚ÄúTechnicians‚Äù example permissions below.\n13. Click Next.\n14. From the list of administrators, check each administrator that should be included in the group.\n15. Click Complete.\n\nExamples of Permissions for technicians that normally preform basic EVO management functions:\n‚Ä¢ Users\n\t‚Ä¢ All\n‚Ä¢ Directories\n\t‚Ä¢ View Directories\n‚Ä¢ Elevated Access\n\t‚Ä¢ Can be Elevated Admin\n‚Ä¢ Keys\n\t‚Ä¢ All\n‚Ä¢ Devices\n\t‚Ä¢ All\n‚Ä¢ Billing\n\t‚Ä¢ All\n‚Ä¢ Customers\n\t‚Ä¢ All\n‚Ä¢ Dashboard\n\t‚Ä¢ All\n\nCustomer Access Permissions\nNow we need to grant access to customers (if any) to your EVO admin users.\n16. Expand the below section to see instructions on how to grant customer permissions to EVO admins:\n\n\nManaging Customer Access\n17. From the dashboard, click Access.\n18. Click Customer Access.\n19. In the displayed list of customers located on the left, find the customer for the restrictions that are to be made. Click the customer‚Äôs name.\n20. From the list of administrators: Changes made are automatically saved.\n21. To grant access: Check the row for each user who should be granted access.\n22. To remove access: Uncheck the row for each user who should no longer be granted access.\n\n\n\nFrom <https://www.sonicwall.com/support/knowledge-base/evo-partner-deployment-guide/240827123540380> \n\nMSS EVO User Guide\n\n\n..</p>\n    </div>\n</body>\n</html>",
      "category": "Documentation",
      "tags": [],
      "created": "2025-08-20T00:52:45.564Z",
      "modified": "2025-08-20T00:54:59.928Z",
      "isPinned": true,
      "isArchived": false,
      "type": "html"
    },
    {
      "id": "note-1755524238196",
      "title": "Evo Security: RMS Technical Document ",
      "content": "Evo Security: RMS Technical Document -    by:  Nishen Harichunder RMS L4            Aug 2025\n\n\nFTRMS Engineer Group Definitions - (Naming conventions & Standards)\n\n\n\n\n\n\n\n\n\n\nEVO User Accounts - Explained\n\n1. Use Evo Cloud User for everyday MSP engineers or operational staff.\n\n2. Use Evo Cloud User (Admin) for MSP administrators who manage the EvoSecurity environment.   - (Restricted to L4 )\n\n3. Use Evo Cloud User (Guest) for temporary or highly restricted access users such as external auditors or clients with minimal interaction rights.\n\n\nChoosing the appropriate user type ensures proper segmentation of duties and adherence to least privilege principles within the EvoSecurity system.\n\n",
      "category": "System Admin",
      "tags": [
        "EvoSecurity",
        "evo",
        "rms doc",
        "msp"
      ],
      "created": "2025-08-18T13:37:18.196Z",
      "modified": "2025-08-18T13:48:16.093Z",
      "isPinned": false,
      "isArchived": false,
      "type": "document"
    },
    {
      "id": "note-1755179491076",
      "title": "Halo and Ncentral Cheats",
      "content": "Halo and Ncentral Cheats\n========================\n\nCreated in Nishen's AI Workspace on 2025/08/14\n\nOverview:\n---------\nDocument description here.\n\nContents:\n---------\n- Section 1\n- Section 2\n- Section 3\n\nNotes:\n------\nAdd your documentation content here.",
      "category": "Documentation",
      "tags": [
        "cheats"
      ],
      "created": "2025-08-14T13:51:31.076Z",
      "modified": "2025-08-14T13:51:31.076Z",
      "isPinned": false,
      "isArchived": false,
      "type": "document"
    },
    {
      "id": "note-1754492581306",
      "title": "Rewst-Enhanced Power Verification Solution<Standby checks -POWER CONFIRMATION ",
      "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Email Summary - Rewst Power Verification</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            line-height: 1.6;\n            color: #333;\n            max-width: 800px;\n            margin: 0 auto;\n            padding: 20px;\n            background: #f9f9f9;\n        }\n        \n        .email-container {\n            background: white;\n            padding: 30px;\n            border-radius: 8px;\n            box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n        }\n        \n        .header {\n            text-align: center;\n            margin-bottom: 30px;\n            padding-bottom: 15px;\n            border-bottom: 2px solid #3498db;\n        }\n        \n        .header h1 {\n            color: #2c3e50;\n            margin: 0;\n            font-size: 1.8em;\n        }\n        \n        .header p {\n            color: #7f8c8d;\n            margin: 5px 0 0 0;\n            font-style: italic;\n        }\n        \n        .executive-summary {\n            background: linear-gradient(135deg, #3498db, #2980b9);\n            color: white;\n            padding: 20px;\n            border-radius: 8px;\n            margin: 20px 0;\n            text-align: center;\n        }\n        \n        .key-benefits {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));\n            gap: 15px;\n            margin: 20px 0;\n        }\n        \n        .benefit-card {\n            background: #e8f4fd;\n            border: 1px solid #bee5eb;\n            border-radius: 6px;\n            padding: 15px;\n            text-align: center;\n        }\n        \n        .benefit-number {\n            font-size: 2em;\n            font-weight: bold;\n            color: #e74c3c;\n            margin-bottom: 5px;\n        }\n        \n        .benefit-text {\n            font-size: 0.9em;\n            color: #2c3e50;\n        }\n        \n        .flowchart {\n            background: #f8f9fa;\n            border: 2px solid #dee2e6;\n            border-radius: 10px;\n            padding: 20px;\n            margin: 25px 0;\n            text-align: center;\n        }\n        \n        .flow-step {\n            display: inline-block;\n            background: #fff;\n            border: 2px solid #3498db;\n            border-radius: 8px;\n            padding: 12px;\n            margin: 8px;\n            min-width: 120px;\n            font-size: 0.9em;\n            vertical-align: top;\n        }\n        \n        .flow-trigger {\n            background: linear-gradient(135deg, #e74c3c, #c0392b);\n            color: white;\n            border-color: #c0392b;\n        }\n        \n        .flow-process {\n            background: linear-gradient(135deg, #9b59b6, #8e44ad);\n            color: white;\n            border-color: #8e44ad;\n        }\n        \n        .flow-decision {\n            background: linear-gradient(135deg, #f39c12, #e67e22);\n            color: white;\n            border-color: #e67e22;\n            border-radius: 50px;\n            width: 140px;\n            height: 80px;\n            display: inline-flex;\n            align-items: center;\n            justify-content: center;\n            text-align: center;\n        }\n        \n        .flow-outcome-a {\n            background: linear-gradient(135deg, #e74c3c, #c0392b);\n            color: white;\n            border-color: #c0392b;\n        }\n        \n        .flow-outcome-b {\n            background: linear-gradient(135deg, #27ae60, #229954);\n            color: white;\n            border-color: #229954;\n        }\n        \n        .flow-arrow {\n            font-size: 20px;\n            color: #3498db;\n            margin: 0 5px;\n        }\n        \n        .comparison-table {\n            width: 100%;\n            border-collapse: collapse;\n            margin: 20px 0;\n            font-size: 0.9em;\n        }\n        \n        .comparison-table th,\n        .comparison-table td {\n            padding: 10px;\n            border: 1px solid #ddd;\n            text-align: left;\n        }\n        \n        .comparison-table th {\n            background: #3498db;\n            color: white;\n        }\n        \n        .comparison-table tr:nth-child(even) {\n            background: #f8f9fa;\n        }\n        \n        .current-problem {\n            background: #fff5f5;\n            border-left: 4px solid #e74c3c;\n            padding: 15px;\n            margin: 15px 0;\n        }\n        \n        .proposed-solution {\n            background: #f0fff4;\n            border-left: 4px solid #27ae60;\n            padding: 15px;\n            margin: 15px 0;\n        }\n        \n        .timeline {\n            background: #f8f9fa;\n            border-radius: 8px;\n            padding: 15px;\n            margin: 20px 0;\n        }\n        \n        .timeline-item {\n            display: flex;\n            align-items: center;\n            margin: 10px 0;\n            padding: 8px;\n            background: white;\n            border-radius: 5px;\n        }\n        \n        .timeline-day {\n            background: #3498db;\n            color: white;\n            border-radius: 50%;\n            width: 35px;\n            height: 35px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            margin-right: 15px;\n            font-weight: bold;\n            font-size: 0.8em;\n        }\n        \n        .roi-highlight {\n            background: linear-gradient(135deg, #2ecc71, #27ae60);\n            color: white;\n            padding: 20px;\n            border-radius: 8px;\n            text-align: center;\n            margin: 20px 0;\n        }\n        \n        .action-required {\n            background: #fff3cd;\n            border: 1px solid #ffc107;\n            border-radius: 6px;\n            padding: 15px;\n            margin: 20px 0;\n        }\n        \n        .signature {\n            margin-top: 30px;\n            padding-top: 15px;\n            border-top: 1px solid #dee2e6;\n            font-size: 0.9em;\n            color: #6c757d;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"email-container\">\n        <div class=\"header\">\n            <h1>üöÄ Automated Power Verification Solution</h1>\n            <p>Rewst-Enhanced Implementation | FTech KZN | August 2025</p>\n        </div>\n\n        <div class=\"executive-summary\">\n            <h3 style=\"margin-top: 0;\">Executive Summary</h3>\n            <p>Transform FTech's incident response from manual customer inquiries to intelligent, automated service delivery. Eliminate \"Do you have power?\" calls and provide proactive customer communication.</p>\n        </div>\n\n        <h3>üìä Key Benefits & ROI</h3>\n        <div class=\"key-benefits\">\n            <div class=\"benefit-card\">\n                <div class=\"benefit-number\">80%</div>\n                <div class=\"benefit-text\">Reduction in Customer<br>Power Inquiries</div>\n            </div>\n            <div class=\"benefit-card\">\n                <div class=\"benefit-number\">40%</div>\n                <div class=\"benefit-text\">Faster Mean Time<br>to Resolution</div>\n            </div>\n            <div class=\"benefit-card\">\n                <div class=\"benefit-number\">90%</div>\n                <div class=\"benefit-text\">Automated Ticket<br>Enrichment Rate</div>\n            </div>\n            <div class=\"benefit-card\">\n                <div class=\"benefit-number\">10</div>\n                <div class=\"benefit-text\">Days Implementation<br>Timeline</div>\n            </div>\n        </div>\n\n        <h3>üîÑ Complete Workflow Process</h3>\n        <div class=\"flowchart\">\n            <!-- Row 1: Trigger -->\n            <div style=\"margin: 15px 0;\">\n                <div class=\"flow-step flow-trigger\">\n                    <strong>üö® SERVER OFFLINE</strong><br>\n                    N-Central Alert<br>\n                    \"OfflineDevice Rule\"\n                </div>\n            </div>\n            \n            <div class=\"flow-arrow\">‚¨áÔ∏è</div>\n            \n            <!-- Row 2: Processing -->\n            <div style=\"margin: 15px 0;\">\n                <div class=\"flow-step flow-process\">\n                    <strong>üîç REWST WORKFLOW</strong><br>\n                    Automated Correlation<br>\n                    Multi-Source Analysis\n                </div>\n            </div>\n            \n            <div class=\"flow-arrow\">‚¨áÔ∏è</div>\n            \n            <!-- Row 3: Data Collection -->\n            <div style=\"margin: 15px 0;\">\n                <div class=\"flow-step\" style=\"background: #ecf0f1; border-color: #bdc3c7;\">\n                    <strong>N-Central</strong><br>\n                    Site Devices<br>\n                    OOB Status\n                </div>\n                \n                <div class=\"flow-step\" style=\"background: #ecf0f1; border-color: #bdc3c7;\">\n                    <strong>NMSaaS</strong><br>\n                    APs, Switches<br>\n                    Firewall, Router\n                </div>\n                \n                <div class=\"flow-step\" style=\"background: #ecf0f1; border-color: #bdc3c7;\">\n                    <strong>WAN Links</strong><br>\n                    Primary Link<br>\n                    Failover Status\n                </div>\n            </div>\n            \n            <div class=\"flow-arrow\">‚¨áÔ∏è</div>\n            \n            <!-- Row 4: Decision -->\n            <div style=\"margin: 20px 0;\">\n                <div class=\"flow-decision\">\n                    <strong>‚ö° POWER<br>STATUS<br>DECISION</strong>\n                </div>\n            </div>\n            \n            <div style=\"margin: 10px 0;\">\n                <span class=\"flow-arrow\">‚¨áÔ∏è</span>\n                <span style=\"margin: 0 80px;\"></span>\n                <span class=\"flow-arrow\">‚¨áÔ∏è</span>\n            </div>\n            \n            <!-- Row 5: Outcomes -->\n            <div style=\"margin: 15px 0;\">\n                <div class=\"flow-step flow-outcome-a\" style=\"display: inline-block; margin: 0 20px;\">\n                    <strong>üî¥ OUTCOME A</strong><br>\n                    POWER OUTAGE<br>\n                    <small>Confidence &lt;50%</small><br><br>\n                    \n                    <div style=\"font-size: 0.8em; margin-top: 8px;\">\n                        ‚Ä¢ Critical Priority<br>\n                        ‚Ä¢ Utility Engagement<br>\n                        ‚Ä¢ Proactive Customer SMS\n                    </div>\n                </div>\n                \n                <div class=\"flow-step flow-outcome-b\" style=\"display: inline-block; margin: 0 20px;\">\n                    <strong>üü¢ OUTCOME B</strong><br>\n                    DEVICE ISSUE<br>\n                    <small>Confidence ‚â•80%</small><br><br>\n                    \n                    <div style=\"font-size: 0.8em; margin-top: 8px;\">\n                        ‚Ä¢ Medium Priority<br>\n                        ‚Ä¢ Hardware Investigation<br>\n                        ‚Ä¢ Technical Update Email\n                    </div>\n                </div>\n            </div>\n            \n            <div style=\"background: #d5f4e6; padding: 10px; border-radius: 5px; margin-top: 20px; border: 2px solid #27ae60;\">\n                <strong>‚úÖ RESULT: Zero manual verification + Proactive customer communication</strong>\n            </div>\n        </div>\n\n        <h3>üìã Current vs Future State</h3>\n        <table class=\"comparison-table\">\n            <tr>\n                <th>Process</th>\n                <th>Current State ‚ùå</th>\n                <th>Future State ‚úÖ</th>\n            </tr>\n            <tr>\n                <td><strong>Power Verification</strong></td>\n                <td>Manual customer calls</td>\n                <td>Automated multi-source correlation</td>\n            </tr>\n            <tr>\n                <td><strong>Data Collection</strong></td>\n                <td>Manual NMSaaS login checks</td>\n                <td>Parallel API queries (5 seconds)</td>\n            </tr>\n            <tr>\n                <td><strong>Ticket Creation</strong></td>\n                <td>Basic alerts, no context</td>\n                <td>Enriched tickets with full analysis</td>\n            </tr>\n            <tr>\n                <td><strong>Customer Communication</strong></td>\n                <td>\"Do you have power?\"</td>\n                <td>\"We've detected a power outage\"</td>\n            </tr>\n            <tr>\n                <td><strong>Response Time</strong></td>\n                <td>15+ minutes investigation</td>\n                <td>Immediate intelligent response</td>\n            </tr>\n        </table>\n\n        <h3>üí∞ Why Rewst Changes Everything</h3>\n        <div class=\"current-problem\">\n            <h4>‚ùå Without Rewst (Original 4-Week Plan):</h4>\n            <ul>\n                <li>Custom PowerShell service development required</li>\n                <li>Manual Windows service management and maintenance</li>\n                <li>Basic error handling and single-threaded processing</li>\n                <li>Limited visibility into workflow execution</li>\n            </ul>\n        </div>\n\n        <div class=\"proposed-solution\">\n            <h4>‚úÖ With Rewst Integration (10-Day Implementation):</h4>\n            <ul>\n                <li><strong>75% faster implementation</strong> - Visual workflow builder, no coding</li>\n                <li><strong>Enterprise reliability</strong> - 99.9% uptime SLA, advanced error handling</li>\n                <li><strong>Real-time monitoring</strong> - Live dashboards, performance analytics</li>\n                <li><strong>Parallel processing</strong> - Sub-10 second correlation vs 30+ seconds</li>\n            </ul>\n        </div>\n\n        <h3>üìÖ Implementation Timeline</h3>\n        <div class=\"timeline\">\n            <div class=\"timeline-item\">\n                <div class=\"timeline-day\">1-2</div>\n                <div><strong>Foundation Setup:</strong> API validation, Rewst access, site inventory</div>\n            </div>\n            <div class=\"timeline-item\">\n                <div class=\"timeline-day\">3-6</div>\n                <div><strong>Workflow Development:</strong> Visual workflow creation, data correlation logic</div>\n            </div>\n            <div class=\"timeline-item\">\n                <div class=\"timeline-day\">7-8</div>\n                <div><strong>Testing & Validation:</strong> End-to-end testing, pilot customer validation</div>\n            </div>\n            <div class=\"timeline-item\">\n                <div class=\"timeline-day\">9-10</div>\n                <div><strong>Go-Live & Training:</strong> Production deployment, staff training</div>\n            </div>\n        </div>\n\n        <div class=\"roi-highlight\">\n            <h3 style=\"margin-top: 0;\">üéØ Strategic Impact</h3>\n            <p><strong>This transforms FTech from reactive support to proactive service delivery, establishing us as the premier MSP in the region through intelligent automation and superior customer experience.</strong></p>\n        </div>\n\n        <h3>‚ö° Technical Requirements</h3>\n        <ul>\n            <li><strong>‚úÖ Rewst Platform:</strong> Already integrated with N-Central and HaloPSA</li>\n            <li><strong>‚úÖ API Access:</strong> Existing N-Central and HaloPSA API credentials</li>\n            <li><strong>üîß NMSaaS Integration:</strong> API access validation required</li>\n            <li><strong>üìã Configuration:</strong> Alert rules, webhook setup, ticket templates</li>\n        </ul>\n\n        <div class=\"action-required\">\n            <h4>üöÄ Action Required - Management Decision</h4>\n            <p><strong>Recommendation:</strong> Proceed with immediate implementation to capitalize on Rewst's existing integration and achieve rapid ROI.</p>\n            \n            <p><strong>Next Steps:</strong></p>\n            <ul>\n                <li>Management approval to proceed</li>\n                <li>Project team assignment (Technical Lead, Platform Admins)</li>\n                <li>Pilot customer site selection</li>\n                <li>Implementation start date confirmation</li>\n            </ul>\n            \n            <p><strong>Expected Go-Live:</strong> End of August 2025</p>\n        </div>\n\n        <h3>üìä Success Metrics (30 Days Post-Implementation)</h3>\n        <ul>\n            <li><strong>Zero</strong> manual power verification customer calls</li>\n            <li><strong>90%+</strong> automated ticket enrichment rate</li>\n            <li><strong>40%</strong> reduction in mean time to resolution</li>\n            <li><strong>25%</strong> improvement in customer satisfaction scores</li>\n            <li><strong>&lt;5%</strong> false positive rate</li>\n        </ul>\n\n        <div style=\"background: linear-gradient(135deg, #3498db, #2980b9); color: white; padding: 20px; border-radius: 8px; text-align: center; margin: 25px 0;\">\n            <h4 style=\"margin-top: 0;\">üí° Bottom Line</h4>\n            <p style=\"margin-bottom: 0; font-size: 1.1em;\">\n                <strong>With Rewst already integrated, this solution delivers enterprise-grade automation in 10 days instead of 4+ weeks, transforming customer experience while reducing operational overhead.</strong>\n            </p>\n        </div>\n\n        <div class=\"signature\">\n            <p><strong>Prepared by:</strong> Senior Systems Engineer<br>\n            <strong>For:</strong> RMS - First Technology KZN<br>\n            <strong>Project Sponsor:</strong> Nishen Harichunder<br>\n            <strong>Date:</strong> August 2025</p>\n        </div>\n    </div>\n</body>\n</html>",
      "category": "Documentation",
      "tags": [],
      "created": "2025-08-06T15:03:01.306Z",
      "modified": "2025-08-06T15:04:51.949Z",
      "isPinned": false,
      "isArchived": false,
      "type": "html"
    },
    {
      "id": "note-1754479735446",
      "title": "Rewst-Enhanced Power Verification Solution<Standby checks -POWER CONFIRMATION ",
      "content": "\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Rewst-Enhanced Power Verification Solution</title>\n    <style>\n        body {\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n            line-height: 1.6;\n            color: #333;\n            max-width: 1200px;\n            margin: 0 auto;\n            padding: 20px;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            min-height: 100vh;\n        }\n        \n        .container {\n            background: white;\n            border-radius: 15px;\n            padding: 30px;\n            box-shadow: 0 20px 40px rgba(0,0,0,0.1);\n        }\n        \n        h1 {\n            color: #2c3e50;\n            text-align: center;\n            margin-bottom: 30px;\n            font-size: 2.5em;\n            background: linear-gradient(45deg, #3498db, #2ecc71);\n            -webkit-background-clip: text;\n            -webkit-text-fill-color: transparent;\n        }\n        \n        h2 {\n            color: #34495e;\n            border-bottom: 3px solid #3498db;\n            padding-bottom: 10px;\n            margin-top: 40px;\n        }\n        \n        .comparison-grid {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 30px;\n            margin: 30px 0;\n        }\n        \n        .before-box {\n            background: #fff5f5;\n            border: 2px solid #e74c3c;\n            border-radius: 10px;\n            padding: 20px;\n        }\n        \n        .after-box {\n            background: #f0fff4;\n            border: 2px solid #27ae60;\n            border-radius: 10px;\n            padding: 20px;\n        }\n        \n        .box-header {\n            font-weight: bold;\n            font-size: 1.2em;\n            margin-bottom: 15px;\n            text-align: center;\n        }\n        \n        .before-header {\n            color: #e74c3c;\n        }\n        \n        .after-header {\n            color: #27ae60;\n        }\n        \n        .workflow-section {\n            background: #f8f9fa;\n            border: 2px solid #e9ecef;\n            border-radius: 15px;\n            padding: 30px;\n            margin: 30px 0;\n        }\n        \n        .rewst-workflow {\n            background: linear-gradient(135deg, #6c5ce7, #a29bfe);\n            color: white;\n            padding: 20px;\n            border-radius: 10px;\n            margin: 20px 0;\n            text-align: center;\n        }\n        \n        .workflow-step {\n            background: white;\n            border: 1px solid #ddd;\n            border-radius: 8px;\n            padding: 15px;\n            margin: 15px 0;\n            display: flex;\n            align-items: center;\n        }\n        \n        .step-number {\n            background: #3498db;\n            color: white;\n            border-radius: 50%;\n            width: 30px;\n            height: 30px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            margin-right: 15px;\n            font-weight: bold;\n        }\n        \n        .advantage-card {\n            background: #e8f5e8;\n            border-left: 4px solid #27ae60;\n            padding: 15px;\n            margin: 15px 0;\n            border-radius: 5px;\n        }\n        \n        .implementation-table {\n            width: 100%;\n            border-collapse: collapse;\n            margin: 20px 0;\n        }\n        \n        .implementation-table th,\n        .implementation-table td {\n            border: 1px solid #ddd;\n            padding: 12px;\n            text-align: left;\n        }\n        \n        .implementation-table th {\n            background: #3498db;\n            color: white;\n        }\n        \n        .implementation-table tr:nth-child(even) {\n            background: #f2f2f2;\n        }\n        \n        .code-block {\n            background: #2d3748;\n            color: #e2e8f0;\n            padding: 20px;\n            border-radius: 8px;\n            overflow-x: auto;\n            font-family: 'Courier New', monospace;\n            margin: 15px 0;\n        }\n        \n        .highlight {\n            background: #fff3cd;\n            padding: 2px 6px;\n            border-radius: 4px;\n            font-weight: bold;\n        }\n        \n        .warning-box {\n            background: #fff3cd;\n            border: 1px solid #ffeaa7;\n            border-radius: 6px;\n            padding: 15px;\n            margin: 15px 0;\n            border-left: 4px solid #ffc107;\n        }\n        \n        .info-box {\n            background: #d1ecf1;\n            border: 1px solid #bee5eb;\n            border-radius: 6px;\n            padding: 15px;\n            margin: 15px 0;\n            border-left: 4px solid #17a2b8;\n        }\n        \n        .metric-improvement {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n            gap: 20px;\n            margin: 30px 0;\n        }\n        \n        .metric-card {\n            background: linear-gradient(135deg, #74b9ff, #0984e3);\n            color: white;\n            padding: 20px;\n            border-radius: 10px;\n            text-align: center;\n        }\n        \n        .metric-number {\n            font-size: 2em;\n            font-weight: bold;\n            margin-bottom: 5px;\n        }\n        \n        .architecture-diagram {\n            background: #f8f9fa;\n            border: 2px dashed #6c757d;\n            border-radius: 10px;\n            padding: 20px;\n            text-align: center;\n            margin: 20px 0;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>üöÄ Rewst-Enhanced Power Verification Solution</h1>\n        \n        <div class=\"info-box\">\n            <strong>üéØ Game Changer:</strong> With Rewst already integrated to N-Central and HaloPSA APIs, this solution transforms from a custom PowerShell implementation to a robust, enterprise-grade automation platform with advanced workflow capabilities, error handling, and scalability.\n        </div>\n\n        <h2>üìà How Rewst Transforms the Solution</h2>\n\n        <div class=\"comparison-grid\">\n            <div class=\"before-box\">\n                <div class=\"box-header before-header\">‚ùå Without Rewst (Original Plan)</div>\n                <ul>\n                    <li>Custom PowerShell service development</li>\n                    <li>Manual Windows service management</li>\n                    <li>Basic error handling</li>\n                    <li>Limited workflow visualization</li>\n                    <li>Monitoring via logs only</li>\n                    <li>Single-threaded processing</li>\n                    <li>4+ weeks development time</li>\n                </ul>\n            </div>\n            \n            <div class=\"after-box\">\n                <div class=\"box-header after-header\">‚úÖ With Rewst Integration</div>\n                <ul>\n                    <li>Visual workflow builder - no coding required</li>\n                    <li>Enterprise-grade automation platform</li>\n                    <li>Advanced error handling & retry logic</li>\n                    <li>Real-time workflow monitoring</li>\n                    <li>Built-in alerting and notifications</li>\n                    <li>Parallel processing capabilities</li>\n                    <li>1-2 weeks implementation time</li>\n                </ul>\n            </div>\n        </div>\n\n        <h2>üîß Rewst-Enhanced Architecture</h2>\n\n        <div class=\"architecture-diagram\">\n            <h3>Streamlined Integration Flow</h3>\n            \n            <div style=\"display: flex; justify-content: space-around; align-items: center; flex-wrap: wrap; gap: 20px; margin: 30px 0;\">\n                <div style=\"background: #3498db; color: white; padding: 15px; border-radius: 8px; min-width: 150px;\">\n                    <strong>N-Central Alert</strong><br>\n                    Device Offline<br>\n                    Webhook Trigger\n                </div>\n                \n                <div style=\"font-size: 28px; color: #e74c3c;\">‚û°Ô∏è</div>\n                \n                <div style=\"background: #6c5ce7; color: white; padding: 15px; border-radius: 8px; min-width: 150px;\">\n                    <strong>Rewst Workflow</strong><br>\n                    Automated Correlation<br>\n                    Decision Engine\n                </div>\n                \n                <div style=\"font-size: 28px; color: #e74c3c;\">‚û°Ô∏è</div>\n                \n                <div style=\"background: #27ae60; color: white; padding: 15px; border-radius: 8px; min-width: 150px;\">\n                    <strong>HaloPSA Ticket</strong><br>\n                    Enriched Context<br>\n                    Automated Priority\n                </div>\n            </div>\n        </div>\n\n        <h2>üéØ Enhanced Workflow with Rewst</h2>\n\n        <div class=\"rewst-workflow\">\n            <h3 style=\"margin-top: 0;\">‚ö° Rewst Automation Workflow</h3>\n            <p>Visual, drag-and-drop workflow builder with enterprise capabilities</p>\n        </div>\n\n        <div class=\"workflow-section\">\n            <h4 style=\"color: #2c3e50; margin-top: 0;\">Complete Rewst Workflow Steps:</h4>\n            \n            <div class=\"workflow-step\">\n                <div class=\"step-number\">1</div>\n                <div>\n                    <strong>Webhook Trigger:</strong> N-Central sends OfflineDevice alert to Rewst webhook endpoint\n                    <br><em>Advantage: Instant triggering, no polling delays</em>\n                </div>\n            </div>\n            \n            <div class=\"workflow-step\">\n                <div class=\"step-number\">2</div>\n                <div>\n                    <strong>Parallel Data Collection:</strong> Rewst simultaneously queries multiple sources\n                    <br><em>‚Ä¢ N-Central API: Site devices, OOB status, connectivity</em>\n                    <br><em>‚Ä¢ NMSaaS API: APs, switches, firewalls, routers</em>\n                    <br><em>‚Ä¢ External checks: ISP gateways, DNS servers</em>\n                </div>\n            </div>\n            \n            <div class=\"workflow-step\">\n                <div class=\"step-number\">3</div>\n                <div>\n                    <strong>Intelligent Decision Engine:</strong> Built-in logic evaluates all data points\n                    <br><em>Advantage: Visual decision trees, easy to modify thresholds</em>\n                </div>\n            </div>\n            \n            <div class=\"workflow-step\">\n                <div class=\"step-number\">4</div>\n                <div>\n                    <strong>Dynamic Ticket Creation:</strong> HaloPSA API creates contextual tickets\n                    <br><em>Advantage: Template-based, consistent formatting, automatic field population</em>\n                </div>\n            </div>\n            \n            <div class=\"workflow-step\">\n                <div class=\"step-number\">5</div>\n                <div>\n                    <strong>Multi-Channel Notifications:</strong> Customer and team communication\n                    <br><em>Advantage: Email, SMS, Teams, Slack - all configurable</em>\n                </div>\n            </div>\n            \n            <div class=\"workflow-step\">\n                <div class=\"step-number\">6</div>\n                <div>\n                    <strong>Monitoring & Reporting:</strong> Real-time workflow execution tracking\n                    <br><em>Advantage: Built-in dashboards, success/failure metrics, performance analytics</em>\n                </div>\n            </div>\n        </div>\n\n        <h2>üíé Key Advantages with Rewst</h2>\n\n        <div class=\"advantage-card\">\n            <h4>üé® Visual Workflow Builder</h4>\n            <p>No PowerShell coding required. Drag-and-drop workflow creation with visual decision trees, making it easy to modify logic and add new data sources.</p>\n        </div>\n\n        <div class=\"advantage-card\">\n            <h4>üîÑ Advanced Error Handling</h4>\n            <p>Built-in retry logic, error branching, and fallback procedures. If one API is down, workflow continues with available data sources.</p>\n        </div>\n\n        <div class=\"advantage-card\">\n            <h4>‚ö° Parallel Processing</h4>\n            <p>Simultaneous API calls reduce correlation time from 30+ seconds to under 5 seconds. Multiple site checks can run concurrently.</p>\n        </div>\n\n        <div class=\"advantage-card\">\n            <h4>üìä Real-time Monitoring</h4>\n            <p>Live workflow execution monitoring, success/failure tracking, performance metrics, and detailed audit trails for compliance.</p>\n        </div>\n\n        <div class=\"advantage-card\">\n            <h4>üîß Template Management</h4>\n            <p>Standardized ticket templates, customer communication templates, and easy customization for different customer types or SLA levels.</p>\n        </div>\n\n        <div class=\"advantage-card\">\n            <h4>üìà Scalability</h4>\n            <p>Handle hundreds of concurrent alerts, auto-scaling, and enterprise-grade reliability with built-in high availability.</p>\n        </div>\n\n        <h2>üìä Improved Metrics with Rewst</h2>\n\n        <div class=\"metric-improvement\">\n            <div class=\"metric-card\">\n                <div class=\"metric-number\">90%</div>\n                <div>Faster Implementation<br>(1-2 weeks vs 4+ weeks)</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-number\">5 sec</div>\n                <div>Correlation Time<br>(vs 30+ seconds)</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-number\">99.9%</div>\n                <div>Reliability<br>Enterprise Platform</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-number\">100%</div>\n                <div>Workflow Visibility<br>Real-time Monitoring</div>\n            </div>\n        </div>\n\n        <h2>üõ†Ô∏è Implementation Comparison</h2>\n\n        <table class=\"implementation-table\">\n            <tr>\n                <th>Aspect</th>\n                <th>PowerShell Solution</th>\n                <th>Rewst Solution</th>\n                <th>Improvement</th>\n            </tr>\n            <tr>\n                <td><strong>Development Time</strong></td>\n                <td>4+ weeks coding</td>\n                <td>1-2 weeks configuration</td>\n                <td>75% time reduction</td>\n            </tr>\n            <tr>\n                <td><strong>Error Handling</strong></td>\n                <td>Basic try/catch</td>\n                <td>Enterprise-grade retry/fallback</td>\n                <td>Robust failure recovery</td>\n            </tr>\n            <tr>\n                <td><strong>Monitoring</strong></td>\n                <td>Log file analysis</td>\n                <td>Real-time dashboards</td>\n                <td>Live visibility</td>\n            </tr>\n            <tr>\n                <td><strong>Scalability</strong></td>\n                <td>Single-threaded processing</td>\n                <td>Parallel multi-threading</td>\n                <td>10x performance improvement</td>\n            </tr>\n            <tr>\n                <td><strong>Maintenance</strong></td>\n                <td>Code updates required</td>\n                <td>Visual workflow updates</td>\n                <td>No technical skills needed</td>\n            </tr>\n            <tr>\n                <td><strong>Reliability</strong></td>\n                <td>Custom service dependency</td>\n                <td>Enterprise platform SLA</td>\n                <td>99.9% uptime guarantee</td>\n            </tr>\n        </table>\n\n        <h2>üîß Rewst Workflow Configuration</h2>\n\n        <div class=\"code-block\">\n# Rewst Workflow Components (Visual Configuration, No Coding Required)\n\n## Trigger Configuration\n- Webhook URL: https://rewst.ftechkzn.co.za/webhooks/power-verification\n- Source: N-Central OfflineDevice alerts\n- Authentication: API key validation\n\n## Data Collection (Parallel Actions)\nAction 1: N-Central Site Query\n  ‚îú‚îÄ‚îÄ Get site devices status\n  ‚îú‚îÄ‚îÄ Check OOB device connectivity  \n  ‚îî‚îÄ‚îÄ Verify other servers online\n\nAction 2: NMSaaS Network Check\n  ‚îú‚îÄ‚îÄ Query AP status\n  ‚îú‚îÄ‚îÄ Check switch connectivity\n  ‚îú‚îÄ‚îÄ Validate firewall status\n  ‚îî‚îÄ‚îÄ Test router reachability\n\nAction 3: External Validation\n  ‚îú‚îÄ‚îÄ ISP gateway ping\n  ‚îú‚îÄ‚îÄ DNS resolution tests\n  ‚îî‚îÄ‚îÄ Cloud service connectivity\n\n## Decision Engine (Visual Logic Tree)\nIF (Confidence Score >= 80):\n  ‚îî‚îÄ‚îÄ Branch to \"Device Issue\" workflow\nELSE IF (Confidence Score < 50):\n  ‚îî‚îÄ‚îÄ Branch to \"Power Outage\" workflow  \nELSE:\n  ‚îî‚îÄ‚îÄ Branch to \"Manual Review\" workflow\n\n## Output Actions\n- HaloPSA ticket creation with templates\n- Customer notification (email/SMS)\n- Team alert (Slack/Teams)\n- Dashboard metric updates\n        </div>\n\n        <h2>üéØ Enhanced Business Benefits</h2>\n\n        <div class=\"info-box\">\n            <h4>üí∞ Additional ROI with Rewst:</h4>\n            <ul>\n                <li><strong>Faster Time to Market:</strong> 75% reduction in development time</li>\n                <li><strong>Reduced Technical Debt:</strong> No custom code to maintain</li>\n                <li><strong>Enhanced Reliability:</strong> Enterprise-grade platform with SLA</li>\n                <li><strong>Future Extensibility:</strong> Easy to add new integrations and workflows</li>\n                <li><strong>Compliance Ready:</strong> Built-in audit trails and reporting</li>\n                <li><strong>Team Efficiency:</strong> Non-technical staff can modify workflows</li>\n            </ul>\n        </div>\n\n        <h2>üöÄ Recommended Implementation Strategy</h2>\n\n        <div class=\"workflow-section\">\n            <h4>Week 1: Rewst Workflow Design</h4>\n            <ul>\n                <li>Configure N-Central webhook triggers</li>\n                <li>Design visual workflow in Rewst platform</li>\n                <li>Set up parallel data collection actions</li>\n                <li>Create decision logic and confidence scoring</li>\n            </ul>\n            \n            <h4>Week 2: Integration & Testing</h4>\n            <ul>\n                <li>Connect HaloPSA ticket creation templates</li>\n                <li>Configure customer notification channels</li>\n                <li>Set up monitoring dashboards</li>\n                <li>Pilot test with selected customer sites</li>\n            </ul>\n        </div>\n\n        <div class=\"warning-box\">\n            <h4>‚ö° Strategic Recommendation:</h4>\n            <p><strong>Leverage Rewst immediately!</strong> Since APIs are already integrated, you can build this solution 75% faster with enterprise-grade reliability, visual workflows, and real-time monitoring. This transforms the project from a development effort to a configuration task, dramatically reducing risk and time to value.</p>\n        </div>\n\n        <div style=\"background: linear-gradient(135deg, #2ecc71, #27ae60); color: white; padding: 25px; border-radius: 10px; text-align: center; margin: 30px 0;\">\n            <h3 style=\"margin-top: 0;\">üéØ Bottom Line Impact</h3>\n            <p style=\"font-size: 1.1em; margin-bottom: 0;\">\n                With Rewst, this solution goes from a \"4-week development project\" to a \"1-2 week configuration task\" with enterprise-grade capabilities, dramatically improving ROI and reducing implementation risk.\n            </p>\n        </div>\n    </div>\n</body>\n</html>",
      "category": "Development",
      "tags": [],
      "created": "2025-08-06T11:28:55.446Z",
      "modified": "2025-08-06T11:31:27.967Z",
      "isPinned": false,
      "isArchived": false,
      "type": "html"
    },
    {
      "id": "note-1",
      "title": "PowerShell Best Practices",
      "content": "# PowerShell Best Practices for System Administration\n\n## Key Guidelines:\n- Always use approved verbs (Get-, Set-, New-, Remove-)\n- Use proper error handling with try/catch blocks\n- Implement parameter validation\n- Use Write-Output instead of Write-Host for data\n- Always test scripts in development environment first\n\n## Security Considerations:\n- Use execution policies appropriately\n- Avoid hardcoded credentials\n- Implement proper logging\n- Use constrained endpoints when possible\n\n## Performance Tips:\n- Use pipeline efficiently\n- Avoid unnecessary object creation\n- Filter left, format right\n- Use specific property selection",
      "category": "System Admin",
      "tags": [
        "powershell",
        "best-practices",
        "security"
      ],
      "created": "2025-06-15T00:00:00.000Z",
      "modified": "2025-06-30T00:00:00.000Z",
      "isPinned": true,
      "isArchived": false,
      "type": "markdown"
    },
    {
      "id": "note-2",
      "title": "Next.js 14 Project Setup",
      "content": "# Next.js 14 Project Setup Notes\n\n## Installation:\n```bash\nnpx create-next-app@latest my-app\ncd my-app\nnpm run dev\n```\n\n## Key Features in v14:\n- App Router (stable)\n- Server Components by default\n- Improved TypeScript support\n- Turbopack (beta)\n\n## Essential Dependencies:\n- tailwindcss\n- @types/node\n- lucide-react for icons\n\n## Configuration Tips:\n- Use exact versions to avoid compatibility issues\n- Configure tailwind.config.ts for custom colors\n- Set up proper ESLint rules",
      "category": "Development",
      "tags": [
        "nextjs",
        "react",
        "setup"
      ],
      "created": "2025-06-20T00:00:00.000Z",
      "modified": "2025-06-28T00:00:00.000Z",
      "isPinned": false,
      "isArchived": false,
      "type": "markdown"
    },
    {
      "id": "note-3",
      "title": "Workspace Color Scheme",
      "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Nishen's AI Workspace Color Palette</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            margin: 0;\n            padding: 20px;\n            background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);\n            color: white;\n            min-height: 100vh;\n        }\n        .container {\n            max-width: 800px;\n            margin: 0 auto;\n            background: rgba(255, 255, 255, 0.1);\n            padding: 30px;\n            border-radius: 15px;\n            backdrop-filter: blur(10px);\n        }\n        .color-swatch {\n            display: flex;\n            align-items: center;\n            margin: 10px 0;\n            padding: 10px;\n            border-radius: 8px;\n            background: rgba(255, 255, 255, 0.1);\n        }\n        .color-box {\n            width: 50px;\n            height: 50px;\n            border-radius: 8px;\n            margin-right: 15px;\n            border: 2px solid rgba(255, 255, 255, 0.3);\n        }\n        .neon-red { background: #ff073a; }\n        .burnt-orange { background: #cc5500; }\n        .british-silver { background: #8B9499; }\n        .neon-green { background: #00CC33; }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>üé® Nishen's AI Workspace Color Palette</h1>\n        \n        <div class=\"color-swatch\">\n            <div class=\"color-box neon-red\"></div>\n            <div>\n                <strong>Neon Red</strong> - #ff073a<br>\n                <small>Primary actions, highlights, active states</small>\n            </div>\n        </div>\n        \n        <div class=\"color-swatch\">\n            <div class=\"color-box burnt-orange\"></div>\n            <div>\n                <strong>Burnt Orange</strong> - #cc5500<br>\n                <small>Secondary actions, accents, hover states</small>\n            </div>\n        </div>\n        \n        <div class=\"color-swatch\">\n            <div class=\"color-box british-silver\"></div>\n            <div>\n                <strong>British Silver</strong> - #8B9499<br>\n                <small>Professional silver theme, neutral accents</small>\n            </div>\n        </div>\n        \n        <div class=\"color-swatch\">\n            <div class=\"color-box neon-green\"></div>\n            <div>\n                <strong>Neon Green</strong> - #00CC33<br>\n                <small>Success states, accent green theme</small>\n            </div>\n        </div>\n        \n        <h2>üéØ Usage Guidelines</h2>\n        <ul>\n            <li>Use neon red for primary CTAs and active states</li>\n            <li>Burnt orange for secondary actions and hover states</li>\n            <li>Gray scale for text hierarchy</li>\n            <li>Maintain WCAG contrast ratios</li>\n        </ul>\n    </div>\n</body>\n</html>",
      "category": "Documentation",
      "tags": [
        "design",
        "colors",
        "branding"
      ],
      "created": "2025-06-25T00:00:00.000Z",
      "modified": "2025-06-25T00:00:00.000Z",
      "isPinned": false,
      "isArchived": false,
      "type": "html"
    },
    {
      "id": "note-4",
      "title": "Nishen's Skills Development and Knowledge Gained on the Job and in R&D",
      "content": "# Nishen's Skills Development and Knowledge Gained on the Job and in R&D\n\n## Project Portfolio & Technical Skills\n\n### üöÄ Nishen's AI Workspace (July 2025 - Ongoing)\n**Status**: Production Ready | **Time Invested**: 17.5+ hours | **Category**: Full-Stack Web/Desktop Application\n\n#### Technologies Mastered:\n- **Frontend**: React 18.2.0, Next.js 14.2.5, TypeScript, Tailwind CSS\n- **Desktop**: Electron (cross-platform Windows/macOS/Linux)\n- **State Management**: React Context API, localStorage persistence\n- **UI/UX**: Dynamic theming system, responsive design, accessibility (WCAG)\n- **Build Tools**: npm, webpack, electron-builder\n- **Development**: VS Code, ESLint, Hot reload, TypeScript strict mode\n\n#### Architecture Patterns Learned:\n- **Single-page workspace architecture** with state-based routing\n- **Component composition** with conditional rendering\n- **CSS custom properties** for dynamic theming\n- **Hydration-safe rendering** for SSR/CSR compatibility\n- **Systematic error handling** and dependency management\n- **Minimal dependency approach** for stability\n- **Production build optimization** and static export configuration\n\n#### Advanced Features Implemented:\n- **Real-time settings system** with 6 configuration categories\n- **Multi-format file preview** (HTML/Markdown rendering)\n- **Terminal simulation** with command history and Claude integration\n- **Note-taking system** with categories, search, tags, pin/unpin functionality\n- **Professional prompt engineering database** with usage tracking\n- **20+ system administration tools** with monitoring simulation\n- **Cross-platform desktop packaging** with native menu integration\n\n#### Key Problem-Solving Skills Developed:\n- **Systematic debugging methodology** using scanning approaches\n- **Production deployment troubleshooting** (Electron static export issues)\n- **TypeScript error resolution** with proper type casting\n- **CSS architecture design** for maintainable theming systems\n- **Performance optimization** for smooth user experience\n- **Version control management** with meaningful commit messages\n\n### üõ†Ô∏è Development Environment Expertise\n\n#### Platforms Mastered:\n- **Ubuntu Linux** (WSL2 on Windows) - Primary development environment\n- **Windows PowerShell** - Cross-platform scripting and terminal management\n- **VS Code** - Advanced configuration, extensions, integrated terminal usage\n- **Git** - Version control, branching strategies, commit message standards\n\n#### Command Line Proficiency:\n- **Node.js/npm** - Package management, script automation, dependency resolution\n- **Bash/PowerShell** - File system operations, process management, environment setup\n- **Build tools** - npm scripts, webpack configuration, production optimization\n- **System administration** - Process monitoring, resource management, troubleshooting\n\n### üìä Technical Documentation & Project Management\n\n#### Skills Developed:\n- **Comprehensive time tracking** with detailed session logs\n- **Technical documentation** writing (README files, API docs, user guides)\n- **Project planning** with phase-based development approaches\n- **Code review methodologies** and systematic testing approaches\n- **Backup and recovery procedures** with versioned snapshots\n- **Performance monitoring** and resource optimization\n\n#### Professional Development Practices:\n- **Agile methodology** application in solo development\n- **Test-driven development** mindset for reliability\n- **Security-first approach** in authentication and data handling\n- **User experience design** with accessibility considerations\n- **Cross-browser compatibility** testing and optimization\n\n### üéØ Current Expertise Level Assessment\n\n#### Advanced Skills:\n- React/Next.js full-stack development\n- TypeScript advanced type system usage\n- Electron desktop application development\n- CSS architecture and dynamic theming\n- Component-based UI design patterns\n\n#### Intermediate Skills:\n- System administration and monitoring\n- Build tool configuration and optimization\n- Cross-platform development considerations\n- Performance profiling and optimization\n- API design and integration patterns\n\n#### Growing Skills:\n- Advanced Node.js backend development\n- Database design and management\n- DevOps and CI/CD pipeline setup\n- Cloud deployment and scaling\n- Advanced security implementation\n\n### üìà Learning & Development Goals\n\n#### Short-term (Next 30 days):\n- Real Claude AI API integration with streaming responses\n- Advanced terminal emulation with multiple shell support\n- File system integration for real file operations\n- Performance optimization and memory management\n\n#### Medium-term (Next 90 days):\n- Backend API development with authentication\n- Database integration (PostgreSQL/MongoDB)\n- Real-time collaboration features\n- Advanced DevOps and deployment automation\n\n#### Long-term (Next 6 months):\n- Cloud-native architecture design\n- Microservices development patterns\n- Advanced security and compliance implementation\n- Team leadership and code review processes\n\n---\n\n**Last Updated**: July 12, 2025  \n**Auto-Update Schedule**: Every 2 days  \n**Total Projects Completed**: 1 major (Nishen's AI Workspace)  \n**Total Development Hours**: 17.5+ hours  \n**Current Focus**: Real-time features and Claude AI integration",
      "category": "Personal",
      "tags": [
        "skills",
        "development",
        "career",
        "projects",
        "learning"
      ],
      "created": "2025-07-12T00:00:00.000Z",
      "modified": "2025-07-12T00:00:00.000Z",
      "isPinned": true,
      "isArchived": false,
      "type": "markdown"
    }
  ],
  "nishen-workspace-prod_CHANGELOG": [
    {
      "timestamp": "2025-09-29T01:05:08.132Z",
      "operation": "INIT",
      "beforeData": null,
      "afterData": null,
      "component": "PROD"
    },
    {
      "timestamp": "2025-09-29T01:05:08.135Z",
      "operation": "USER_SAVE",
      "beforeData": [
        {
          "id": "proj-1",
          "name": "Production RMS Tools",
          "description": "Live production system administration tools and scripts",
          "files": [
            {
              "id": "file-1",
              "name": "live-monitor.ps1",
              "type": "script",
              "category": "Monitoring",
              "content": "# Production Live Monitor Script\n# Author: Nishen Harichunder\n# WARNING: This script runs in production environment\n\nParam(\n    [string]$Environment = \"PRODUCTION\",\n    [switch]$AlertMode = $true\n)\n\nWrite-Host \"Starting production monitor for environment: $Environment\" -ForegroundColor Red\n\n# Production monitoring logic here\nif ($AlertMode) {\n    Write-Host \"ALERT MODE ENABLED - Will send notifications on issues\" -ForegroundColor Yellow\n}\n\n# Add your production monitoring logic here",
              "versions": [],
              "created": "2025-05-01T00:00:00.000Z",
              "modified": "2025-07-08T00:00:00.000Z",
              "timeSpent": 14400
            },
            {
              "id": "file-2",
              "name": "prod-status-dashboard.html",
              "type": "html",
              "category": "Dashboard",
              "content": "<!DOCTYPE html>\n<html>\n<head>\n    <title>Production Status Dashboard</title>\n    <style>\n        body { font-family: Arial, sans-serif; background: #000; color: #fff; }\n        .header { background: #ff073a; color: white; padding: 20px; text-align: center; }\n        .status-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; padding: 20px; }\n        .status-card { background: #1a1a1a; border: 1px solid #333; border-radius: 8px; padding: 20px; }\n        .status-green { border-left: 4px solid #00ff00; }\n        .status-red { border-left: 4px solid #ff0000; }\n        .status-yellow { border-left: 4px solid #ffff00; }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <h1>üöÄ Production Status Dashboard</h1>\n        <p>Live system monitoring for RMS Production Environment</p>\n    </div>\n    <div class=\"status-grid\">\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Web Services</h3>\n            <p>All services operational</p>\n            <small>Last check: 2 minutes ago</small>\n        </div>\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Database</h3>\n            <p>Performance optimal</p>\n            <small>Response time: 45ms</small>\n        </div>\n        <div class=\"status-card status-yellow\">\n            <h3>‚ö†Ô∏è Storage</h3>\n            <p>85% capacity used</p>\n            <small>Monitoring closely</small>\n        </div>\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Security</h3>\n            <p>No threats detected</p>\n            <small>Last scan: 1 hour ago</small>\n        </div>\n    </div>\n</body>\n</html>",
              "versions": [],
              "created": "2025-05-15T00:00:00.000Z",
              "modified": "2025-07-08T00:00:00.000Z",
              "timeSpent": 7200
            }
          ],
          "totalTimeSpent": 21600,
          "created": "2025-05-01T00:00:00.000Z",
          "isTimerRunning": false
        },
        {
          "id": "proj-1754641340163",
          "name": "RMS Security Assessments Scripts & Reports",
          "description": "Collection of Scripts in Production",
          "files": [
            {
              "id": "file-1754641865329",
              "name": "Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1",
              "type": "script",
              "category": "Security, Assessment, AD, PAssword",
              "content": "# Production PowerShell Script\n# Created in Nishen's AI Workspace - PRODUCTION ENVIRONMENT\n# File: Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1\n# WARNING: This script will run in production - use extreme caution\n\nparam(\n    [string]$Environment = \"PRODUCTION\",\n    [switch]$DryRun = $false\n)\n\n# Production safety check\nif ($Environment -eq \"PRODUCTION\" -and -not $DryRun) {\n    Write-Host \"‚ö†Ô∏è  PRODUCTION MODE ENABLED - This will affect live systems!\" -ForegroundColor Red\n    $confirm = Read-Host \"Are you sure you want to continue? (yes/no)\"\n    if ($confirm -ne \"yes\") {\n        Write-Host \"Operation cancelled.\" -ForegroundColor Yellow\n        exit 0\n    }\n}\n\nWrite-Host \"Starting production script: Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1\" -ForegroundColor Green\n\ntry {\n    # Add your production script logic here\n    Write-Host \"Production script execution completed successfully!\" -ForegroundColor Green\n}\ncatch {\n    Write-Error \"Production script failed: $_\"\n    # Add production error handling/alerting here\n    exit 1\n}",
              "versions": [],
              "created": "2025-08-08T08:31:05.329Z",
              "modified": "2025-08-08T08:31:05.329Z",
              "timeSpent": 0
            }
          ],
          "totalTimeSpent": 0,
          "created": "2025-08-08T08:22:20.163Z",
          "isTimerRunning": false
        }
      ],
      "afterData": [
        {
          "id": "proj-1",
          "name": "Production RMS Tools",
          "description": "Live production system administration tools and scripts",
          "files": [
            {
              "id": "file-1",
              "name": "live-monitor.ps1",
              "type": "script",
              "category": "Monitoring",
              "content": "# Production Live Monitor Script\n# Author: Nishen Harichunder\n# WARNING: This script runs in production environment\n\nParam(\n    [string]$Environment = \"PRODUCTION\",\n    [switch]$AlertMode = $true\n)\n\nWrite-Host \"Starting production monitor for environment: $Environment\" -ForegroundColor Red\n\n# Production monitoring logic here\nif ($AlertMode) {\n    Write-Host \"ALERT MODE ENABLED - Will send notifications on issues\" -ForegroundColor Yellow\n}\n\n# Add your production monitoring logic here",
              "versions": [],
              "created": "2025-05-01T00:00:00.000Z",
              "modified": "2025-07-08T00:00:00.000Z",
              "timeSpent": 14400
            },
            {
              "id": "file-2",
              "name": "prod-status-dashboard.html",
              "type": "html",
              "category": "Dashboard",
              "content": "<!DOCTYPE html>\n<html>\n<head>\n    <title>Production Status Dashboard</title>\n    <style>\n        body { font-family: Arial, sans-serif; background: #000; color: #fff; }\n        .header { background: #ff073a; color: white; padding: 20px; text-align: center; }\n        .status-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; padding: 20px; }\n        .status-card { background: #1a1a1a; border: 1px solid #333; border-radius: 8px; padding: 20px; }\n        .status-green { border-left: 4px solid #00ff00; }\n        .status-red { border-left: 4px solid #ff0000; }\n        .status-yellow { border-left: 4px solid #ffff00; }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <h1>üöÄ Production Status Dashboard</h1>\n        <p>Live system monitoring for RMS Production Environment</p>\n    </div>\n    <div class=\"status-grid\">\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Web Services</h3>\n            <p>All services operational</p>\n            <small>Last check: 2 minutes ago</small>\n        </div>\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Database</h3>\n            <p>Performance optimal</p>\n            <small>Response time: 45ms</small>\n        </div>\n        <div class=\"status-card status-yellow\">\n            <h3>‚ö†Ô∏è Storage</h3>\n            <p>85% capacity used</p>\n            <small>Monitoring closely</small>\n        </div>\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Security</h3>\n            <p>No threats detected</p>\n            <small>Last scan: 1 hour ago</small>\n        </div>\n    </div>\n</body>\n</html>",
              "versions": [],
              "created": "2025-05-15T00:00:00.000Z",
              "modified": "2025-07-08T00:00:00.000Z",
              "timeSpent": 7200
            }
          ],
          "totalTimeSpent": 21600,
          "created": "2025-05-01T00:00:00.000Z",
          "isTimerRunning": false
        },
        {
          "id": "proj-1754641340163",
          "name": "RMS Security Assessments Scripts & Reports",
          "description": "Collection of Scripts in Production",
          "files": [
            {
              "id": "file-1754641865329",
              "name": "Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1",
              "type": "script",
              "category": "Security, Assessment, AD, PAssword",
              "content": "# Production PowerShell Script\n# Created in Nishen's AI Workspace - PRODUCTION ENVIRONMENT\n# File: Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1\n# WARNING: This script will run in production - use extreme caution\n\nparam(\n    [string]$Environment = \"PRODUCTION\",\n    [switch]$DryRun = $false\n)\n\n# Production safety check\nif ($Environment -eq \"PRODUCTION\" -and -not $DryRun) {\n    Write-Host \"‚ö†Ô∏è  PRODUCTION MODE ENABLED - This will affect live systems!\" -ForegroundColor Red\n    $confirm = Read-Host \"Are you sure you want to continue? (yes/no)\"\n    if ($confirm -ne \"yes\") {\n        Write-Host \"Operation cancelled.\" -ForegroundColor Yellow\n        exit 0\n    }\n}\n\nWrite-Host \"Starting production script: Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1\" -ForegroundColor Green\n\ntry {\n    # Add your production script logic here\n    Write-Host \"Production script execution completed successfully!\" -ForegroundColor Green\n}\ncatch {\n    Write-Error \"Production script failed: $_\"\n    # Add production error handling/alerting here\n    exit 1\n}",
              "versions": [],
              "created": "2025-08-08T08:31:05.329Z",
              "modified": "2025-08-08T08:31:05.329Z",
              "timeSpent": 0
            }
          ],
          "totalTimeSpent": 0,
          "created": "2025-08-08T08:22:20.163Z",
          "isTimerRunning": false
        }
      ],
      "component": "PROD"
    },
    {
      "timestamp": "2025-09-29T01:05:38.134Z",
      "operation": "AUTO_SAVE",
      "beforeData": [
        {
          "id": "proj-1",
          "name": "Production RMS Tools",
          "description": "Live production system administration tools and scripts",
          "files": [
            {
              "id": "file-1",
              "name": "live-monitor.ps1",
              "type": "script",
              "category": "Monitoring",
              "content": "# Production Live Monitor Script\n# Author: Nishen Harichunder\n# WARNING: This script runs in production environment\n\nParam(\n    [string]$Environment = \"PRODUCTION\",\n    [switch]$AlertMode = $true\n)\n\nWrite-Host \"Starting production monitor for environment: $Environment\" -ForegroundColor Red\n\n# Production monitoring logic here\nif ($AlertMode) {\n    Write-Host \"ALERT MODE ENABLED - Will send notifications on issues\" -ForegroundColor Yellow\n}\n\n# Add your production monitoring logic here",
              "versions": [],
              "created": "2025-05-01T00:00:00.000Z",
              "modified": "2025-07-08T00:00:00.000Z",
              "timeSpent": 14400
            },
            {
              "id": "file-2",
              "name": "prod-status-dashboard.html",
              "type": "html",
              "category": "Dashboard",
              "content": "<!DOCTYPE html>\n<html>\n<head>\n    <title>Production Status Dashboard</title>\n    <style>\n        body { font-family: Arial, sans-serif; background: #000; color: #fff; }\n        .header { background: #ff073a; color: white; padding: 20px; text-align: center; }\n        .status-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; padding: 20px; }\n        .status-card { background: #1a1a1a; border: 1px solid #333; border-radius: 8px; padding: 20px; }\n        .status-green { border-left: 4px solid #00ff00; }\n        .status-red { border-left: 4px solid #ff0000; }\n        .status-yellow { border-left: 4px solid #ffff00; }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <h1>üöÄ Production Status Dashboard</h1>\n        <p>Live system monitoring for RMS Production Environment</p>\n    </div>\n    <div class=\"status-grid\">\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Web Services</h3>\n            <p>All services operational</p>\n            <small>Last check: 2 minutes ago</small>\n        </div>\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Database</h3>\n            <p>Performance optimal</p>\n            <small>Response time: 45ms</small>\n        </div>\n        <div class=\"status-card status-yellow\">\n            <h3>‚ö†Ô∏è Storage</h3>\n            <p>85% capacity used</p>\n            <small>Monitoring closely</small>\n        </div>\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Security</h3>\n            <p>No threats detected</p>\n            <small>Last scan: 1 hour ago</small>\n        </div>\n    </div>\n</body>\n</html>",
              "versions": [],
              "created": "2025-05-15T00:00:00.000Z",
              "modified": "2025-07-08T00:00:00.000Z",
              "timeSpent": 7200
            }
          ],
          "totalTimeSpent": 21600,
          "created": "2025-05-01T00:00:00.000Z",
          "isTimerRunning": false
        },
        {
          "id": "proj-1754641340163",
          "name": "RMS Security Assessments Scripts & Reports",
          "description": "Collection of Scripts in Production",
          "files": [
            {
              "id": "file-1754641865329",
              "name": "Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1",
              "type": "script",
              "category": "Security, Assessment, AD, PAssword",
              "content": "# Production PowerShell Script\n# Created in Nishen's AI Workspace - PRODUCTION ENVIRONMENT\n# File: Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1\n# WARNING: This script will run in production - use extreme caution\n\nparam(\n    [string]$Environment = \"PRODUCTION\",\n    [switch]$DryRun = $false\n)\n\n# Production safety check\nif ($Environment -eq \"PRODUCTION\" -and -not $DryRun) {\n    Write-Host \"‚ö†Ô∏è  PRODUCTION MODE ENABLED - This will affect live systems!\" -ForegroundColor Red\n    $confirm = Read-Host \"Are you sure you want to continue? (yes/no)\"\n    if ($confirm -ne \"yes\") {\n        Write-Host \"Operation cancelled.\" -ForegroundColor Yellow\n        exit 0\n    }\n}\n\nWrite-Host \"Starting production script: Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1\" -ForegroundColor Green\n\ntry {\n    # Add your production script logic here\n    Write-Host \"Production script execution completed successfully!\" -ForegroundColor Green\n}\ncatch {\n    Write-Error \"Production script failed: $_\"\n    # Add production error handling/alerting here\n    exit 1\n}",
              "versions": [],
              "created": "2025-08-08T08:31:05.329Z",
              "modified": "2025-08-08T08:31:05.329Z",
              "timeSpent": 0
            }
          ],
          "totalTimeSpent": 0,
          "created": "2025-08-08T08:22:20.163Z",
          "isTimerRunning": false
        }
      ],
      "afterData": [
        {
          "id": "proj-1",
          "name": "Production RMS Tools",
          "description": "Live production system administration tools and scripts",
          "files": [
            {
              "id": "file-1",
              "name": "live-monitor.ps1",
              "type": "script",
              "category": "Monitoring",
              "content": "# Production Live Monitor Script\n# Author: Nishen Harichunder\n# WARNING: This script runs in production environment\n\nParam(\n    [string]$Environment = \"PRODUCTION\",\n    [switch]$AlertMode = $true\n)\n\nWrite-Host \"Starting production monitor for environment: $Environment\" -ForegroundColor Red\n\n# Production monitoring logic here\nif ($AlertMode) {\n    Write-Host \"ALERT MODE ENABLED - Will send notifications on issues\" -ForegroundColor Yellow\n}\n\n# Add your production monitoring logic here",
              "versions": [],
              "created": "2025-05-01T00:00:00.000Z",
              "modified": "2025-07-08T00:00:00.000Z",
              "timeSpent": 14400
            },
            {
              "id": "file-2",
              "name": "prod-status-dashboard.html",
              "type": "html",
              "category": "Dashboard",
              "content": "<!DOCTYPE html>\n<html>\n<head>\n    <title>Production Status Dashboard</title>\n    <style>\n        body { font-family: Arial, sans-serif; background: #000; color: #fff; }\n        .header { background: #ff073a; color: white; padding: 20px; text-align: center; }\n        .status-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; padding: 20px; }\n        .status-card { background: #1a1a1a; border: 1px solid #333; border-radius: 8px; padding: 20px; }\n        .status-green { border-left: 4px solid #00ff00; }\n        .status-red { border-left: 4px solid #ff0000; }\n        .status-yellow { border-left: 4px solid #ffff00; }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <h1>üöÄ Production Status Dashboard</h1>\n        <p>Live system monitoring for RMS Production Environment</p>\n    </div>\n    <div class=\"status-grid\">\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Web Services</h3>\n            <p>All services operational</p>\n            <small>Last check: 2 minutes ago</small>\n        </div>\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Database</h3>\n            <p>Performance optimal</p>\n            <small>Response time: 45ms</small>\n        </div>\n        <div class=\"status-card status-yellow\">\n            <h3>‚ö†Ô∏è Storage</h3>\n            <p>85% capacity used</p>\n            <small>Monitoring closely</small>\n        </div>\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Security</h3>\n            <p>No threats detected</p>\n            <small>Last scan: 1 hour ago</small>\n        </div>\n    </div>\n</body>\n</html>",
              "versions": [],
              "created": "2025-05-15T00:00:00.000Z",
              "modified": "2025-07-08T00:00:00.000Z",
              "timeSpent": 7200
            }
          ],
          "totalTimeSpent": 21600,
          "created": "2025-05-01T00:00:00.000Z",
          "isTimerRunning": false
        },
        {
          "id": "proj-1754641340163",
          "name": "RMS Security Assessments Scripts & Reports",
          "description": "Collection of Scripts in Production",
          "files": [
            {
              "id": "file-1754641865329",
              "name": "Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1",
              "type": "script",
              "category": "Security, Assessment, AD, PAssword",
              "content": "# Production PowerShell Script\n# Created in Nishen's AI Workspace - PRODUCTION ENVIRONMENT\n# File: Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1\n# WARNING: This script will run in production - use extreme caution\n\nparam(\n    [string]$Environment = \"PRODUCTION\",\n    [switch]$DryRun = $false\n)\n\n# Production safety check\nif ($Environment -eq \"PRODUCTION\" -and -not $DryRun) {\n    Write-Host \"‚ö†Ô∏è  PRODUCTION MODE ENABLED - This will affect live systems!\" -ForegroundColor Red\n    $confirm = Read-Host \"Are you sure you want to continue? (yes/no)\"\n    if ($confirm -ne \"yes\") {\n        Write-Host \"Operation cancelled.\" -ForegroundColor Yellow\n        exit 0\n    }\n}\n\nWrite-Host \"Starting production script: Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1\" -ForegroundColor Green\n\ntry {\n    # Add your production script logic here\n    Write-Host \"Production script execution completed successfully!\" -ForegroundColor Green\n}\ncatch {\n    Write-Error \"Production script failed: $_\"\n    # Add production error handling/alerting here\n    exit 1\n}",
              "versions": [],
              "created": "2025-08-08T08:31:05.329Z",
              "modified": "2025-08-08T08:31:05.329Z",
              "timeSpent": 0
            }
          ],
          "totalTimeSpent": 0,
          "created": "2025-08-08T08:22:20.163Z",
          "isTimerRunning": false
        }
      ],
      "component": "PROD"
    },
    {
      "timestamp": "2025-09-29T01:06:08.136Z",
      "operation": "AUTO_SAVE",
      "beforeData": [
        {
          "id": "proj-1",
          "name": "Production RMS Tools",
          "description": "Live production system administration tools and scripts",
          "files": [
            {
              "id": "file-1",
              "name": "live-monitor.ps1",
              "type": "script",
              "category": "Monitoring",
              "content": "# Production Live Monitor Script\n# Author: Nishen Harichunder\n# WARNING: This script runs in production environment\n\nParam(\n    [string]$Environment = \"PRODUCTION\",\n    [switch]$AlertMode = $true\n)\n\nWrite-Host \"Starting production monitor for environment: $Environment\" -ForegroundColor Red\n\n# Production monitoring logic here\nif ($AlertMode) {\n    Write-Host \"ALERT MODE ENABLED - Will send notifications on issues\" -ForegroundColor Yellow\n}\n\n# Add your production monitoring logic here",
              "versions": [],
              "created": "2025-05-01T00:00:00.000Z",
              "modified": "2025-07-08T00:00:00.000Z",
              "timeSpent": 14400
            },
            {
              "id": "file-2",
              "name": "prod-status-dashboard.html",
              "type": "html",
              "category": "Dashboard",
              "content": "<!DOCTYPE html>\n<html>\n<head>\n    <title>Production Status Dashboard</title>\n    <style>\n        body { font-family: Arial, sans-serif; background: #000; color: #fff; }\n        .header { background: #ff073a; color: white; padding: 20px; text-align: center; }\n        .status-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; padding: 20px; }\n        .status-card { background: #1a1a1a; border: 1px solid #333; border-radius: 8px; padding: 20px; }\n        .status-green { border-left: 4px solid #00ff00; }\n        .status-red { border-left: 4px solid #ff0000; }\n        .status-yellow { border-left: 4px solid #ffff00; }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <h1>üöÄ Production Status Dashboard</h1>\n        <p>Live system monitoring for RMS Production Environment</p>\n    </div>\n    <div class=\"status-grid\">\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Web Services</h3>\n            <p>All services operational</p>\n            <small>Last check: 2 minutes ago</small>\n        </div>\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Database</h3>\n            <p>Performance optimal</p>\n            <small>Response time: 45ms</small>\n        </div>\n        <div class=\"status-card status-yellow\">\n            <h3>‚ö†Ô∏è Storage</h3>\n            <p>85% capacity used</p>\n            <small>Monitoring closely</small>\n        </div>\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Security</h3>\n            <p>No threats detected</p>\n            <small>Last scan: 1 hour ago</small>\n        </div>\n    </div>\n</body>\n</html>",
              "versions": [],
              "created": "2025-05-15T00:00:00.000Z",
              "modified": "2025-07-08T00:00:00.000Z",
              "timeSpent": 7200
            }
          ],
          "totalTimeSpent": 21600,
          "created": "2025-05-01T00:00:00.000Z",
          "isTimerRunning": false
        },
        {
          "id": "proj-1754641340163",
          "name": "RMS Security Assessments Scripts & Reports",
          "description": "Collection of Scripts in Production",
          "files": [
            {
              "id": "file-1754641865329",
              "name": "Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1",
              "type": "script",
              "category": "Security, Assessment, AD, PAssword",
              "content": "# Production PowerShell Script\n# Created in Nishen's AI Workspace - PRODUCTION ENVIRONMENT\n# File: Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1\n# WARNING: This script will run in production - use extreme caution\n\nparam(\n    [string]$Environment = \"PRODUCTION\",\n    [switch]$DryRun = $false\n)\n\n# Production safety check\nif ($Environment -eq \"PRODUCTION\" -and -not $DryRun) {\n    Write-Host \"‚ö†Ô∏è  PRODUCTION MODE ENABLED - This will affect live systems!\" -ForegroundColor Red\n    $confirm = Read-Host \"Are you sure you want to continue? (yes/no)\"\n    if ($confirm -ne \"yes\") {\n        Write-Host \"Operation cancelled.\" -ForegroundColor Yellow\n        exit 0\n    }\n}\n\nWrite-Host \"Starting production script: Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1\" -ForegroundColor Green\n\ntry {\n    # Add your production script logic here\n    Write-Host \"Production script execution completed successfully!\" -ForegroundColor Green\n}\ncatch {\n    Write-Error \"Production script failed: $_\"\n    # Add production error handling/alerting here\n    exit 1\n}",
              "versions": [],
              "created": "2025-08-08T08:31:05.329Z",
              "modified": "2025-08-08T08:31:05.329Z",
              "timeSpent": 0
            }
          ],
          "totalTimeSpent": 0,
          "created": "2025-08-08T08:22:20.163Z",
          "isTimerRunning": false
        }
      ],
      "afterData": [
        {
          "id": "proj-1",
          "name": "Production RMS Tools",
          "description": "Live production system administration tools and scripts",
          "files": [
            {
              "id": "file-1",
              "name": "live-monitor.ps1",
              "type": "script",
              "category": "Monitoring",
              "content": "# Production Live Monitor Script\n# Author: Nishen Harichunder\n# WARNING: This script runs in production environment\n\nParam(\n    [string]$Environment = \"PRODUCTION\",\n    [switch]$AlertMode = $true\n)\n\nWrite-Host \"Starting production monitor for environment: $Environment\" -ForegroundColor Red\n\n# Production monitoring logic here\nif ($AlertMode) {\n    Write-Host \"ALERT MODE ENABLED - Will send notifications on issues\" -ForegroundColor Yellow\n}\n\n# Add your production monitoring logic here",
              "versions": [],
              "created": "2025-05-01T00:00:00.000Z",
              "modified": "2025-07-08T00:00:00.000Z",
              "timeSpent": 14400
            },
            {
              "id": "file-2",
              "name": "prod-status-dashboard.html",
              "type": "html",
              "category": "Dashboard",
              "content": "<!DOCTYPE html>\n<html>\n<head>\n    <title>Production Status Dashboard</title>\n    <style>\n        body { font-family: Arial, sans-serif; background: #000; color: #fff; }\n        .header { background: #ff073a; color: white; padding: 20px; text-align: center; }\n        .status-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; padding: 20px; }\n        .status-card { background: #1a1a1a; border: 1px solid #333; border-radius: 8px; padding: 20px; }\n        .status-green { border-left: 4px solid #00ff00; }\n        .status-red { border-left: 4px solid #ff0000; }\n        .status-yellow { border-left: 4px solid #ffff00; }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <h1>üöÄ Production Status Dashboard</h1>\n        <p>Live system monitoring for RMS Production Environment</p>\n    </div>\n    <div class=\"status-grid\">\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Web Services</h3>\n            <p>All services operational</p>\n            <small>Last check: 2 minutes ago</small>\n        </div>\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Database</h3>\n            <p>Performance optimal</p>\n            <small>Response time: 45ms</small>\n        </div>\n        <div class=\"status-card status-yellow\">\n            <h3>‚ö†Ô∏è Storage</h3>\n            <p>85% capacity used</p>\n            <small>Monitoring closely</small>\n        </div>\n        <div class=\"status-card status-green\">\n            <h3>‚úÖ Security</h3>\n            <p>No threats detected</p>\n            <small>Last scan: 1 hour ago</small>\n        </div>\n    </div>\n</body>\n</html>",
              "versions": [],
              "created": "2025-05-15T00:00:00.000Z",
              "modified": "2025-07-08T00:00:00.000Z",
              "timeSpent": 7200
            }
          ],
          "totalTimeSpent": 21600,
          "created": "2025-05-01T00:00:00.000Z",
          "isTimerRunning": false
        },
        {
          "id": "proj-1754641340163",
          "name": "RMS Security Assessments Scripts & Reports",
          "description": "Collection of Scripts in Production",
          "files": [
            {
              "id": "file-1754641865329",
              "name": "Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1",
              "type": "script",
              "category": "Security, Assessment, AD, PAssword",
              "content": "# Production PowerShell Script\n# Created in Nishen's AI Workspace - PRODUCTION ENVIRONMENT\n# File: Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1\n# WARNING: This script will run in production - use extreme caution\n\nparam(\n    [string]$Environment = \"PRODUCTION\",\n    [switch]$DryRun = $false\n)\n\n# Production safety check\nif ($Environment -eq \"PRODUCTION\" -and -not $DryRun) {\n    Write-Host \"‚ö†Ô∏è  PRODUCTION MODE ENABLED - This will affect live systems!\" -ForegroundColor Red\n    $confirm = Read-Host \"Are you sure you want to continue? (yes/no)\"\n    if ($confirm -ne \"yes\") {\n        Write-Host \"Operation cancelled.\" -ForegroundColor Yellow\n        exit 0\n    }\n}\n\nWrite-Host \"Starting production script: Rms_AD_Security_AssessmentTool.v11.0_Prod.ps1\" -ForegroundColor Green\n\ntry {\n    # Add your production script logic here\n    Write-Host \"Production script execution completed successfully!\" -ForegroundColor Green\n}\ncatch {\n    Write-Error \"Production script failed: $_\"\n    # Add production error handling/alerting here\n    exit 1\n}",
              "versions": [],
              "created": "2025-08-08T08:31:05.329Z",
              "modified": "2025-08-08T08:31:05.329Z",
              "timeSpent": 0
            }
          ],
          "totalTimeSpent": 0,
          "created": "2025-08-08T08:22:20.163Z",
          "isTimerRunning": false
        }
      ],
      "component": "PROD"
    }
  ],
  "nishen-workspace-dev_REDUNDANT": {
    "data": [
      {
        "id": "proj-1",
        "name": "RMS Tools Collection",
        "description": "Professional system administration tools and scripts",
        "files": [
          {
            "id": "file-1",
            "name": "password-audit.ps1",
            "type": "script",
            "category": "Security",
            "content": "# PowerShell Password Audit Script\n# Author: Nishen Harichunder\n\nParam(\n    [string]$Domain = $env:USERDNSDOMAIN\n)\n\nWrite-Host \"Starting password audit for domain: $Domain\" -ForegroundColor Green\n\n# Add your audit logic here",
            "versions": [],
            "created": "2025-06-01T00:00:00.000Z",
            "modified": "2025-06-25T00:00:00.000Z",
            "timeSpent": 7200
          },
          {
            "id": "file-2",
            "name": "incident-report.html",
            "type": "html",
            "category": "Reporting",
            "content": "<!DOCTYPE html>\n<html>\n<head>\n    <title>RMS Incident Report</title>\n    <style>\n        body { font-family: Arial, sans-serif; }\n        .header { background: #003366; color: white; padding: 20px; }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <h1>RMS Incident Report</h1>\n    </div>\n</body>\n</html>",
            "versions": [],
            "created": "2025-06-10T00:00:00.000Z",
            "modified": "2025-06-28T00:00:00.000Z",
            "timeSpent": 5400
          },
          {
            "id": "file-1755174928167",
            "name": "Kofax  - Run as service NSSM - wrapper",
            "type": "document",
            "category": "Kofax, sso",
            "content": "# Kofax  - Run as service NSSM - wrapper\n\nCreated in Nishen's AI Workspace on 2025/08/14\n\nhe Kofax processes as a Windows service under a service account, so no interactive login is required. This is definitely the better approach. Here are several options:\nService Wrapper Solutions:\n1. NSSM (Non-Sucking Service Manager) ‚≠ê Recommended\npowershell# Download NSSM and install Kofax as service\nnssm install \"KofaxProcessingService\" \"C:\\Path\\To\\Kofax\\Application.exe\"\nnssm set \"KofaxProcessingService\" ObjectName \"DOMAIN\\KofaxServiceAccount\" \"ServicePassword\"\nnssm set \"KofaxProcessingService\" Start SERVICE_AUTO_START\nnssm start \"KofaxProcessingService\"\n2. Windows Service Wrapper (WinSW)\nxml<!-- Create KofaxService.xml -->\n<service>\n  <id>KofaxProcessing</id>\n  <name>Kofax Document Processing</name>\n  <description>Kofax automated job processing service</description>\n  <executable>C:\\Path\\To\\Kofax\\Application.exe</executable>\n  <serviceaccount>\n    <domain>YOURDOMAIN</domain>\n    <user>KofaxServiceAccount</user>\n    <password>ServicePassword</password>\n  </serviceaccount>\n  <startmode>Automatic</startmode>\n</service>\n3. PowerShell Service Wrapper\npowershell# Create scheduled task that runs as service\n$Action = New-ScheduledTaskAction -Execute \"C:\\Path\\To\\Kofax\\Application.exe\"\n$Trigger = New-ScheduledTaskTrigger -AtStartup\n$Principal = New-ScheduledTaskPrincipal -UserId \"DOMAIN\\KofaxServiceAccount\" -LogonType ServiceAccount\n$Settings = New-ScheduledTaskSettingsSet -AllowStartIfOnBatteries -DontStopIfGoingOnBatteries -StartWhenAvailable -RestartCount 3\n\nRegister-ScheduledTask -TaskName \"KofaxProcessingService\" -Action $Action -Trigger $Trigger -Principal $Principal -Settings $Settings\nService Account Configuration:\nRequired Permissions:\n\nLog on as a service (SeServiceLogonRight)\nReplace a process level token (SeAssignPrimaryTokenPrivilege)\nAdjust memory quotas (SeIncreaseQuotaPrivilege)\nAct as part of operating system (SeTcbPrivilege) - if needed\n\nPowerShell to Set Permissions:\npowershell# Grant service logon rights\n$UserAccount = \"DOMAIN\\KofaxServiceAccount\"\n$TempFile = [System.IO.Path]::GetTempFileName()\n\n# Export current policy\nsecedit /export /cfg $TempFile /areas USER_RIGHTS\n\n# Add service logon right\n$Content = Get-Content $TempFile\n$Content = $Content.Replace(\"SeServiceLogonRight = \", \"SeServiceLogonRight = $UserAccount,\")\n$Content | Set-Content $TempFile\n\n# Import modified policy\nsecedit /configure /db secedit.sdb /cfg $TempFile\nRemove-Item $TempFile\nAlternative: Interactive Service in Session 0\npowershell# Create service that can interact with desktop (legacy method)\nsc create \"KofaxService\" binPath=\"C:\\Path\\To\\Kofax\\Application.exe\" type=interact type=own obj=\"DOMAIN\\KofaxServiceAccount\" password=\"ServicePassword\"\nsc config \"KofaxService\" start=auto\nKofax-Specific Considerations:\n\nCheck if Kofax has native service mode\nVerify database/network connectivity from service context\nConfigure file system permissions for service account\nTest COM/DCOM registrations if Kofax uses them\nHandle any GUI dependencies (some Kofax modules need desktop interaction)",
            "versions": [
              {
                "id": "ver-1755174951862",
                "content": "# Kofax  - Run as service NSSM - wrapper\n\nCreated in Nishen's AI Workspace on 2025/08/14\n\nhe Kofax processes as a Windows service under a service account, so no interactive login is required. This is definitely the better approach. Here are several options:\nService Wrapper Solutions:\n1. NSSM (Non-Sucking Service Manager) ‚≠ê Recommended\npowershell# Download NSSM and install Kofax as service\nnssm install \"KofaxProcessingService\" \"C:\\Path\\To\\Kofax\\Application.exe\"\nnssm set \"KofaxProcessingService\" ObjectName \"DOMAIN\\KofaxServiceAccount\" \"ServicePassword\"\nnssm set \"KofaxProcessingService\" Start SERVICE_AUTO_START\nnssm start \"KofaxProcessingService\"\n2. Windows Service Wrapper (WinSW)\nxml<!-- Create KofaxService.xml -->\n<service>\n  <id>KofaxProcessing</id>\n  <name>Kofax Document Processing</name>\n  <description>Kofax automated job processing service</description>\n  <executable>C:\\Path\\To\\Kofax\\Application.exe</executable>\n  <serviceaccount>\n    <domain>YOURDOMAIN</domain>\n    <user>KofaxServiceAccount</user>\n    <password>ServicePassword</password>\n  </serviceaccount>\n  <startmode>Automatic</startmode>\n</service>\n3. PowerShell Service Wrapper\npowershell# Create scheduled task that runs as service\n$Action = New-ScheduledTaskAction -Execute \"C:\\Path\\To\\Kofax\\Application.exe\"\n$Trigger = New-ScheduledTaskTrigger -AtStartup\n$Principal = New-ScheduledTaskPrincipal -UserId \"DOMAIN\\KofaxServiceAccount\" -LogonType ServiceAccount\n$Settings = New-ScheduledTaskSettingsSet -AllowStartIfOnBatteries -DontStopIfGoingOnBatteries -StartWhenAvailable -RestartCount 3\n\nRegister-ScheduledTask -TaskName \"KofaxProcessingService\" -Action $Action -Trigger $Trigger -Principal $Principal -Settings $Settings\nService Account Configuration:\nRequired Permissions:\n\nLog on as a service (SeServiceLogonRight)\nReplace a process level token (SeAssignPrimaryTokenPrivilege)\nAdjust memory quotas (SeIncreaseQuotaPrivilege)\nAct as part of operating system (SeTcbPrivilege) - if needed\n\nPowerShell to Set Permissions:\npowershell# Grant service logon rights\n$UserAccount = \"DOMAIN\\KofaxServiceAccount\"\n$TempFile = [System.IO.Path]::GetTempFileName()\n\n# Export current policy\nsecedit /export /cfg $TempFile /areas USER_RIGHTS\n\n# Add service logon right\n$Content = Get-Content $TempFile\n$Content = $Content.Replace(\"SeServiceLogonRight = \", \"SeServiceLogonRight = $UserAccount,\")\n$Content | Set-Content $TempFile\n\n# Import modified policy\nsecedit /configure /db secedit.sdb /cfg $TempFile\nRemove-Item $TempFile\nAlternative: Interactive Service in Session 0\npowershell# Create service that can interact with desktop (legacy method)\nsc create \"KofaxService\" binPath=\"C:\\Path\\To\\Kofax\\Application.exe\" type=interact type=own obj=\"DOMAIN\\KofaxServiceAccount\" password=\"ServicePassword\"\nsc config \"KofaxService\" start=auto\nKofax-Specific Considerations:\n\nCheck if Kofax has native service mode\nVerify database/network connectivity from service context\nConfigure file system permissions for service account\nTest COM/DCOM registrations if Kofax uses them\nHandle any GUI dependencies (some Kofax modules need desktop interaction)",
                "timestamp": "2025-08-14T12:35:51.862Z",
                "description": "baseline"
              }
            ],
            "created": "2025-08-14T12:35:28.167Z",
            "modified": "2025-08-14T12:35:51.862Z",
            "timeSpent": 0
          },
          {
            "id": "file-1755648025947",
            "name": "Modern_V3_EngIssue_reporting_Tool_deepseek.html",
            "type": "html",
            "category": "incident report,tool,deepseek",
            "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>IT Incident Reporting Tool | First Technology</title>\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\">\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js\"></script>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js\"></script>\n    <style>\n        :root {\n            --primary: #1a3a5f;\n            --secondary: #2c5b82;\n            --accent: #4a90e2;\n            --light: #f8f9fa;\n            --dark: #212529;\n            --success: #28a745;\n            --warning: #ffc107;\n            --danger: #dc3545;\n            --info: #17a2b8;\n            --gray: #6c757d;\n            --border: #dee2e6;\n            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\n            --bg-color: white;\n            --text-color: #212529;\n            --form-bg: #f8fafc;\n        }\n        \n        /* Dark Theme */\n        .theme-dark {\n            --primary: #2c3e50;\n            --secondary: #34495e;\n            --accent: #3498db;\n            --light: #34495e;\n            --dark: #ecf0f1;\n            --bg-color: #2c3e50;\n            --text-color: #ecf0f1;\n            --form-bg: #34495e;\n            --border: #4a6278;\n        }\n        \n        /* Blue Theme (default) */\n        .theme-blue {\n            --primary: #1a3a5f;\n            --secondary: #2c5b82;\n            --accent: #4a90e2;\n        }\n        \n        /* Green Theme */\n        .theme-green {\n            --primary: #1e5631;\n            --secondary: #2d7d46;\n            --accent: #4caf50;\n        }\n        \n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n        }\n        \n        body {\n            background: linear-gradient(135deg, #f0f4f8, #e6edf5);\n            color: var(--dark);\n            line-height: 1.6;\n            min-height: 100vh;\n            padding: 20px;\n            background-color: var(--bg-color);\n            color: var(--text-color);\n        }\n        \n        .app-container {\n            max-width: 1200px;\n            margin: 0 auto;\n            background: var(--bg-color);\n            border-radius: 15px;\n            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);\n            overflow: hidden;\n        }\n        \n        /* Header */\n        .header {\n            background: linear-gradient(to right, var(--primary), var(--secondary));\n            color: white;\n            padding: 25px 40px;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            position: relative;\n        }\n        \n        .logo {\n            display: flex;\n            align-items: center;\n            gap: 15px;\n        }\n        \n        .logo-icon {\n            font-size: 32px;\n            color: white;\n        }\n        \n        .logo-text h1 {\n            font-size: 26px;\n            font-weight: 700;\n            letter-spacing: 0.5px;\n        }\n        \n        .logo-text p {\n            font-size: 14px;\n            opacity: 0.9;\n            margin-top: 3px;\n        }\n        \n        .action-buttons {\n            display: flex;\n            gap: 12px;\n        }\n        \n        .btn {\n            padding: 12px 22px;\n            border-radius: 8px;\n            font-weight: 600;\n            cursor: pointer;\n            display: inline-flex;\n            align-items: center;\n            gap: 8px;\n            transition: all 0.3s;\n            border: none;\n            font-size: 15px;\n        }\n        \n        .btn-primary {\n            background-color: white;\n            color: var(--primary);\n            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);\n        }\n        \n        .btn-outline {\n            background-color: transparent;\n            border: 2px solid rgba(255, 255, 255, 0.7);\n            color: white;\n        }\n        \n        .btn-success {\n            background-color: var(--success);\n            color: white;\n        }\n        \n        .btn-danger {\n            background-color: var(--danger);\n            color: white;\n        }\n        \n        .btn:hover {\n            transform: translateY(-3px);\n            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.15);\n        }\n        \n        .btn:active {\n            transform: translateY(-1px);\n        }\n        \n        /* Navigation */\n        .nav-tabs {\n            display: flex;\n            background-color: var(--bg-color);\n            border-bottom: 1px solid var(--border);\n            padding: 0 40px;\n        }\n        \n        .nav-item {\n            padding: 18px 25px;\n            cursor: pointer;\n            position: relative;\n            font-weight: 600;\n            color: var(--gray);\n            transition: all 0.3s;\n        }\n        \n        .nav-item.active {\n            color: var(--primary);\n        }\n        \n        .nav-item.active::after {\n            content: '';\n            position: absolute;\n            bottom: -1px;\n            left: 0;\n            width: 100%;\n            height: 3px;\n            background-color: var(--accent);\n            border-radius: 3px 3px 0 0;\n        }\n        \n        .nav-item:hover {\n            color: var(--primary);\n            background-color: rgba(74, 144, 226, 0.05);\n        }\n        \n        /* Main Content */\n        .main-content {\n            padding: 30px 40px;\n            min-height: 600px;\n        }\n        \n        .tab-content {\n            display: none;\n        }\n        \n        .tab-content.active {\n            display: block;\n        }\n        \n        .form-section {\n            background: var(--bg-color);\n            border-radius: 10px;\n            box-shadow: var(--card-shadow);\n            padding: 30px;\n            margin-bottom: 25px;\n            border: 1px solid var(--border);\n        }\n        \n        .section-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 25px;\n            padding-bottom: 15px;\n            border-bottom: 2px solid rgba(26, 58, 95, 0.1);\n        }\n        \n        .section-header h3 {\n            color: var(--primary);\n            font-weight: 700;\n            font-size: 20px;\n            display: flex;\n            align-items: center;\n            gap: 10px;\n        }\n        \n        .section-header i {\n            color: var(--accent);\n        }\n        \n        .form-row {\n            display: flex;\n            gap: 25px;\n            margin-bottom: 25px;\n            flex-wrap: wrap;\n        }\n        \n        .form-group {\n            flex: 1;\n            min-width: 250px;\n        }\n        \n        .form-group label {\n            display: block;\n            margin-bottom: 10px;\n            font-weight: 600;\n            color: var(--text-color);\n            font-size: 15px;\n        }\n        \n        .form-control {\n            width: 100%;\n            padding: 14px 18px;\n            border: 1px solid var(--border);\n            border-radius: 8px;\n            font-size: 15px;\n            transition: all 0.3s;\n            background-color: var(--form-bg);\n            color: var(--text-color);\n        }\n        \n        .form-control:focus {\n            outline: none;\n            border-color: var(--accent);\n            box-shadow: 0 0 0 4px rgba(74, 144, 226, 0.2);\n            background-color: var(--bg-color);\n        }\n        \n        textarea.form-control {\n            min-height: 140px;\n            resize: vertical;\n        }\n        \n        select.form-control {\n            appearance: none;\n            background-image: url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%236c757d' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10z'/%3E%3C/svg%3E\");\n            background-repeat: no-repeat;\n            background-position: right 15px center;\n            background-size: 12px;\n            padding-right: 40px;\n        }\n        \n        /* Timeline Table */\n        .timeline-table {\n            width: 100%;\n            border-collapse: collapse;\n            margin: 20px 0;\n            border-radius: 8px;\n            overflow: hidden;\n            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);\n        }\n        \n        .timeline-table th {\n            background-color: var(--primary);\n            color: white;\n            padding: 16px 20px;\n            text-align: left;\n            font-weight: 600;\n        }\n        \n        .timeline-table td {\n            padding: 16px 20px;\n            border-bottom: 1px solid var(--border);\n            background-color: var(--bg-color);\n        }\n        \n        .timeline-table tr:nth-child(even) td {\n            background-color: var(--form-bg);\n        }\n        \n        .timeline-table tr:hover td {\n            background-color: #e9f0f9;\n        }\n        \n        .add-row-btn {\n            background-color: var(--success);\n            color: white;\n            border: none;\n            border-radius: 8px;\n            padding: 12px 20px;\n            cursor: pointer;\n            margin-top: 15px;\n            display: inline-flex;\n            align-items: center;\n            gap: 8px;\n            font-weight: 600;\n            transition: all 0.3s;\n        }\n        \n        .add-row-btn:hover {\n            background-color: #218838;\n            transform: translateY(-2px);\n        }\n        \n        /* Status Indicators */\n        .system-status {\n            display: flex;\n            gap: 20px;\n            flex-wrap: wrap;\n            margin: 20px 0;\n        }\n        \n        .status-card {\n            flex: 1;\n            min-width: 250px;\n            background: var(--bg-color);\n            border-radius: 12px;\n            padding: 20px;\n            box-shadow: var(--card-shadow);\n            border-left: 4px solid var(--accent);\n            transition: all 0.3s;\n        }\n        \n        .status-card:hover {\n            transform: translateY(-5px);\n            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);\n        }\n        \n        .status-card h4 {\n            font-size: 16px;\n            margin-bottom: 15px;\n            color: var(--gray);\n            font-weight: 600;\n            display: flex;\n            align-items: center;\n            gap: 8px;\n        }\n        \n        .status-card .status {\n            font-weight: 700;\n            font-size: 17px;\n            padding: 10px 15px;\n            border-radius: 8px;\n            display: inline-block;\n        }\n        \n        .status-resolved {\n            background-color: rgba(40, 167, 69, 0.15);\n            color: var(--success);\n        }\n        \n        .status-in-progress {\n            background-color: rgba(255, 193, 7, 0.15);\n            color: var(--warning);\n        }\n        \n        .status-pending {\n            background-color: rgba(220, 53, 69, 0.15);\n            color: var(--danger);\n        }\n        \n        .status-info {\n            background-color: rgba(23, 162, 184, 0.15);\n            color: var(--info);\n        }\n        \n        /* Footer */\n        .footer {\n            margin-top: 40px;\n            padding: 25px 40px;\n            background-color: var(--form-bg);\n            border-top: 1px solid var(--border);\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            flex-wrap: wrap;\n            gap: 20px;\n        }\n        \n        .footer-text {\n            color: var(--gray);\n            font-size: 14px;\n        }\n        \n        .footer-links {\n            display: flex;\n            gap: 15px;\n        }\n        \n        .footer-link {\n            color: var(--primary);\n            text-decoration: none;\n            font-weight: 600;\n            font-size: 14px;\n            transition: all 0.3s;\n        }\n        \n        .footer-link:hover {\n            color: var(--accent);\n            text-decoration: underline;\n        }\n        \n        /* Modal */\n        .modal {\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background-color: rgba(0, 0, 0, 0.7);\n            z-index: 1000;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            opacity: 0;\n            visibility: hidden;\n            transition: all 0.3s;\n        }\n        \n        .modal.active {\n            opacity: 1;\n            visibility: visible;\n        }\n        \n        .modal-content {\n            background: var(--bg-color);\n            border-radius: 15px;\n            width: 100%;\n            max-width: 500px;\n            padding: 30px;\n            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.25);\n            transform: translateY(-30px);\n            transition: all 0.4s;\n        }\n        \n        .modal.active .modal-content {\n            transform: translateY(0);\n        }\n        \n        .modal-header {\n            margin-bottom: 25px;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n        \n        .modal-header h3 {\n            color: var(--primary);\n            font-size: 24px;\n            font-weight: 700;\n        }\n        \n        .close-modal {\n            background: none;\n            border: none;\n            font-size: 24px;\n            color: var(--gray);\n            cursor: pointer;\n            transition: all 0.3s;\n        }\n        \n        .close-modal:hover {\n            color: var(--danger);\n            transform: rotate(90deg);\n        }\n        \n        .modal-footer {\n            display: flex;\n            justify-content: flex-end;\n            gap: 15px;\n            margin-top: 25px;\n        }\n        \n        /* Dashboard Styles */\n        .dashboard-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n            gap: 25px;\n            margin-top: 20px;\n        }\n        \n        .dashboard-card {\n            background: var(--bg-color);\n            border-radius: 12px;\n            padding: 25px;\n            box-shadow: var(--card-shadow);\n            border-top: 4px solid var(--accent);\n            transition: all 0.3s;\n        }\n        \n        .dashboard-card:hover {\n            transform: translateY(-5px);\n            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);\n        }\n        \n        .dashboard-card h3 {\n            color: var(--primary);\n            margin-bottom: 15px;\n            display: flex;\n            align-items: center;\n            gap: 10px;\n        }\n        \n        .stat-number {\n            font-size: 32px;\n            font-weight: 700;\n            color: var(--primary);\n            margin: 10px 0;\n        }\n        \n        .stat-label {\n            color: var(--gray);\n            font-weight: 600;\n        }\n        \n        .recent-reports {\n            margin-top: 20px;\n        }\n        \n        .report-item {\n            padding: 15px;\n            border-bottom: 1px solid var(--border);\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n        \n        .report-item:last-child {\n            border-bottom: none;\n        }\n        \n        .report-title {\n            font-weight: 600;\n            color: var(--text-color);\n        }\n        \n        .report-date {\n            color: var(--gray);\n            font-size: 14px;\n        }\n        \n        /* FAQ Accordion */\n        .faq-content {\n            display: none;\n            padding: 15px;\n            background-color: var(--form-bg);\n            border-radius: 0 0 8px 8px;\n            margin-top: -10px;\n            border: 1px solid var(--border);\n            border-top: none;\n        }\n        \n        .faq-item.active .faq-content {\n            display: block;\n        }\n        \n        .faq-item.active .fa-chevron-down {\n            transform: rotate(180deg);\n        }\n        \n        /* Responsive */\n        @media (max-width: 992px) {\n            .header {\n                flex-direction: column;\n                align-items: flex-start;\n                gap: 25px;\n            }\n            \n            .action-buttons {\n                width: 100%;\n                flex-wrap: wrap;\n            }\n            \n            .btn {\n                flex: 1;\n                justify-content: center;\n            }\n        }\n        \n        @media (max-width: 768px) {\n            .header, .main-content, .footer {\n                padding: 20px;\n            }\n            \n            .nav-tabs {\n                padding: 0 20px;\n                overflow-x: auto;\n            }\n            \n            .nav-item {\n                white-space: nowrap;\n                padding: 15px 20px;\n            }\n            \n            .form-section {\n                padding: 20px;\n            }\n            \n            .system-status {\n                flex-direction: column;\n            }\n        }\n        \n        @media (max-width: 576px) {\n            .form-row {\n                flex-direction: column;\n                gap: 15px;\n            }\n            \n            .modal-content {\n                padding: 20px;\n            }\n            \n            .btn {\n                padding: 10px 15px;\n                font-size: 14px;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"app-container\">\n        <!-- Header -->\n        <div class=\"header\">\n            <div class=\"logo\">\n                <div class=\"logo-icon\">\n                    <i class=\"fas fa-bug fa-2x\"></i>\n                </div>\n                <div class=\"logo-text\">\n                    <h1>IT Incident Reporting Tool</h1>\n                    <p>Professional Incident Management Solution</p>\n                </div>\n            </div>\n            <div class=\"action-buttons\">\n                <button class=\"btn btn-outline\" id=\"saveBtn\">\n                    <i class=\"fas fa-save\"></i> Save Draft\n                </button>\n                <button class=\"btn btn-outline\" id=\"loadBtn\">\n                    <i class=\"fas fa-folder-open\"></i> Load Draft\n                </button>\n                <button class=\"btn btn-primary\" id=\"exportPdfBtn\">\n                    <i class=\"fas fa-file-pdf\"></i> Export PDF\n                </button>\n                <button class=\"btn btn-success\" id=\"emailBtn\">\n                    <i class=\"fas fa-envelope\"></i> Email Report\n                </button>\n            </div>\n        </div>\n        \n        <!-- Navigation -->\n        <div class=\"nav-tabs\">\n            <div class=\"nav-item active\" data-tab=\"dashboard\">\n                <i class=\"fas fa-home\"></i> Dashboard\n            </div>\n            <div class=\"nav-item\" data-tab=\"new-report\">\n                <i class=\"fas fa-file-alt\"></i> New Report\n            </div>\n            <div class=\"nav-item\" data-tab=\"history\">\n                <i class=\"fas fa-history\"></i> Report History\n            </div>\n            <div class=\"nav-item\" data-tab=\"settings\">\n                <i class=\"fas fa-cog\"></i> Settings\n            </div>\n            <div class=\"nav-item\" data-tab=\"help\">\n                <i class=\"fas fa-question-circle\"></i> Help & Support\n            </div>\n        </div>\n        \n        <!-- Main Content -->\n        <div class=\"main-content\">\n            <!-- Dashboard Tab -->\n            <div id=\"dashboardContent\" class=\"tab-content active\">\n                <div class=\"form-section\">\n                    <div class=\"section-header\">\n                        <h3><i class=\"fas fa-chart-line\"></i> Incident Dashboard</h3>\n                    </div>\n                    \n                    <div class=\"dashboard-grid\">\n                        <div class=\"dashboard-card\">\n                            <h3><i class=\"fas fa-exclamation-circle\"></i> Open Incidents</h3>\n                            <div class=\"stat-number\">12</div>\n                            <div class=\"stat-label\">Active issues requiring attention</div>\n                        </div>\n                        \n                        <div class=\"dashboard-card\">\n                            <h3><i class=\"fas fa-check-circle\"></i> Resolved This Week</h3>\n                            <div class=\"stat-number\">24</div>\n                            <div class=\"stat-label\">Issues successfully resolved</div>\n                        </div>\n                        \n                        <div class=\"dashboard-card\">\n                            <h3><i class=\"fas fa-clock\"></i> Average Resolution Time</h3>\n                            <div class=\"stat-number\">18.5h</div>\n                            <div class=\"stat-label\">From report to resolution</div>\n                        </div>\n                        \n                        <div class=\"dashboard-card\">\n                            <h3><i class=\"fas fa-user-shield\"></i> Your Reports</h3>\n                            <div class=\"stat-number\">7</div>\n                            <div class=\"stat-label\">Incidents managed by you</div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-section\">\n                        <h3><i class=\"fas fa-list\"></i> Recent Reports</h3>\n                        <div class=\"recent-reports\">\n                            <div class=\"report-item\">\n                                <div>\n                                    <div class=\"report-title\">SQL Service Failure on ASTW-APP04</div>\n                                    <div class=\"report-date\">Priority: High ‚Ä¢ Created: 2023-11-15</div>\n                                </div>\n                                <div>\n                                    <span class=\"status status-in-progress\">In Progress</span>\n                                </div>\n                            </div>\n                            <div class=\"report-item\">\n                                <div>\n                                    <div class=\"report-title\">Network Connectivity Issues</div>\n                                    <div class=\"report-date\">Priority: Medium ‚Ä¢ Created: 2023-11-14</div>\n                                </div>\n                                <div>\n                                    <span class=\"status status-resolved\">Resolved</span>\n                                </div>\n                            </div>\n                            <div class=\"report-item\">\n                                <div>\n                                    <div class=\"report-title\">Email Server Outage</div>\n                                    <div class=\"report-date\">Priority: Critical ‚Ä¢ Created: 2023-11-12</div>\n                                </div>\n                                <div>\n                                    <span class=\"status status-resolved\">Resolved</span>\n                                </div>\n                            </div>\n                            <div class=\"report-item\">\n                                <div>\n                                    <div class=\"report-title\">Firewall Configuration Error</div>\n                                    <div class=\"report-date\">Priority: High ‚Ä¢ Created: 2023-11-10</div>\n                                </div>\n                                <div>\n                                    <span class=\"status status-pending\">Pending</span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            \n            <!-- New Report Tab -->\n            <div id=\"newReportContent\" class=\"tab-content\">\n                <form id=\"incidentReportForm\">\n                    <!-- Ticket & Basic Info -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-info-circle\"></i> Incident Information</h3>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"ticketNumber\"><i class=\"fas fa-ticket-alt\"></i> Ticket/Incident Number</label>\n                                <input type=\"text\" id=\"ticketNumber\" class=\"form-control\" placeholder=\"INC-2023-001\" value=\"INC-2023-001\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"clientName\"><i class=\"fas fa-building\"></i> Client Name</label>\n                                <input type=\"text\" id=\"clientName\" class=\"form-control\" placeholder=\"Ashtons IT\" value=\"Ashtons IT\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"reportDate\"><i class=\"fas fa-calendar\"></i> Report Date</label>\n                                <input type=\"date\" id=\"reportDate\" class=\"form-control\">\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"priority\"><i class=\"fas fa-exclamation-triangle\"></i> Priority</label>\n                                <select id=\"priority\" class=\"form-control\">\n                                    <option value=\"HIGH\">High</option>\n                                    <option value=\"MEDIUM\">Medium</option>\n                                    <option value=\"LOW\">Low</option>\n                                </select>\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"status\"><i class=\"fas fa-sync\"></i> Current Status</label>\n                                <select id=\"status\" class=\"form-control\">\n                                    <option value=\"RESOLVED\">Resolved</option>\n                                    <option value=\"IN_PROGRESS\">In Progress</option>\n                                    <option value=\"PENDING\">Pending</option>\n                                </select>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Executive Summary -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-chart-line\"></i> Executive Summary</h3>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"issue\"><i class=\"fas fa-exclamation-circle\"></i> Issue Description</label>\n                                <textarea id=\"issue\" class=\"form-control\">SQL services failing to start on server ASTW-APP04, affecting Solcase application functionality</textarea>\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"impact\"><i class=\"fas fa-bolt\"></i> Business Impact</label>\n                                <textarea id=\"impact\" class=\"form-control\">Critical Solcase operations (including reporting and batch processing) impaired; domain admin credentials compromised.</textarea>\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"rootCause\"><i class=\"fas fa-search\"></i> Root Cause</label>\n                                <textarea id=\"rootCause\" class=\"form-control\">Domain administrator account compromise and misuse for SQL services.</textarea>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Incident Details -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-clipboard-list\"></i> Incident Details</h3>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"reportedTime\"><i class=\"fas fa-clock\"></i> Reported Time</label>\n                                <input type=\"datetime-local\" id=\"reportedTime\" class=\"form-control\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"reportedBy\"><i class=\"fas fa-user\"></i> Reported By</label>\n                                <input type=\"text\" id=\"reportedBy\" class=\"form-control\" placeholder=\"Contact name/role\" value=\"Josh Teague (Ashtons IT)\">\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"affectedSystems\"><i class=\"fas fa-server\"></i> Affected Systems</label>\n                                <textarea id=\"affectedSystems\" class=\"form-control\">ASTW-APP04 (SQL Server), Solcase application</textarea>\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"symptoms\"><i class=\"fas fa-stethoscope\"></i> Symptoms</label>\n                                <textarea id=\"symptoms\" class=\"form-control\">SQL services unresponsive; scheduled tasks failing; domain admin account locked.</textarea>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Investigation Timeline -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-history\"></i> Investigation Timeline</h3>\n                        </div>\n                        <table class=\"timeline-table\">\n                            <thead>\n                                <tr>\n                                    <th>Time</th>\n                                    <th>Action Taken</th>\n                                    <th>Engineer</th>\n                                    <th>Outcome</th>\n                                    <th></th>\n                                </tr>\n                            </thead>\n                            <tbody id=\"timelineBody\">\n                                <tr>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"15:31\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Identified domain admin account lockout\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Josh Teague\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Suspicious activity detected\"></td>\n                                    <td><button type=\"button\" class=\"btn btn-danger\" onclick=\"removeTimelineRow(this)\"><i class=\"fas fa-trash\"></i></button></td>\n                                </tr>\n                                <tr>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"15:33\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Detected unauthorized password change\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Nishen Harichunder\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Credentials compromised\"></td>\n                                    <td><button type=\"button\" class=\"btn btn-danger\" onclick=\"removeTimelineRow(this)\"><i class=\"fas fa-trash\"></i></button></td>\n                                </tr>\n                                <tr>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"15:34\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Recommended dedicated SQL service account\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Nishen Harichunder\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Plan for credential remediation\"></td>\n                                    <td><button type=\"button\" class=\"btn btn-danger\" onclick=\"removeTimelineRow(this)\"><i class=\"fas fa-trash\"></i></button></td>\n                                </tr>\n                            </tbody>\n                        </table>\n                        <button type=\"button\" class=\"add-row-btn\" onclick=\"addTimelineRow()\">\n                            <i class=\"fas fa-plus\"></i> Add Timeline Event\n                        </button>\n                    </div>\n                    \n                    <!-- Resolution Actions -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-tools\"></i> Resolution Actions</h3>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"actionsTaken\"><i class=\"fas fa-hammer\"></i> Actions Implemented</label>\n                                <textarea id=\"actionsTaken\" class=\"form-control\">1. Service Account Migration\n- Created sql_svc_progressDB@internal.ashtongraham.co.uk\n- Updated all SQL services on ASTW-APP04\n- SQL services started successfully\n\n2. Scheduled Task Remediation\n- Updated 4 tasks (RapidRTA, Claims processing, Notification retrieval, Report spooling)\n- Tasks reconfigured; manual execution required for missed jobs</textarea>\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"securityImprovements\"><i class=\"fas fa-shield-alt\"></i> Security Improvements</label>\n                                <textarea id=\"securityImprovements\" class=\"form-control\">- Eliminated Domain Admin Usage\n- Updated service account details in PassPortal\n- Dedicated Service Account for SQL operations\n- Implemented alerting for domain admin account lockouts</textarea>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Current Status -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-chart-bar\"></i> Current Status</h3>\n                        </div>\n                        <div class=\"system-status\">\n                            <div class=\"status-card\">\n                                <h4><i class=\"fas fa-database\"></i> SQL Services</h4>\n                                <div class=\"status status-resolved\">\n                                    <i class=\"fas fa-check-circle\"></i> Running with dedicated service account\n                                </div>\n                            </div>\n                            <div class=\"status-card\">\n                                <h4><i class=\"fas fa-window-restore\"></i> Application</h4>\n                                <div class=\"status status-in-progress\">\n                                    <i class=\"fas fa-exclamation-triangle\"></i> May require server reboot\n                                </div>\n                            </div>\n                            <div class=\"status-card\">\n                                <h4><i class=\"fas fa-tasks\"></i> Scheduled Tasks</h4>\n                                <div class=\"status status-info\">\n                                    <i class=\"fas fa-clipboard-list\"></i> Updated but may need manual execution\n                                </div>\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"outstandingActions\"><i class=\"fas fa-list-check\"></i> Outstanding Actions</label>\n                                <textarea id=\"outstandingActions\" class=\"form-control\">1. Server Reboot (ASTW-APP04)\n- Reboot to flush credential cache\n- Responsible: Steve (Approval Pending)\n\n2. Domain-Wide Security Audit\n- Scan all servers for services using domain admin accounts\n- Responsible: Oliver Govender (Next 48 hours)\n\n3. Password Change Investigation\n- Determine who changed domain admin password and why\n- Responsible: Ashtons IT Security Team (High priority)</textarea>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Recommendations -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-lightbulb\"></i> Recommendations</h3>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"immediateRecs\"><i class=\"fas fa-bolt\"></i> Immediate Recommendations (24-48 Hours)</label>\n                                <textarea id=\"immediateRecs\" class=\"form-control\">1. Implement Domain Admin Lockout Alerts\n- Configure SIEM/Sentinel rules for real-time detection\n\n2. Manual Task Execution\n- Execute backlog from failed scheduled jobs\n- Validate outputs post-execution</textarea>\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"longTermRecs\"><i class=\"fas fa-chart-line\"></i> Long-term Improvements (30-90 Days)</label>\n                                <textarea id=\"longTermRecs\" class=\"form-control\">1. Deploy Group Managed Service Accounts (gMSA)\n- Automate password management for service accounts\n- Eliminate manual credential rotation\n\n2. Privileged Access Audit Framework\n- Quarterly reviews of service account dependencies\n- Implement automated scanning tools</textarea>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Contact Information -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-address-card\"></i> Contact Information</h3>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"engineerName\"><i class=\"fas fa-user-tie\"></i> Primary Engineer</label>\n                                <input type=\"text\" id=\"engineerName\" class=\"form-control\" value=\"Nishen Harichunder\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"engineerEmail\"><i class=\"fas fa-envelope\"></i> Email</label>\n                                <input type=\"email\" id=\"engineerEmail\" class=\"form-control\" placeholder=\"engineer@example.com\" value=\"nishen@firsttech.com\">\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"engineerPhone\"><i class=\"fas fa-phone\"></i> Mobile</label>\n                                <input type=\"tel\" id=\"engineerPhone\" class=\"form-control\" placeholder=\"+27 123 456 789\" value=\"+27 123 456 789\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"availability\"><i class=\"fas fa-calendar-check\"></i> Availability</label>\n                                <input type=\"text\" id=\"availability\" class=\"form-control\" placeholder=\"08:00-17:00 SAST (Mon-Fri)\" value=\"08:00-17:00 SAST (Mon-Fri)\">\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-section\">\n                        <button type=\"button\" class=\"btn btn-primary\" id=\"submitReport\" style=\"width: 100%; padding: 16px; font-size: 17px; font-weight: 600;\">\n                            <i class=\"fas fa-paper-plane\"></i> Submit Final Report\n                        </button>\n                    </div>\n                </form>\n            </div>\n            \n            <!-- Report History Tab -->\n            <div id=\"historyContent\" class=\"tab-content\">\n                <div class=\"form-section\">\n                    <div class=\"section-header\">\n                        <h3><i class=\"fas fa-history\"></i> Report History</h3>\n                    </div>\n                    \n                    <div class=\"recent-reports\">\n                        <div class=\"report-item\">\n                            <div>\n                                <div class=\"report-title\">Database Connection Failure</div>\n                                <div class=\"report-date\">Created: 2023-11-14 ‚Ä¢ Priority: High</div>\n                            </div>\n                            <div>\n                                <span class=\"status status-resolved\">Resolved</span>\n                            </div>\n                        </div>\n                        <div class=\"report-item\">\n                            <div>\n                                <div class=\"report-title\">Firewall Configuration Error</div>\n                                <div class=\"report-date\">Created: 2023-11-12 ‚Ä¢ Priority: Critical</div>\n                            </div>\n                            <div>\n                                <span class=\"status status-resolved\">Resolved</span>\n                            </div>\n                        </div>\n                        <div class=\"report-item\">\n                            <div>\n                                <div class=\"report-title\">Email Server Outage</div>\n                                <div class=\"report-date\">Created: 2023-11-10 ‚Ä¢ Priority: High</div>\n                            </div>\n                            <div>\n                                <span class=\"status status-resolved\">Resolved</span>\n                            </div>\n                        </div>\n                        <div class=\"report-item\">\n                            <div>\n                                <div class=\"report-title\">Network Switch Failure</div>\n                                <div class=\"report-date\">Created: 2023-11-08 ‚Ä¢ Priority: Medium</div>\n                            </div>\n                            <div>\n                                <span class=\"status status-resolved\">Resolved</span>\n                            </div>\n                        </div>\n                        <div class=\"report-item\">\n                            <div>\n                                <div class=\"report-title\">Backup System Failure</div>\n                                <div class=\"report-date\">Created: 2023-11-05 ‚Ä¢ Priority: High</div>\n                            </div>\n                            <div>\n                                <span class=\"status status-resolved\">Resolved</span>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div style=\"margin-top: 30px; text-align: center;\">\n                        <button class=\"btn btn-outline\">\n                            <i class=\"fas fa-arrow-left\"></i> Previous\n                        </button>\n                        <span style=\"margin: 0 15px; font-weight: 600;\">Page 1 of 3</span>\n                        <button class=\"btn btn-outline\">\n                            Next <i class=\"fas fa-arrow-right\"></i>\n                        </button>\n                    </div>\n                </div>\n            </div>\n            \n            <!-- Settings Tab -->\n            <div id=\"settingsContent\" class=\"tab-content\">\n                <div class=\"form-section\">\n                    <div class=\"section-header\">\n                        <h3><i class=\"fas fa-cog\"></i> Application Settings</h3>\n                    </div>\n                    \n                    <div class=\"form-row\">\n                        <div class=\"form-group\">\n                            <label for=\"companyName\"><i class=\"fas fa-building\"></i> Company Name</label>\n                            <input type=\"text\" id=\"companyName\" class=\"form-control\" value=\"First Technology KZN (Pty) Ltd\">\n                        </div>\n                        <div class=\"form-group\">\n                            <label for=\"defaultEngineer\"><i class=\"fas fa-user-tie\"></i> Default Engineer</label>\n                            <input type=\"text\" id=\"defaultEngineer\" class=\"form-control\" value=\"Nishen Harichunder\">\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-row\">\n                        <div class=\"form-group\">\n                            <label for=\"emailSignature\"><i class=\"fas fa-signature\"></i> Email Signature</label>\n                            <textarea id=\"emailSignature\" class=\"form-control\">Best regards,\nFirst Technology Support Team\nsupport@firsttech.com\n+27 123 456 789</textarea>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-row\">\n                        <div class=\"form-group\">\n                            <label for=\"autoSave\"><i class=\"fas fa-save\"></i> Auto-save Interval</label>\n                            <select id=\"autoSave\" class=\"form-control\">\n                                <option value=\"5\">Every 5 minutes</option>\n                                <option value=\"10\" selected>Every 10 minutes</option>\n                                <option value=\"15\">Every 15 minutes</option>\n                                <option value=\"30\">Every 30 minutes</option>\n                                <option value=\"0\">Disabled</option>\n                            </select>\n                        </div>\n                        <div class=\"form-group\">\n                            <label for=\"theme\"><i class=\"fas fa-palette\"></i> Theme</label>\n                            <select id=\"theme\" class=\"form-control\">\n                                <option value=\"light\">Light Theme</option>\n                                <option value=\"dark\">Dark Theme</option>\n                                <option value=\"blue\" selected>Blue Theme</option>\n                                <option value=\"green\">Green Theme</option>\n                            </select>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-section\">\n                        <button type=\"button\" class=\"btn btn-primary\" id=\"saveSettingsBtn\" style=\"width: 100%; padding: 16px; font-size: 17px; font-weight: 600;\">\n                            <i class=\"fas fa-save\"></i> Save Settings\n                        </button>\n                    </div>\n                </div>\n            </div>\n            \n            <!-- Help & Support Tab -->\n            <div id=\"helpContent\" class=\"tab-content\">\n                <div class=\"form-section\">\n                    <div class=\"section-header\">\n                        <h3><i class=\"fas fa-question-circle\"></i> Help & Support</h3>\n                    </div>\n                    \n                    <div class=\"system-status\">\n                        <div class=\"status-card\">\n                            <h4><i class=\"fas fa-book\"></i> Documentation</h4>\n                            <p>Access our comprehensive user guides and documentation to learn how to use all features of the Incident Reporting Tool.</p>\n                            <button class=\"btn btn-outline\" style=\"margin-top: 15px;\">\n                                <i class=\"fas fa-download\"></i> Download User Guide\n                            </button>\n                        </div>\n                        <div class=\"status-card\">\n                            <h4><i class=\"fas fa-video\"></i> Video Tutorials</h4>\n                            <p>Watch step-by-step video tutorials that demonstrate how to create, manage, and export incident reports.</p>\n                            <button class=\"btn btn-outline\" style=\"margin-top: 15px;\">\n                                <i class=\"fas fa-play-circle\"></i> View Tutorials\n                            </button>\n                        </div>\n                        <div class=\"status-card\">\n                            <h4><i class=\"fas fa-headset\"></i> Contact Support</h4>\n                            <p>Our support team is available to assist you with any questions or issues you may encounter.</p>\n                            <div style=\"margin-top: 15px;\">\n                                <p><i class=\"fas fa-envelope\"></i> support@firsttech.com</p>\n                                <p><i class=\"fas fa-phone\"></i> +27 123 456 789</p>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-section\">\n                        <h3><i class=\"fas fa-comments\"></i> Frequently Asked Questions</h3>\n                        <div class=\"recent-reports\" id=\"faqContainer\">\n                            <div class=\"report-item faq-item\">\n                                <div>\n                                    <div class=\"report-title\">How do I save a draft of my report?</div>\n                                </div>\n                                <div>\n                                    <i class=\"fas fa-chevron-down\"></i>\n                                </div>\n                                <div class=\"faq-content\">\n                                    <p>To save a draft of your report, click the \"Save Draft\" button in the top right corner of the application. This will save your current progress to your browser's local storage. You can later load this draft by clicking the \"Load Draft\" button.</p>\n                                </div>\n                            </div>\n                            <div class=\"report-item faq-item\">\n                                <div>\n                                    <div class=\"report-title\">Can I export reports to PDF?</div>\n                                </div>\n                                <div>\n                                    <i class=\"fas fa-chevron-down\"></i>\n                                </div>\n                                <div class=\"faq-content\">\n                                    <p>Yes, you can export your reports to PDF by clicking the \"Export PDF\" button in the top right corner. This will generate a PDF version of your current report that you can save to your computer or print.</p>\n                                </div>\n                            </div>\n                            <div class=\"report-item faq-item\">\n                                <div>\n                                    <div class=\"report-title\">How do I change my account settings?</div>\n                                </div>\n                                <div>\n                                    <i class=\"fas fa-chevron-down\"></i>\n                                </div>\n                                <div class=\"faq-content\">\n                                    <p>Account settings can be changed in the \"Settings\" tab. Here you can update your default engineer information, company details, email signature, and application preferences like theme and auto-save interval.</p>\n                                </div>\n                            </div>\n                            <div class=\"report-item faq-item\">\n                                <div>\n                                    <div class=\"report-title\">Where can I find my previously submitted reports?</div>\n                                </div>\n                                <div>\n                                    <i class=\"fas fa-chevron-down\"></i>\n                                </div>\n                                <div class=\"faq-content\">\n                                    <p>All your previously submitted reports can be found in the \"Report History\" tab. This section displays a list of all your past reports with their status, priority, and creation date.</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            \n            <div class=\"footer\">\n                <div class=\"footer-text\">\n                    First Technology KZN (Pty) Ltd | Incident Reporting Tool v2.1\n                </div>\n                <div class=\"footer-links\">\n                    <a href=\"#\" class=\"footer-link\">Privacy Policy</a>\n                    <a href=\"#\" class=\"footer-link\">Terms of Service</a>\n                    <a href=\"#\" class=\"footer-link\">Contact Support</a>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    <!-- Email Modal -->\n    <div class=\"modal\" id=\"emailModal\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <h3><i class=\"fas fa-envelope\"></i> Email Incident Report</h3>\n                <button class=\"close-modal\" id=\"cancelEmailBtn\">&times;</button>\n            </div>\n            <div class=\"form-group\" style=\"margin-bottom: 20px;\">\n                <label for=\"recipientEmail\">Recipient Email</label>\n                <input type=\"email\" id=\"recipientEmail\" class=\"form-control\" placeholder=\"recipient@example.com\" value=\"manager@ashtons.com\">\n            </div>\n            <div class=\"form-group\" style=\"margin-bottom: 20px;\">\n                <label for=\"emailSubject\">Subject</label>\n                <input type=\"text\" id=\"emailSubject\" class=\"form-control\" value=\"IT Incident Report - Ashtons IT\">\n            </div>\n            <div class=\"form-group\" style=\"margin-bottom: 20px;\">\n                <label for=\"emailMessage\">Additional Message</label>\n                <textarea id=\"emailMessage\" class=\"form-control\" rows=\"4\">Please find attached the incident report for your review. Let me know if you need any additional information.</textarea>\n            </div>\n            <div class=\"modal-footer\">\n                <button class=\"btn btn-outline\" id=\"cancelEmailBtn2\">Cancel</button>\n                <button class=\"btn btn-success\" id=\"sendEmailBtn\">\n                    <i class=\"fas fa-paper-plane\"></i> Send Email\n                </button>\n            </div>\n        </div>\n    </div>\n    \n    <!-- Success Modal -->\n    <div class=\"modal\" id=\"successModal\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <h3><i class=\"fas fa-check-circle\"></i> Success!</h3>\n                <button class=\"close-modal\" id=\"closeSuccessBtn\">&times;</button>\n            </div>\n            <div style=\"padding: 20px; text-align: center;\">\n                <i class=\"fas fa-check-circle fa-4x\" style=\"color: var(--success); margin-bottom: 20px;\"></i>\n                <p id=\"successMessage\" style=\"font-size: 18px; line-height: 1.6;\">\n                    Your incident report has been processed successfully.\n                </p>\n            </div>\n            <div class=\"modal-footer\" style=\"justify-content: center;\">\n                <button class=\"btn btn-primary\" id=\"successOkBtn\">\n                    OK\n                </button>\n            </div>\n        </div>\n    </div>\n    \n    <script>\n        // Set today's date as default\n        document.addEventListener('DOMContentLoaded', function() {\n            const today = new Date().toISOString().split('T')[0];\n            document.getElementById('reportDate').value = today;\n            \n            // Set reported time to 2 hours ago\n            const reportedTime = new Date();\n            reportedTime.setHours(reportedTime.getHours() - 2);\n            const reportedTimeString = reportedTime.toISOString().slice(0, 16);\n            document.getElementById('reportedTime').value = reportedTimeString;\n            \n            // Initialize navigation\n            initNavigation();\n            \n            // Initialize FAQ accordion\n            initFAQ();\n            \n            // Load saved theme if exists\n            const savedTheme = localStorage.getItem('appTheme') || 'blue';\n            document.body.classList.add(`theme-${savedTheme}`);\n            document.getElementById('theme').value = savedTheme;\n        });\n        \n        // Initialize navigation tabs\n        function initNavigation() {\n            // Set first tab as active\n            document.querySelector('.nav-item').classList.add('active');\n            document.getElementById('dashboardContent').classList.add('active');\n            \n            // Add event listeners to all nav items\n            document.querySelectorAll('.nav-item').forEach(item => {\n                item.addEventListener('click', function() {\n                    // Remove active class from all items\n                    document.querySelectorAll('.nav-item').forEach(i => {\n                        i.classList.remove('active');\n                    });\n                    \n                    // Hide all tab contents\n                    document.querySelectorAll('.tab-content').forEach(tab => {\n                        tab.classList.remove('active');\n                    });\n                    \n                    // Add active class to clicked item\n                    this.classList.add('active');\n                    \n                    // Show corresponding tab content\n                    const tabId = this.getAttribute('data-tab');\n                    document.getElementById(tabId + 'Content').classList.add('active');\n                });\n            });\n        }\n        \n        // Initialize FAQ accordion\n        function initFAQ() {\n            const faqItems = document.querySelectorAll('.faq-item');\n            \n            faqItems.forEach(item => {\n                const header = item.querySelector('.report-item');\n                \n                header.addEventListener('click', () => {\n                    // Toggle active class on the FAQ item\n                    item.classList.toggle('active');\n                    \n                    // Close other FAQ items\n                    faqItems.forEach(otherItem => {\n                        if (otherItem !== item) {\n                            otherItem.classList.remove('active');\n                        }\n                    });\n                });\n            });\n        }\n        \n        // Timeline table functions\n        function addTimelineRow() {\n            const tbody = document.getElementById('timelineBody');\n            const newRow = document.createElement('tr');\n            \n            // Get current time for new row\n            const now = new Date();\n            const timeString = now.toTimeString().substring(0,5);\n            \n            newRow.innerHTML = `\n                <td><input type=\"text\" class=\"form-control\" value=\"${timeString}\"></td>\n                <td><input type=\"text\" class=\"form-control\" placeholder=\"Action description\"></td>\n                <td><input type=\"text\" class=\"form-control\" placeholder=\"Engineer name\"></td>\n                <td><input type=\"text\" class=\"form-control\" placeholder=\"Result\"></td>\n                <td><button type=\"button\" class=\"btn btn-danger\" onclick=\"removeTimelineRow(this)\"><i class=\"fas fa-trash\"></i></button></td>\n            `;\n            \n            tbody.appendChild(newRow);\n        }\n        \n        function removeTimelineRow(button) {\n            const row = button.parentNode.parentNode;\n            row.parentNode.removeChild(row);\n        }\n        \n        // Save report to localStorage\n        document.getElementById('saveBtn').addEventListener('click', function() {\n            const formData = getFormData();\n            localStorage.setItem('incidentReportDraft', JSON.stringify(formData));\n            \n            // Show success message\n            document.getElementById('successMessage').textContent = 'Report draft saved successfully! You can load it anytime to continue working.';\n            document.getElementById('successModal').classList.add('active');\n        });\n        \n        // Load report from localStorage\n        document.getElementById('loadBtn').addEventListener('click', function() {\n            const savedData = localStorage.getItem('incidentReportDraft');\n            \n            if (savedData) {\n                const formData = JSON.parse(savedData);\n                setFormData(formData);\n                \n                // Show success message\n                document.getElementById('successMessage').textContent = 'Report draft loaded successfully! You can now continue editing.';\n                document.getElementById('successModal').classList.add('active');\n            } else {\n                alert('No saved draft found. Please save a draft first.');\n            }\n        });\n        \n        // Get all form data as an object\n        function getFormData() {\n            const form = document.getElementById('incidentReportForm');\n            const inputs = form.querySelectorAll('input, textarea, select');\n            const formData = {};\n            \n            inputs.forEach(input => {\n                if (input.type !== 'button') {\n                    formData[input.id] = input.value;\n                }\n            });\n            \n            // Get timeline data\n            const timelineRows = document.querySelectorAll('#timelineBody tr');\n            const timelineData = [];\n            \n            timelineRows.forEach(row => {\n                const cells = row.querySelectorAll('td');\n                timelineData.push({\n                    time: cells[0].querySelector('input').value,\n                    action: cells[1].querySelector('input').value,\n                    engineer: cells[2].querySelector('input').value,\n                    outcome: cells[3].querySelector('input').value\n                });\n            });\n            \n            formData.timeline = timelineData;\n            \n            return formData;\n        }\n        \n        // Set form data from object\n        function setFormData(formData) {\n            for (const key in formData) {\n                if (key === 'timeline') {\n                    // Handle timeline separately\n                    const tbody = document.getElementById('timelineBody');\n                    tbody.innerHTML = '';\n                    \n                    formData.timeline.forEach(item => {\n                        const newRow = document.createElement('tr');\n                        newRow.innerHTML = `\n                            <td><input type=\"text\" class=\"form-control\" value=\"${item.time}\"></td>\n                            <td><input type=\"text\" class=\"form-control\" value=\"${item.action}\"></td>\n                            <td><input type=\"text\" class=\"form-control\" value=\"${item.engineer}\"></td>\n                            <td><input type=\"text\" class=\"form-control\" value=\"${item.outcome}\"></td>\n                            <td><button type=\"button\" class=\"btn btn-danger\" onclick=\"removeTimelineRow(this)\"><i class=\"fas fa-trash\"></i></button></td>\n                        `;\n                        tbody.appendChild(newRow);\n                    });\n                } else {\n                    const element = document.getElementById(key);\n                    if (element) {\n                        element.value = formData[key];\n                    }\n                }\n            }\n        }\n        \n        // Email functionality\n        document.getElementById('emailBtn').addEventListener('click', function() {\n            document.getElementById('emailModal').classList.add('active');\n        });\n        \n        document.getElementById('cancelEmailBtn').addEventListener('click', function() {\n            document.getElementById('emailModal').classList.remove('active');\n        });\n        \n        document.getElementById('cancelEmailBtn2').addEventListener('click', function() {\n            document.getElementById('emailModal').classList.remove('active');\n        });\n        \n        document.getElementById('sendEmailBtn').addEventListener('click', function() {\n            const recipient = document.getElementById('recipientEmail').value;\n            if (!recipient) {\n                alert('Please enter a recipient email address');\n                return;\n            }\n            \n            // Create mailto link with form data\n            const subject = document.getElementById('emailSubject').value;\n            const body = document.getElementById('emailMessage').value;\n            const mailtoLink = `mailto:${recipient}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;\n            \n            // Open default email client\n            window.location.href = mailtoLink;\n            \n            document.getElementById('emailModal').classList.remove('active');\n            document.getElementById('successMessage').textContent = `Incident report has been emailed to ${recipient} successfully!`;\n            document.getElementById('successModal').classList.add('active');\n        });\n        \n        // Export to PDF functionality\n        document.getElementById('exportPdfBtn').addEventListener('click', function() {\n            const { jsPDF } = window.jspdf;\n            const doc = new jsPDF();\n            \n            // Get the form content\n            const formContent = document.getElementById('incidentReportForm');\n            \n            // Use html2canvas to capture the form as an image\n            html2canvas(formContent).then(canvas => {\n                const imgData = canvas.toDataURL('image/png');\n                const imgWidth = doc.internal.pageSize.getWidth() - 20;\n                const imgHeight = (canvas.height * imgWidth) / canvas.width;\n                \n                doc.addImage(imgData, 'PNG', 10, 10, imgWidth, imgHeight);\n                \n                // Save the PDF\n                doc.save('incident-report.pdf');\n                \n                // Show success message\n                document.getElementById('successMessage').textContent = 'Incident report has been exported to PDF successfully!';\n                document.getElementById('successModal').classList.add('active');\n            });\n        });\n        \n        // Submit report\n        document.getElementById('submitReport').addEventListener('click', function() {\n            // In a real application, you would send this to a server\n            const formData = getFormData();\n            console.log('Form submitted:', formData);\n            \n            document.getElementById('successMessage').textContent = 'Incident report submitted successfully! Thank you for using our system.';\n            document.getElementById('successModal').classList.add('active');\n        });\n        \n        // Save settings\n        document.getElementById('saveSettingsBtn').addEventListener('click', function() {\n            const theme = document.getElementById('theme').value;\n            \n            // Remove all theme classes\n            document.body.classList.remove('theme-light', 'theme-dark', 'theme-blue', 'theme-green');\n            // Add selected theme class\n            document.body.classList.add(`theme-${theme}`);\n            \n            // Save to localStorage\n            localStorage.setItem('appTheme', theme);\n            \n            // Show success message\n            document.getElementById('successMessage').textContent = 'Settings saved successfully!';\n            document.getElementById('successModal').classList.add('active');\n        });\n        \n        // Close modals\n        document.getElementById('closeSuccessBtn').addEventListener('click', function() {\n            document.getElementById('successModal').classList.remove('active');\n        });\n        \n        document.getElementById('successOkBtn').addEventListener('click', function() {\n            document.getElementById('successModal').classList.remove('active');\n        });\n    </script>\n</body>\n</html>",
            "versions": [
              {
                "id": "ver-1755650895028",
                "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>IT Incident Reporting Tool | First Technology</title>\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\">\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js\"></script>\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js\"></script>\n    <style>\n        :root {\n            --primary: #1a3a5f;\n            --secondary: #2c5b82;\n            --accent: #4a90e2;\n            --light: #f8f9fa;\n            --dark: #212529;\n            --success: #28a745;\n            --warning: #ffc107;\n            --danger: #dc3545;\n            --info: #17a2b8;\n            --gray: #6c757d;\n            --border: #dee2e6;\n            --card-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\n            --bg-color: white;\n            --text-color: #212529;\n            --form-bg: #f8fafc;\n        }\n        \n        /* Dark Theme */\n        .theme-dark {\n            --primary: #2c3e50;\n            --secondary: #34495e;\n            --accent: #3498db;\n            --light: #34495e;\n            --dark: #ecf0f1;\n            --bg-color: #2c3e50;\n            --text-color: #ecf0f1;\n            --form-bg: #34495e;\n            --border: #4a6278;\n        }\n        \n        /* Blue Theme (default) */\n        .theme-blue {\n            --primary: #1a3a5f;\n            --secondary: #2c5b82;\n            --accent: #4a90e2;\n        }\n        \n        /* Green Theme */\n        .theme-green {\n            --primary: #1e5631;\n            --secondary: #2d7d46;\n            --accent: #4caf50;\n        }\n        \n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n        }\n        \n        body {\n            background: linear-gradient(135deg, #f0f4f8, #e6edf5);\n            color: var(--dark);\n            line-height: 1.6;\n            min-height: 100vh;\n            padding: 20px;\n            background-color: var(--bg-color);\n            color: var(--text-color);\n        }\n        \n        .app-container {\n            max-width: 1200px;\n            margin: 0 auto;\n            background: var(--bg-color);\n            border-radius: 15px;\n            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);\n            overflow: hidden;\n        }\n        \n        /* Header */\n        .header {\n            background: linear-gradient(to right, var(--primary), var(--secondary));\n            color: white;\n            padding: 25px 40px;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            position: relative;\n        }\n        \n        .logo {\n            display: flex;\n            align-items: center;\n            gap: 15px;\n        }\n        \n        .logo-icon {\n            font-size: 32px;\n            color: white;\n        }\n        \n        .logo-text h1 {\n            font-size: 26px;\n            font-weight: 700;\n            letter-spacing: 0.5px;\n        }\n        \n        .logo-text p {\n            font-size: 14px;\n            opacity: 0.9;\n            margin-top: 3px;\n        }\n        \n        .action-buttons {\n            display: flex;\n            gap: 12px;\n        }\n        \n        .btn {\n            padding: 12px 22px;\n            border-radius: 8px;\n            font-weight: 600;\n            cursor: pointer;\n            display: inline-flex;\n            align-items: center;\n            gap: 8px;\n            transition: all 0.3s;\n            border: none;\n            font-size: 15px;\n        }\n        \n        .btn-primary {\n            background-color: white;\n            color: var(--primary);\n            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);\n        }\n        \n        .btn-outline {\n            background-color: transparent;\n            border: 2px solid rgba(255, 255, 255, 0.7);\n            color: white;\n        }\n        \n        .btn-success {\n            background-color: var(--success);\n            color: white;\n        }\n        \n        .btn-danger {\n            background-color: var(--danger);\n            color: white;\n        }\n        \n        .btn:hover {\n            transform: translateY(-3px);\n            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.15);\n        }\n        \n        .btn:active {\n            transform: translateY(-1px);\n        }\n        \n        /* Navigation */\n        .nav-tabs {\n            display: flex;\n            background-color: var(--bg-color);\n            border-bottom: 1px solid var(--border);\n            padding: 0 40px;\n        }\n        \n        .nav-item {\n            padding: 18px 25px;\n            cursor: pointer;\n            position: relative;\n            font-weight: 600;\n            color: var(--gray);\n            transition: all 0.3s;\n        }\n        \n        .nav-item.active {\n            color: var(--primary);\n        }\n        \n        .nav-item.active::after {\n            content: '';\n            position: absolute;\n            bottom: -1px;\n            left: 0;\n            width: 100%;\n            height: 3px;\n            background-color: var(--accent);\n            border-radius: 3px 3px 0 0;\n        }\n        \n        .nav-item:hover {\n            color: var(--primary);\n            background-color: rgba(74, 144, 226, 0.05);\n        }\n        \n        /* Main Content */\n        .main-content {\n            padding: 30px 40px;\n            min-height: 600px;\n        }\n        \n        .tab-content {\n            display: none;\n        }\n        \n        .tab-content.active {\n            display: block;\n        }\n        \n        .form-section {\n            background: var(--bg-color);\n            border-radius: 10px;\n            box-shadow: var(--card-shadow);\n            padding: 30px;\n            margin-bottom: 25px;\n            border: 1px solid var(--border);\n        }\n        \n        .section-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 25px;\n            padding-bottom: 15px;\n            border-bottom: 2px solid rgba(26, 58, 95, 0.1);\n        }\n        \n        .section-header h3 {\n            color: var(--primary);\n            font-weight: 700;\n            font-size: 20px;\n            display: flex;\n            align-items: center;\n            gap: 10px;\n        }\n        \n        .section-header i {\n            color: var(--accent);\n        }\n        \n        .form-row {\n            display: flex;\n            gap: 25px;\n            margin-bottom: 25px;\n            flex-wrap: wrap;\n        }\n        \n        .form-group {\n            flex: 1;\n            min-width: 250px;\n        }\n        \n        .form-group label {\n            display: block;\n            margin-bottom: 10px;\n            font-weight: 600;\n            color: var(--text-color);\n            font-size: 15px;\n        }\n        \n        .form-control {\n            width: 100%;\n            padding: 14px 18px;\n            border: 1px solid var(--border);\n            border-radius: 8px;\n            font-size: 15px;\n            transition: all 0.3s;\n            background-color: var(--form-bg);\n            color: var(--text-color);\n        }\n        \n        .form-control:focus {\n            outline: none;\n            border-color: var(--accent);\n            box-shadow: 0 0 0 4px rgba(74, 144, 226, 0.2);\n            background-color: var(--bg-color);\n        }\n        \n        textarea.form-control {\n            min-height: 140px;\n            resize: vertical;\n        }\n        \n        select.form-control {\n            appearance: none;\n            background-image: url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%236c757d' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10z'/%3E%3C/svg%3E\");\n            background-repeat: no-repeat;\n            background-position: right 15px center;\n            background-size: 12px;\n            padding-right: 40px;\n        }\n        \n        /* Timeline Table */\n        .timeline-table {\n            width: 100%;\n            border-collapse: collapse;\n            margin: 20px 0;\n            border-radius: 8px;\n            overflow: hidden;\n            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);\n        }\n        \n        .timeline-table th {\n            background-color: var(--primary);\n            color: white;\n            padding: 16px 20px;\n            text-align: left;\n            font-weight: 600;\n        }\n        \n        .timeline-table td {\n            padding: 16px 20px;\n            border-bottom: 1px solid var(--border);\n            background-color: var(--bg-color);\n        }\n        \n        .timeline-table tr:nth-child(even) td {\n            background-color: var(--form-bg);\n        }\n        \n        .timeline-table tr:hover td {\n            background-color: #e9f0f9;\n        }\n        \n        .add-row-btn {\n            background-color: var(--success);\n            color: white;\n            border: none;\n            border-radius: 8px;\n            padding: 12px 20px;\n            cursor: pointer;\n            margin-top: 15px;\n            display: inline-flex;\n            align-items: center;\n            gap: 8px;\n            font-weight: 600;\n            transition: all 0.3s;\n        }\n        \n        .add-row-btn:hover {\n            background-color: #218838;\n            transform: translateY(-2px);\n        }\n        \n        /* Status Indicators */\n        .system-status {\n            display: flex;\n            gap: 20px;\n            flex-wrap: wrap;\n            margin: 20px 0;\n        }\n        \n        .status-card {\n            flex: 1;\n            min-width: 250px;\n            background: var(--bg-color);\n            border-radius: 12px;\n            padding: 20px;\n            box-shadow: var(--card-shadow);\n            border-left: 4px solid var(--accent);\n            transition: all 0.3s;\n        }\n        \n        .status-card:hover {\n            transform: translateY(-5px);\n            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);\n        }\n        \n        .status-card h4 {\n            font-size: 16px;\n            margin-bottom: 15px;\n            color: var(--gray);\n            font-weight: 600;\n            display: flex;\n            align-items: center;\n            gap: 8px;\n        }\n        \n        .status-card .status {\n            font-weight: 700;\n            font-size: 17px;\n            padding: 10px 15px;\n            border-radius: 8px;\n            display: inline-block;\n        }\n        \n        .status-resolved {\n            background-color: rgba(40, 167, 69, 0.15);\n            color: var(--success);\n        }\n        \n        .status-in-progress {\n            background-color: rgba(255, 193, 7, 0.15);\n            color: var(--warning);\n        }\n        \n        .status-pending {\n            background-color: rgba(220, 53, 69, 0.15);\n            color: var(--danger);\n        }\n        \n        .status-info {\n            background-color: rgba(23, 162, 184, 0.15);\n            color: var(--info);\n        }\n        \n        /* Footer */\n        .footer {\n            margin-top: 40px;\n            padding: 25px 40px;\n            background-color: var(--form-bg);\n            border-top: 1px solid var(--border);\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            flex-wrap: wrap;\n            gap: 20px;\n        }\n        \n        .footer-text {\n            color: var(--gray);\n            font-size: 14px;\n        }\n        \n        .footer-links {\n            display: flex;\n            gap: 15px;\n        }\n        \n        .footer-link {\n            color: var(--primary);\n            text-decoration: none;\n            font-weight: 600;\n            font-size: 14px;\n            transition: all 0.3s;\n        }\n        \n        .footer-link:hover {\n            color: var(--accent);\n            text-decoration: underline;\n        }\n        \n        /* Modal */\n        .modal {\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background-color: rgba(0, 0, 0, 0.7);\n            z-index: 1000;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            opacity: 0;\n            visibility: hidden;\n            transition: all 0.3s;\n        }\n        \n        .modal.active {\n            opacity: 1;\n            visibility: visible;\n        }\n        \n        .modal-content {\n            background: var(--bg-color);\n            border-radius: 15px;\n            width: 100%;\n            max-width: 500px;\n            padding: 30px;\n            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.25);\n            transform: translateY(-30px);\n            transition: all 0.4s;\n        }\n        \n        .modal.active .modal-content {\n            transform: translateY(0);\n        }\n        \n        .modal-header {\n            margin-bottom: 25px;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n        \n        .modal-header h3 {\n            color: var(--primary);\n            font-size: 24px;\n            font-weight: 700;\n        }\n        \n        .close-modal {\n            background: none;\n            border: none;\n            font-size: 24px;\n            color: var(--gray);\n            cursor: pointer;\n            transition: all 0.3s;\n        }\n        \n        .close-modal:hover {\n            color: var(--danger);\n            transform: rotate(90deg);\n        }\n        \n        .modal-footer {\n            display: flex;\n            justify-content: flex-end;\n            gap: 15px;\n            margin-top: 25px;\n        }\n        \n        /* Dashboard Styles */\n        .dashboard-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n            gap: 25px;\n            margin-top: 20px;\n        }\n        \n        .dashboard-card {\n            background: var(--bg-color);\n            border-radius: 12px;\n            padding: 25px;\n            box-shadow: var(--card-shadow);\n            border-top: 4px solid var(--accent);\n            transition: all 0.3s;\n        }\n        \n        .dashboard-card:hover {\n            transform: translateY(-5px);\n            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);\n        }\n        \n        .dashboard-card h3 {\n            color: var(--primary);\n            margin-bottom: 15px;\n            display: flex;\n            align-items: center;\n            gap: 10px;\n        }\n        \n        .stat-number {\n            font-size: 32px;\n            font-weight: 700;\n            color: var(--primary);\n            margin: 10px 0;\n        }\n        \n        .stat-label {\n            color: var(--gray);\n            font-weight: 600;\n        }\n        \n        .recent-reports {\n            margin-top: 20px;\n        }\n        \n        .report-item {\n            padding: 15px;\n            border-bottom: 1px solid var(--border);\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n        \n        .report-item:last-child {\n            border-bottom: none;\n        }\n        \n        .report-title {\n            font-weight: 600;\n            color: var(--text-color);\n        }\n        \n        .report-date {\n            color: var(--gray);\n            font-size: 14px;\n        }\n        \n        /* FAQ Accordion */\n        .faq-content {\n            display: none;\n            padding: 15px;\n            background-color: var(--form-bg);\n            border-radius: 0 0 8px 8px;\n            margin-top: -10px;\n            border: 1px solid var(--border);\n            border-top: none;\n        }\n        \n        .faq-item.active .faq-content {\n            display: block;\n        }\n        \n        .faq-item.active .fa-chevron-down {\n            transform: rotate(180deg);\n        }\n        \n        /* Responsive */\n        @media (max-width: 992px) {\n            .header {\n                flex-direction: column;\n                align-items: flex-start;\n                gap: 25px;\n            }\n            \n            .action-buttons {\n                width: 100%;\n                flex-wrap: wrap;\n            }\n            \n            .btn {\n                flex: 1;\n                justify-content: center;\n            }\n        }\n        \n        @media (max-width: 768px) {\n            .header, .main-content, .footer {\n                padding: 20px;\n            }\n            \n            .nav-tabs {\n                padding: 0 20px;\n                overflow-x: auto;\n            }\n            \n            .nav-item {\n                white-space: nowrap;\n                padding: 15px 20px;\n            }\n            \n            .form-section {\n                padding: 20px;\n            }\n            \n            .system-status {\n                flex-direction: column;\n            }\n        }\n        \n        @media (max-width: 576px) {\n            .form-row {\n                flex-direction: column;\n                gap: 15px;\n            }\n            \n            .modal-content {\n                padding: 20px;\n            }\n            \n            .btn {\n                padding: 10px 15px;\n                font-size: 14px;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"app-container\">\n        <!-- Header -->\n        <div class=\"header\">\n            <div class=\"logo\">\n                <div class=\"logo-icon\">\n                    <i class=\"fas fa-bug fa-2x\"></i>\n                </div>\n                <div class=\"logo-text\">\n                    <h1>IT Incident Reporting Tool</h1>\n                    <p>Professional Incident Management Solution</p>\n                </div>\n            </div>\n            <div class=\"action-buttons\">\n                <button class=\"btn btn-outline\" id=\"saveBtn\">\n                    <i class=\"fas fa-save\"></i> Save Draft\n                </button>\n                <button class=\"btn btn-outline\" id=\"loadBtn\">\n                    <i class=\"fas fa-folder-open\"></i> Load Draft\n                </button>\n                <button class=\"btn btn-primary\" id=\"exportPdfBtn\">\n                    <i class=\"fas fa-file-pdf\"></i> Export PDF\n                </button>\n                <button class=\"btn btn-success\" id=\"emailBtn\">\n                    <i class=\"fas fa-envelope\"></i> Email Report\n                </button>\n            </div>\n        </div>\n        \n        <!-- Navigation -->\n        <div class=\"nav-tabs\">\n            <div class=\"nav-item active\" data-tab=\"dashboard\">\n                <i class=\"fas fa-home\"></i> Dashboard\n            </div>\n            <div class=\"nav-item\" data-tab=\"new-report\">\n                <i class=\"fas fa-file-alt\"></i> New Report\n            </div>\n            <div class=\"nav-item\" data-tab=\"history\">\n                <i class=\"fas fa-history\"></i> Report History\n            </div>\n            <div class=\"nav-item\" data-tab=\"settings\">\n                <i class=\"fas fa-cog\"></i> Settings\n            </div>\n            <div class=\"nav-item\" data-tab=\"help\">\n                <i class=\"fas fa-question-circle\"></i> Help & Support\n            </div>\n        </div>\n        \n        <!-- Main Content -->\n        <div class=\"main-content\">\n            <!-- Dashboard Tab -->\n            <div id=\"dashboardContent\" class=\"tab-content active\">\n                <div class=\"form-section\">\n                    <div class=\"section-header\">\n                        <h3><i class=\"fas fa-chart-line\"></i> Incident Dashboard</h3>\n                    </div>\n                    \n                    <div class=\"dashboard-grid\">\n                        <div class=\"dashboard-card\">\n                            <h3><i class=\"fas fa-exclamation-circle\"></i> Open Incidents</h3>\n                            <div class=\"stat-number\">12</div>\n                            <div class=\"stat-label\">Active issues requiring attention</div>\n                        </div>\n                        \n                        <div class=\"dashboard-card\">\n                            <h3><i class=\"fas fa-check-circle\"></i> Resolved This Week</h3>\n                            <div class=\"stat-number\">24</div>\n                            <div class=\"stat-label\">Issues successfully resolved</div>\n                        </div>\n                        \n                        <div class=\"dashboard-card\">\n                            <h3><i class=\"fas fa-clock\"></i> Average Resolution Time</h3>\n                            <div class=\"stat-number\">18.5h</div>\n                            <div class=\"stat-label\">From report to resolution</div>\n                        </div>\n                        \n                        <div class=\"dashboard-card\">\n                            <h3><i class=\"fas fa-user-shield\"></i> Your Reports</h3>\n                            <div class=\"stat-number\">7</div>\n                            <div class=\"stat-label\">Incidents managed by you</div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-section\">\n                        <h3><i class=\"fas fa-list\"></i> Recent Reports</h3>\n                        <div class=\"recent-reports\">\n                            <div class=\"report-item\">\n                                <div>\n                                    <div class=\"report-title\">SQL Service Failure on ASTW-APP04</div>\n                                    <div class=\"report-date\">Priority: High ‚Ä¢ Created: 2023-11-15</div>\n                                </div>\n                                <div>\n                                    <span class=\"status status-in-progress\">In Progress</span>\n                                </div>\n                            </div>\n                            <div class=\"report-item\">\n                                <div>\n                                    <div class=\"report-title\">Network Connectivity Issues</div>\n                                    <div class=\"report-date\">Priority: Medium ‚Ä¢ Created: 2023-11-14</div>\n                                </div>\n                                <div>\n                                    <span class=\"status status-resolved\">Resolved</span>\n                                </div>\n                            </div>\n                            <div class=\"report-item\">\n                                <div>\n                                    <div class=\"report-title\">Email Server Outage</div>\n                                    <div class=\"report-date\">Priority: Critical ‚Ä¢ Created: 2023-11-12</div>\n                                </div>\n                                <div>\n                                    <span class=\"status status-resolved\">Resolved</span>\n                                </div>\n                            </div>\n                            <div class=\"report-item\">\n                                <div>\n                                    <div class=\"report-title\">Firewall Configuration Error</div>\n                                    <div class=\"report-date\">Priority: High ‚Ä¢ Created: 2023-11-10</div>\n                                </div>\n                                <div>\n                                    <span class=\"status status-pending\">Pending</span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            \n            <!-- New Report Tab -->\n            <div id=\"newReportContent\" class=\"tab-content\">\n                <form id=\"incidentReportForm\">\n                    <!-- Ticket & Basic Info -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-info-circle\"></i> Incident Information</h3>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"ticketNumber\"><i class=\"fas fa-ticket-alt\"></i> Ticket/Incident Number</label>\n                                <input type=\"text\" id=\"ticketNumber\" class=\"form-control\" placeholder=\"INC-2023-001\" value=\"INC-2023-001\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"clientName\"><i class=\"fas fa-building\"></i> Client Name</label>\n                                <input type=\"text\" id=\"clientName\" class=\"form-control\" placeholder=\"Ashtons IT\" value=\"Ashtons IT\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"reportDate\"><i class=\"fas fa-calendar\"></i> Report Date</label>\n                                <input type=\"date\" id=\"reportDate\" class=\"form-control\">\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"priority\"><i class=\"fas fa-exclamation-triangle\"></i> Priority</label>\n                                <select id=\"priority\" class=\"form-control\">\n                                    <option value=\"HIGH\">High</option>\n                                    <option value=\"MEDIUM\">Medium</option>\n                                    <option value=\"LOW\">Low</option>\n                                </select>\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"status\"><i class=\"fas fa-sync\"></i> Current Status</label>\n                                <select id=\"status\" class=\"form-control\">\n                                    <option value=\"RESOLVED\">Resolved</option>\n                                    <option value=\"IN_PROGRESS\">In Progress</option>\n                                    <option value=\"PENDING\">Pending</option>\n                                </select>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Executive Summary -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-chart-line\"></i> Executive Summary</h3>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"issue\"><i class=\"fas fa-exclamation-circle\"></i> Issue Description</label>\n                                <textarea id=\"issue\" class=\"form-control\">SQL services failing to start on server ASTW-APP04, affecting Solcase application functionality</textarea>\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"impact\"><i class=\"fas fa-bolt\"></i> Business Impact</label>\n                                <textarea id=\"impact\" class=\"form-control\">Critical Solcase operations (including reporting and batch processing) impaired; domain admin credentials compromised.</textarea>\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"rootCause\"><i class=\"fas fa-search\"></i> Root Cause</label>\n                                <textarea id=\"rootCause\" class=\"form-control\">Domain administrator account compromise and misuse for SQL services.</textarea>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Incident Details -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-clipboard-list\"></i> Incident Details</h3>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"reportedTime\"><i class=\"fas fa-clock\"></i> Reported Time</label>\n                                <input type=\"datetime-local\" id=\"reportedTime\" class=\"form-control\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"reportedBy\"><i class=\"fas fa-user\"></i> Reported By</label>\n                                <input type=\"text\" id=\"reportedBy\" class=\"form-control\" placeholder=\"Contact name/role\" value=\"Josh Teague (Ashtons IT)\">\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"affectedSystems\"><i class=\"fas fa-server\"></i> Affected Systems</label>\n                                <textarea id=\"affectedSystems\" class=\"form-control\">ASTW-APP04 (SQL Server), Solcase application</textarea>\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"symptoms\"><i class=\"fas fa-stethoscope\"></i> Symptoms</label>\n                                <textarea id=\"symptoms\" class=\"form-control\">SQL services unresponsive; scheduled tasks failing; domain admin account locked.</textarea>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Investigation Timeline -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-history\"></i> Investigation Timeline</h3>\n                        </div>\n                        <table class=\"timeline-table\">\n                            <thead>\n                                <tr>\n                                    <th>Time</th>\n                                    <th>Action Taken</th>\n                                    <th>Engineer</th>\n                                    <th>Outcome</th>\n                                    <th></th>\n                                </tr>\n                            </thead>\n                            <tbody id=\"timelineBody\">\n                                <tr>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"15:31\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Identified domain admin account lockout\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Josh Teague\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Suspicious activity detected\"></td>\n                                    <td><button type=\"button\" class=\"btn btn-danger\" onclick=\"removeTimelineRow(this)\"><i class=\"fas fa-trash\"></i></button></td>\n                                </tr>\n                                <tr>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"15:33\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Detected unauthorized password change\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Nishen Harichunder\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Credentials compromised\"></td>\n                                    <td><button type=\"button\" class=\"btn btn-danger\" onclick=\"removeTimelineRow(this)\"><i class=\"fas fa-trash\"></i></button></td>\n                                </tr>\n                                <tr>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"15:34\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Recommended dedicated SQL service account\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Nishen Harichunder\"></td>\n                                    <td><input type=\"text\" class=\"form-control\" value=\"Plan for credential remediation\"></td>\n                                    <td><button type=\"button\" class=\"btn btn-danger\" onclick=\"removeTimelineRow(this)\"><i class=\"fas fa-trash\"></i></button></td>\n                                </tr>\n                            </tbody>\n                        </table>\n                        <button type=\"button\" class=\"add-row-btn\" onclick=\"addTimelineRow()\">\n                            <i class=\"fas fa-plus\"></i> Add Timeline Event\n                        </button>\n                    </div>\n                    \n                    <!-- Resolution Actions -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-tools\"></i> Resolution Actions</h3>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"actionsTaken\"><i class=\"fas fa-hammer\"></i> Actions Implemented</label>\n                                <textarea id=\"actionsTaken\" class=\"form-control\">1. Service Account Migration\n- Created sql_svc_progressDB@internal.ashtongraham.co.uk\n- Updated all SQL services on ASTW-APP04\n- SQL services started successfully\n\n2. Scheduled Task Remediation\n- Updated 4 tasks (RapidRTA, Claims processing, Notification retrieval, Report spooling)\n- Tasks reconfigured; manual execution required for missed jobs</textarea>\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"securityImprovements\"><i class=\"fas fa-shield-alt\"></i> Security Improvements</label>\n                                <textarea id=\"securityImprovements\" class=\"form-control\">- Eliminated Domain Admin Usage\n- Updated service account details in PassPortal\n- Dedicated Service Account for SQL operations\n- Implemented alerting for domain admin account lockouts</textarea>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Current Status -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-chart-bar\"></i> Current Status</h3>\n                        </div>\n                        <div class=\"system-status\">\n                            <div class=\"status-card\">\n                                <h4><i class=\"fas fa-database\"></i> SQL Services</h4>\n                                <div class=\"status status-resolved\">\n                                    <i class=\"fas fa-check-circle\"></i> Running with dedicated service account\n                                </div>\n                            </div>\n                            <div class=\"status-card\">\n                                <h4><i class=\"fas fa-window-restore\"></i> Application</h4>\n                                <div class=\"status status-in-progress\">\n                                    <i class=\"fas fa-exclamation-triangle\"></i> May require server reboot\n                                </div>\n                            </div>\n                            <div class=\"status-card\">\n                                <h4><i class=\"fas fa-tasks\"></i> Scheduled Tasks</h4>\n                                <div class=\"status status-info\">\n                                    <i class=\"fas fa-clipboard-list\"></i> Updated but may need manual execution\n                                </div>\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"outstandingActions\"><i class=\"fas fa-list-check\"></i> Outstanding Actions</label>\n                                <textarea id=\"outstandingActions\" class=\"form-control\">1. Server Reboot (ASTW-APP04)\n- Reboot to flush credential cache\n- Responsible: Steve (Approval Pending)\n\n2. Domain-Wide Security Audit\n- Scan all servers for services using domain admin accounts\n- Responsible: Oliver Govender (Next 48 hours)\n\n3. Password Change Investigation\n- Determine who changed domain admin password and why\n- Responsible: Ashtons IT Security Team (High priority)</textarea>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Recommendations -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-lightbulb\"></i> Recommendations</h3>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"immediateRecs\"><i class=\"fas fa-bolt\"></i> Immediate Recommendations (24-48 Hours)</label>\n                                <textarea id=\"immediateRecs\" class=\"form-control\">1. Implement Domain Admin Lockout Alerts\n- Configure SIEM/Sentinel rules for real-time detection\n\n2. Manual Task Execution\n- Execute backlog from failed scheduled jobs\n- Validate outputs post-execution</textarea>\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"longTermRecs\"><i class=\"fas fa-chart-line\"></i> Long-term Improvements (30-90 Days)</label>\n                                <textarea id=\"longTermRecs\" class=\"form-control\">1. Deploy Group Managed Service Accounts (gMSA)\n- Automate password management for service accounts\n- Eliminate manual credential rotation\n\n2. Privileged Access Audit Framework\n- Quarterly reviews of service account dependencies\n- Implement automated scanning tools</textarea>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Contact Information -->\n                    <div class=\"form-section\">\n                        <div class=\"section-header\">\n                            <h3><i class=\"fas fa-address-card\"></i> Contact Information</h3>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"engineerName\"><i class=\"fas fa-user-tie\"></i> Primary Engineer</label>\n                                <input type=\"text\" id=\"engineerName\" class=\"form-control\" value=\"Nishen Harichunder\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"engineerEmail\"><i class=\"fas fa-envelope\"></i> Email</label>\n                                <input type=\"email\" id=\"engineerEmail\" class=\"form-control\" placeholder=\"engineer@example.com\" value=\"nishen@firsttech.com\">\n                            </div>\n                        </div>\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"engineerPhone\"><i class=\"fas fa-phone\"></i> Mobile</label>\n                                <input type=\"tel\" id=\"engineerPhone\" class=\"form-control\" placeholder=\"+27 123 456 789\" value=\"+27 123 456 789\">\n                            </div>\n                            <div class=\"form-group\">\n                                <label for=\"availability\"><i class=\"fas fa-calendar-check\"></i> Availability</label>\n                                <input type=\"text\" id=\"availability\" class=\"form-control\" placeholder=\"08:00-17:00 SAST (Mon-Fri)\" value=\"08:00-17:00 SAST (Mon-Fri)\">\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-section\">\n                        <button type=\"button\" class=\"btn btn-primary\" id=\"submitReport\" style=\"width: 100%; padding: 16px; font-size: 17px; font-weight: 600;\">\n                            <i class=\"fas fa-paper-plane\"></i> Submit Final Report\n                        </button>\n                    </div>\n                </form>\n            </div>\n            \n            <!-- Report History Tab -->\n            <div id=\"historyContent\" class=\"tab-content\">\n                <div class=\"form-section\">\n                    <div class=\"section-header\">\n                        <h3><i class=\"fas fa-history\"></i> Report History</h3>\n                    </div>\n                    \n                    <div class=\"recent-reports\">\n                        <div class=\"report-item\">\n                            <div>\n                                <div class=\"report-title\">Database Connection Failure</div>\n                                <div class=\"report-date\">Created: 2023-11-14 ‚Ä¢ Priority: High</div>\n                            </div>\n                            <div>\n                                <span class=\"status status-resolved\">Resolved</span>\n                            </div>\n                        </div>\n                        <div class=\"report-item\">\n                            <div>\n                                <div class=\"report-title\">Firewall Configuration Error</div>\n                                <div class=\"report-date\">Created: 2023-11-12 ‚Ä¢ Priority: Critical</div>\n                            </div>\n                            <div>\n                                <span class=\"status status-resolved\">Resolved</span>\n                            </div>\n                        </div>\n                        <div class=\"report-item\">\n                            <div>\n                                <div class=\"report-title\">Email Server Outage</div>\n                                <div class=\"report-date\">Created: 2023-11-10 ‚Ä¢ Priority: High</div>\n                            </div>\n                            <div>\n                                <span class=\"status status-resolved\">Resolved</span>\n                            </div>\n                        </div>\n                        <div class=\"report-item\">\n                            <div>\n                                <div class=\"report-title\">Network Switch Failure</div>\n                                <div class=\"report-date\">Created: 2023-11-08 ‚Ä¢ Priority: Medium</div>\n                            </div>\n                            <div>\n                                <span class=\"status status-resolved\">Resolved</span>\n                            </div>\n                        </div>\n                        <div class=\"report-item\">\n                            <div>\n                                <div class=\"report-title\">Backup System Failure</div>\n                                <div class=\"report-date\">Created: 2023-11-05 ‚Ä¢ Priority: High</div>\n                            </div>\n                            <div>\n                                <span class=\"status status-resolved\">Resolved</span>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div style=\"margin-top: 30px; text-align: center;\">\n                        <button class=\"btn btn-outline\">\n                            <i class=\"fas fa-arrow-left\"></i> Previous\n                        </button>\n                        <span style=\"margin: 0 15px; font-weight: 600;\">Page 1 of 3</span>\n                        <button class=\"btn btn-outline\">\n                            Next <i class=\"fas fa-arrow-right\"></i>\n                        </button>\n                    </div>\n                </div>\n            </div>\n            \n            <!-- Settings Tab -->\n            <div id=\"settingsContent\" class=\"tab-content\">\n                <div class=\"form-section\">\n                    <div class=\"section-header\">\n                        <h3><i class=\"fas fa-cog\"></i> Application Settings</h3>\n                    </div>\n                    \n                    <div class=\"form-row\">\n                        <div class=\"form-group\">\n                            <label for=\"companyName\"><i class=\"fas fa-building\"></i> Company Name</label>\n                            <input type=\"text\" id=\"companyName\" class=\"form-control\" value=\"First Technology KZN (Pty) Ltd\">\n                        </div>\n                        <div class=\"form-group\">\n                            <label for=\"defaultEngineer\"><i class=\"fas fa-user-tie\"></i> Default Engineer</label>\n                            <input type=\"text\" id=\"defaultEngineer\" class=\"form-control\" value=\"Nishen Harichunder\">\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-row\">\n                        <div class=\"form-group\">\n                            <label for=\"emailSignature\"><i class=\"fas fa-signature\"></i> Email Signature</label>\n                            <textarea id=\"emailSignature\" class=\"form-control\">Best regards,\nFirst Technology Support Team\nsupport@firsttech.com\n+27 123 456 789</textarea>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-row\">\n                        <div class=\"form-group\">\n                            <label for=\"autoSave\"><i class=\"fas fa-save\"></i> Auto-save Interval</label>\n                            <select id=\"autoSave\" class=\"form-control\">\n                                <option value=\"5\">Every 5 minutes</option>\n                                <option value=\"10\" selected>Every 10 minutes</option>\n                                <option value=\"15\">Every 15 minutes</option>\n                                <option value=\"30\">Every 30 minutes</option>\n                                <option value=\"0\">Disabled</option>\n                            </select>\n                        </div>\n                        <div class=\"form-group\">\n                            <label for=\"theme\"><i class=\"fas fa-palette\"></i> Theme</label>\n                            <select id=\"theme\" class=\"form-control\">\n                                <option value=\"light\">Light Theme</option>\n                                <option value=\"dark\">Dark Theme</option>\n                                <option value=\"blue\" selected>Blue Theme</option>\n                                <option value=\"green\">Green Theme</option>\n                            </select>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-section\">\n                        <button type=\"button\" class=\"btn btn-primary\" id=\"saveSettingsBtn\" style=\"width: 100%; padding: 16px; font-size: 17px; font-weight: 600;\">\n                            <i class=\"fas fa-save\"></i> Save Settings\n                        </button>\n                    </div>\n                </div>\n            </div>\n            \n            <!-- Help & Support Tab -->\n            <div id=\"helpContent\" class=\"tab-content\">\n                <div class=\"form-section\">\n                    <div class=\"section-header\">\n                        <h3><i class=\"fas fa-question-circle\"></i> Help & Support</h3>\n                    </div>\n                    \n                    <div class=\"system-status\">\n                        <div class=\"status-card\">\n                            <h4><i class=\"fas fa-book\"></i> Documentation</h4>\n                            <p>Access our comprehensive user guides and documentation to learn how to use all features of the Incident Reporting Tool.</p>\n                            <button class=\"btn btn-outline\" style=\"margin-top: 15px;\">\n                                <i class=\"fas fa-download\"></i> Download User Guide\n                            </button>\n                        </div>\n                        <div class=\"status-card\">\n                            <h4><i class=\"fas fa-video\"></i> Video Tutorials</h4>\n                            <p>Watch step-by-step video tutorials that demonstrate how to create, manage, and export incident reports.</p>\n                            <button class=\"btn btn-outline\" style=\"margin-top: 15px;\">\n                                <i class=\"fas fa-play-circle\"></i> View Tutorials\n                            </button>\n                        </div>\n                        <div class=\"status-card\">\n                            <h4><i class=\"fas fa-headset\"></i> Contact Support</h4>\n                            <p>Our support team is available to assist you with any questions or issues you may encounter.</p>\n                            <div style=\"margin-top: 15px;\">\n                                <p><i class=\"fas fa-envelope\"></i> support@firsttech.com</p>\n                                <p><i class=\"fas fa-phone\"></i> +27 123 456 789</p>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div class=\"form-section\">\n                        <h3><i class=\"fas fa-comments\"></i> Frequently Asked Questions</h3>\n                        <div class=\"recent-reports\" id=\"faqContainer\">\n                            <div class=\"report-item faq-item\">\n                                <div>\n                                    <div class=\"report-title\">How do I save a draft of my report?</div>\n                                </div>\n                                <div>\n                                    <i class=\"fas fa-chevron-down\"></i>\n                                </div>\n                                <div class=\"faq-content\">\n                                    <p>To save a draft of your report, click the \"Save Draft\" button in the top right corner of the application. This will save your current progress to your browser's local storage. You can later load this draft by clicking the \"Load Draft\" button.</p>\n                                </div>\n                            </div>\n                            <div class=\"report-item faq-item\">\n                                <div>\n                                    <div class=\"report-title\">Can I export reports to PDF?</div>\n                                </div>\n                                <div>\n                                    <i class=\"fas fa-chevron-down\"></i>\n                                </div>\n                                <div class=\"faq-content\">\n                                    <p>Yes, you can export your reports to PDF by clicking the \"Export PDF\" button in the top right corner. This will generate a PDF version of your current report that you can save to your computer or print.</p>\n                                </div>\n                            </div>\n                            <div class=\"report-item faq-item\">\n                                <div>\n                                    <div class=\"report-title\">How do I change my account settings?</div>\n                                </div>\n                                <div>\n                                    <i class=\"fas fa-chevron-down\"></i>\n                                </div>\n                                <div class=\"faq-content\">\n                                    <p>Account settings can be changed in the \"Settings\" tab. Here you can update your default engineer information, company details, email signature, and application preferences like theme and auto-save interval.</p>\n                                </div>\n                            </div>\n                            <div class=\"report-item faq-item\">\n                                <div>\n                                    <div class=\"report-title\">Where can I find my previously submitted reports?</div>\n                                </div>\n                                <div>\n                                    <i class=\"fas fa-chevron-down\"></i>\n                                </div>\n                                <div class=\"faq-content\">\n                                    <p>All your previously submitted reports can be found in the \"Report History\" tab. This section displays a list of all your past reports with their status, priority, and creation date.</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            \n            <div class=\"footer\">\n                <div class=\"footer-text\">\n                    First Technology KZN (Pty) Ltd | Incident Reporting Tool v2.1\n                </div>\n                <div class=\"footer-links\">\n                    <a href=\"#\" class=\"footer-link\">Privacy Policy</a>\n                    <a href=\"#\" class=\"footer-link\">Terms of Service</a>\n                    <a href=\"#\" class=\"footer-link\">Contact Support</a>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    <!-- Email Modal -->\n    <div class=\"modal\" id=\"emailModal\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <h3><i class=\"fas fa-envelope\"></i> Email Incident Report</h3>\n                <button class=\"close-modal\" id=\"cancelEmailBtn\">&times;</button>\n            </div>\n            <div class=\"form-group\" style=\"margin-bottom: 20px;\">\n                <label for=\"recipientEmail\">Recipient Email</label>\n                <input type=\"email\" id=\"recipientEmail\" class=\"form-control\" placeholder=\"recipient@example.com\" value=\"manager@ashtons.com\">\n            </div>\n            <div class=\"form-group\" style=\"margin-bottom: 20px;\">\n                <label for=\"emailSubject\">Subject</label>\n                <input type=\"text\" id=\"emailSubject\" class=\"form-control\" value=\"IT Incident Report - Ashtons IT\">\n            </div>\n            <div class=\"form-group\" style=\"margin-bottom: 20px;\">\n                <label for=\"emailMessage\">Additional Message</label>\n                <textarea id=\"emailMessage\" class=\"form-control\" rows=\"4\">Please find attached the incident report for your review. Let me know if you need any additional information.</textarea>\n            </div>\n            <div class=\"modal-footer\">\n                <button class=\"btn btn-outline\" id=\"cancelEmailBtn2\">Cancel</button>\n                <button class=\"btn btn-success\" id=\"sendEmailBtn\">\n                    <i class=\"fas fa-paper-plane\"></i> Send Email\n                </button>\n            </div>\n        </div>\n    </div>\n    \n    <!-- Success Modal -->\n    <div class=\"modal\" id=\"successModal\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <h3><i class=\"fas fa-check-circle\"></i> Success!</h3>\n                <button class=\"close-modal\" id=\"closeSuccessBtn\">&times;</button>\n            </div>\n            <div style=\"padding: 20px; text-align: center;\">\n                <i class=\"fas fa-check-circle fa-4x\" style=\"color: var(--success); margin-bottom: 20px;\"></i>\n                <p id=\"successMessage\" style=\"font-size: 18px; line-height: 1.6;\">\n                    Your incident report has been processed successfully.\n                </p>\n            </div>\n            <div class=\"modal-footer\" style=\"justify-content: center;\">\n                <button class=\"btn btn-primary\" id=\"successOkBtn\">\n                    OK\n                </button>\n            </div>\n        </div>\n    </div>\n    \n    <script>\n        // Set today's date as default\n        document.addEventListener('DOMContentLoaded', function() {\n            const today = new Date().toISOString().split('T')[0];\n            document.getElementById('reportDate').value = today;\n            \n            // Set reported time to 2 hours ago\n            const reportedTime = new Date();\n            reportedTime.setHours(reportedTime.getHours() - 2);\n            const reportedTimeString = reportedTime.toISOString().slice(0, 16);\n            document.getElementById('reportedTime').value = reportedTimeString;\n            \n            // Initialize navigation\n            initNavigation();\n            \n            // Initialize FAQ accordion\n            initFAQ();\n            \n            // Load saved theme if exists\n            const savedTheme = localStorage.getItem('appTheme') || 'blue';\n            document.body.classList.add(`theme-${savedTheme}`);\n            document.getElementById('theme').value = savedTheme;\n        });\n        \n        // Initialize navigation tabs\n        function initNavigation() {\n            // Set first tab as active\n            document.querySelector('.nav-item').classList.add('active');\n            document.getElementById('dashboardContent').classList.add('active');\n            \n            // Add event listeners to all nav items\n            document.querySelectorAll('.nav-item').forEach(item => {\n                item.addEventListener('click', function() {\n                    // Remove active class from all items\n                    document.querySelectorAll('.nav-item').forEach(i => {\n                        i.classList.remove('active');\n                    });\n                    \n                    // Hide all tab contents\n                    document.querySelectorAll('.tab-content').forEach(tab => {\n                        tab.classList.remove('active');\n                    });\n                    \n                    // Add active class to clicked item\n                    this.classList.add('active');\n                    \n                    // Show corresponding tab content\n                    const tabId = this.getAttribute('data-tab');\n                    document.getElementById(tabId + 'Content').classList.add('active');\n                });\n            });\n        }\n        \n        // Initialize FAQ accordion\n        function initFAQ() {\n            const faqItems = document.querySelectorAll('.faq-item');\n            \n            faqItems.forEach(item => {\n                const header = item.querySelector('.report-item');\n                \n                header.addEventListener('click', () => {\n                    // Toggle active class on the FAQ item\n                    item.classList.toggle('active');\n                    \n                    // Close other FAQ items\n                    faqItems.forEach(otherItem => {\n                        if (otherItem !== item) {\n                            otherItem.classList.remove('active');\n                        }\n                    });\n                });\n            });\n        }\n        \n        // Timeline table functions\n        function addTimelineRow() {\n            const tbody = document.getElementById('timelineBody');\n            const newRow = document.createElement('tr');\n            \n            // Get current time for new row\n            const now = new Date();\n            const timeString = now.toTimeString().substring(0,5);\n            \n            newRow.innerHTML = `\n                <td><input type=\"text\" class=\"form-control\" value=\"${timeString}\"></td>\n                <td><input type=\"text\" class=\"form-control\" placeholder=\"Action description\"></td>\n                <td><input type=\"text\" class=\"form-control\" placeholder=\"Engineer name\"></td>\n                <td><input type=\"text\" class=\"form-control\" placeholder=\"Result\"></td>\n                <td><button type=\"button\" class=\"btn btn-danger\" onclick=\"removeTimelineRow(this)\"><i class=\"fas fa-trash\"></i></button></td>\n            `;\n            \n            tbody.appendChild(newRow);\n        }\n        \n        function removeTimelineRow(button) {\n            const row = button.parentNode.parentNode;\n            row.parentNode.removeChild(row);\n        }\n        \n        // Save report to localStorage\n        document.getElementById('saveBtn').addEventListener('click', function() {\n            const formData = getFormData();\n            localStorage.setItem('incidentReportDraft', JSON.stringify(formData));\n            \n            // Show success message\n            document.getElementById('successMessage').textContent = 'Report draft saved successfully! You can load it anytime to continue working.';\n            document.getElementById('successModal').classList.add('active');\n        });\n        \n        // Load report from localStorage\n        document.getElementById('loadBtn').addEventListener('click', function() {\n            const savedData = localStorage.getItem('incidentReportDraft');\n            \n            if (savedData) {\n                const formData = JSON.parse(savedData);\n                setFormData(formData);\n                \n                // Show success message\n                document.getElementById('successMessage').textContent = 'Report draft loaded successfully! You can now continue editing.';\n                document.getElementById('successModal').classList.add('active');\n            } else {\n                alert('No saved draft found. Please save a draft first.');\n            }\n        });\n        \n        // Get all form data as an object\n        function getFormData() {\n            const form = document.getElementById('incidentReportForm');\n            const inputs = form.querySelectorAll('input, textarea, select');\n            const formData = {};\n            \n            inputs.forEach(input => {\n                if (input.type !== 'button') {\n                    formData[input.id] = input.value;\n                }\n            });\n            \n            // Get timeline data\n            const timelineRows = document.querySelectorAll('#timelineBody tr');\n            const timelineData = [];\n            \n            timelineRows.forEach(row => {\n                const cells = row.querySelectorAll('td');\n                timelineData.push({\n                    time: cells[0].querySelector('input').value,\n                    action: cells[1].querySelector('input').value,\n                    engineer: cells[2].querySelector('input').value,\n                    outcome: cells[3].querySelector('input').value\n                });\n            });\n            \n            formData.timeline = timelineData;\n            \n            return formData;\n        }\n        \n        // Set form data from object\n        function setFormData(formData) {\n            for (const key in formData) {\n                if (key === 'timeline') {\n                    // Handle timeline separately\n                    const tbody = document.getElementById('timelineBody');\n                    tbody.innerHTML = '';\n                    \n                    formData.timeline.forEach(item => {\n                        const newRow = document.createElement('tr');\n                        newRow.innerHTML = `\n                            <td><input type=\"text\" class=\"form-control\" value=\"${item.time}\"></td>\n                            <td><input type=\"text\" class=\"form-control\" value=\"${item.action}\"></td>\n                            <td><input type=\"text\" class=\"form-control\" value=\"${item.engineer}\"></td>\n                            <td><input type=\"text\" class=\"form-control\" value=\"${item.outcome}\"></td>\n                            <td><button type=\"button\" class=\"btn btn-danger\" onclick=\"removeTimelineRow(this)\"><i class=\"fas fa-trash\"></i></button></td>\n                        `;\n                        tbody.appendChild(newRow);\n                    });\n                } else {\n                    const element = document.getElementById(key);\n                    if (element) {\n                        element.value = formData[key];\n                    }\n                }\n            }\n        }\n        \n        // Email functionality\n        document.getElementById('emailBtn').addEventListener('click', function() {\n            document.getElementById('emailModal').classList.add('active');\n        });\n        \n        document.getElementById('cancelEmailBtn').addEventListener('click', function() {\n            document.getElementById('emailModal').classList.remove('active');\n        });\n        \n        document.getElementById('cancelEmailBtn2').addEventListener('click', function() {\n            document.getElementById('emailModal').classList.remove('active');\n        });\n        \n        document.getElementById('sendEmailBtn').addEventListener('click', function() {\n            const recipient = document.getElementById('recipientEmail').value;\n            if (!recipient) {\n                alert('Please enter a recipient email address');\n                return;\n            }\n            \n            // Create mailto link with form data\n            const subject = document.getElementById('emailSubject').value;\n            const body = document.getElementById('emailMessage').value;\n            const mailtoLink = `mailto:${recipient}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;\n            \n            // Open default email client\n            window.location.href = mailtoLink;\n            \n            document.getElementById('emailModal').classList.remove('active');\n            document.getElementById('successMessage').textContent = `Incident report has been emailed to ${recipient} successfully!`;\n            document.getElementById('successModal').classList.add('active');\n        });\n        \n        // Export to PDF functionality\n        document.getElementById('exportPdfBtn').addEventListener('click', function() {\n            const { jsPDF } = window.jspdf;\n            const doc = new jsPDF();\n            \n            // Get the form content\n            const formContent = document.getElementById('incidentReportForm');\n            \n            // Use html2canvas to capture the form as an image\n            html2canvas(formContent).then(canvas => {\n                const imgData = canvas.toDataURL('image/png');\n                const imgWidth = doc.internal.pageSize.getWidth() - 20;\n                const imgHeight = (canvas.height * imgWidth) / canvas.width;\n                \n                doc.addImage(imgData, 'PNG', 10, 10, imgWidth, imgHeight);\n                \n                // Save the PDF\n                doc.save('incident-report.pdf');\n                \n                // Show success message\n                document.getElementById('successMessage').textContent = 'Incident report has been exported to PDF successfully!';\n                document.getElementById('successModal').classList.add('active');\n            });\n        });\n        \n        // Submit report\n        document.getElementById('submitReport').addEventListener('click', function() {\n            // In a real application, you would send this to a server\n            const formData = getFormData();\n            console.log('Form submitted:', formData);\n            \n            document.getElementById('successMessage').textContent = 'Incident report submitted successfully! Thank you for using our system.';\n            document.getElementById('successModal').classList.add('active');\n        });\n        \n        // Save settings\n        document.getElementById('saveSettingsBtn').addEventListener('click', function() {\n            const theme = document.getElementById('theme').value;\n            \n            // Remove all theme classes\n            document.body.classList.remove('theme-light', 'theme-dark', 'theme-blue', 'theme-green');\n            // Add selected theme class\n            document.body.classList.add(`theme-${theme}`);\n            \n            // Save to localStorage\n            localStorage.setItem('appTheme', theme);\n            \n            // Show success message\n            document.getElementById('successMessage').textContent = 'Settings saved successfully!';\n            document.getElementById('successModal').classList.add('active');\n        });\n        \n        // Close modals\n        document.getElementById('closeSuccessBtn').addEventListener('click', function() {\n            document.getElementById('successModal').classList.remove('active');\n        });\n        \n        document.getElementById('successOkBtn').addEventListener('click', function() {\n            document.getElementById('successModal').classList.remove('active');\n        });\n    </script>\n</body>\n</html>",
                "timestamp": "2025-08-20T00:48:15.028Z",
                "description": "base"
              }
            ],
            "created": "2025-08-20T00:00:25.947Z",
            "modified": "2025-08-20T00:48:15.029Z",
            "timeSpent": 0
          }
        ],
        "totalTimeSpent": 12600,
        "created": "2025-06-01T00:00:00.000Z",
        "isTimerRunning": false
      },
      {
        "id": "proj-2",
        "name": "AI Workspace Development",
        "description": "Next.js workspace development project",
        "files": [
          {
            "id": "file-3",
            "name": "workspace-component.tsx",
            "type": "code",
            "category": "Frontend",
            "content": "import React from 'react'\n\ninterface WorkspaceProps {\n  theme: 'dark' | 'light'\n}\n\nexport default function Workspace({ theme }: WorkspaceProps) {\n  return (\n    <div className={`workspace ${theme}`}>\n      <h1>Nishen's AI Workspace</h1>\n    </div>\n  )\n}",
            "versions": [],
            "created": "2025-06-30T00:00:00.000Z",
            "modified": "2025-06-30T00:00:00.000Z",
            "timeSpent": 3600
          }
        ],
        "totalTimeSpent": 3600,
        "created": "2025-06-30T00:00:00.000Z",
        "isTimerRunning": false
      },
      {
        "id": "proj-1754559521998",
        "name": "Audit & Revenue Generation Scripts",
        "description": "Scripts for Auditing Backen Server Infra producing revenue opportunities.",
        "files": [
          {
            "id": "file-1754559583370",
            "name": "Physical Server Audit Script",
            "type": "script",
            "category": "Hp, Dell, Physical Servers, Audit",
            "content": "# PowerShell Script\n# Created in Nishen's AI Workspace\n# File: Physical Server Audit ScriptV1.0\n\n# Physical Server Audit Script for Hardware Inventory and Warranty Status\n# Author: Nishen Harichunder L4 Senior Systems Engineer\n# Purpose: Comprehensive server hardware assessment with warranty validation - Results to be used for revenue Opportunities \n\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$CSVPath = \".\\ServerList.csv\",\n    \n    [Parameter(Mandatory=$false)]\n    [string]$OutputPath = \".\\ServerAudit_$(Get-Date -Format 'yyyyMMdd_HHmm')\",\n    \n    [Parameter(Mandatory=$false)]\n    [switch]$SkipWarranty\n)\n\n# Required modules check and installation\n$RequiredModules = @('ImportExcel', 'DellBIOSProvider')\nforeach ($Module in $RequiredModules) {\n    if (!(Get-Module -ListAvailable -Name $Module)) {\n        Write-Host \"Installing module: $Module\" -ForegroundColor Yellow\n        Install-Module -Name $Module -Force -Scope CurrentUser\n    }\n}\n\n# Initialize collections\n$ServerInventory = @()\n$WarrantyData = @()\n$Errors = @()\n\n# HP iLO API functions\nfunction Get-HPiLOData {\n    param(\n        [string]$iLOIP,\n        [pscredential]$Credential\n    )\n    \n    try {\n        $Headers = @{\n            'Authorization' = 'Basic ' + [Convert]::ToBase64String([Text.Encoding]::ASCII.GetBytes((\"$($Credential.UserName):$($Credential.GetNetworkCredential().Password)\")))\n            'Content-Type' = 'application/json'\n        }\n        \n        # Get system info\n        $SystemInfo = Invoke-RestMethod -Uri \"https://$iLOIP/rest/v1/Systems/1\" -Headers $Headers -SkipCertificateCheck\n        $ChassisInfo = Invoke-RestMethod -Uri \"https://$iLOIP/rest/v1/Chassis/1\" -Headers $Headers -SkipCertificateCheck\n        \n        return @{\n            Manufacturer = 'HP Enterprise'\n            Model = $SystemInfo.Model\n            SerialNumber = $SystemInfo.SerialNumber\n            BIOSVersion = $SystemInfo.Bios.Current.VersionString\n            ProcessorModel = $SystemInfo.ProcessorSummary.Model\n            ProcessorCount = $SystemInfo.ProcessorSummary.Count\n            TotalMemoryGB = [math]::Round($SystemInfo.MemorySummary.TotalSystemMemoryGiB, 2)\n            PowerState = $SystemInfo.PowerState\n            HealthStatus = $SystemInfo.Status.Health\n            Firmware = @{\n                iLO = $ChassisInfo.iLO.Firmware.Current.VersionString\n                SystemROM = $SystemInfo.Bios.Current.VersionString\n            }\n        }\n    }\n    catch {\n        Write-Warning \"Failed to connect to HP iLO $iLOIP : $($_.Exception.Message)\"\n        return $null\n    }\n}\n\n# Dell iDRAC API functions\nfunction Get-DelliDRACData {\n    param(\n        [string]$iDRACIP,\n        [pscredential]$Credential\n    )\n    \n    try {\n        $Headers = @{\n            'Authorization' = 'Basic ' + [Convert]::ToBase64String([Text.Encoding]::ASCII.GetBytes((\"$($Credential.UserName):$($Credential.GetNetworkCredential().Password)\")))\n            'Content-Type' = 'application/json'\n        }\n        \n        # Get system info via Redfish API\n        $SystemInfo = Invoke-RestMethod -Uri \"https://$iDRACIP/redfish/v1/Systems/System.Embedded.1\" -Headers $Headers -SkipCertificateCheck\n        $ChassisInfo = Invoke-RestMethod -Uri \"https://$iDRACIP/redfish/v1/Chassis/System.Embedded.1\" -Headers $Headers -SkipCertificateCheck\n        \n        return @{\n            Manufacturer = 'Dell Inc.'\n            Model = $SystemInfo.Model\n            SerialNumber = $SystemInfo.SerialNumber\n            BIOSVersion = $SystemInfo.BiosVersion\n            ProcessorModel = $SystemInfo.ProcessorSummary.Model\n            ProcessorCount = $SystemInfo.ProcessorSummary.Count\n            TotalMemoryGB = [math]::Round($SystemInfo.MemorySummary.TotalSystemMemoryGiB, 2)\n            PowerState = $SystemInfo.PowerState\n            HealthStatus = $SystemInfo.Status.Health\n            Firmware = @{\n                iDRAC = $ChassisInfo.Links.ManagedBy[0].FirmwareVersion\n                BIOS = $SystemInfo.BiosVersion\n            }\n        }\n    }\n    catch {\n        Write-Warning \"Failed to connect to Dell iDRAC $iDRACIP : $($_.Exception.Message)\"\n        return $null\n    }\n}\n\n# Get OS and Hypervisor information via WMI/CIM\nfunction Get-OSInfo {\n    param(\n        [string]$ComputerName,\n        [pscredential]$Credential\n    )\n    \n    try {\n        $OS = Get-CimInstance -ComputerName $ComputerName -ClassName Win32_OperatingSystem -Credential $Credential\n        $CS = Get-CimInstance -ComputerName $ComputerName -ClassName Win32_ComputerSystem -Credential $Credential\n        \n        # Check for VMware ESXi (if applicable)\n        $VMwareCheck = $null\n        try {\n            $VMwareCheck = Get-CimInstance -ComputerName $ComputerName -ClassName Win32_Product -Filter \"Name LIKE '%VMware%'\" -Credential $Credential\n        } catch {}\n        \n        return @{\n            OSName = $OS.Caption\n            OSVersion = $OS.Version\n            OSArchitecture = $OS.OSArchitecture\n            ServicePack = $OS.ServicePackMajorVersion\n            IsVirtualized = $CS.Model -match 'Virtual'\n            HypervisorPresent = $CS.HypervisorPresent\n            VMwareVersion = if ($VMwareCheck) { $VMwareCheck.Version } else { \"Not Detected\" }\n            Domain = $CS.Domain\n            LastBootTime = $OS.LastBootUpTime\n        }\n    }\n    catch {\n        Write-Warning \"Failed to get OS info from $ComputerName : $($_.Exception.Message)\"\n        return $null\n    }\n}\n\n# Dell warranty lookup function\nfunction Get-DellWarranty {\n    param(\n        [string]$ServiceTag\n    )\n    \n    try {\n        $WarrantyURL = \"https://apigtwb2c.us.dell.com/PROD/sbil/eapi/v5/asset-entitlements?servicetags=$ServiceTag\"\n        $Response = Invoke-RestMethod -Uri $WarrantyURL -Method Get\n        \n        if ($Response -and $Response.Count -gt 0) {\n            $Warranty = $Response[0]\n            return @{\n                ServiceTag = $ServiceTag\n                WarrantyStatus = if ($Warranty.entitlements) { \"Valid\" } else { \"Expired\" }\n                StartDate = $Warranty.startDate\n                EndDate = $Warranty.endDate\n                ServiceLevel = $Warranty.serviceLevel\n                DaysRemaining = if ($Warranty.endDate) { \n                    [math]::Max(0, ([datetime]$Warranty.endDate - (Get-Date)).Days) \n                } else { 0 }\n            }\n        }\n    }\n    catch {\n        Write-Warning \"Failed to get Dell warranty for $ServiceTag : $($_.Exception.Message)\"\n        return @{\n            ServiceTag = $ServiceTag\n            WarrantyStatus = \"Unknown\"\n            StartDate = \"N/A\"\n            EndDate = \"N/A\"\n            ServiceLevel = \"N/A\"\n            DaysRemaining = 0\n        }\n    }\n}\n\n# HP warranty lookup function\nfunction Get-HPWarranty {\n    param(\n        [string]$SerialNumber,\n        [string]$ProductNumber\n    )\n    \n    try {\n        # Note: HP warranty API requires authentication and proper setup\n        # This is a simplified version - full implementation requires HP Passport authentication\n        \n        return @{\n            SerialNumber = $SerialNumber\n            WarrantyStatus = \"Requires HP API Setup\"\n            StartDate = \"N/A\"\n            EndDate = \"N/A\"\n            ServiceLevel = \"N/A\"\n            DaysRemaining = 0\n        }\n    }\n    catch {\n        return @{\n            SerialNumber = $SerialNumber\n            WarrantyStatus = \"Unknown\"\n            StartDate = \"N/A\"\n            EndDate = \"N/A\"\n            ServiceLevel = \"N/A\"\n            DaysRemaining = 0\n        }\n    }\n}\n\n# Main processing function\nfunction Process-ServerInventory {\n    param(\n        [string]$CSVPath\n    )\n    \n    # Read server list from CSV\n    # Expected columns: ServerName, OOBIP, OOBType, Username, Password, OSCredentialUser, OSCredentialPass\n    $ServerList = Import-Csv -Path $CSVPath\n    \n    foreach ($Server in $ServerList) {\n        Write-Host \"Processing server: $($Server.ServerName)\" -ForegroundColor Green\n        \n        # Create credential objects\n        $OOBCred = New-Object System.Management.Automation.PSCredential(\n            $Server.Username, \n            (ConvertTo-SecureString $Server.Password -AsPlainText -Force)\n        )\n        \n        $OSCred = New-Object System.Management.Automation.PSCredential(\n            $Server.OSCredentialUser,\n            (ConvertTo-SecureString $Server.OSCredentialPass -AsPlainText -Force)\n        )\n        \n        # Get hardware info based on OOB type\n        $HardwareInfo = $null\n        switch ($Server.OOBType.ToUpper()) {\n            'ILO' { $HardwareInfo = Get-HPiLOData -iLOIP $Server.OOBIP -Credential $OOBCred }\n            'IDRAC' { $HardwareInfo = Get-DelliDRACData -iDRACIP $Server.OOBIP -Credential $OOBCred }\n        }\n        \n        # Get OS information\n        $OSInfo = Get-OSInfo -ComputerName $Server.ServerName -Credential $OSCred\n        \n        # Combine information\n        if ($HardwareInfo) {\n            $ServerRecord = [PSCustomObject]@{\n                ServerName = $Server.ServerName\n                OOBIP = $Server.OOBIP\n                OOBType = $Server.OOBType\n                Manufacturer = $HardwareInfo.Manufacturer\n                Model = $HardwareInfo.Model\n                SerialNumber = $HardwareInfo.SerialNumber\n                BIOSVersion = $HardwareInfo.BIOSVersion\n                ProcessorModel = $HardwareInfo.ProcessorModel\n                ProcessorCount = $HardwareInfo.ProcessorCount\n                TotalMemoryGB = $HardwareInfo.TotalMemoryGB\n                PowerState = $HardwareInfo.PowerState\n                HealthStatus = $HardwareInfo.HealthStatus\n                OSName = if ($OSInfo) { $OSInfo.OSName } else { \"Unknown\" }\n                OSVersion = if ($OSInfo) { $OSInfo.OSVersion } else { \"Unknown\" }\n                VMwareVersion = if ($OSInfo) { $OSInfo.VMwareVersion } else { \"Unknown\" }\n                Domain = if ($OSInfo) { $OSInfo.Domain } else { \"Unknown\" }\n                LastBootTime = if ($OSInfo) { $OSInfo.LastBootTime } else { \"Unknown\" }\n                FirmwareVersions = ($HardwareInfo.Firmware | ConvertTo-Json -Compress)\n                AuditDate = Get-Date\n                RiskLevel = \"Low\" # Will be calculated based on warranty and firmware age\n            }\n            \n            $ServerInventory += $ServerRecord\n            \n            # Get warranty information if not skipped\n            if (-not $SkipWarranty) {\n                $WarrantyInfo = $null\n                switch ($HardwareInfo.Manufacturer) {\n                    'Dell Inc.' { \n                        $WarrantyInfo = Get-DellWarranty -ServiceTag $HardwareInfo.SerialNumber \n                    }\n                    'HP Enterprise' { \n                        $WarrantyInfo = Get-HPWarranty -SerialNumber $HardwareInfo.SerialNumber -ProductNumber $HardwareInfo.Model\n                    }\n                }\n                \n                if ($WarrantyInfo) {\n                    $WarrantyInfo | Add-Member -MemberType NoteProperty -Name \"ServerName\" -Value $Server.ServerName\n                    $WarrantyData += $WarrantyInfo\n                }\n            }\n        }\n        else {\n            $Errors += [PSCustomObject]@{\n                ServerName = $Server.ServerName\n                OOBIP = $Server.OOBIP\n                Error = \"Failed to retrieve hardware information\"\n                Timestamp = Get-Date\n            }\n        }\n    }\n}\n\n# Generate executive report\nfunction Generate-ExecutiveReport {\n    param(\n        [string]$OutputPath\n    )\n    \n    # Create output directory\n    New-Item -ItemType Directory -Path $OutputPath -Force | Out-Null\n    \n    # Export detailed data\n    $ServerInventory | Export-Csv -Path \"$OutputPath\\ServerInventory_Detailed.csv\" -NoTypeInformation\n    $WarrantyData | Export-Csv -Path \"$OutputPath\\WarrantyStatus.csv\" -NoTypeInformation\n    \n    if ($Errors.Count -gt 0) {\n        $Errors | Export-Csv -Path \"$OutputPath\\AuditErrors.csv\" -NoTypeInformation\n    }\n    \n    # Generate Excel report with charts\n    $ExcelPath = \"$OutputPath\\Physical_Server_Audit_Report.xlsx\"\n    \n    # Summary statistics\n    $Summary = @{\n        TotalServers = $ServerInventory.Count\n        DellServers = ($ServerInventory | Where-Object { $_.Manufacturer -eq 'Dell Inc.' }).Count\n        HPServers = ($ServerInventory | Where-Object { $_.Manufacturer -eq 'HP Enterprise' }).Count\n        WindowsServers = ($ServerInventory | Where-Object { $_.OSName -like '*Windows*' }).Count\n        VMwareHosts = ($ServerInventory | Where-Object { $_.VMwareVersion -ne 'Not Detected' }).Count\n        ServersWithIssues = ($ServerInventory | Where-Object { $_.HealthStatus -ne 'OK' }).Count\n        WarrantyExpired = if ($WarrantyData) { ($WarrantyData | Where-Object { $_.DaysRemaining -le 0 }).Count } else { 0 }\n        WarrantyExpiringSoon = if ($WarrantyData) { ($WarrantyData | Where-Object { $_.DaysRemaining -le 90 -and $_.DaysRemaining -gt 0 }).Count } else { 0 }\n    }\n    \n    # Create workbook\n    $ServerInventory | Export-Excel -Path $ExcelPath -WorksheetName \"Server Inventory\" -TableStyle Medium2 -AutoSize\n    $WarrantyData | Export-Excel -Path $ExcelPath -WorksheetName \"Warranty Status\" -TableStyle Medium6 -AutoSize\n    \n    # Summary worksheet\n    $SummaryData = $Summary.GetEnumerator() | ForEach-Object {\n        [PSCustomObject]@{\n            Metric = $_.Name\n            Value = $_.Value\n        }\n    }\n    $SummaryData | Export-Excel -Path $ExcelPath -WorksheetName \"Executive Summary\" -TableStyle Medium1 -AutoSize\n    \n    Write-Host \"Report generated successfully at: $ExcelPath\" -ForegroundColor Green\n    Write-Host \"Summary:\" -ForegroundColor Yellow\n    $Summary | Format-Table -AutoSize\n}\n\n# Main execution\nWrite-Host \"Starting Physical Server Audit...\" -ForegroundColor Cyan\n\nif (-not (Test-Path $CSVPath)) {\n    Write-Error \"CSV file not found at: $CSVPath\"\n    Write-Host \"Expected CSV format with columns: ServerName, OOBIP, OOBType, Username, Password, OSCredentialUser, OSCredentialPass\"\n    exit 1\n}\n\n# Process inventory\nProcess-ServerInventory -CSVPath $CSVPath\n\n# Generate reports\nGenerate-ExecutiveReport -OutputPath $OutputPath\n\nWrite-Host \"Audit completed. Check $OutputPath for detailed reports.\" -ForegroundColor Green",
            "versions": [
              {
                "id": "ver-1754559608386",
                "content": "# PowerShell Script\n# Created in Nishen's AI Workspace\n# File: Physical Server Audit Script\n\n# Physical Server Audit Script for Hardware Inventory and Warranty Status\n# Author: Senior Systems Engineer\n# Purpose: Comprehensive server hardware assessment with warranty validation\n\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$CSVPath = \".\\ServerList.csv\",\n    \n    [Parameter(Mandatory=$false)]\n    [string]$OutputPath = \".\\ServerAudit_$(Get-Date -Format 'yyyyMMdd_HHmm')\",\n    \n    [Parameter(Mandatory=$false)]\n    [switch]$SkipWarranty\n)\n\n# Required modules check and installation\n$RequiredModules = @('ImportExcel', 'DellBIOSProvider')\nforeach ($Module in $RequiredModules) {\n    if (!(Get-Module -ListAvailable -Name $Module)) {\n        Write-Host \"Installing module: $Module\" -ForegroundColor Yellow\n        Install-Module -Name $Module -Force -Scope CurrentUser\n    }\n}\n\n# Initialize collections\n$ServerInventory = @()\n$WarrantyData = @()\n$Errors = @()\n\n# HP iLO API functions\nfunction Get-HPiLOData {\n    param(\n        [string]$iLOIP,\n        [pscredential]$Credential\n    )\n    \n    try {\n        $Headers = @{\n            'Authorization' = 'Basic ' + [Convert]::ToBase64String([Text.Encoding]::ASCII.GetBytes((\"$($Credential.UserName):$($Credential.GetNetworkCredential().Password)\")))\n            'Content-Type' = 'application/json'\n        }\n        \n        # Get system info\n        $SystemInfo = Invoke-RestMethod -Uri \"https://$iLOIP/rest/v1/Systems/1\" -Headers $Headers -SkipCertificateCheck\n        $ChassisInfo = Invoke-RestMethod -Uri \"https://$iLOIP/rest/v1/Chassis/1\" -Headers $Headers -SkipCertificateCheck\n        \n        return @{\n            Manufacturer = 'HP Enterprise'\n            Model = $SystemInfo.Model\n            SerialNumber = $SystemInfo.SerialNumber\n            BIOSVersion = $SystemInfo.Bios.Current.VersionString\n            ProcessorModel = $SystemInfo.ProcessorSummary.Model\n            ProcessorCount = $SystemInfo.ProcessorSummary.Count\n            TotalMemoryGB = [math]::Round($SystemInfo.MemorySummary.TotalSystemMemoryGiB, 2)\n            PowerState = $SystemInfo.PowerState\n            HealthStatus = $SystemInfo.Status.Health\n            Firmware = @{\n                iLO = $ChassisInfo.iLO.Firmware.Current.VersionString\n                SystemROM = $SystemInfo.Bios.Current.VersionString\n            }\n        }\n    }\n    catch {\n        Write-Warning \"Failed to connect to HP iLO $iLOIP : $($_.Exception.Message)\"\n        return $null\n    }\n}\n\n# Dell iDRAC API functions\nfunction Get-DelliDRACData {\n    param(\n        [string]$iDRACIP,\n        [pscredential]$Credential\n    )\n    \n    try {\n        $Headers = @{\n            'Authorization' = 'Basic ' + [Convert]::ToBase64String([Text.Encoding]::ASCII.GetBytes((\"$($Credential.UserName):$($Credential.GetNetworkCredential().Password)\")))\n            'Content-Type' = 'application/json'\n        }\n        \n        # Get system info via Redfish API\n        $SystemInfo = Invoke-RestMethod -Uri \"https://$iDRACIP/redfish/v1/Systems/System.Embedded.1\" -Headers $Headers -SkipCertificateCheck\n        $ChassisInfo = Invoke-RestMethod -Uri \"https://$iDRACIP/redfish/v1/Chassis/System.Embedded.1\" -Headers $Headers -SkipCertificateCheck\n        \n        return @{\n            Manufacturer = 'Dell Inc.'\n            Model = $SystemInfo.Model\n            SerialNumber = $SystemInfo.SerialNumber\n            BIOSVersion = $SystemInfo.BiosVersion\n            ProcessorModel = $SystemInfo.ProcessorSummary.Model\n            ProcessorCount = $SystemInfo.ProcessorSummary.Count\n            TotalMemoryGB = [math]::Round($SystemInfo.MemorySummary.TotalSystemMemoryGiB, 2)\n            PowerState = $SystemInfo.PowerState\n            HealthStatus = $SystemInfo.Status.Health\n            Firmware = @{\n                iDRAC = $ChassisInfo.Links.ManagedBy[0].FirmwareVersion\n                BIOS = $SystemInfo.BiosVersion\n            }\n        }\n    }\n    catch {\n        Write-Warning \"Failed to connect to Dell iDRAC $iDRACIP : $($_.Exception.Message)\"\n        return $null\n    }\n}\n\n# Get OS and Hypervisor information via WMI/CIM\nfunction Get-OSInfo {\n    param(\n        [string]$ComputerName,\n        [pscredential]$Credential\n    )\n    \n    try {\n        $OS = Get-CimInstance -ComputerName $ComputerName -ClassName Win32_OperatingSystem -Credential $Credential\n        $CS = Get-CimInstance -ComputerName $ComputerName -ClassName Win32_ComputerSystem -Credential $Credential\n        \n        # Check for VMware ESXi (if applicable)\n        $VMwareCheck = $null\n        try {\n            $VMwareCheck = Get-CimInstance -ComputerName $ComputerName -ClassName Win32_Product -Filter \"Name LIKE '%VMware%'\" -Credential $Credential\n        } catch {}\n        \n        return @{\n            OSName = $OS.Caption\n            OSVersion = $OS.Version\n            OSArchitecture = $OS.OSArchitecture\n            ServicePack = $OS.ServicePackMajorVersion\n            IsVirtualized = $CS.Model -match 'Virtual'\n            HypervisorPresent = $CS.HypervisorPresent\n            VMwareVersion = if ($VMwareCheck) { $VMwareCheck.Version } else { \"Not Detected\" }\n            Domain = $CS.Domain\n            LastBootTime = $OS.LastBootUpTime\n        }\n    }\n    catch {\n        Write-Warning \"Failed to get OS info from $ComputerName : $($_.Exception.Message)\"\n        return $null\n    }\n}\n\n# Dell warranty lookup function\nfunction Get-DellWarranty {\n    param(\n        [string]$ServiceTag\n    )\n    \n    try {\n        $WarrantyURL = \"https://apigtwb2c.us.dell.com/PROD/sbil/eapi/v5/asset-entitlements?servicetags=$ServiceTag\"\n        $Response = Invoke-RestMethod -Uri $WarrantyURL -Method Get\n        \n        if ($Response -and $Response.Count -gt 0) {\n            $Warranty = $Response[0]\n            return @{\n                ServiceTag = $ServiceTag\n                WarrantyStatus = if ($Warranty.entitlements) { \"Valid\" } else { \"Expired\" }\n                StartDate = $Warranty.startDate\n                EndDate = $Warranty.endDate\n                ServiceLevel = $Warranty.serviceLevel\n                DaysRemaining = if ($Warranty.endDate) { \n                    [math]::Max(0, ([datetime]$Warranty.endDate - (Get-Date)).Days) \n                } else { 0 }\n            }\n        }\n    }\n    catch {\n        Write-Warning \"Failed to get Dell warranty for $ServiceTag : $($_.Exception.Message)\"\n        return @{\n            ServiceTag = $ServiceTag\n            WarrantyStatus = \"Unknown\"\n            StartDate = \"N/A\"\n            EndDate = \"N/A\"\n            ServiceLevel = \"N/A\"\n            DaysRemaining = 0\n        }\n    }\n}\n\n# HP warranty lookup function\nfunction Get-HPWarranty {\n    param(\n        [string]$SerialNumber,\n        [string]$ProductNumber\n    )\n    \n    try {\n        # Note: HP warranty API requires authentication and proper setup\n        # This is a simplified version - full implementation requires HP Passport authentication\n        \n        return @{\n            SerialNumber = $SerialNumber\n            WarrantyStatus = \"Requires HP API Setup\"\n            StartDate = \"N/A\"\n            EndDate = \"N/A\"\n            ServiceLevel = \"N/A\"\n            DaysRemaining = 0\n        }\n    }\n    catch {\n        return @{\n            SerialNumber = $SerialNumber\n            WarrantyStatus = \"Unknown\"\n            StartDate = \"N/A\"\n            EndDate = \"N/A\"\n            ServiceLevel = \"N/A\"\n            DaysRemaining = 0\n        }\n    }\n}\n\n# Main processing function\nfunction Process-ServerInventory {\n    param(\n        [string]$CSVPath\n    )\n    \n    # Read server list from CSV\n    # Expected columns: ServerName, OOBIP, OOBType, Username, Password, OSCredentialUser, OSCredentialPass\n    $ServerList = Import-Csv -Path $CSVPath\n    \n    foreach ($Server in $ServerList) {\n        Write-Host \"Processing server: $($Server.ServerName)\" -ForegroundColor Green\n        \n        # Create credential objects\n        $OOBCred = New-Object System.Management.Automation.PSCredential(\n            $Server.Username, \n            (ConvertTo-SecureString $Server.Password -AsPlainText -Force)\n        )\n        \n        $OSCred = New-Object System.Management.Automation.PSCredential(\n            $Server.OSCredentialUser,\n            (ConvertTo-SecureString $Server.OSCredentialPass -AsPlainText -Force)\n        )\n        \n        # Get hardware info based on OOB type\n        $HardwareInfo = $null\n        switch ($Server.OOBType.ToUpper()) {\n            'ILO' { $HardwareInfo = Get-HPiLOData -iLOIP $Server.OOBIP -Credential $OOBCred }\n            'IDRAC' { $HardwareInfo = Get-DelliDRACData -iDRACIP $Server.OOBIP -Credential $OOBCred }\n        }\n        \n        # Get OS information\n        $OSInfo = Get-OSInfo -ComputerName $Server.ServerName -Credential $OSCred\n        \n        # Combine information\n        if ($HardwareInfo) {\n            $ServerRecord = [PSCustomObject]@{\n                ServerName = $Server.ServerName\n                OOBIP = $Server.OOBIP\n                OOBType = $Server.OOBType\n                Manufacturer = $HardwareInfo.Manufacturer\n                Model = $HardwareInfo.Model\n                SerialNumber = $HardwareInfo.SerialNumber\n                BIOSVersion = $HardwareInfo.BIOSVersion\n                ProcessorModel = $HardwareInfo.ProcessorModel\n                ProcessorCount = $HardwareInfo.ProcessorCount\n                TotalMemoryGB = $HardwareInfo.TotalMemoryGB\n                PowerState = $HardwareInfo.PowerState\n                HealthStatus = $HardwareInfo.HealthStatus\n                OSName = if ($OSInfo) { $OSInfo.OSName } else { \"Unknown\" }\n                OSVersion = if ($OSInfo) { $OSInfo.OSVersion } else { \"Unknown\" }\n                VMwareVersion = if ($OSInfo) { $OSInfo.VMwareVersion } else { \"Unknown\" }\n                Domain = if ($OSInfo) { $OSInfo.Domain } else { \"Unknown\" }\n                LastBootTime = if ($OSInfo) { $OSInfo.LastBootTime } else { \"Unknown\" }\n                FirmwareVersions = ($HardwareInfo.Firmware | ConvertTo-Json -Compress)\n                AuditDate = Get-Date\n                RiskLevel = \"Low\" # Will be calculated based on warranty and firmware age\n            }\n            \n            $ServerInventory += $ServerRecord\n            \n            # Get warranty information if not skipped\n            if (-not $SkipWarranty) {\n                $WarrantyInfo = $null\n                switch ($HardwareInfo.Manufacturer) {\n                    'Dell Inc.' { \n                        $WarrantyInfo = Get-DellWarranty -ServiceTag $HardwareInfo.SerialNumber \n                    }\n                    'HP Enterprise' { \n                        $WarrantyInfo = Get-HPWarranty -SerialNumber $HardwareInfo.SerialNumber -ProductNumber $HardwareInfo.Model\n                    }\n                }\n                \n                if ($WarrantyInfo) {\n                    $WarrantyInfo | Add-Member -MemberType NoteProperty -Name \"ServerName\" -Value $Server.ServerName\n                    $WarrantyData += $WarrantyInfo\n                }\n            }\n        }\n        else {\n            $Errors += [PSCustomObject]@{\n                ServerName = $Server.ServerName\n                OOBIP = $Server.OOBIP\n                Error = \"Failed to retrieve hardware information\"\n                Timestamp = Get-Date\n            }\n        }\n    }\n}\n\n# Generate executive report\nfunction Generate-ExecutiveReport {\n    param(\n        [string]$OutputPath\n    )\n    \n    # Create output directory\n    New-Item -ItemType Directory -Path $OutputPath -Force | Out-Null\n    \n    # Export detailed data\n    $ServerInventory | Export-Csv -Path \"$OutputPath\\ServerInventory_Detailed.csv\" -NoTypeInformation\n    $WarrantyData | Export-Csv -Path \"$OutputPath\\WarrantyStatus.csv\" -NoTypeInformation\n    \n    if ($Errors.Count -gt 0) {\n        $Errors | Export-Csv -Path \"$OutputPath\\AuditErrors.csv\" -NoTypeInformation\n    }\n    \n    # Generate Excel report with charts\n    $ExcelPath = \"$OutputPath\\Physical_Server_Audit_Report.xlsx\"\n    \n    # Summary statistics\n    $Summary = @{\n        TotalServers = $ServerInventory.Count\n        DellServers = ($ServerInventory | Where-Object { $_.Manufacturer -eq 'Dell Inc.' }).Count\n        HPServers = ($ServerInventory | Where-Object { $_.Manufacturer -eq 'HP Enterprise' }).Count\n        WindowsServers = ($ServerInventory | Where-Object { $_.OSName -like '*Windows*' }).Count\n        VMwareHosts = ($ServerInventory | Where-Object { $_.VMwareVersion -ne 'Not Detected' }).Count\n        ServersWithIssues = ($ServerInventory | Where-Object { $_.HealthStatus -ne 'OK' }).Count\n        WarrantyExpired = if ($WarrantyData) { ($WarrantyData | Where-Object { $_.DaysRemaining -le 0 }).Count } else { 0 }\n        WarrantyExpiringSoon = if ($WarrantyData) { ($WarrantyData | Where-Object { $_.DaysRemaining -le 90 -and $_.DaysRemaining -gt 0 }).Count } else { 0 }\n    }\n    \n    # Create workbook\n    $ServerInventory | Export-Excel -Path $ExcelPath -WorksheetName \"Server Inventory\" -TableStyle Medium2 -AutoSize\n    $WarrantyData | Export-Excel -Path $ExcelPath -WorksheetName \"Warranty Status\" -TableStyle Medium6 -AutoSize\n    \n    # Summary worksheet\n    $SummaryData = $Summary.GetEnumerator() | ForEach-Object {\n        [PSCustomObject]@{\n            Metric = $_.Name\n            Value = $_.Value\n        }\n    }\n    $SummaryData | Export-Excel -Path $ExcelPath -WorksheetName \"Executive Summary\" -TableStyle Medium1 -AutoSize\n    \n    Write-Host \"Report generated successfully at: $ExcelPath\" -ForegroundColor Green\n    Write-Host \"Summary:\" -ForegroundColor Yellow\n    $Summary | Format-Table -AutoSize\n}\n\n# Main execution\nWrite-Host \"Starting Physical Server Audit...\" -ForegroundColor Cyan\n\nif (-not (Test-Path $CSVPath)) {\n    Write-Error \"CSV file not found at: $CSVPath\"\n    Write-Host \"Expected CSV format with columns: ServerName, OOBIP, OOBType, Username, Password, OSCredentialUser, OSCredentialPass\"\n    exit 1\n}\n\n# Process inventory\nProcess-ServerInventory -CSVPath $CSVPath\n\n# Generate reports\nGenerate-ExecutiveReport -OutputPath $OutputPath\n\nWrite-Host \"Audit completed. Check $OutputPath for detailed reports.\" -ForegroundColor Green",
                "timestamp": "2025-08-07T09:40:08.386Z",
                "description": "baseline0"
              },
              {
                "id": "ver-1754559735044",
                "content": "# PowerShell Script\n# Created in Nishen's AI Workspace\n# File: Physical Server Audit ScriptV1.0\n\n# Physical Server Audit Script for Hardware Inventory and Warranty Status\n# Author: Nishen Harichunder L4 Senior Systems Engineer\n# Purpose: Comprehensive server hardware assessment with warranty validation - Results to be used for revenue Opportunities \n\nparam(\n    [Parameter(Mandatory=$true)]\n    [string]$CSVPath = \".\\ServerList.csv\",\n    \n    [Parameter(Mandatory=$false)]\n    [string]$OutputPath = \".\\ServerAudit_$(Get-Date -Format 'yyyyMMdd_HHmm')\",\n    \n    [Parameter(Mandatory=$false)]\n    [switch]$SkipWarranty\n)\n\n# Required modules check and installation\n$RequiredModules = @('ImportExcel', 'DellBIOSProvider')\nforeach ($Module in $RequiredModules) {\n    if (!(Get-Module -ListAvailable -Name $Module)) {\n        Write-Host \"Installing module: $Module\" -ForegroundColor Yellow\n        Install-Module -Name $Module -Force -Scope CurrentUser\n    }\n}\n\n# Initialize collections\n$ServerInventory = @()\n$WarrantyData = @()\n$Errors = @()\n\n# HP iLO API functions\nfunction Get-HPiLOData {\n    param(\n        [string]$iLOIP,\n        [pscredential]$Credential\n    )\n    \n    try {\n        $Headers = @{\n            'Authorization' = 'Basic ' + [Convert]::ToBase64String([Text.Encoding]::ASCII.GetBytes((\"$($Credential.UserName):$($Credential.GetNetworkCredential().Password)\")))\n            'Content-Type' = 'application/json'\n        }\n        \n        # Get system info\n        $SystemInfo = Invoke-RestMethod -Uri \"https://$iLOIP/rest/v1/Systems/1\" -Headers $Headers -SkipCertificateCheck\n        $ChassisInfo = Invoke-RestMethod -Uri \"https://$iLOIP/rest/v1/Chassis/1\" -Headers $Headers -SkipCertificateCheck\n        \n        return @{\n            Manufacturer = 'HP Enterprise'\n            Model = $SystemInfo.Model\n            SerialNumber = $SystemInfo.SerialNumber\n            BIOSVersion = $SystemInfo.Bios.Current.VersionString\n            ProcessorModel = $SystemInfo.ProcessorSummary.Model\n            ProcessorCount = $SystemInfo.ProcessorSummary.Count\n            TotalMemoryGB = [math]::Round($SystemInfo.MemorySummary.TotalSystemMemoryGiB, 2)\n            PowerState = $SystemInfo.PowerState\n            HealthStatus = $SystemInfo.Status.Health\n            Firmware = @{\n                iLO = $ChassisInfo.iLO.Firmware.Current.VersionString\n                SystemROM = $SystemInfo.Bios.Current.VersionString\n            }\n        }\n    }\n    catch {\n        Write-Warning \"Failed to connect to HP iLO $iLOIP : $($_.Exception.Message)\"\n        return $null\n    }\n}\n\n# Dell iDRAC API functions\nfunction Get-DelliDRACData {\n    param(\n        [string]$iDRACIP,\n        [pscredential]$Credential\n    )\n    \n    try {\n        $Headers = @{\n            'Authorization' = 'Basic ' + [Convert]::ToBase64String([Text.Encoding]::ASCII.GetBytes((\"$($Credential.UserName):$($Credential.GetNetworkCredential().Password)\")))\n            'Content-Type' = 'application/json'\n        }\n        \n        # Get system info via Redfish API\n        $SystemInfo = Invoke-RestMethod -Uri \"https://$iDRACIP/redfish/v1/Systems/System.Embedded.1\" -Headers $Headers -SkipCertificateCheck\n        $ChassisInfo = Invoke-RestMethod -Uri \"https://$iDRACIP/redfish/v1/Chassis/System.Embedded.1\" -Headers $Headers -SkipCertificateCheck\n        \n        return @{\n            Manufacturer = 'Dell Inc.'\n            Model = $SystemInfo.Model\n            SerialNumber = $SystemInfo.SerialNumber\n            BIOSVersion = $SystemInfo.BiosVersion\n            ProcessorModel = $SystemInfo.ProcessorSummary.Model\n            ProcessorCount = $SystemInfo.ProcessorSummary.Count\n            TotalMemoryGB = [math]::Round($SystemInfo.MemorySummary.TotalSystemMemoryGiB, 2)\n            PowerState = $SystemInfo.PowerState\n            HealthStatus = $SystemInfo.Status.Health\n            Firmware = @{\n                iDRAC = $ChassisInfo.Links.ManagedBy[0].FirmwareVersion\n                BIOS = $SystemInfo.BiosVersion\n            }\n        }\n    }\n    catch {\n        Write-Warning \"Failed to connect to Dell iDRAC $iDRACIP : $($_.Exception.Message)\"\n        return $null\n    }\n}\n\n# Get OS and Hypervisor information via WMI/CIM\nfunction Get-OSInfo {\n    param(\n        [string]$ComputerName,\n        [pscredential]$Credential\n    )\n    \n    try {\n        $OS = Get-CimInstance -ComputerName $ComputerName -ClassName Win32_OperatingSystem -Credential $Credential\n        $CS = Get-CimInstance -ComputerName $ComputerName -ClassName Win32_ComputerSystem -Credential $Credential\n        \n        # Check for VMware ESXi (if applicable)\n        $VMwareCheck = $null\n        try {\n            $VMwareCheck = Get-CimInstance -ComputerName $ComputerName -ClassName Win32_Product -Filter \"Name LIKE '%VMware%'\" -Credential $Credential\n        } catch {}\n        \n        return @{\n            OSName = $OS.Caption\n            OSVersion = $OS.Version\n            OSArchitecture = $OS.OSArchitecture\n            ServicePack = $OS.ServicePackMajorVersion\n            IsVirtualized = $CS.Model -match 'Virtual'\n            HypervisorPresent = $CS.HypervisorPresent\n            VMwareVersion = if ($VMwareCheck) { $VMwareCheck.Version } else { \"Not Detected\" }\n            Domain = $CS.Domain\n            LastBootTime = $OS.LastBootUpTime\n        }\n    }\n    catch {\n        Write-Warning \"Failed to get OS info from $ComputerName : $($_.Exception.Message)\"\n        return $null\n    }\n}\n\n# Dell warranty lookup function\nfunction Get-DellWarranty {\n    param(\n        [string]$ServiceTag\n    )\n    \n    try {\n        $WarrantyURL = \"https://apigtwb2c.us.dell.com/PROD/sbil/eapi/v5/asset-entitlements?servicetags=$ServiceTag\"\n        $Response = Invoke-RestMethod -Uri $WarrantyURL -Method Get\n        \n        if ($Response -and $Response.Count -gt 0) {\n            $Warranty = $Response[0]\n            return @{\n                ServiceTag = $ServiceTag\n                WarrantyStatus = if ($Warranty.entitlements) { \"Valid\" } else { \"Expired\" }\n                StartDate = $Warranty.startDate\n                EndDate = $Warranty.endDate\n                ServiceLevel = $Warranty.serviceLevel\n                DaysRemaining = if ($Warranty.endDate) { \n                    [math]::Max(0, ([datetime]$Warranty.endDate - (Get-Date)).Days) \n                } else { 0 }\n            }\n        }\n    }\n    catch {\n        Write-Warning \"Failed to get Dell warranty for $ServiceTag : $($_.Exception.Message)\"\n        return @{\n            ServiceTag = $ServiceTag\n            WarrantyStatus = \"Unknown\"\n            StartDate = \"N/A\"\n            EndDate = \"N/A\"\n            ServiceLevel = \"N/A\"\n            DaysRemaining = 0\n        }\n    }\n}\n\n# HP warranty lookup function\nfunction Get-HPWarranty {\n    param(\n        [string]$SerialNumber,\n        [string]$ProductNumber\n    )\n    \n    try {\n        # Note: HP warranty API requires authentication and proper setup\n        # This is a simplified version - full implementation requires HP Passport authentication\n        \n        return @{\n            SerialNumber = $SerialNumber\n            WarrantyStatus = \"Requires HP API Setup\"\n            StartDate = \"N/A\"\n            EndDate = \"N/A\"\n            ServiceLevel = \"N/A\"\n            DaysRemaining = 0\n        }\n    }\n    catch {\n        return @{\n            SerialNumber = $SerialNumber\n            WarrantyStatus = \"Unknown\"\n            StartDate = \"N/A\"\n            EndDate = \"N/A\"\n            ServiceLevel = \"N/A\"\n            DaysRemaining = 0\n        }\n    }\n}\n\n# Main processing function\nfunction Process-ServerInventory {\n    param(\n        [string]$CSVPath\n    )\n    \n    # Read server list from CSV\n    # Expected columns: ServerName, OOBIP, OOBType, Username, Password, OSCredentialUser, OSCredentialPass\n    $ServerList = Import-Csv -Path $CSVPath\n    \n    foreach ($Server in $ServerList) {\n        Write-Host \"Processing server: $($Server.ServerName)\" -ForegroundColor Green\n        \n        # Create credential objects\n        $OOBCred = New-Object System.Management.Automation.PSCredential(\n            $Server.Username, \n            (ConvertTo-SecureString $Server.Password -AsPlainText -Force)\n        )\n        \n        $OSCred = New-Object System.Management.Automation.PSCredential(\n            $Server.OSCredentialUser,\n            (ConvertTo-SecureString $Server.OSCredentialPass -AsPlainText -Force)\n        )\n        \n        # Get hardware info based on OOB type\n        $HardwareInfo = $null\n        switch ($Server.OOBType.ToUpper()) {\n            'ILO' { $HardwareInfo = Get-HPiLOData -iLOIP $Server.OOBIP -Credential $OOBCred }\n            'IDRAC' { $HardwareInfo = Get-DelliDRACData -iDRACIP $Server.OOBIP -Credential $OOBCred }\n        }\n        \n        # Get OS information\n        $OSInfo = Get-OSInfo -ComputerName $Server.ServerName -Credential $OSCred\n        \n        # Combine information\n        if ($HardwareInfo) {\n            $ServerRecord = [PSCustomObject]@{\n                ServerName = $Server.ServerName\n                OOBIP = $Server.OOBIP\n                OOBType = $Server.OOBType\n                Manufacturer = $HardwareInfo.Manufacturer\n                Model = $HardwareInfo.Model\n                SerialNumber = $HardwareInfo.SerialNumber\n                BIOSVersion = $HardwareInfo.BIOSVersion\n                ProcessorModel = $HardwareInfo.ProcessorModel\n                ProcessorCount = $HardwareInfo.ProcessorCount\n                TotalMemoryGB = $HardwareInfo.TotalMemoryGB\n                PowerState = $HardwareInfo.PowerState\n                HealthStatus = $HardwareInfo.HealthStatus\n                OSName = if ($OSInfo) { $OSInfo.OSName } else { \"Unknown\" }\n                OSVersion = if ($OSInfo) { $OSInfo.OSVersion } else { \"Unknown\" }\n                VMwareVersion = if ($OSInfo) { $OSInfo.VMwareVersion } else { \"Unknown\" }\n                Domain = if ($OSInfo) { $OSInfo.Domain } else { \"Unknown\" }\n                LastBootTime = if ($OSInfo) { $OSInfo.LastBootTime } else { \"Unknown\" }\n                FirmwareVersions = ($HardwareInfo.Firmware | ConvertTo-Json -Compress)\n                AuditDate = Get-Date\n                RiskLevel = \"Low\" # Will be calculated based on warranty and firmware age\n            }\n            \n            $ServerInventory += $ServerRecord\n            \n            # Get warranty information if not skipped\n            if (-not $SkipWarranty) {\n                $WarrantyInfo = $null\n                switch ($HardwareInfo.Manufacturer) {\n                    'Dell Inc.' { \n                        $WarrantyInfo = Get-DellWarranty -ServiceTag $HardwareInfo.SerialNumber \n                    }\n                    'HP Enterprise' { \n                        $WarrantyInfo = Get-HPWarranty -SerialNumber $HardwareInfo.SerialNumber -ProductNumber $HardwareInfo.Model\n                    }\n                }\n                \n                if ($WarrantyInfo) {\n                    $WarrantyInfo | Add-Member -MemberType NoteProperty -Name \"ServerName\" -Value $Server.ServerName\n                    $WarrantyData += $WarrantyInfo\n                }\n            }\n        }\n        else {\n            $Errors += [PSCustomObject]@{\n                ServerName = $Server.ServerName\n                OOBIP = $Server.OOBIP\n                Error = \"Failed to retrieve hardware information\"\n                Timestamp = Get-Date\n            }\n        }\n    }\n}\n\n# Generate executive report\nfunction Generate-ExecutiveReport {\n    param(\n        [string]$OutputPath\n    )\n    \n    # Create output directory\n    New-Item -ItemType Directory -Path $OutputPath -Force | Out-Null\n    \n    # Export detailed data\n    $ServerInventory | Export-Csv -Path \"$OutputPath\\ServerInventory_Detailed.csv\" -NoTypeInformation\n    $WarrantyData | Export-Csv -Path \"$OutputPath\\WarrantyStatus.csv\" -NoTypeInformation\n    \n    if ($Errors.Count -gt 0) {\n        $Errors | Export-Csv -Path \"$OutputPath\\AuditErrors.csv\" -NoTypeInformation\n    }\n    \n    # Generate Excel report with charts\n    $ExcelPath = \"$OutputPath\\Physical_Server_Audit_Report.xlsx\"\n    \n    # Summary statistics\n    $Summary = @{\n        TotalServers = $ServerInventory.Count\n        DellServers = ($ServerInventory | Where-Object { $_.Manufacturer -eq 'Dell Inc.' }).Count\n        HPServers = ($ServerInventory | Where-Object { $_.Manufacturer -eq 'HP Enterprise' }).Count\n        WindowsServers = ($ServerInventory | Where-Object { $_.OSName -like '*Windows*' }).Count\n        VMwareHosts = ($ServerInventory | Where-Object { $_.VMwareVersion -ne 'Not Detected' }).Count\n        ServersWithIssues = ($ServerInventory | Where-Object { $_.HealthStatus -ne 'OK' }).Count\n        WarrantyExpired = if ($WarrantyData) { ($WarrantyData | Where-Object { $_.DaysRemaining -le 0 }).Count } else { 0 }\n        WarrantyExpiringSoon = if ($WarrantyData) { ($WarrantyData | Where-Object { $_.DaysRemaining -le 90 -and $_.DaysRemaining -gt 0 }).Count } else { 0 }\n    }\n    \n    # Create workbook\n    $ServerInventory | Export-Excel -Path $ExcelPath -WorksheetName \"Server Inventory\" -TableStyle Medium2 -AutoSize\n    $WarrantyData | Export-Excel -Path $ExcelPath -WorksheetName \"Warranty Status\" -TableStyle Medium6 -AutoSize\n    \n    # Summary worksheet\n    $SummaryData = $Summary.GetEnumerator() | ForEach-Object {\n        [PSCustomObject]@{\n            Metric = $_.Name\n            Value = $_.Value\n        }\n    }\n    $SummaryData | Export-Excel -Path $ExcelPath -WorksheetName \"Executive Summary\" -TableStyle Medium1 -AutoSize\n    \n    Write-Host \"Report generated successfully at: $ExcelPath\" -ForegroundColor Green\n    Write-Host \"Summary:\" -ForegroundColor Yellow\n    $Summary | Format-Table -AutoSize\n}\n\n# Main execution\nWrite-Host \"Starting Physical Server Audit...\" -ForegroundColor Cyan\n\nif (-not (Test-Path $CSVPath)) {\n    Write-Error \"CSV file not found at: $CSVPath\"\n    Write-Host \"Expected CSV format with columns: ServerName, OOBIP, OOBType, Username, Password, OSCredentialUser, OSCredentialPass\"\n    exit 1\n}\n\n# Process inventory\nProcess-ServerInventory -CSVPath $CSVPath\n\n# Generate reports\nGenerate-ExecutiveReport -OutputPath $OutputPath\n\nWrite-Host \"Audit completed. Check $OutputPath for detailed reports.\" -ForegroundColor Green",
                "timestamp": "2025-08-07T09:42:15.044Z",
                "description": "baseline0.1"
              }
            ],
            "created": "2025-08-07T09:39:43.370Z",
            "modified": "2025-08-07T09:42:15.044Z",
            "timeSpent": 0
          },
          {
            "id": "file-1755457318278",
            "name": "N1_Rms_PP_ADUsers_Security_Ass4NC.ps1",
            "type": "script",
            "category": "Password Policy, domain users, ad assessement, ncentral version, security",
            "content": "# PowerShell Script\n# Created in Nishen's AI Workspace\n# File: N1_Rms_PP_ADUsers_Security_Ass4NC.ps1\n\n#Requires -Modules ActiveDirectory\n<#\n.SYNOPSIS\n    N1_Rms_PassPolicy_ADUsers_Security_Assessment4NCentral :\n    Active Directory Security Assessment Tool - N-Central Complete Automated Version\n    \n.DESCRIPTION\n    N-Central compatible version of the comprehensive audit script that:\n    - Reports current domain password policy with enhanced best practice evaluation\n    - Identifies fine-grained password policies with risk assessment\n    - Analyzes ALL privileged groups (Domain Admins, Enterprise Admins, Schema Admins, Administrators)\n    - Handles recursive nested group memberships automatically\n    - Comprehensive analysis of ALL domain users with password security risks\n    - Enhanced risk assessment with multi-factor analysis\n    - Generates dual professional PDF reports (Security Assessment + User Analysis)\n    - Professional presentation-ready format for customer delivery\n    - AUTOMATED: No interactive prompts - auto-generates customer name from domain\n    \n.PARAMETER CustomerName\n    Name of the customer/client (optional - auto-generated from domain if not specified)\n    Auto-extracts customer name from domain by removing suffixes (.local, .co.za, .com, etc.)\n    \n.PARAMETER DomainName\n    FQDN of domain to assess (optional - uses current domain if not specified)\n    \n.PARAMETER EngineerName\n    Name of engineer/technician running assessment (optional)\n    Defaults to \"N-Central RMS Assessment\" with timestamp\n    \n.AUTHOR\n    Nishen Harichunder L4 RMS Senior Systems Engineer\n    Modified for N-Central Complete Automation\n    \n.VERSION\n    12.0 - N-Central Complete Automated Version (Full Functionality)\n    \n.DATE\n    August 2025\n    \n.EXAMPLE\n    # Simplest execution - auto-generates customer name from domain\n    .\\N1_Rms_PassPolicy_ADUsers_Security_Assessment4NCentral.ps1\n    \n.EXAMPLE\n    # N-Central execution - fully automated (no parameters needed)  \n    powershell.exe -ExecutionPolicy Bypass -File \"C:\\Scripts\\N1_Rms_PassPolicy_ADUsers_Security_Assessment4NCentral.ps1\"\n\n.NOTES\n    N-Central Deployment Instructions:\n    1. Deploy script to C:\\Scripts\\ on target servers\n    2. Create scheduled task - NO PARAMETERS REQUIRED:\n       Command: powershell.exe\n       Arguments: -ExecutionPolicy Bypass -WindowStyle Hidden -File \"C:\\Scripts\\N1_Rms_PassPolicy_ADUsers_Security_Assessment4NCentral.ps1\"\n    3. Customer name automatically extracted from domain (e.g., \"acme.local\" becomes \"Acme\")\n    4. Reports generated in C:\\Temp\\ with auto-generated customer name and timestamp\n    5. Use AMP or file retrieval to collect reports\n    6. Generates full HTML/PDF reports + CSV data + N-Central summary files\n    \n    Requirements:\n    - Domain-joined server with AD PowerShell module\n    - Read access to Active Directory\n    - Local admin rights for report generation\n    \nScript Overview\n\n  This is a comprehensive Active Directory security assessment tool (Version 12.0) that generates\n  professional PDF reports for client security audits. The script analyzes domain security posture and\n  produces dual reports: a main security assessment and a detailed user analysis.\n\n  What the Script Does\n\n  1. Domain Password Policy Analysis: Evaluates password policies against Microsoft best practices and NIST      \n  SP 800-63B standards\n  2. Privileged Account Assessment: Analyzes Domain Admins, Enterprise Admins, Schema Admins, and local\n  Administrators groups with recursive nested membership support\n  3. Complete User Analysis: Reviews ALL domain users for password and account security risks\n  4. Compliance Mapping: Maps findings to Microsoft Security Baseline, NIST Cybersecurity Framework, and\n  NIST SP 800-63B\n  5. Report Generation: Creates HTML and PDF reports with professional formatting, charts, and metrics\n  6. Data Export: Generates CSV files with detailed findings for further analysis\n\n  Risk Scoring Methodology\n\n  Overall Risk Levels\n\n  - Critical: 80-100 points\n  - High: 60-79 points\n  - Medium: 40-59 points\n  - Low: 20-39 points\n  - Info: <20 points (for disabled accounts)\n\n  Password Policy Risk Scoring\n\n  - No complexity enabled: +20 points\n  - Password length < 14 chars: +15-30 points (scaled by severity)\n  - Min password age issues: +5-20 points\n  - Max password age > 365 days: +15-35 points\n  - Password history < 12: +10 points\n  - No account lockout: +35 points\n  - Lockout threshold issues: +5-15 points\n  - Lockout duration issues: +5-20 points\n  - Reversible encryption enabled: +35 points (critical)\n\n  User Account Risk Scoring\n\n  - Never logged on: +25-40 points\n  - No logon 30+ days: +40 points (critical)\n  - No logon 90+ days: +20 points\n  - No logon 180+ days: +30 points\n  - Password never set: +30-40 points\n  - Password > 6 months old: +20-30 points\n  - Password never expires: +25-30 points\n  - Default Administrator enabled: +40 points (critical)\n  - Multiple privileged memberships: +5 points\n\n  The compliance score is calculated as (100 - RiskScore), providing a percentage-based security posture\n  rating. The script produces actionable recommendations prioritized by risk level for immediate\n  remediation.\n\n#>\n\n# Instructions , Can be run on any Server thats on the domain , because we only capturing and quering AD - read only access is more than sufficient. \n# Reports are created on c:\\temp - copy this over to your machine and store centraly on sharepoint /SDMs to access.\n\n# N-Central Parameters\nparam(\n    [Parameter(Mandatory=$false, HelpMessage=\"Customer/Client name for the assessment (auto-generated from domain if not specified)\")]\n    [string]$CustomerName = \"\",\n    \n    [Parameter(Mandatory=$false, HelpMessage=\"Domain FQDN to assess (leave blank for current domain)\")]\n    [string]$DomainName = \"\",\n    \n    [Parameter(Mandatory=$false, HelpMessage=\"Engineer/Technician name\")]\n    [string]$EngineerName = \"N-Central RMS Assessment - $(Get-Date -Format 'yyyy-MM-dd HH:mm')\"\n)\n\n# Function to extract customer name from domain name\nfunction Get-CustomerNameFromDomain {\n    param([string]$DomainFQDN)\n    \n    if ([string]::IsNullOrWhiteSpace($DomainFQDN)) {\n        return \"\"\n    }\n    \n    # Common domain suffixes to remove\n    $suffixes = @(\n        '.local', '.co.za', '.com', '.net', '.org', '.co.uk', '.com.au', '.ca',\n        '.de', '.fr', '.it', '.nl', '.be', '.ch', '.at', '.se', '.no', '.dk',\n        '.fi', '.ie', '.pt', '.es', '.pl', '.cz', '.hu', '.sk', '.si', '.hr',\n        '.rs', '.bg', '.ro', '.gr', '.cy', '.mt', '.lu', '.li', '.mc', '.sm',\n        '.va', '.ad', '.int'\n    )\n    \n    $customerName = $DomainFQDN.ToLower()\n    \n    # Remove common suffixes\n    foreach ($suffix in $suffixes) {\n        if ($customerName.EndsWith($suffix)) {\n            $customerName = $customerName.Substring(0, $customerName.Length - $suffix.Length)\n            break\n        }\n    }\n    \n    # Handle multi-part domains (take first part before first dot if multiple dots remain)\n    if ($customerName.Contains('.')) {\n        $parts = $customerName.Split('.')\n        $customerName = $parts[0]\n    }\n    \n    # Capitalize first letter and clean up\n    if ($customerName.Length -gt 0) {\n        $customerName = $customerName.Substring(0,1).ToUpper() + $customerName.Substring(1)\n        # Replace hyphens/underscores with spaces for better formatting\n        $customerName = $customerName -replace '[-_]', ' '\n    }\n    \n    return $customerName\n}\n\n# N-Central Logging Function  \nfunction Write-NCentralLog {\n    param(\n        [string]$Message,\n        [ValidateSet(\"Info\", \"Warning\", \"Error\", \"Success\")]\n        [string]$Level = \"Info\"\n    )\n    \n    $timestamp = Get-Date -Format \"yyyy-MM-dd HH:mm:ss\"\n    $logMessage = \"[$timestamp] [$Level] $Message\"\n    \n    # Output to console for N-Central capture\n    switch ($Level) {\n        \"Error\" { Write-Error $logMessage }\n        \"Warning\" { Write-Warning $logMessage }\n        \"Success\" { Write-Host $logMessage -ForegroundColor Green }\n        default { Write-Host $logMessage -ForegroundColor Cyan }\n    }\n    \n    # Also write to log file\n    try {\n        $logPath = \"C:\\Temp\\NCentral_AD_Assessment_$(Get-Date -Format 'yyyyMMdd').log\"\n        \"$logMessage\" | Out-File -FilePath $logPath -Append -Encoding UTF8\n    } catch {\n        # Ignore logging errors to prevent script failure\n    }\n}\n\n# Initialize N-Central execution\n$StartTime = Get-Date\nWrite-NCentralLog \"Starting N-Central Complete AD Security Assessment\" -Level \"Info\"\n\n# Ensure C:\\Temp exists\nif (-not (Test-Path \"C:\\Temp\")) {\n    try {\n        New-Item -Path \"C:\\Temp\" -ItemType Directory -Force | Out-Null\n        Write-NCentralLog \"Created C:\\Temp directory\" -Level \"Info\"\n    } catch {\n        Write-NCentralLog \"Failed to create C:\\Temp directory: $($_.Exception.Message)\" -Level \"Error\"\n        exit 1\n    }\n}\n\n# Import required modules\ntry {\n    Import-Module ActiveDirectory -ErrorAction Stop\n    Write-NCentralLog \"Active Directory module imported successfully\" -Level \"Success\"\n} catch {\n    Write-NCentralLog \"Failed to import Active Directory module: $($_.Exception.Message)\" -Level \"Error\"\n    Write-NCentralLog \"Ensure RSAT-AD-PowerShell is installed\" -Level \"Error\"\n    exit 1\n}\n\n# Check for required assemblies for PDF generation\ntry {\n    Add-Type -AssemblyName System.Drawing\n    Add-Type -AssemblyName System.Windows.Forms\n    Add-Type -AssemblyName Microsoft.PowerShell.Commands.Utility\n    Write-Host \"PDF generation libraries loaded successfully\" -ForegroundColor Green\n}\ncatch {\n    Write-Warning \"Some PDF generation features may be limited. Continuing with HTML to PDF conversion.\"\n}\n\n# N-Central Automated Setup - No Interactive Prompts\nWrite-NCentralLog \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -Level \"Info\"\nWrite-NCentralLog \"N-Central Active Directory Security Assessment Tool v11.1 Complete\" -Level \"Info\"\nWrite-NCentralLog \"Comprehensive Privileged Groups & User Analysis (Automated)\" -Level \"Info\"\nWrite-NCentralLog \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -Level \"Info\"\n\n# Handle domain selection first\nif ([string]::IsNullOrWhiteSpace($DomainName)) {\n    try {\n        $Domain = Get-ADDomain\n        $DomainName = $Domain.DNSRoot\n        Write-NCentralLog \"Using current domain: $DomainName\" -Level \"Success\"\n    } catch {\n        Write-NCentralLog \"Unable to connect to current domain: $($_.Exception.Message)\" -Level \"Error\"\n        exit 1\n    }\n} else {\n    try {\n        $Domain = Get-ADDomain -Server $DomainName\n        $DomainName = $Domain.DNSRoot\n        Write-NCentralLog \"Connected to specified domain: $DomainName\" -Level \"Success\"\n    } catch {\n        Write-NCentralLog \"Unable to connect to domain '$DomainName': $($_.Exception.Message)\" -Level \"Error\"\n        exit 1\n    }\n}\n\n# Auto-generate customer name from domain if not provided\nif ([string]::IsNullOrWhiteSpace($CustomerName)) {\n    $CustomerName = Get-CustomerNameFromDomain -DomainFQDN $DomainName\n    Write-NCentralLog \"Auto-generated customer name from domain: '$CustomerName'\" -Level \"Info\"\n    \n    if ([string]::IsNullOrWhiteSpace($CustomerName)) {\n        Write-NCentralLog \"Unable to generate customer name from domain '$DomainName'. Using domain NetBIOS name as customer name.\" -Level \"Warning\"\n        $CustomerName = $Domain.NetBIOSName\n    }\n} else {\n    Write-NCentralLog \"Using provided customer name: '$CustomerName'\" -Level \"Info\"\n}\n\n# Validate final inputs\nif ([string]::IsNullOrWhiteSpace($CustomerName)) {\n    Write-NCentralLog \"Customer Name could not be determined\" -Level \"Error\"\n    exit 1\n}\n\nif ([string]::IsNullOrWhiteSpace($EngineerName)) {\n    Write-NCentralLog \"Engineer Name could not be determined\" -Level \"Error\" \n    exit 1\n}\n\n# Initialize variables with N-Central friendly naming\n$ReportDate = Get-Date -Format \"yyyy-MM-dd HH:mm:ss\"\n$SafeCustomerName = $CustomerName -replace '[^\\w\\s]', '' -replace '\\s+', '_'\n$Timestamp = Get-Date -Format 'yyyyMMdd_HHmmss'\n\n# N-Central file naming with NCentral prefix for easy identification\n$OutputPathHTML = \"C:\\Temp\\NCentral_AD_Security_Assessment_$($SafeCustomerName)_$($Domain.NetBIOSName)_$($Timestamp).html\"\n$OutputPathPDF = \"C:\\Temp\\NCentral_AD_Security_Assessment_$($SafeCustomerName)_$($Domain.NetBIOSName)_$($Timestamp).pdf\"\n$OutputPathUserHTML = \"C:\\Temp\\NCentral_AD_User_Analysis_$($SafeCustomerName)_$($Domain.NetBIOSName)_$($Timestamp).html\"\n$OutputPathUserPDF = \"C:\\Temp\\NCentral_AD_User_Analysis_$($SafeCustomerName)_$($Domain.NetBIOSName)_$($Timestamp).pdf\"\n$OutputPathCSV = \"C:\\Temp\\NCentral_AD_Complete_Assessment_$($SafeCustomerName)_$($Domain.NetBIOSName)_$($Timestamp)_Details.csv\"\n\nWrite-NCentralLog \"Starting comprehensive Active Directory Security Assessment\" -Level \"Success\"\nWrite-NCentralLog \"Customer: $CustomerName\" -Level \"Info\"\nWrite-NCentralLog \"Domain: $DomainName\" -Level \"Info\" \nWrite-NCentralLog \"Engineer: $EngineerName\" -Level \"Info\"\nWrite-NCentralLog \"Output files will be prefixed with: NCentral_AD_*_$($SafeCustomerName)_$($Domain.NetBIOSName)_$($Timestamp)\" -Level \"Info\"\n\n# Function to calculate risk score\nfunction Get-RiskLevel {\n    param($Score)\n    if ($Score -ge 80) { return 'Critical' }\n    elseif ($Score -ge 60) { return 'High' }\n    elseif ($Score -ge 40) { return 'Medium' }\n    elseif ($Score -ge 20) { return 'Low' }\n    else { return 'Info' }\n}\n\n# Function to get domain password policy with enhanced evaluation\nfunction Get-DomainPasswordPolicy {\n    param($DomainServer)\n    Write-Host \"Retrieving enhanced domain password policy...\" -ForegroundColor Yellow\n    \n    $Policy = if ($DomainServer) { \n        Get-ADDefaultDomainPasswordPolicy -Server $DomainServer \n    } else { \n        Get-ADDefaultDomainPasswordPolicy \n    }\n    \n    return @{\n        'ComplexityEnabled' = $Policy.ComplexityEnabled\n        'DistinguishedName' = $Policy.DistinguishedName\n        'LockoutDuration' = $Policy.LockoutDuration.TotalMinutes\n        'LockoutObservationWindow' = $Policy.LockoutObservationWindow.TotalMinutes\n        'LockoutThreshold' = $Policy.LockoutThreshold\n        'MaxPasswordAge' = $Policy.MaxPasswordAge.TotalDays\n        'MinPasswordAge' = $Policy.MinPasswordAge.TotalDays\n        'MinPasswordLength' = $Policy.MinPasswordLength\n        'PasswordHistoryCount' = $Policy.PasswordHistoryCount\n        'ReversibleEncryptionEnabled' = $Policy.ReversibleEncryptionEnabled\n    }\n}\n\n# Function to get fine-grained password policies\nfunction Get-FineGrainedPolicies {\n    param($DomainServer)\n    Write-Host \"Retrieving fine-grained password policies...\" -ForegroundColor Yellow\n    \n    try {\n        $FGPPs = if ($DomainServer) {\n            Get-ADFineGrainedPasswordPolicy -Filter * -Properties * -Server $DomainServer\n        } else {\n            Get-ADFineGrainedPasswordPolicy -Filter * -Properties *\n        }\n        \n        $FGPPDetails = @()\n        \n        foreach ($FGPP in $FGPPs) {\n            $AppliesTo = if ($DomainServer) {\n                (Get-ADFineGrainedPasswordPolicySubject -Identity $FGPP -Server $DomainServer).Name -join \", \"\n            } else {\n                (Get-ADFineGrainedPasswordPolicySubject -Identity $FGPP).Name -join \", \"\n            }\n            \n            $FGPPDetails += [PSCustomObject]@{\n                'Name' = $FGPP.Name\n                'Precedence' = $FGPP.Precedence\n                'ComplexityEnabled' = $FGPP.ComplexityEnabled\n                'LockoutDuration' = $FGPP.LockoutDuration.TotalMinutes\n                'LockoutObservationWindow' = $FGPP.LockoutObservationWindow.TotalMinutes\n                'LockoutThreshold' = $FGPP.LockoutThreshold\n                'MaxPasswordAge' = $FGPP.MaxPasswordAge.TotalDays\n                'MinPasswordAge' = $FGPP.MinPasswordAge.TotalDays\n                'MinPasswordLength' = $FGPP.MinPasswordLength\n                'PasswordHistoryCount' = $FGPP.PasswordHistoryCount\n                'ReversibleEncryptionEnabled' = $FGPP.ReversibleEncryptionEnabled\n                'AppliesTo' = $AppliesTo\n            }\n        }\n        \n        return $FGPPDetails\n    }\n    catch {\n        Write-Warning \"No fine-grained password policies found or insufficient permissions\"\n        return @()\n    }\n}\n\n# Enhanced function to analyze password policy compliance with new requirements\nfunction Test-PolicyCompliance {\n    param($Policy)\n    \n    $Issues = @()\n    $RiskScore = 0\n    \n    # Enhanced Microsoft Best Practices and Industry Standards\n    if (-not $Policy.ComplexityEnabled) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = 'Password complexity is disabled'\n            'Risk' = 'High'\n            'Recommendation' = 'Enable password complexity requirements'\n            'BestPractice' = 'Microsoft recommends enabling complexity for passwords'\n        }\n        $RiskScore += 20\n    }\n    \n    if ($Policy.MinPasswordLength -lt 14) {\n        $Risk = if ($Policy.MinPasswordLength -lt 8) { 'Critical' } \n               elseif ($Policy.MinPasswordLength -lt 12) { 'High' }\n               else { 'Medium' }\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Minimum password length is $($Policy.MinPasswordLength) characters\"\n            'Risk' = $Risk\n            'Recommendation' = 'Set minimum password length to 14+ characters per NIST SP 800-63B'\n            'BestPractice' = 'NIST SP 800-63B and Microsoft recommend 14+ character passwords for security'\n        }\n        $RiskScore += if ($Policy.MinPasswordLength -lt 8) { 30 } \n                     elseif ($Policy.MinPasswordLength -lt 12) { 20 } \n                     else { 15 }\n    }\n    \n    # Enhanced Minimum Password Age evaluation\n    if ($Policy.MinPasswordAge -lt 1) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Minimum password age is $($Policy.MinPasswordAge) days\"\n            'Risk' = 'High'\n            'Recommendation' = 'Set minimum password age to at least 1 day to prevent immediate password reuse'\n            'BestPractice' = 'Industry standard is 1-2 days to balance security with usability'\n        }\n        $RiskScore += 20\n    }\n    elseif ($Policy.MinPasswordAge -gt 2) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Minimum password age is $($Policy.MinPasswordAge) days\"\n            'Risk' = 'Low'\n            'Recommendation' = 'Consider reducing minimum password age to 1-2 days'\n            'BestPractice' = 'Industry standard is 1-2 days to balance security with usability'\n        }\n        $RiskScore += 5\n    }\n    \n    # Enhanced Maximum Password Age evaluation\n    if ($Policy.MaxPasswordAge -eq 0) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Maximum password age is set to never expire\"\n            'Risk' = 'Critical'\n            'Recommendation' = 'Set maximum password age to 60-365 days or implement alternative authentication'\n            'BestPractice' = 'Balance between security and usability - consider modern authentication methods'\n        }\n        $RiskScore += 35\n    }\n    elseif ($Policy.MaxPasswordAge -gt 365) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Maximum password age is $($Policy.MaxPasswordAge) days\"\n            'Risk' = 'Medium'\n            'Recommendation' = 'Consider reducing maximum password age to 365 days or less'\n            'BestPractice' = 'Regularly changed passwords reduce long-term exposure risk'\n        }\n        $RiskScore += 15\n    }\n    \n    if ($Policy.PasswordHistoryCount -lt 12) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Password history is set to $($Policy.PasswordHistoryCount) passwords\"\n            'Risk' = 'Medium'\n            'Recommendation' = 'Set password history to remember at least 12 passwords'\n            'BestPractice' = 'Prevents password reuse and cycling - Microsoft baseline recommendation'\n        }\n        $RiskScore += 10\n    }\n    \n    if ($Policy.LockoutThreshold -eq 0) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = 'Account lockout is disabled'\n            'Risk' = 'Critical'\n            'Recommendation' = 'Enable account lockout with threshold of 5-10 attempts'\n            'BestPractice' = 'Protects against brute force attacks while maintaining usability'\n        }\n        $RiskScore += 35\n    }\n    elseif ($Policy.LockoutThreshold -lt 5 -or $Policy.LockoutThreshold -gt 10) {\n        $Risk = if ($Policy.LockoutThreshold -lt 5) { 'Medium' } else { 'Low' }\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Account lockout threshold is $($Policy.LockoutThreshold) attempts\"\n            'Risk' = $Risk\n            'Recommendation' = 'Set lockout threshold to 5-10 failed attempts for optimal security'\n            'BestPractice' = 'Balance security protection with user experience'\n        }\n        $RiskScore += if ($Policy.LockoutThreshold -lt 5) { 15 } else { 5 }\n    }\n    \n    # Enhanced Lockout Duration evaluation\n    if ($Policy.LockoutDuration -lt 15) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Account lockout duration is $($Policy.LockoutDuration) minutes\"\n            'Risk' = 'High'\n            'Recommendation' = 'Set lockout duration to at least 15 minutes for optimal security'\n            'BestPractice' = 'Adequate lockout duration deters automated attacks while minimizing user impact'\n        }\n        $RiskScore += 20\n    }\n    elseif ($Policy.LockoutDuration -gt 60) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Account lockout duration is $($Policy.LockoutDuration) minutes\"\n            'Risk' = 'Low'\n            'Recommendation' = 'Consider reducing lockout duration to 15-60 minutes'\n            'BestPractice' = 'Adequate lockout duration deters automated attacks while minimizing user impact'\n        }\n        $RiskScore += 5\n    }\n    \n    # Enhanced Reset Account Lockout Counter evaluation\n    if ($Policy.LockoutObservationWindow -lt $Policy.LockoutDuration -and $Policy.LockoutThreshold -gt 0) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Reset account lockout counter ($($Policy.LockoutObservationWindow) min) is less than lockout duration ($($Policy.LockoutDuration) min)\"\n            'Risk' = 'High'\n            'Recommendation' = 'Set reset lockout counter equal to or greater than lockout duration'\n            'BestPractice' = 'Ensures proper lockout behavior and prevents premature counter resets'\n        }\n        $RiskScore += 20\n    }\n    \n    if ($Policy.ReversibleEncryptionEnabled) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = 'Reversible encryption is enabled'\n            'Risk' = 'Critical'\n            'Recommendation' = 'Disable reversible encryption immediately - CRITICAL SECURITY RISK'\n            'BestPractice' = 'Reversible encryption is equivalent to storing passwords in plain text'\n        }\n        $RiskScore += 35\n    }\n    \n    return @{\n        'Issues' = $Issues\n        'RiskScore' = $RiskScore\n        'RiskLevel' = Get-RiskLevel $RiskScore\n    }\n}\n\n# Enhanced function to get comprehensive privileged group analysis\nfunction Get-AllPrivilegedAccounts {\n    param($DomainServer)\n    Write-Host \"Performing comprehensive privileged group analysis...\" -ForegroundColor Yellow\n    \n    $PrivilegedGroups = @(\n        'Domain Admins',\n        'Enterprise Admins', \n        'Schema Admins',\n        'Administrators'\n    )\n    \n    $AllPrivilegedAccounts = @()\n    \n    foreach ($GroupName in $PrivilegedGroups) {\n        Write-Host \"  Analyzing group: $GroupName\" -ForegroundColor Cyan\n        \n        try {\n            # Get group with recursive membership\n            $Members = if ($DomainServer) {\n                Get-ADGroupMember $GroupName -Recursive -Server $DomainServer -ErrorAction SilentlyContinue\n            } else {\n                Get-ADGroupMember $GroupName -Recursive -ErrorAction SilentlyContinue\n            }\n            \n            foreach ($Member in $Members) {\n                if ($Member.objectClass -eq \"user\") {\n                    $User = if ($DomainServer) {\n                        Get-ADUser $Member.SamAccountName -Properties LastLogonDate, PasswordLastSet, Enabled, AccountExpirationDate, PasswordNeverExpires, MemberOf -Server $DomainServer\n                    } else {\n                        Get-ADUser $Member.SamAccountName -Properties LastLogonDate, PasswordLastSet, Enabled, AccountExpirationDate, PasswordNeverExpires, MemberOf\n                    }\n                    \n                    $LastLogon = if ($User.LastLogonDate) { $User.LastLogonDate } else { \"Never\" }\n                    $PasswordLastSet = if ($User.PasswordLastSet) { $User.PasswordLastSet } else { \"Never\" }\n                    \n                    # Calculate days since last logon and password change\n                    $DaysSinceLogon = if ($User.LastLogonDate) { (Get-Date) - $User.LastLogonDate | Select-Object -ExpandProperty Days } else { 9999 }\n                    $DaysSincePasswordChange = if ($User.PasswordLastSet) { (Get-Date) - $User.PasswordLastSet | Select-Object -ExpandProperty Days } else { 9999 }\n                    \n                    # Get all privileged groups this user belongs to\n                    $UserPrivilegedGroups = @()\n                    foreach ($CheckGroup in $PrivilegedGroups) {\n                        try {\n                            $GroupMembers = if ($DomainServer) {\n                                Get-ADGroupMember $CheckGroup -Recursive -Server $DomainServer -ErrorAction SilentlyContinue\n                            } else {\n                                Get-ADGroupMember $CheckGroup -Recursive -ErrorAction SilentlyContinue\n                            }\n                            if ($GroupMembers.SamAccountName -contains $User.SamAccountName) {\n                                $UserPrivilegedGroups += $CheckGroup\n                            }\n                        }\n                        catch {\n                            # Group might not exist in this domain\n                        }\n                    }\n                    \n                    # Enhanced risk assessment with multi-factor analysis\n                    $RiskFactors = @()\n                    $RiskScore = 0\n                    \n                    if (-not $User.Enabled) { \n                        $RiskFactors += \"Account Disabled\"\n                        $RiskScore += 0 # Disabled accounts are actually lower risk\n                    }\n                    \n                    if ($DaysSinceLogon -gt 180) { \n                        $RiskFactors += \"No logon for 180+ days\"\n                        $RiskScore += 30\n                    }\n                    elseif ($DaysSinceLogon -gt 90) { \n                        $RiskFactors += \"No logon for 90+ days\"\n                        $RiskScore += 20\n                    }\n                    elseif ($DaysSinceLogon -gt 30) { \n                        $RiskFactors += \"No logon for 30+ days\"\n                        $RiskScore += 40  # Changed to Critical for 30+ days\n                    }\n                    \n                    if ($LastLogon -eq \"Never\") {\n                        $RiskFactors += \"Never logged on\"\n                        $RiskScore += 40  # Changed to Critical\n                    }\n                    \n                    if ($DaysSincePasswordChange -gt 365) { \n                        $RiskFactors += \"Password older than 1 year\"\n                        $RiskScore += 30\n                    }\n                    elseif ($DaysSincePasswordChange -gt 180) { \n                        $RiskFactors += \"Password older than 6 months\"\n                        $RiskScore += 25  # Changed to High risk\n                    }\n                    \n                    if ($User.PasswordNeverExpires) { \n                        $RiskFactors += \"Password never expires\"\n                        $RiskScore += 30  # Changed to High risk\n                    }\n                    \n                    if ($PasswordLastSet -eq \"Never\") {\n                        $RiskFactors += \"Password never set\"\n                        $RiskScore += 40  # Changed to Critical\n                    }\n                    \n                    if ($UserPrivilegedGroups.Count -gt 1) {\n                        $RiskFactors += \"Multiple privileged group memberships\"\n                        $RiskScore += 5\n                    }\n                    \n                    # Check for default Administrator account\n                    if ($User.SamAccountName -eq \"Administrator\" -and $User.Enabled) {\n                        $RiskFactors += \"Default Administrator account is enabled\"\n                        $RiskScore += 40  # Changed to Critical\n                    }\n                    \n                    # Determine overall risk level\n                    $Risk = Get-RiskLevel $RiskScore\n                    if (-not $User.Enabled) { $Risk = 'Info' }\n                    \n                    $AllPrivilegedAccounts += [PSCustomObject]@{\n                        'Name' = $User.Name\n                        'SamAccountName' = $User.SamAccountName\n                        'PrimaryGroup' = $GroupName\n                        'AllPrivilegedGroups' = $UserPrivilegedGroups -join \"; \"\n                        'Enabled' = $User.Enabled\n                        'LastLogonDate' = $LastLogon\n                        'PasswordLastSet' = $PasswordLastSet\n                        'DaysSinceLogon' = $DaysSinceLogon\n                        'DaysSincePasswordChange' = $DaysSincePasswordChange\n                        'PasswordNeverExpires' = $User.PasswordNeverExpires\n                        'AccountExpirationDate' = $User.AccountExpirationDate\n                        'RiskFactors' = $RiskFactors -join \"; \"\n                        'RiskScore' = $RiskScore\n                        'Risk' = $Risk\n                    }\n                }\n            }\n        }\n        catch {\n            Write-Warning \"Unable to analyze group '$GroupName': $($_.Exception.Message)\"\n        }\n    }\n    \n    # Remove duplicates (users in multiple groups)\n    $UniqueAccounts = $AllPrivilegedAccounts | Sort-Object SamAccountName -Unique\n    \n    return $UniqueAccounts\n}\n\n# New function for comprehensive domain user analysis\nfunction Get-DomainUserAnalysis {\n    param($DomainServer)\n    Write-Host \"Performing comprehensive domain user analysis...\" -ForegroundColor Yellow\n    Write-Host \"  This may take several minutes for large domains...\" -ForegroundColor Cyan\n    \n    $AllUsers = if ($DomainServer) {\n        Get-ADUser -Filter * -Properties LastLogonDate, PasswordLastSet, Enabled, AccountExpirationDate, PasswordNeverExpires, Created, BadLogonCount -Server $DomainServer\n    } else {\n        Get-ADUser -Filter * -Properties LastLogonDate, PasswordLastSet, Enabled, AccountExpirationDate, PasswordNeverExpires, Created, BadLogonCount\n    }\n    \n    Write-Host \"  Analyzing $($AllUsers.Count) user accounts...\" -ForegroundColor Cyan\n    \n    $UserAnalysis = @()\n    $Counter = 0\n    \n    foreach ($User in $AllUsers) {\n        $Counter++\n        if ($Counter % 100 -eq 0) {\n            Write-Host \"    Processed $Counter of $($AllUsers.Count) users...\" -ForegroundColor Yellow\n        }\n        \n        $LastLogon = if ($User.LastLogonDate) { $User.LastLogonDate } else { \"Never\" }\n        $PasswordLastSet = if ($User.PasswordLastSet) { $User.PasswordLastSet } else { \"Never\" }\n        \n        # Calculate days since last logon and password change\n        $DaysSinceLogon = if ($User.LastLogonDate) { (Get-Date) - $User.LastLogonDate | Select-Object -ExpandProperty Days } else { 9999 }\n        $DaysSincePasswordChange = if ($User.PasswordLastSet) { (Get-Date) - $User.PasswordLastSet | Select-Object -ExpandProperty Days } else { 9999 }\n        $DaysSinceCreated = if ($User.Created) { (Get-Date) - $User.Created | Select-Object -ExpandProperty Days } else { 9999 }\n        \n        # Password and account risk assessment\n        $RiskFactors = @()\n        $RiskScore = 0\n        \n        # Account status risks\n        if (-not $User.Enabled) { \n            $RiskFactors += \"Account Disabled\"\n        }\n        \n        # Logon pattern risks\n        if ($LastLogon -eq \"Never\") {\n            $RiskFactors += \"Never logged on\"\n            $RiskScore += 25\n        }\n        elseif ($DaysSinceLogon -gt 365) { \n            $RiskFactors += \"No logon for 1+ years (Stale)\"\n            $RiskScore += 30\n        }\n        elseif ($DaysSinceLogon -gt 180) { \n            $RiskFactors += \"No logon for 6+ months\"\n            $RiskScore += 25\n        }\n        elseif ($DaysSinceLogon -gt 90) { \n            $RiskFactors += \"No logon for 3+ months\"\n            $RiskScore += 20\n        }\n        elseif ($DaysSinceLogon -gt 30) { \n            $RiskFactors += \"No logon for 30+ days\"\n            $RiskScore += 40  # Changed to Critical\n        }\n        \n        # Password security risks\n        if ($PasswordLastSet -eq \"Never\") {\n            $RiskFactors += \"Password never set\"\n            $RiskScore += 30\n        }\n        elseif ($DaysSincePasswordChange -gt 730) { \n            $RiskFactors += \"Password older than 2 years\"\n            $RiskScore += 30\n        }\n        elseif ($DaysSincePasswordChange -gt 365) { \n            $RiskFactors += \"Password older than 1 year\"\n            $RiskScore += 25\n        }\n        elseif ($DaysSincePasswordChange -gt 180) { \n            $RiskFactors += \"Password older than 6 months\"\n            $RiskScore += 20  # Changed to High risk\n        }\n        \n        if ($User.PasswordNeverExpires) { \n            $RiskFactors += \"Password never expires\"\n            $RiskScore += 25  # Changed to High risk\n        }\n        \n        # Account behavior risks\n        if ($User.BadLogonCount -gt 0) {\n            $RiskFactors += \"Recent failed logon attempts: $($User.BadLogonCount)\"\n            $RiskScore += 10\n        }\n        \n        # New account risks\n        if ($DaysSinceCreated -lt 30 -and $LastLogon -eq \"Never\") {\n            $RiskFactors += \"New account never used\"\n            $RiskScore += 15\n        }\n        \n        # Account expiration\n        if ($User.AccountExpirationDate -and $User.AccountExpirationDate -lt (Get-Date)) {\n            $RiskFactors += \"Account expired\"\n            $RiskScore += 5\n        }\n        \n        # Check for default Administrator account\n        if ($User.SamAccountName -eq \"Administrator\" -and $User.Enabled) {\n            $RiskFactors += \"Default Administrator account is enabled\"\n            $RiskScore += 40  # Changed to Critical\n        }\n        \n        # Determine overall risk level\n        $Risk = Get-RiskLevel $RiskScore\n        if (-not $User.Enabled) { $Risk = 'Info' }\n        \n        # Categorize user type\n        $UserType = \"Standard User\"\n        if ($User.SamAccountName -like \"*admin*\" -or $User.SamAccountName -like \"*svc*\" -or $User.SamAccountName -like \"*service*\") {\n            $UserType = \"Service/Admin Account\"\n        }\n        elseif ($User.SamAccountName -like \"*test*\" -or $User.SamAccountName -like \"*temp*\") {\n            $UserType = \"Test/Temp Account\"\n        }\n        \n        $UserAnalysis += [PSCustomObject]@{\n            'Name' = $User.Name\n            'SamAccountName' = $User.SamAccountName\n            'UserType' = $UserType\n            'Enabled' = $User.Enabled\n            'Created' = if ($User.Created) { $User.Created.ToString(\"yyyy-MM-dd\") } else { \"Unknown\" }\n            'LastLogonDate' = if ($LastLogon -eq \"Never\") { \"Never\" } else { $LastLogon.ToString(\"yyyy-MM-dd\") }\n            'PasswordLastSet' = if ($PasswordLastSet -eq \"Never\") { \"Never\" } else { $PasswordLastSet.ToString(\"yyyy-MM-dd\") }\n            'DaysSinceLogon' = $DaysSinceLogon\n            'DaysSincePasswordChange' = $DaysSincePasswordChange\n            'PasswordNeverExpires' = $User.PasswordNeverExpires\n            'AccountExpirationDate' = $User.AccountExpirationDate\n            'BadLogonCount' = $User.BadLogonCount\n            'RiskFactors' = if ($RiskFactors.Count -gt 0) { $RiskFactors -join \"; \" } else { \"None\" }\n            'RiskScore' = $RiskScore\n            'Risk' = $Risk\n        }\n    }\n    \n    Write-Host \"  User analysis completed!\" -ForegroundColor Green\n    return $UserAnalysis\n}\n\n# Enhanced function to generate professional HTML for main security assessment\nfunction New-SecurityAssessmentHTML {\n    param(\n        $DomainPolicy,\n        $FGPPs,\n        $PolicyCompliance,\n        $PrivilegedAccounts,\n        $CustomerName,\n        $DomainName,\n        $EngineerName\n    )\n    \n    # Calculate additional metrics\n    $StalePrivileged = $PrivilegedAccounts | Where-Object { $_.DaysSinceLogon -gt 90 -and $_.Enabled }\n    $CriticalIssues = $PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Critical' }\n    $HighIssues = $PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'High' }\n    $NeverLoggedOn = $PrivilegedAccounts | Where-Object { $_.LastLogonDate -eq 'Never' }\n    \n    $HTML = @\"\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <title>Active Directory Security Assessment Report</title>\n    <style>\n        @page {\n            margin: 0.5in;\n            @top-center {\n                content: \"Active Directory Security Assessment\";\n                font-family: 'Segoe UI', sans-serif;\n                font-size: 10px;\n                color: #666;\n            }\n            @bottom-center {\n                content: \"Page \" counter(page) \" of \" counter(pages);\n                font-family: 'Segoe UI', sans-serif;\n                font-size: 10px;\n                color: #666;\n            }\n        }\n        \n        body {\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n            margin: 0;\n            padding: 20px;\n            background-color: white;\n            line-height: 1.4;\n            font-size: 11px;\n        }\n        \n        .header {\n            text-align: center;\n            border-bottom: 3px solid #2E86AB;\n            padding-bottom: 15px;\n            margin-bottom: 20px;\n        }\n        \n        .customer-name {\n            font-size: 28px;\n            font-weight: bold;\n            color: #2E86AB;\n            margin-bottom: 5px;\n            text-transform: uppercase;\n        }\n        \n        .report-title {\n            font-size: 18px;\n            font-weight: bold;\n            color: #333;\n            margin-bottom: 15px;\n        }\n        \n        .header-info {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 20px;\n            margin-top: 15px;\n            font-size: 10px;\n        }\n        \n        .section {\n            margin-bottom: 20px;\n            page-break-inside: avoid;\n        }\n        \n        .section h2 {\n            background: linear-gradient(135deg, #2E86AB 0%, #1f5f99 100%);\n            color: white;\n            padding: 8px 15px;\n            margin: 0 0 10px 0;\n            font-size: 14px;\n            font-weight: bold;\n        }\n        \n        .section h3 {\n            color: #2E86AB;\n            font-size: 12px;\n            margin: 15px 0 8px 0;\n            border-bottom: 1px solid #ddd;\n            padding-bottom: 3px;\n        }\n        \n        .executive-summary {\n            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);\n            padding: 15px;\n            border-left: 4px solid #2E86AB;\n            margin-bottom: 20px;\n        }\n        \n        .metrics-grid {\n            display: grid;\n            grid-template-columns: repeat(4, 1fr);\n            gap: 15px;\n            margin: 15px 0;\n        }\n        \n        .metric-card {\n            text-align: center;\n            padding: 12px;\n            background: white;\n            border: 1px solid #ddd;\n            border-radius: 5px;\n        }\n        \n        .metric-value {\n            font-size: 18px;\n            font-weight: bold;\n            color: #2E86AB;\n        }\n        \n        .metric-label {\n            font-size: 10px;\n            color: #666;\n            margin-top: 5px;\n        }\n        \n        table {\n            width: 100%;\n            border-collapse: collapse;\n            margin: 10px 0;\n            font-size: 10px;\n        }\n        \n        th, td {\n            border: 1px solid #ddd;\n            padding: 6px;\n            text-align: left;\n        }\n        \n        th {\n            background-color: #f8f9fa;\n            font-weight: bold;\n            color: #2E86AB;\n        }\n        \n        .compliant {\n            background-color: #d4edda;\n            color: #155724;\n            font-weight: bold;\n        }\n        \n        .non-compliant {\n            background-color: #f8d7da;\n            color: #721c24;\n            font-weight: bold;\n        }\n        \n        .risk-critical {\n            background-color: #f8d7da;\n            border-left: 4px solid #dc3545;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-high {\n            background-color: #fff3cd;\n            border-left: 4px solid #ffc107;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-medium {\n            background-color: #d1ecf1;\n            border-left: 4px solid #17a2b8;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-low {\n            background-color: #d4edda;\n            border-left: 4px solid #28a745;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-badge {\n            padding: 3px 8px;\n            border-radius: 12px;\n            color: white;\n            font-weight: bold;\n            font-size: 9px;\n            text-transform: uppercase;\n        }\n        \n        .risk-critical .risk-badge { background-color: #dc3545; }\n        .risk-high .risk-badge { background-color: #ffc107; color: #333; }\n        .risk-medium .risk-badge { background-color: #17a2b8; }\n        .risk-low .risk-badge { background-color: #28a745; }\n        \n        .recommendation {\n            background-color: #f0f8ff;\n            border: 1px solid #b3d9ff;\n            padding: 12px;\n            margin: 10px 0;\n            border-radius: 5px;\n        }\n        \n        .recommendation h4 {\n            margin: 0 0 8px 0;\n            color: #2E86AB;\n            font-size: 11px;\n        }\n        \n        .footer {\n            border-top: 2px solid #2E86AB;\n            padding-top: 15px;\n            margin-top: 30px;\n            text-align: center;\n            font-size: 9px;\n            color: #666;\n        }\n        \n        .chart-container {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 20px;\n            margin: 15px 0;\n        }\n        \n        .chart-item {\n            background: white;\n            border: 1px solid #ddd;\n            padding: 10px;\n            border-radius: 5px;\n        }\n        \n        .progress-bar {\n            width: 100%;\n            height: 15px;\n            background-color: #e9ecef;\n            border-radius: 8px;\n            overflow: hidden;\n            margin: 5px 0;\n        }\n        \n        .progress-fill {\n            height: 100%;\n            border-radius: 8px;\n        }\n        \n        .no-break { page-break-inside: avoid; }\n        \n        .enhanced-metrics {\n            display: grid;\n            grid-template-columns: repeat(6, 1fr);\n            gap: 10px;\n            margin: 15px 0;\n        }\n        \n        .risk-distribution {\n            display: grid;\n            grid-template-columns: repeat(4, 1fr);\n            gap: 10px;\n            margin: 10px 0;\n        }\n        \n        .risk-item {\n            text-align: center;\n            padding: 8px;\n            border-radius: 5px;\n            color: white;\n            font-weight: bold;\n        }\n        \n        .risk-critical-bg { background-color: #dc3545; }\n        .risk-high-bg { background-color: #fd7e14; }\n        .risk-medium-bg { background-color: #ffc107; color: #333; }\n        .risk-low-bg { background-color: #28a745; }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <div class=\"customer-name\">$CustomerName</div>\n        <div class=\"report-title\">Active Directory Security Assessment Report</div>\n        <div style=\"font-size: 12px; color: #2E86AB; margin-top: 5px;\">Comprehensive Privileged Groups & Deafult Domain Password Policy Analysis</div>\n        \n        <div class=\"header-info\">\n            <div>\n                <strong>Customer:</strong> $CustomerName<br>\n                <strong>Domain:</strong> $DomainName<br>\n                <strong>Assessment Date:</strong> $ReportDate\n            </div>\n            <div>\n                <strong>Assessed By:</strong> $EngineerName<br>\n                <strong>Report Version:</strong> 11.0<br>\n                <strong>Classification:</strong> Domain Security\n            </div>\n        </div>\n    </div>\n\n    <div class=\"executive-summary no-break\">\n        <h2>Executive Summary</h2>\n        <p>This comprehensive assessment evaluates the Active Directory password policies, fine-grained policies, and <strong>all privileged group memberships</strong> (Domain Admins, Enterprise Admins, Schema Admins, Administrators) for <strong>$CustomerName</strong>. The evaluation compares current configurations against Microsoft security baselines, NIST SP 800-63B guidelines, and industry best practices to identify security risks and provide actionable recommendations.</p>\n        \n        <div class=\"enhanced-metrics\">\n            <div class=\"metric-card\">\n                <div class=\"metric-value\" style=\"color: $(\n                    switch ($PolicyCompliance.RiskLevel) {\n                        'Critical' { '#dc3545' }\n                        'High' { '#fd7e14' }\n                        'Medium' { '#ffc107' }\n                        'Low' { '#28a745' }\n                        default { '#17a2b8' }\n                    }\n                );\">$($PolicyCompliance.RiskLevel.ToUpper())</div>\n                <div class=\"metric-label\">Overall Risk Level</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$($PolicyCompliance.RiskScore)/100</div>\n                <div class=\"metric-label\">Policy Risk Score</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$($PolicyCompliance.Issues.Count)</div>\n                <div class=\"metric-label\">Policy Issues</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$($PrivilegedAccounts.Count)</div>\n                <div class=\"metric-label\">Privileged Accounts</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$($StalePrivileged.Count)</div>\n                <div class=\"metric-label\">Stale Privileged</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$($NeverLoggedOn.Count)</div>\n                <div class=\"metric-label\">Never Used</div>\n            </div>\n        </div>\n        \n        <div class=\"chart-container\">\n            <div class=\"chart-item\">\n                <h4>Security Compliance Score</h4>\n                <div class=\"progress-bar\">\n                    <div class=\"progress-fill\" style=\"width: $((100-$PolicyCompliance.RiskScore))%; background-color: $(\n                        if ((100-$PolicyCompliance.RiskScore) -ge 80) { '#28a745' }\n                        elseif ((100-$PolicyCompliance.RiskScore) -ge 60) { '#ffc107' }\n                        else { '#dc3545' }\n                    );\"></div>\n                </div>\n                <small>$((100-$PolicyCompliance.RiskScore))% Compliant</small>\n            </div>\n            <div class=\"chart-item\">\n                <h4>Privileged Account Health</h4>\n                <div class=\"progress-bar\">\n                    <div class=\"progress-fill\" style=\"width: $(\n                        if ($PrivilegedAccounts.Count -gt 0) {\n                            $HealthyPrivileged = $PrivilegedAccounts | Where-Object { $_.Risk -eq 'Low' -or $_.Risk -eq 'Info' }\n                            [math]::Round(($HealthyPrivileged.Count / $PrivilegedAccounts.Count) * 100, 0)\n                        } else { 0 }\n                    )%; background-color: #28a745;\"></div>\n                </div>\n                <small>$(\n                    if ($PrivilegedAccounts.Count -gt 0) {\n                        $HealthyPrivileged = $PrivilegedAccounts | Where-Object { $_.Risk -eq 'Low' -or $_.Risk -eq 'Info' }\n                        [math]::Round(($HealthyPrivileged.Count / $PrivilegedAccounts.Count) * 100, 0)\n                    } else { 0 }\n                )% Low Risk</small>\n            </div>\n        </div>\n        \n        <div class=\"risk-distribution\">\n            <div class=\"risk-item risk-critical-bg\">\n                <div>$(($PrivilegedAccounts | Where-Object { $_.Risk -eq 'Critical' }).Count)</div>\n                <div style=\"font-size: 9px;\">CRITICAL</div>\n            </div>\n            <div class=\"risk-item risk-high-bg\">\n                <div>$(($PrivilegedAccounts | Where-Object { $_.Risk -eq 'High' }).Count)</div>\n                <div style=\"font-size: 9px;\">HIGH</div>\n            </div>\n            <div class=\"risk-item risk-medium-bg\">\n                <div>$(($PrivilegedAccounts | Where-Object { $_.Risk -eq 'Medium' }).Count)</div>\n                <div style=\"font-size: 9px;\">MEDIUM</div>\n            </div>\n            <div class=\"risk-item risk-low-bg\">\n                <div>$(($PrivilegedAccounts | Where-Object { $_.Risk -eq 'Low' -or $_.Risk -eq 'Info' }).Count)</div>\n                <div style=\"font-size: 9px;\">LOW/INFO</div>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"section no-break\">\n        <h2>Domain Password Policy Assessment</h2>\n        <p>Current domain password policy configuration compared to Microsoft security baselines and NIST SP 800-63B guidelines:</p>\n        \n        <table>\n            <thead>\n                <tr>\n                    <th>Policy Setting</th>\n                    <th>Current Value</th>\n                    <th>Best Practice</th>\n                    <th>Compliance Status</th>\n                </tr>\n            </thead>\n            <tbody>\n                <tr>\n                    <td>Password Complexity</td>\n                    <td>$($DomainPolicy.ComplexityEnabled)</td>\n                    <td>Enabled</td>\n                    <td class=\"$(if($DomainPolicy.ComplexityEnabled){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.ComplexityEnabled){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Minimum Password Length</td>\n                    <td>$($DomainPolicy.MinPasswordLength) characters</td>\n                    <td>14+ characters (NIST SP 800-63B)</td>\n                    <td class=\"$(if($DomainPolicy.MinPasswordLength -ge 14){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.MinPasswordLength -ge 14){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Minimum Password Age</td>\n                    <td>$($DomainPolicy.MinPasswordAge) days</td>\n                    <td>1-2 days (prevents immediate reuse)</td>\n                    <td class=\"$(if($DomainPolicy.MinPasswordAge -ge 1 -and $DomainPolicy.MinPasswordAge -le 2){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.MinPasswordAge -ge 1 -and $DomainPolicy.MinPasswordAge -le 2){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Maximum Password Age</td>\n                    <td>$(if($DomainPolicy.MaxPasswordAge -eq 0){'Never expires'}else{\"$($DomainPolicy.MaxPasswordAge) days\"})</td>\n                    <td>60-365 days or modern auth</td>\n                    <td class=\"$(if(($DomainPolicy.MaxPasswordAge -ge 60 -and $DomainPolicy.MaxPasswordAge -le 365) -or $DomainPolicy.MaxPasswordAge -eq 0){'compliant'}else{'non-compliant'})\">\n                        $(if(($DomainPolicy.MaxPasswordAge -ge 60 -and $DomainPolicy.MaxPasswordAge -le 365) -or $DomainPolicy.MaxPasswordAge -eq 0){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Password History Count</td>\n                    <td>$($DomainPolicy.PasswordHistoryCount) passwords</td>\n                    <td>12+ passwords</td>\n                    <td class=\"$(if($DomainPolicy.PasswordHistoryCount -ge 12){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.PasswordHistoryCount -ge 12){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Account Lockout Threshold</td>\n                    <td>$($DomainPolicy.LockoutThreshold) attempts</td>\n                    <td>5-10 attempts</td>\n                    <td class=\"$(if($DomainPolicy.LockoutThreshold -ge 5 -and $DomainPolicy.LockoutThreshold -le 10){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.LockoutThreshold -ge 5 -and $DomainPolicy.LockoutThreshold -le 10){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Lockout Duration</td>\n                    <td>$($DomainPolicy.LockoutDuration) minutes</td>\n                    <td>15-60 minutes</td>\n                    <td class=\"$(if($DomainPolicy.LockoutDuration -ge 15 -and $DomainPolicy.LockoutDuration -le 60){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.LockoutDuration -ge 15 -and $DomainPolicy.LockoutDuration -le 60){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Reset Account Lockout Counter</td>\n                    <td>$($DomainPolicy.LockoutObservationWindow) minutes</td>\n                    <td>‚â• Lockout Duration ($($DomainPolicy.LockoutDuration) min)</td>\n                    <td class=\"$(if($DomainPolicy.LockoutObservationWindow -ge $DomainPolicy.LockoutDuration){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.LockoutObservationWindow -ge $DomainPolicy.LockoutDuration){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Reversible Encryption</td>\n                    <td>$($DomainPolicy.ReversibleEncryptionEnabled)</td>\n                    <td>Disabled (CRITICAL)</td>\n                    <td class=\"$(if(-not $DomainPolicy.ReversibleEncryptionEnabled){'compliant'}else{'non-compliant'})\">\n                        $(if(-not $DomainPolicy.ReversibleEncryptionEnabled){'‚úì Compliant'}else{'üî• CRITICAL NON-COMPLIANT'})\n                    </td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n\n    <div class=\"section\">\n        <h2>Comprehensive Privileged Group Analysis</h2>\n        <p>Analysis of ALL privileged groups with recursive nested membership support:</p>\n        \n        <h3>Privileged Group Summary</h3>\n        <div class=\"chart-container\">\n            <div class=\"chart-item\">\n                <h4>Group Membership Distribution</h4>\n\"@\n\n    # Calculate group distributions\n    $DomainAdminsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Domain Admins*\" }).Count\n    $EnterpriseAdminsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Enterprise Admins*\" }).Count\n    $SchemaAdminsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Schema Admins*\" }).Count\n    $AdministratorsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Administrators*\" }).Count\n    \n    $HTML += @\"\n                <p><strong>Domain Admins:</strong> $DomainAdminsCount</p>\n                <p><strong>Enterprise Admins:</strong> $EnterpriseAdminsCount</p>\n                <p><strong>Schema Admins:</strong> $SchemaAdminsCount</p>\n                <p><strong>Administrators:</strong> $AdministratorsCount</p>\n            </div>\n            <div class=\"chart-item\">\n                <h4>Risk Assessment Summary</h4>\n                <p><strong>Total Privileged Accounts:</strong> $($PrivilegedAccounts.Count)</p>\n                <p><strong>High Risk Accounts:</strong> $(($PrivilegedAccounts | Where-Object { $_.Risk -eq 'High' -or $_.Risk -eq 'Critical' }).Count)</p>\n                <p><strong>Stale Accounts (90+ days):</strong> $($StalePrivileged.Count)</p>\n                <p><strong>Never Logged On:</strong> $($NeverLoggedOn.Count)</p>\n            </div>\n        </div>\n        \n        <table>\n            <thead>\n                <tr>\n                    <th>Account Name</th>\n                    <th>Display Name</th>\n                    <th>All Privileged Groups</th>\n                    <th>Enabled</th>\n                    <th>Last Logon</th>\n                    <th>Password Age (Days)</th>\n                    <th>Risk Factors</th>\n                    <th>Risk Level</th>\n                </tr>\n            </thead>\n            <tbody>\n\"@\n\n    foreach ($Account in $PrivilegedAccounts) {\n        $RiskColor = switch ($Account.Risk) {\n            'Critical' { '#dc3545' }\n            'High' { '#fd7e14' }\n            'Medium' { '#ffc107' }\n            'Low' { '#28a745' }\n            default { '#17a2b8' }\n        }\n        \n        $LastLogon = if ($Account.LastLogonDate -eq \"Never\") { \"Never\" } else { $Account.LastLogonDate.ToString(\"yyyy-MM-dd\") }\n        $RiskFactorsDisplay = if ($Account.RiskFactors -eq \"\") { \"None\" } else { $Account.RiskFactors }\n        \n        $HTML += @\"\n<tr>\n    <td>$($Account.SamAccountName)</td>\n    <td>$($Account.Name)</td>\n    <td style=\"font-size: 9px;\">$($Account.AllPrivilegedGroups)</td>\n    <td>$($Account.Enabled)</td>\n    <td>$LastLogon</td>\n    <td>$($Account.DaysSincePasswordChange)</td>\n    <td style=\"font-size: 9px;\">$RiskFactorsDisplay</td>\n    <td><span style=\"color: $RiskColor; font-weight: bold;\">$($Account.Risk.ToUpper())</span></td>\n</tr>\n\"@\n    }\n\n    $HTML += @\"\n            </tbody>\n        </table>\n    </div>\n\n    <div class=\"section\">\n        <h2>Security Compliance Issues and Recommendations</h2>\n\"@\n    \n    if ($PolicyCompliance.Issues.Count -eq 0) {\n        $HTML += \"<div class='risk-low'><p><strong>‚úì Excellent:</strong> No policy compliance issues identified. Current configuration aligns with Microsoft security baselines and NIST SP 800-63B guidelines.</p></div>\"\n    }\n    else {\n        foreach ($Issue in $PolicyCompliance.Issues) {\n            $RiskClass = \"risk-$($Issue.Risk.ToLower())\"\n            $HTML += @\"\n        <div class=\"$RiskClass no-break\">\n            <h4>$($Issue.Issue) <span class=\"risk-badge\">$($Issue.Risk.ToUpper())</span></h4>\n            <p><strong>Recommendation:</strong> $($Issue.Recommendation)</p>\n            <p><strong>Best Practice:</strong> $($Issue.BestPractice)</p>\n        </div>\n\"@\n        }\n    }\n\n    # Add Fine-Grained Password Policies section if any exist\n    if ($FGPPs.Count -gt 0) {\n        $HTML += @\"\n    </div>\n\n    <div class=\"section\">\n        <h2>Fine-Grained Password Policies Analysis</h2>\n        <p>The following fine-grained password policies are configured in the domain:</p>\n        <table>\n            <thead>\n                <tr>\n                    <th>Policy Name</th>\n                    <th>Precedence</th>\n                    <th>Min Length</th>\n                    <th>Complexity</th>\n                    <th>Max Age (Days)</th>\n                    <th>Min Age (Days)</th>\n                    <th>Lockout Threshold</th>\n                    <th>Applies To</th>\n                </tr>\n            </thead>\n            <tbody>\n\"@\n        foreach ($FGPP in $FGPPs) {\n            $HTML += \"<tr><td>$($FGPP.Name)</td><td>$($FGPP.Precedence)</td><td>$($FGPP.MinPasswordLength)</td><td>$($FGPP.ComplexityEnabled)</td><td>$($FGPP.MaxPasswordAge)</td><td>$($FGPP.MinPasswordAge)</td><td>$($FGPP.LockoutThreshold)</td><td style='font-size: 9px;'>$($FGPP.AppliesTo)</td></tr>\"\n        }\n        $HTML += @\"\n            </tbody>\n        </table>\n\"@\n    }\n\n    $HTML += @\"\n    </div>\n\n    <div class=\"section\">\n        <h2>Risk Assessment Summary</h2>\n        \n        <div class=\"chart-container\">\n            <div class=\"chart-item\">\n                <h4>Policy Compliance Risk Distribution</h4>\n\"@\n\n    $TotalIssues = $PolicyCompliance.Issues.Count\n    if ($TotalIssues -gt 0) {\n        $CriticalCount = ($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Critical' }).Count\n        $HighCount = ($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'High' }).Count\n        $MediumCount = ($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Medium' }).Count\n        $LowCount = ($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Low' }).Count\n        \n        $HTML += @\"\n                <p><span style=\"color: #dc3545;\">‚óè Critical:</span> $CriticalCount ($([math]::Round(($CriticalCount/$TotalIssues)*100,1))%)</p>\n                <p><span style=\"color: #fd7e14;\">‚óè High:</span> $HighCount ($([math]::Round(($HighCount/$TotalIssues)*100,1))%)</p>\n                <p><span style=\"color: #ffc107;\">‚óè Medium:</span> $MediumCount ($([math]::Round(($MediumCount/$TotalIssues)*100,1))%)</p>\n                <p><span style=\"color: #28a745;\">‚óè Low:</span> $LowCount ($([math]::Round(($LowCount/$TotalIssues)*100,1))%)</p>\n\"@\n    } else {\n        $HTML += \"<p style='color: #28a745; font-weight: bold;'>‚úì No compliance issues identified</p>\"\n    }\n\n    $HTML += @\"\n            </div>\n            <div class=\"chart-item\">\n                <h4>Overall Security Posture</h4>\n                <p><strong>Compliance Score:</strong> $((100-$PolicyCompliance.RiskScore))/100</p>\n                <p><strong>Risk Level:</strong> <span style=\"color: $(\n                    switch ($PolicyCompliance.RiskLevel) {\n                        'Critical' { '#dc3545' }\n                        'High' { '#fd7e14' }\n                        'Medium' { '#ffc107' }\n                        'Low' { '#28a745' }\n                        default { '#17a2b8' }\n                    }\n                );\">$($PolicyCompliance.RiskLevel.ToUpper())</span></p>\n                <p><strong>Total Issues:</strong> $($PolicyCompliance.Issues.Count)</p>\n                <p><strong>Privileged Accounts:</strong> $($PrivilegedAccounts.Count)</p>\n                <p><strong>Stale Privileged:</strong> $($StalePrivileged.Count)</p>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"section\">\n        <h2>Strategic Recommendations and Implementation Roadmap</h2>\n        \n        <div class=\"recommendation\">\n            <h4>üö® IMMEDIATE ACTIONS REQUIRED (0-30 days)</h4>\n            <ul>\n\"@\n\n    # Add specific immediate recommendations\n    if ($CriticalIssues.Count -gt 0) {\n        $HTML += \"<li><strong>CRITICAL PRIORITY:</strong> Immediately address $($CriticalIssues.Count) critical security issues identified in this assessment</li>\"\n    }\n    \n    if ($StalePrivileged.Count -gt 0) {\n        $HTML += \"<li><strong>HIGH PRIORITY:</strong> Review and disable $($StalePrivileged.Count) stale privileged accounts that haven't been used in 90+ days</li>\"\n    }\n    \n    if ($NeverLoggedOn.Count -gt 0) {\n        $HTML += \"<li><strong>HIGH PRIORITY:</strong> Review $($NeverLoggedOn.Count) privileged accounts that have never been used</li>\"\n    }\n    \n    if ($DomainPolicy.MinPasswordLength -lt 14) {\n        $HTML += \"<li>Increase minimum password length requirement to 14+ characters per NIST SP 800-63B guidelines</li>\"\n    }\n    \n    if (-not $DomainPolicy.ComplexityEnabled) {\n        $HTML += \"<li>Enable password complexity requirements to strengthen password security</li>\"\n    }\n\n    if ($DomainPolicy.LockoutThreshold -eq 0) {\n        $HTML += \"<li>Implement account lockout protection with 5-10 failed attempt threshold to prevent brute force attacks</li>\"\n    }\n\n    if ($DomainPolicy.ReversibleEncryptionEnabled) {\n        $HTML += \"<li><strong>CRITICAL:</strong> Disable reversible encryption immediately - passwords are stored in plain text equivalent</li>\"\n    }\n\n    $HTML += @\"\n            </ul>\n        </div>\n        \n        <div class=\"recommendation\">\n            <h4>üìà SHORT-TERM IMPROVEMENTS (1-3 months)</h4>\n            <ul>\n                <li>Deploy multi-factor authentication (MFA) for all privileged accounts across all groups</li>\n                <li>Implement Privileged Access Management (PAM) solution for elevated account management</li>\n                <li>Establish monthly privileged account access reviews for all groups (Domain Admins, Enterprise Admins, Schema Admins, Administrators)</li>\n                <li>Deploy advanced monitoring and alerting for privileged account activities</li>\n                <li>Implement Azure AD Password Protection for enhanced password policy enforcement</li>\n                <li>Establish administrative workstation security baselines with privileged access workstations (PAWs)</li>\n                <li>Implement fine-grained password policies for privileged accounts with stricter requirements</li>\n            </ul>\n        </div>\n        \n        <div class=\"recommendation\">\n            <h4>üéØ LONG-TERM STRATEGIC ENHANCEMENTS (3-6 months)</h4>\n            <ul>\n                <li>Deploy Just-In-Time (JIT) administrative access model for all privileged groups</li>\n                <li>Implement Microsoft's enhanced administrative tier model (Tier 0, 1, 2 separation)</li>\n                <li>Establish continuous security monitoring with SIEM integration for privileged account activities</li>\n                <li>Deploy Privileged Identity Management (PIM) for cloud-hybrid environments</li>\n                <li>Implement regular penetration testing and security assessments focusing on privileged escalation</li>\n                <li>Establish comprehensive security awareness training program with privileged user focus</li>\n                <li>Consider migration to Azure AD Premium for advanced security features and conditional access</li>\n                <li>Implement break-glass emergency access procedures with proper monitoring</li>\n            </ul>\n        </div>\n    </div>\n\n    <div class=\"section\">\n        <h2>Compliance Framework Alignment</h2>\n        <p>This assessment aligns with the following industry standards and frameworks:</p>\n        \n        <table>\n            <thead>\n                <tr>\n                    <th>Framework/Standard</th>\n                    <th>Relevant Controls</th>\n                    <th>Compliance Status</th>\n                    <th>Recommendations</th>\n                </tr>\n            </thead>\n            <tbody>\n                <tr>\n                    <td>Microsoft Security Baseline</td>\n                    <td>Password Policy, Privileged Account Management</td>\n                    <td class=\"$(if($PolicyCompliance.RiskScore -lt 40){'compliant'}else{'non-compliant'})\">\n                        $(if($PolicyCompliance.RiskScore -lt 40){'Aligned'}else{'Requires Attention'})\n                    </td>\n                    <td>$(if($PolicyCompliance.RiskScore -ge 40){'Address identified policy gaps'}else{'Maintain current standards'})</td>\n                </tr>\n                <tr>\n                    <td>NIST Cybersecurity Framework</td>\n                    <td>PR.AC-1, PR.AC-4, PR.AC-7, DE.CM-3</td>\n                    <td class=\"$(if($PolicyCompliance.RiskScore -lt 30){'compliant'}else{'non-compliant'})\">\n                        $(if($PolicyCompliance.RiskScore -lt 30){'Compliant'}else{'Partial Compliance'})\n                    </td>\n                    <td>$(if($PolicyCompliance.RiskScore -ge 30){'Enhance detection and protection controls'}else{'Continue monitoring'})</td>\n                </tr>\n                <tr>\n                    <td>NIST SP 800-63B</td>\n                    <td>Password Length, Complexity, Verification</td>\n                    <td class=\"$(if($DomainPolicy.MinPasswordLength -ge 14){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.MinPasswordLength -ge 14){'Compliant'}else{'Non-Compliant'})\n                    </td>\n                    <td>$(if($DomainPolicy.MinPasswordLength -lt 14){'Increase minimum password length to 14+ characters'}else{'Maintain current standards'})</td>\n                </tr>\n                <tr>\n                    <td>CIS Controls v8</td>\n                    <td>Control 5: Account Management, Control 6: Access Control</td>\n                    <td class=\"$(if($StalePrivileged.Count -eq 0){'compliant'}else{'non-compliant'})\">\n                        $(if($StalePrivileged.Count -eq 0){'Compliant'}else{'Improvement Needed'})\n                    </td>\n                    <td>$(if($StalePrivileged.Count -gt 0){'Remove or disable stale privileged accounts'}else{'Continue regular reviews'})</td>\n                </tr>\n                <tr>\n                    <td>ISO 27001:2022</td>\n                    <td>A.9.2.1, A.9.2.2, A.9.4.3, A.18.1.4</td>\n                    <td class=\"$(if($PolicyCompliance.Issues.Count -lt 3){'compliant'}else{'non-compliant'})\">\n                        $(if($PolicyCompliance.Issues.Count -lt 3){'Satisfactory'}else{'Requires Remediation'})\n                    </td>\n                    <td>$(if($PolicyCompliance.Issues.Count -ge 3){'Address policy compliance gaps'}else{'Maintain documentation'})</td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n\n    <div class=\"footer\">\n        <p><strong>First Technology: RMS SECURITY ASSESSMENT REPORT</strong></p>\n        <p>Prepared by: $EngineerName</p>\n        <p>Assessment Tool: AD Security Assessment v11.0 | Generated: $ReportDate</p>\n        <p>Customer: $CustomerName | Domain: $DomainName</p>\n        <p>Next Recommended Review: $(((Get-Date).AddMonths(3)).ToString('yyyy-MM-dd'))</p>\n        <hr>\n        <p style=\"font-size: 8px;\">This report contains sensitive security information and should be distributed only to authorized personnel.\n        Report includes analysis of Domain Admins, Enterprise Admins, Schema Admins, and Administrators groups with recursive membership evaluation.</p>\n    </div>\n\n</body>\n</html>\n\"@\n\n    return $HTML\n}\n\n# New function to generate comprehensive user analysis HTML report\nfunction New-UserAnalysisHTML {\n    param(\n        $UserAnalysis,\n        $CustomerName,\n        $DomainName,\n        $EngineerName\n    )\n    \n    # Calculate user analysis metrics\n    $TotalUsers = $UserAnalysis.Count\n    $EnabledUsers = ($UserAnalysis | Where-Object { $_.Enabled }).Count\n    $DisabledUsers = $TotalUsers - $EnabledUsers\n    $StaleUsers = ($UserAnalysis | Where-Object { $_.DaysSinceLogon -gt 90 -and $_.Enabled }).Count\n    $NeverLoggedOnUsers = ($UserAnalysis | Where-Object { $_.LastLogonDate -eq 'Never' -and $_.Enabled }).Count\n    $PasswordNeverExpiresUsers = ($UserAnalysis | Where-Object { $_.PasswordNeverExpires -and $_.Enabled }).Count\n    $HighRiskUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'High' -or $_.Risk -eq 'Critical' }).Count\n    \n    $CriticalUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'Critical' }).Count\n    $HighUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'High' }).Count\n    $MediumUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'Medium' }).Count\n    $LowUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'Low' }).Count\n    $InfoUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'Info' }).Count\n    \n    $HTML = @\"\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <title>Domain User Analysis Report</title>\n    <style>\n        @page {\n            margin: 0.5in;\n            @top-center {\n                content: \"Domain User Analysis Report\";\n                font-family: 'Segoe UI', sans-serif;\n                font-size: 10px;\n                color: #666;\n            }\n            @bottom-center {\n                content: \"Page \" counter(page) \" of \" counter(pages);\n                font-family: 'Segoe UI', sans-serif;\n                font-size: 10px;\n                color: #666;\n            }\n        }\n        \n        body {\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n            margin: 0;\n            padding: 20px;\n            background-color: white;\n            line-height: 1.4;\n            font-size: 11px;\n        }\n        \n        .header {\n            text-align: center;\n            border-bottom: 3px solid #28a745;\n            padding-bottom: 15px;\n            margin-bottom: 20px;\n        }\n        \n        .customer-name {\n            font-size: 28px;\n            font-weight: bold;\n            color: #28a745;\n            margin-bottom: 5px;\n            text-transform: uppercase;\n        }\n        \n        .report-title {\n            font-size: 18px;\n            font-weight: bold;\n            color: #333;\n            margin-bottom: 15px;\n        }\n        \n        .header-info {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 20px;\n            margin-top: 15px;\n            font-size: 10px;\n        }\n        \n        .section {\n            margin-bottom: 20px;\n            page-break-inside: avoid;\n        }\n        \n        .section h2 {\n            background: linear-gradient(135deg, #28a745 0%, #1e7e34 100%);\n            color: white;\n            padding: 8px 15px;\n            margin: 0 0 10px 0;\n            font-size: 14px;\n            font-weight: bold;\n        }\n        \n        .section h3 {\n            color: #28a745;\n            font-size: 12px;\n            margin: 15px 0 8px 0;\n            border-bottom: 1px solid #ddd;\n            padding-bottom: 3px;\n        }\n        \n        .executive-summary {\n            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);\n            padding: 15px;\n            border-left: 4px solid #28a745;\n            margin-bottom: 20px;\n        }\n        \n        .metrics-grid {\n            display: grid;\n            grid-template-columns: repeat(6, 1fr);\n            gap: 10px;\n            margin: 15px 0;\n        }\n        \n        .metric-card {\n            text-align: center;\n            padding: 12px;\n            background: white;\n            border: 1px solid #ddd;\n            border-radius: 5px;\n        }\n        \n        .metric-value {\n            font-size: 18px;\n            font-weight: bold;\n            color: #28a745;\n        }\n        \n        .metric-label {\n            font-size: 10px;\n            color: #666;\n            margin-top: 5px;\n        }\n        \n        table {\n            width: 100%;\n            border-collapse: collapse;\n            margin: 10px 0;\n            font-size: 9px;\n        }\n        \n        th, td {\n            border: 1px solid #ddd;\n            padding: 4px;\n            text-align: left;\n        }\n        \n        th {\n            background-color: #f8f9fa;\n            font-weight: bold;\n            color: #28a745;\n        }\n        \n        .risk-critical {\n            background-color: #f8d7da;\n            border-left: 4px solid #dc3545;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-high {\n            background-color: #fff3cd;\n            border-left: 4px solid #ffc107;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-medium {\n            background-color: #d1ecf1;\n            border-left: 4px solid #17a2b8;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-low {\n            background-color: #d4edda;\n            border-left: 4px solid #28a745;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .footer {\n            border-top: 2px solid #28a745;\n            padding-top: 15px;\n            margin-top: 30px;\n            text-align: center;\n            font-size: 9px;\n            color: #666;\n        }\n        \n        .chart-container {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 20px;\n            margin: 15px 0;\n        }\n        \n        .chart-item {\n            background: white;\n            border: 1px solid #ddd;\n            padding: 10px;\n            border-radius: 5px;\n        }\n        \n        .progress-bar {\n            width: 100%;\n            height: 15px;\n            background-color: #e9ecef;\n            border-radius: 8px;\n            overflow: hidden;\n            margin: 5px 0;\n        }\n        \n        .progress-fill {\n            height: 100%;\n            border-radius: 8px;\n        }\n        \n        .no-break { page-break-inside: avoid; }\n        \n        .risk-distribution {\n            display: grid;\n            grid-template-columns: repeat(5, 1fr);\n            gap: 10px;\n            margin: 10px 0;\n        }\n        \n        .risk-item {\n            text-align: center;\n            padding: 8px;\n            border-radius: 5px;\n            color: white;\n            font-weight: bold;\n        }\n        \n        .risk-critical-bg { background-color: #dc3545; }\n        .risk-high-bg { background-color: #fd7e14; }\n        .risk-medium-bg { background-color: #ffc107; color: #333; }\n        .risk-low-bg { background-color: #28a745; }\n        .risk-info-bg { background-color: #17a2b8; }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <div class=\"customer-name\">$CustomerName</div>\n        <div class=\"report-title\">Domain User Analysis Report</div>\n        <div style=\"font-size: 12px; color: #28a745; margin-top: 5px;\">Complete Domain User Security Risk Assessment</div>\n        \n        <div class=\"header-info\">\n            <div>\n                <strong>Customer:</strong> $CustomerName<br>\n                <strong>Domain:</strong> $DomainName<br>\n                <strong>Assessment Date:</strong> $((Get-Date).ToString(\"yyyy-MM-dd HH:mm:ss\"))\n            </div>\n            <div>\n                <strong>Assessed By:</strong> $EngineerName<br>\n                <strong>Report Version:</strong> 11.0<br>\n                <strong>Classification:</strong> Domain Security\n            </div>\n        </div>\n    </div>\n\n    <div class=\"executive-summary no-break\">\n        <h2>Executive Summary - Domain User Analysis</h2>\n        <p>This comprehensive user analysis evaluates <strong>all $TotalUsers domain user accounts</strong> for <strong>$CustomerName</strong> to identify password security risks, stale accounts, and potential security threats. The analysis focuses on user account hygiene, password policies, and access patterns to provide actionable security recommendations.</p>\n        \n        <div class=\"metrics-grid\">\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$TotalUsers</div>\n                <div class=\"metric-label\">Total Users</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$EnabledUsers</div>\n                <div class=\"metric-label\">Enabled Users</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$StaleUsers</div>\n                <div class=\"metric-label\">Stale Users (90+ days)</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$NeverLoggedOnUsers</div>\n                <div class=\"metric-label\">Never Logged On</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$PasswordNeverExpiresUsers</div>\n                <div class=\"metric-label\">Password Never Expires</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$HighRiskUsers</div>\n                <div class=\"metric-label\">High Risk Users</div>\n            </div>\n        </div>\n        \n        <div class=\"risk-distribution\">\n            <div class=\"risk-item risk-critical-bg\">\n                <div>$CriticalUsers</div>\n                <div style=\"font-size: 9px;\">CRITICAL</div>\n            </div>\n            <div class=\"risk-item risk-high-bg\">\n                <div>$HighUsers</div>\n                <div style=\"font-size: 9px;\">HIGH</div>\n            </div>\n            <div class=\"risk-item risk-medium-bg\">\n                <div>$MediumUsers</div>\n                <div style=\"font-size: 9px;\">MEDIUM</div>\n            </div>\n            <div class=\"risk-item risk-low-bg\">\n                <div>$LowUsers</div>\n                <div style=\"font-size: 9px;\">LOW</div>\n            </div>\n            <div class=\"risk-item risk-info-bg\">\n                <div>$InfoUsers</div>\n                <div style=\"font-size: 9px;\">INFO</div>\n            </div>\n        </div>\n        \n        <div class=\"chart-container\">\n            <div class=\"chart-item\">\n                <h4>Account Health Status</h4>\n                <div class=\"progress-bar\">\n                    <div class=\"progress-fill\" style=\"width: $(if($TotalUsers -gt 0){[math]::Round(($EnabledUsers/$TotalUsers)*100,0)}else{0})%; background-color: #28a745;\"></div>\n                </div>\n                <small>$(if($TotalUsers -gt 0){[math]::Round(($EnabledUsers/$TotalUsers)*100,0)}else{0})% Enabled Accounts</small>\n            </div>\n            <div class=\"chart-item\">\n                <h4>Security Risk Level</h4>\n                <div class=\"progress-bar\">\n                    <div class=\"progress-fill\" style=\"width: $(if($EnabledUsers -gt 0){[math]::Round((($EnabledUsers-$HighRiskUsers)/$EnabledUsers)*100,0)}else{100})%; background-color: $(if($HighRiskUsers -eq 0){'#28a745'}else{'#ffc107'});\"></div>\n                </div>\n                <small>$(if($EnabledUsers -gt 0){[math]::Round((($EnabledUsers-$HighRiskUsers)/$EnabledUsers)*100,0)}else{100})% Low Risk</small>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"section no-break\">\n        <h2>Critical and High Risk User Accounts</h2>\n        <p>Immediate attention required for the following high-risk user accounts:</p>\n\"@\n\n    $HighRiskAccounts = $UserAnalysis | Where-Object { $_.Risk -eq 'Critical' -or $_.Risk -eq 'High' } | Sort-Object RiskScore -Descending\n\n    if ($HighRiskAccounts.Count -eq 0) {\n        $HTML += \"<div class='risk-low'><p><strong>‚úì Excellent:</strong> No critical or high-risk user accounts identified.</p></div>\"\n    } else {\n        $HTML += @\"\n        <table>\n            <thead>\n                <tr>\n                    <th>Account Name</th>\n                    <th>Display Name</th>\n                    <th>User Type</th>\n                    <th>Enabled</th>\n                    <th>Last Logon</th>\n                    <th>Password Age (Days)</th>\n                    <th>Risk Factors</th>\n                    <th>Risk</th>\n                </tr>\n            </thead>\n            <tbody>\n\"@\n        \n        foreach ($User in $HighRiskAccounts) {\n            $RiskColor = switch ($User.Risk) {\n                'Critical' { '#dc3545' }\n                'High' { '#fd7e14' }\n                default { '#ffc107' }\n            }\n            \n            $HTML += @\"\n<tr>\n    <td>$($User.SamAccountName)</td>\n    <td>$($User.Name)</td>\n    <td>$($User.UserType)</td>\n    <td>$($User.Enabled)</td>\n    <td>$($User.LastLogonDate)</td>\n    <td>$($User.DaysSincePasswordChange)</td>\n    <td style=\"font-size: 8px;\">$($User.RiskFactors)</td>\n    <td><span style=\"color: $RiskColor; font-weight: bold;\">$($User.Risk.ToUpper())</span></td>\n</tr>\n\"@\n        }\n        \n        $HTML += \"</tbody></table>\"\n    }\n\n    $HTML += @\"\n    </div>\n\n    <div class=\"section\">\n        <h2>Stale Account Analysis</h2>\n        <p>Analysis of accounts that haven't been used recently (potential security risks):</p>\n        \n        <div class=\"chart-container\">\n            <div class=\"chart-item\">\n                <h4>Stale Account Categories</h4>\n                <p><strong>1+ Year Stale:</strong> $(($UserAnalysis | Where-Object { $_.DaysSinceLogon -gt 365 -and $_.Enabled }).Count)</p>\n                <p><strong>6+ Months Stale:</strong> $(($UserAnalysis | Where-Object { $_.DaysSinceLogon -gt 180 -and $_.DaysSinceLogon -le 365 -and $_.Enabled }).Count)</p>\n                <p><strong>3+ Months Stale:</strong> $(($UserAnalysis | Where-Object { $_.DaysSinceLogon -gt 90 -and $_.DaysSinceLogon -le 180 -and $_.Enabled }).Count)</p>\n                <p><strong>Never Logged On:</strong> $NeverLoggedOnUsers</p>\n            </div>\n            <div class=\"chart-item\">\n                <h4>Password Security Issues</h4>\n                <p><strong>Password Never Expires:</strong> $PasswordNeverExpiresUsers</p>\n                <p><strong>Password 1+ Year Old:</strong> $(($UserAnalysis | Where-Object { $_.DaysSincePasswordChange -gt 365 -and $_.Enabled }).Count)</p>\n                <p><strong>Password Never Set:</strong> $(($UserAnalysis | Where-Object { $_.PasswordLastSet -eq 'Never' -and $_.Enabled }).Count)</p>\n                <p><strong>Failed Logon Attempts:</strong> $(($UserAnalysis | Where-Object { $_.BadLogonCount -gt 0 }).Count)</p>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"section\">\n        <h2>User Account Recommendations</h2>\n        \n        <div class=\"risk-critical\">\n            <h4>üö® IMMEDIATE ACTIONS REQUIRED</h4>\n            <ul>\n\"@\n\n    if ($CriticalUsers -gt 0) {\n        $HTML += \"<li><strong>CRITICAL PRIORITY:</strong> Review and remediate $CriticalUsers accounts with critical security risks</li>\"\n    }\n    \n    if ($HighUsers -gt 0) {\n        $HTML += \"<li><strong>HIGH PRIORITY:</strong> Address $HighUsers accounts with high security risks</li>\"\n    }\n    \n    if ($NeverLoggedOnUsers -gt 0) {\n        $HTML += \"<li>Review $NeverLoggedOnUsers enabled accounts that have never been used - consider disabling</li>\"\n    }\n    \n    if ($StaleUsers -gt 0) {\n        $HTML += \"<li>Audit $StaleUsers stale accounts (90+ days inactive) for potential deactivation</li>\"\n    }\n\n    $HTML += @\"\n            </ul>\n        </div>\n        \n        <div class=\"risk-medium\">\n            <h4>üìã MEDIUM PRIORITY ACTIONS</h4>\n            <ul>\n                <li>Implement automated account lifecycle management processes</li>\n                <li>Establish quarterly user access reviews with managers</li>\n                <li>Deploy user activity monitoring for anomaly detection</li>\n                <li>Implement self-service password reset capabilities</li>\n                <li>Review and update password policies based on user behavior patterns</li>\n            </ul>\n        </div>\n        \n        <div class=\"risk-low\">\n            <h4>üéØ LONG-TERM IMPROVEMENTS</h4>\n            <ul>\n                <li>Deploy advanced threat protection for user accounts</li>\n                <li>Implement risk-based authentication policies</li>\n                <li>Establish comprehensive user security training programs</li>\n                <li>Deploy privileged access management for elevated operations</li>\n                <li>Implement continuous compliance monitoring</li>\n            </ul>\n        </div>\n    </div>\n\n    <div class=\"footer\">\n        <p><strong>CONFIDENTIAL USER ANALYSIS REPORT</strong></p>\n        <p>Prepared by: $EngineerName</p>\n        <p>Assessment Tool: User Analysis v11.0 | Generated: $((Get-Date).ToString(\"yyyy-MM-dd HH:mm:ss\"))</p>\n        <p>Customer: $CustomerName | Domain: $DomainName | Users Analyzed: $TotalUsers</p>\n        <p>Next Recommended Review: $(((Get-Date).AddMonths(6)).ToString('yyyy-MM-dd'))</p>\n        <hr>\n        <p style=\"font-size: 8px;\">This user analysis report contains sensitive security information and should be distributed only to authorized personnel.</p>\n    </div>\n\n</body>\n</html>\n\"@\n\n    return $HTML\n}\n\n# Function to convert HTML to PDF using system tools\nfunction Convert-HTMLToPDF {\n    param(\n        [string]$HTMLPath,\n        [string]$PDFPath\n    )\n    \n    Write-Host \"Converting HTML to PDF...\" -ForegroundColor Yellow\n    \n    try {\n        # Try using Microsoft Edge (if available)\n        $EdgePath = \"${env:ProgramFiles(x86)}\\Microsoft\\Edge\\Application\\msedge.exe\"\n        if (-not (Test-Path $EdgePath)) {\n            $EdgePath = \"${env:ProgramFiles}\\Microsoft\\Edge\\Application\\msedge.exe\"\n        }\n        \n        if (Test-Path $EdgePath) {\n            Write-Host \"Using Microsoft Edge for PDF conversion...\" -ForegroundColor Green\n            $Arguments = @(\n                \"--headless\"\n                \"--disable-gpu\"\n                \"--run-all-compositor-stages-before-draw\"\n                \"--disable-extensions\"\n                \"--disable-plugins\"\n                \"--no-sandbox\"\n                \"--print-to-pdf=`\"$PDFPath`\"\"\n                \"`\"$HTMLPath`\"\"\n            )\n            \n            Start-Process -FilePath $EdgePath -ArgumentList $Arguments -Wait -NoNewWindow\n            \n            if (Test-Path $PDFPath) {\n                Write-Host \"PDF generated successfully using Edge!\" -ForegroundColor Green\n                return $true\n            }\n        }\n        \n        # Fallback: Try Chrome\n        $ChromePaths = @(\n            \"${env:ProgramFiles}\\Google\\Chrome\\Application\\chrome.exe\",\n            \"${env:ProgramFiles(x86)}\\Google\\Chrome\\Application\\chrome.exe\",\n            \"${env:LOCALAPPDATA}\\Google\\Chrome\\Application\\chrome.exe\"\n        )\n        \n        $ChromePath = $ChromePaths | Where-Object { Test-Path $_ } | Select-Object -First 1\n        \n        if ($ChromePath) {\n            Write-Host \"Using Google Chrome for PDF conversion...\" -ForegroundColor Green\n            $Arguments = @(\n                \"--headless\"\n                \"--disable-gpu\"\n                \"--run-all-compositor-stages-before-draw\"\n                \"--print-to-pdf=`\"$PDFPath`\"\"\n                \"`\"$HTMLPath`\"\"\n            )\n            \n            Start-Process -FilePath $ChromePath -ArgumentList $Arguments -Wait -NoNewWindow\n            \n            if (Test-Path $PDFPath) {\n                Write-Host \"PDF generated successfully using Chrome!\" -ForegroundColor Green\n                return $true\n            }\n        }\n        \n        Write-Warning \"No suitable PDF converter found. HTML report will be available for manual conversion.\"\n        return $false\n        \n    }\n    catch {\n        Write-Warning \"PDF conversion failed: $($_.Exception.Message)\"\n        return $false\n    }\n}\n\n# Main execution\ntry {\n    $StartTime = Get-Date\n    \n    # Ensure output directory exists\n    $OutputDir = Split-Path $OutputPathPDF -Parent\n    if (-not (Test-Path $OutputDir)) {\n        New-Item -Path $OutputDir -ItemType Directory -Force | Out-Null\n        Write-Host \"Created output directory: $OutputDir\" -ForegroundColor Green\n    }\n\n    # Gather enhanced assessment data\n    Write-Host \"\"\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Yellow\n    Write-Host \"                            GATHERING ASSESSMENT DATA\" -ForegroundColor Yellow\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Yellow\n    \n    $DomainServer = if ($Domain.DNSRoot -ne (Get-ADDomain).DNSRoot) { $Domain.DNSRoot } else { $null }\n    $DomainPolicy = Get-DomainPasswordPolicy -DomainServer $DomainServer\n    $FGPPs = Get-FineGrainedPolicies -DomainServer $DomainServer\n    $PolicyCompliance = Test-PolicyCompliance -Policy $DomainPolicy\n    $PrivilegedAccounts = Get-AllPrivilegedAccounts -DomainServer $DomainServer\n    \n    Write-Host \"\"\n    Write-Host \"Starting comprehensive domain user analysis...\" -ForegroundColor Yellow\n    $UserAnalysis = Get-DomainUserAnalysis -DomainServer $DomainServer\n\n    # Generate Main Security Assessment Report\n    Write-Host \"\"\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Green\n    Write-Host \"                        GENERATING SECURITY ASSESSMENT REPORT\" -ForegroundColor Green\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Green\n    \n    Write-Host \"Generating security assessment HTML report...\" -ForegroundColor Yellow\n    $SecurityHTMLContent = New-SecurityAssessmentHTML -DomainPolicy $DomainPolicy -FGPPs $FGPPs -PolicyCompliance $PolicyCompliance -PrivilegedAccounts $PrivilegedAccounts -CustomerName $CustomerName -DomainName $DomainName -EngineerName $EngineerName\n    $SecurityHTMLContent | Out-File -FilePath $OutputPathHTML -Encoding UTF8\n\n    # Convert Security Assessment to PDF\n    $SecurityPDFCreated = Convert-HTMLToPDF -HTMLPath $OutputPathHTML -PDFPath $OutputPathPDF\n    \n    # Generate User Analysis Report\n    Write-Host \"\"\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Green\n    Write-Host \"                         GENERATING USER ANALYSIS REPORT\" -ForegroundColor Green\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Green\n    \n    Write-Host \"Generating comprehensive user analysis HTML report...\" -ForegroundColor Yellow\n    $UserHTMLContent = New-UserAnalysisHTML -UserAnalysis $UserAnalysis -CustomerName $CustomerName -DomainName $DomainName -EngineerName $EngineerName\n    $UserHTMLContent | Out-File -FilePath $OutputPathUserHTML -Encoding UTF8\n\n    # Convert User Analysis to PDF\n    $UserPDFCreated = Convert-HTMLToPDF -HTMLPath $OutputPathUserHTML -PDFPath $OutputPathUserPDF\n    \n    # Export comprehensive data to CSV\n    Write-Host \"Exporting comprehensive assessment data to CSV...\" -ForegroundColor Yellow\n    $AllData = @()\n    \n    # Add policy compliance data\n    foreach ($Issue in $PolicyCompliance.Issues) {\n        $AllData += [PSCustomObject]@{\n            'Assessment_Date' = $ReportDate\n            'Customer' = $CustomerName\n            'Domain' = $DomainName\n            'Category' = 'Policy Compliance'\n            'Finding' = $Issue.Issue\n            'Risk_Level' = $Issue.Risk\n            'Recommendation' = $Issue.Recommendation\n            'Best_Practice' = $Issue.BestPractice\n            'Status' = 'Non-Compliant'\n            'Account_Name' = 'N/A'\n            'Account_Type' = 'N/A'\n        }\n    }\n    \n    # Add privileged account data\n    foreach ($Account in $PrivilegedAccounts) {\n        $AllData += [PSCustomObject]@{\n            'Assessment_Date' = $ReportDate\n            'Customer' = $CustomerName\n            'Domain' = $DomainName\n            'Category' = 'Privileged Account'\n            'Finding' = \"$($Account.SamAccountName) - $($Account.Name)\"\n            'Risk_Level' = $Account.Risk\n            'Recommendation' = switch ($Account.Risk) {\n                'Critical' { 'Immediate attention required - critical security risk' }\n                'High' { 'Review account usage and disable if unused' }\n                'Medium' { 'Monitor regularly and consider access review' }\n                default { 'Continue monitoring with regular reviews' }\n            }\n            'Best_Practice' = 'Regular review of privileged accounts with quarterly access assessments'\n            'Status' = if ($Account.Enabled) { 'Enabled' } else { 'Disabled' }\n            'Account_Name' = $Account.SamAccountName\n            'Account_Type' = 'Privileged'\n        }\n    }\n    \n    # Add high-risk user data (only Critical and High risk to keep CSV manageable)\n    $HighRiskUsers = $UserAnalysis | Where-Object { $_.Risk -eq 'Critical' -or $_.Risk -eq 'High' }\n    foreach ($User in $HighRiskUsers) {\n        $AllData += [PSCustomObject]@{\n            'Assessment_Date' = $ReportDate\n            'Customer' = $CustomerName\n            'Domain' = $DomainName\n            'Category' = 'High Risk User'\n            'Finding' = \"$($User.SamAccountName) - $($User.Name)\"\n            'Risk_Level' = $User.Risk\n            'Recommendation' = switch ($User.Risk) {\n                'Critical' { 'Immediate review and remediation required' }\n                'High' { 'Review account and address security risks' }\n                default { 'Monitor and review regularly' }\n            }\n            'Best_Practice' = 'Regular user access reviews and account lifecycle management'\n            'Status' = if ($User.Enabled) { 'Enabled' } else { 'Disabled' }\n            'Account_Name' = $User.SamAccountName\n            'Account_Type' = $User.UserType\n        }\n    }\n    \n    $AllData | Export-Csv -Path $OutputPathCSV -NoTypeInformation\n\n    # Display comprehensive results\n    Clear-Host\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Green\n    Write-Host \"                 ACTIVE DIRECTORY SECURITY ASSESSMENT COMPLETED\" -ForegroundColor Green\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Green\n    Write-Host \"\"\n    \n    Write-Host \"üìä ASSESSMENT SUMMARY\" -ForegroundColor Cyan\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    Write-Host \"Customer:                 $CustomerName\" -ForegroundColor White\n    Write-Host \"Domain:                   $DomainName\" -ForegroundColor White\n    Write-Host \"Assessed By:              $EngineerName\" -ForegroundColor White\n    Write-Host \"Assessment Date:          $ReportDate\" -ForegroundColor White\n    Write-Host \"Assessment Duration:      $([math]::Round(((Get-Date) - $StartTime).TotalMinutes, 1)) minutes\" -ForegroundColor White\n    Write-Host \"\"\n    \n    Write-Host \"üö® SECURITY RISK ANALYSIS\" -ForegroundColor Yellow\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    Write-Host \"Overall Risk Level:       $($PolicyCompliance.RiskLevel)\" -ForegroundColor $(\n        switch ($PolicyCompliance.RiskLevel) {\n            'Critical' { 'Red' }\n            'High' { 'Red' }\n            'Medium' { 'Yellow' }\n            'Low' { 'Green' }\n            default { 'Cyan' }\n        }\n    )\n    Write-Host \"Policy Risk Score:        $($PolicyCompliance.RiskScore)/100\" -ForegroundColor White\n    Write-Host \"Policy Compliance:        $((100-$PolicyCompliance.RiskScore))/100\" -ForegroundColor $(if((100-$PolicyCompliance.RiskScore) -ge 70){'Green'}else{'Red'})\n    Write-Host \"Policy Issues Found:      $($PolicyCompliance.Issues.Count)\" -ForegroundColor $(if($PolicyCompliance.Issues.Count -eq 0){'Green'}else{'Red'})\n    Write-Host \"\"\n    \n    Write-Host \"üë• PRIVILEGED ACCOUNT ANALYSIS\" -ForegroundColor Magenta\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    Write-Host \"Total Privileged Accounts: $($PrivilegedAccounts.Count)\" -ForegroundColor White\n    \n    $DomainAdminsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Domain Admins*\" }).Count\n    $EnterpriseAdminsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Enterprise Admins*\" }).Count\n    $SchemaAdminsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Schema Admins*\" }).Count\n    $AdministratorsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Administrators*\" }).Count\n    \n    Write-Host \"  Domain Admins:          $DomainAdminsCount\" -ForegroundColor Cyan\n    Write-Host \"  Enterprise Admins:      $EnterpriseAdminsCount\" -ForegroundColor Cyan\n    Write-Host \"  Schema Admins:          $SchemaAdminsCount\" -ForegroundColor Cyan\n    Write-Host \"  Administrators:         $AdministratorsCount\" -ForegroundColor Cyan\n    Write-Host \"\"\n    \n    $StalePrivileged = $PrivilegedAccounts | Where-Object { $_.DaysSinceLogon -gt 90 -and $_.Enabled }\n    $HighRiskPrivileged = $PrivilegedAccounts | Where-Object { $_.Risk -eq 'High' -or $_.Risk -eq 'Critical' }\n    $NeverLoggedOnPrivileged = $PrivilegedAccounts | Where-Object { $_.LastLogonDate -eq 'Never' }\n    \n    Write-Host \"Stale Privileged (90+ days): $($StalePrivileged.Count)\" -ForegroundColor $(if($StalePrivileged.Count -eq 0){'Green'}else{'Red'})\n    Write-Host \"High-Risk Privileged:     $($HighRiskPrivileged.Count)\" -ForegroundColor $(if($HighRiskPrivileged.Count -eq 0){'Green'}else{'Red'})\n    Write-Host \"Never Used Privileged:    $($NeverLoggedOnPrivileged.Count)\" -ForegroundColor $(if($NeverLoggedOnPrivileged.Count -eq 0){'Green'}else{'Red'})\n    Write-Host \"\"\n    \n    Write-Host \"üë§ DOMAIN USER ANALYSIS\" -ForegroundColor Blue\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    \n    $TotalUsers = $UserAnalysis.Count\n    $EnabledUsers = ($UserAnalysis | Where-Object { $_.Enabled }).Count\n    $StaleUsers = ($UserAnalysis | Where-Object { $_.DaysSinceLogon -gt 90 -and $_.Enabled }).Count\n    $NeverLoggedOnUsers = ($UserAnalysis | Where-Object { $_.LastLogonDate -eq 'Never' -and $_.Enabled }).Count\n    $HighRiskUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'High' -or $_.Risk -eq 'Critical' }).Count\n    $CriticalUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'Critical' }).Count\n    \n    Write-Host \"Total Domain Users:       $TotalUsers\" -ForegroundColor White\n    Write-Host \"Enabled Users:            $EnabledUsers\" -ForegroundColor White\n    Write-Host \"Stale Users (90+ days):   $StaleUsers\" -ForegroundColor $(if($StaleUsers -eq 0){'Green'}else{'Yellow'})\n    Write-Host \"Never Logged On Users:    $NeverLoggedOnUsers\" -ForegroundColor $(if($NeverLoggedOnUsers -eq 0){'Green'}else{'Yellow'})\n    Write-Host \"High-Risk Users:          $HighRiskUsers\" -ForegroundColor $(if($HighRiskUsers -eq 0){'Green'}else{'Red'})\n    Write-Host \"Critical Risk Users:      $CriticalUsers\" -ForegroundColor $(if($CriticalUsers -eq 0){'Green'}else{'Red'})\n    Write-Host \"\"\n    \n    Write-Host \"‚ö†Ô∏è  CRITICAL FINDINGS\" -ForegroundColor Red\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    $CriticalIssues = $PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Critical' }\n    if ($CriticalIssues.Count -eq 0 -and $CriticalUsers -eq 0 -and $HighRiskPrivileged.Count -eq 0) {\n        Write-Host \"‚úÖ No critical security issues identified\" -ForegroundColor Green\n    } else {\n        if ($CriticalIssues.Count -gt 0) {\n            Write-Host \"üî• Policy Issues:\" -ForegroundColor Red\n            foreach ($Issue in $CriticalIssues) {\n                Write-Host \"   ‚Ä¢ $($Issue.Issue)\" -ForegroundColor Red\n            }\n        }\n        if ($CriticalUsers -gt 0) {\n            Write-Host \"üî• $CriticalUsers critical risk user accounts require immediate attention\" -ForegroundColor Red\n        }\n        if ($HighRiskPrivileged.Count -gt 0) {\n            Write-Host \"üî• $($HighRiskPrivileged.Count) high-risk privileged accounts require review\" -ForegroundColor Red\n        }\n    }\n    \n    Write-Host \"\"\n    Write-Host \"üìÑ GENERATED REPORTS\" -ForegroundColor Green\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    \n    if ($SecurityPDFCreated) {\n        Write-Host \"‚úÖ Security Assessment PDF:  $OutputPathPDF\" -ForegroundColor Green\n    } else {\n        Write-Host \"‚ö†Ô∏è  Security PDF Failed:     Manual conversion required\" -ForegroundColor Yellow\n    }\n    Write-Host \"‚úÖ Security HTML Report:     $OutputPathHTML\" -ForegroundColor Green\n    \n    if ($UserPDFCreated) {\n        Write-Host \"‚úÖ User Analysis PDF:        $OutputPathUserPDF\" -ForegroundColor Green\n    } else {\n        Write-Host \"‚ö†Ô∏è  User Analysis PDF Failed: Manual conversion required\" -ForegroundColor Yellow\n    }\n    Write-Host \"‚úÖ User Analysis HTML:       $OutputPathUserHTML\" -ForegroundColor Green\n    Write-Host \"‚úÖ Comprehensive CSV Data:   $OutputPathCSV\" -ForegroundColor Green\n    \n    Write-Host \"\"\n    Write-Host \"üéØ RECOMMENDED NEXT STEPS\" -ForegroundColor Magenta\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    Write-Host \"1. Review both comprehensive reports with customer stakeholders\" -ForegroundColor White\n    Write-Host \"2. Address Critical and High-risk findings within 30 days\" -ForegroundColor White\n    Write-Host \"3. Implement privileged account management improvements\" -ForegroundColor White\n    Write-Host \"4. Establish user lifecycle management processes\" -ForegroundColor White\n    Write-Host \"5. Schedule quarterly follow-up assessments\" -ForegroundColor White\n    \n    # N-Central Summary and Exit Handling (Do not open reports automatically)\n    Write-NCentralLog \"\"\n    Write-NCentralLog \"N-Central Assessment Completed Successfully\" -Level \"Success\"\n    Write-NCentralLog \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\"\n    Write-NCentralLog \"Customer: $CustomerName | Domain: $DomainName | Engineer: $EngineerName\" -Level \"Info\"\n    Write-NCentralLog \"Assessment Duration: $([math]::Round(((Get-Date) - $StartTime).TotalMinutes, 1)) minutes\" -Level \"Info\"\n    Write-NCentralLog \"Overall Risk Level: $($PolicyCompliance.RiskLevel) | Risk Score: $($PolicyCompliance.RiskScore)/100\" -Level \"Info\"\n    Write-NCentralLog \"Total Users: $TotalUsers | Privileged Accounts: $($PrivilegedAccounts.Count) | High Risk Users: $HighRiskUsers\" -Level \"Info\"\n    \n    # Create N-Central summary file\n    try {\n        $ncentralSummaryPath = \"C:\\Temp\\NCentral_AD_Assessment_Summary_$($SafeCustomerName)_$($Timestamp).txt\"\n        $ncentralSummary = @\"\nN-CENTRAL AD SECURITY ASSESSMENT SUMMARY\n=========================================\n\nCustomer: $CustomerName\nDomain: $DomainName  \nAssessment Date: $ReportDate\nExecution Time: $([math]::Round(((Get-Date) - $StartTime).TotalMinutes, 1)) minutes\n\nRISK ASSESSMENT:\nOverall Risk Level: $($PolicyCompliance.RiskLevel)\nRisk Score: $($PolicyCompliance.RiskScore)/100\nCompliance Score: $((100-$PolicyCompliance.RiskScore))/100\nTotal Issues Found: $($PolicyCompliance.Issues.Count)\n\nPRIVILEGED ACCOUNTS:\nTotal Privileged: $($PrivilegedAccounts.Count)\nHigh Risk Privileged: $($HighRiskPrivileged.Count)\n\nUSER ANALYSIS:\nTotal Users: $TotalUsers\nEnabled Users: $EnabledUsers\nHigh Risk Users: $HighRiskUsers\nCritical Risk Users: $CriticalUsers\n\nISSUE BREAKDOWN:\nCritical Issues: $(($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Critical' }).Count + $CriticalUsers + $($HighRiskPrivileged.Count))\nHigh Issues: $(($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'High' }).Count)\nMedium Issues: $(($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Medium' }).Count)\nLow Issues: $(($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Low' }).Count)\n\nFILES GENERATED:\n- Security Assessment HTML: $OutputPathHTML\n- Security Assessment PDF: $OutputPathPDF  \n- User Analysis HTML: $OutputPathUserHTML\n- User Analysis PDF: $OutputPathUserPDF\n- Complete CSV Data: $OutputPathCSV\n\nSTATUS: $( if ($PolicyCompliance.RiskScore -ge 60) { \"REQUIRES IMMEDIATE ATTENTION\" } \n          elseif ($PolicyCompliance.RiskScore -ge 40) { \"NEEDS IMPROVEMENT\" }\n          elseif ($PolicyCompliance.RiskScore -ge 20) { \"ACCEPTABLE WITH MINOR ISSUES\" }\n          else { \"GOOD SECURITY POSTURE\" } )\n\nNext Recommended Assessment: $(((Get-Date).AddMonths(3)).ToString('yyyy-MM-dd'))\n\nN-Central RMS Active Directory Security Assessment Tool v11.1 Complete\nGenerated by: $EngineerName\n\"@\n        $ncentralSummary | Out-File -FilePath $ncentralSummaryPath -Encoding UTF8\n        Write-NCentralLog \"N-Central summary file created: $ncentralSummaryPath\" -Level \"Success\"\n    } catch {\n        Write-NCentralLog \"Failed to create N-Central summary file: $($_.Exception.Message)\" -Level \"Warning\"\n    }\n    \n    Write-NCentralLog \"\"\n    Write-NCentralLog \"Files Generated Successfully:\" -Level \"Success\"\n    Write-NCentralLog \"- Security Assessment HTML: $OutputPathHTML\" -Level \"Info\"\n    Write-NCentralLog \"- Security Assessment PDF: $OutputPathPDF\" -Level \"Info\"\n    Write-NCentralLog \"- User Analysis HTML: $OutputPathUserHTML\" -Level \"Info\"  \n    Write-NCentralLog \"- User Analysis PDF: $OutputPathUserPDF\" -Level \"Info\"\n    Write-NCentralLog \"- Complete CSV Data: $OutputPathCSV\" -Level \"Info\"\n    Write-NCentralLog \"- N-Central Summary: $ncentralSummaryPath\" -Level \"Info\"\n    \n    Write-NCentralLog \"\"\n    Write-NCentralLog \"N-Central AD Security Assessment Tool v11.1 Complete - Assessment Finished\" -Level \"Success\"\n    \n    # N-Central Exit Codes for Monitoring/Alerting\n    $criticalFindings = ($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Critical' }).Count + $CriticalUsers + $($HighRiskPrivileged.Count)\n    $highFindings = ($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'High' }).Count\n    \n    if ($criticalFindings -gt 0) {\n        Write-NCentralLog \"Exiting with error code 2 (Critical security findings detected)\" -Level \"Error\"\n        exit 2\n    } elseif ($PolicyCompliance.RiskScore -ge 60 -or $highFindings -gt 3) {\n        Write-NCentralLog \"Exiting with warning code 1 (High risk level or multiple high findings)\" -Level \"Warning\"\n        exit 1\n    } else {\n        Write-NCentralLog \"Exiting with success code 0 (Acceptable security posture)\" -Level \"Success\"\n        exit 0\n    }\n\n}\ncatch {\n    Write-NCentralLog \"\"\n    Write-NCentralLog \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -Level \"Error\"\n    Write-NCentralLog \"üö® N-CENTRAL AD SECURITY ASSESSMENT ERROR üö®\" -Level \"Error\"\n    Write-NCentralLog \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -Level \"Error\"\n    Write-NCentralLog \"Assessment failed: $($_.Exception.Message)\" -Level \"Error\"\n    Write-NCentralLog \"Stack trace: $($_.ScriptStackTrace)\" -Level \"Error\"\n    Write-NCentralLog \"\"\n    Write-NCentralLog \"TROUBLESHOOTING CHECKLIST:\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ Verify Active Directory PowerShell module is installed (Install-WindowsFeature RSAT-AD-PowerShell)\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ Confirm sufficient domain permissions (Domain Users minimum for read-only assessment)\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ Check network connectivity to domain controllers\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ Ensure C:\\Temp directory exists and is writable\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ Verify Microsoft Edge or Chrome is installed for PDF generation\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ For large domains, ensure adequate memory and processing time\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ Check if domain controllers are reachable and responsive\" -Level \"Warning\"\n    Write-NCentralLog \"\"\n    Write-NCentralLog \"N-Central Assessment Failed - Exiting with error code 3\" -Level \"Error\"\n    exit 3\n}\n\n# End of Active Directory Security Assessment Tool v11.0",
            "versions": [
              {
                "id": "ver-1755457361065",
                "content": "# PowerShell Script\n# Created in Nishen's AI Workspace\n# File: N1_Rms_PP_ADUsers_Security_Ass4NC.ps1\n\n#Requires -Modules ActiveDirectory\n<#\n.SYNOPSIS\n    N1_Rms_PassPolicy_ADUsers_Security_Assessment4NCentral :\n    Active Directory Security Assessment Tool - N-Central Complete Automated Version\n    \n.DESCRIPTION\n    N-Central compatible version of the comprehensive audit script that:\n    - Reports current domain password policy with enhanced best practice evaluation\n    - Identifies fine-grained password policies with risk assessment\n    - Analyzes ALL privileged groups (Domain Admins, Enterprise Admins, Schema Admins, Administrators)\n    - Handles recursive nested group memberships automatically\n    - Comprehensive analysis of ALL domain users with password security risks\n    - Enhanced risk assessment with multi-factor analysis\n    - Generates dual professional PDF reports (Security Assessment + User Analysis)\n    - Professional presentation-ready format for customer delivery\n    - AUTOMATED: No interactive prompts - auto-generates customer name from domain\n    \n.PARAMETER CustomerName\n    Name of the customer/client (optional - auto-generated from domain if not specified)\n    Auto-extracts customer name from domain by removing suffixes (.local, .co.za, .com, etc.)\n    \n.PARAMETER DomainName\n    FQDN of domain to assess (optional - uses current domain if not specified)\n    \n.PARAMETER EngineerName\n    Name of engineer/technician running assessment (optional)\n    Defaults to \"N-Central RMS Assessment\" with timestamp\n    \n.AUTHOR\n    Nishen Harichunder L4 RMS Senior Systems Engineer\n    Modified for N-Central Complete Automation\n    \n.VERSION\n    12.0 - N-Central Complete Automated Version (Full Functionality)\n    \n.DATE\n    August 2025\n    \n.EXAMPLE\n    # Simplest execution - auto-generates customer name from domain\n    .\\N1_Rms_PassPolicy_ADUsers_Security_Assessment4NCentral.ps1\n    \n.EXAMPLE\n    # N-Central execution - fully automated (no parameters needed)  \n    powershell.exe -ExecutionPolicy Bypass -File \"C:\\Scripts\\N1_Rms_PassPolicy_ADUsers_Security_Assessment4NCentral.ps1\"\n\n.NOTES\n    N-Central Deployment Instructions:\n    1. Deploy script to C:\\Scripts\\ on target servers\n    2. Create scheduled task - NO PARAMETERS REQUIRED:\n       Command: powershell.exe\n       Arguments: -ExecutionPolicy Bypass -WindowStyle Hidden -File \"C:\\Scripts\\N1_Rms_PassPolicy_ADUsers_Security_Assessment4NCentral.ps1\"\n    3. Customer name automatically extracted from domain (e.g., \"acme.local\" becomes \"Acme\")\n    4. Reports generated in C:\\Temp\\ with auto-generated customer name and timestamp\n    5. Use AMP or file retrieval to collect reports\n    6. Generates full HTML/PDF reports + CSV data + N-Central summary files\n    \n    Requirements:\n    - Domain-joined server with AD PowerShell module\n    - Read access to Active Directory\n    - Local admin rights for report generation\n    \nScript Overview\n\n  This is a comprehensive Active Directory security assessment tool (Version 12.0) that generates\n  professional PDF reports for client security audits. The script analyzes domain security posture and\n  produces dual reports: a main security assessment and a detailed user analysis.\n\n  What the Script Does\n\n  1. Domain Password Policy Analysis: Evaluates password policies against Microsoft best practices and NIST      \n  SP 800-63B standards\n  2. Privileged Account Assessment: Analyzes Domain Admins, Enterprise Admins, Schema Admins, and local\n  Administrators groups with recursive nested membership support\n  3. Complete User Analysis: Reviews ALL domain users for password and account security risks\n  4. Compliance Mapping: Maps findings to Microsoft Security Baseline, NIST Cybersecurity Framework, and\n  NIST SP 800-63B\n  5. Report Generation: Creates HTML and PDF reports with professional formatting, charts, and metrics\n  6. Data Export: Generates CSV files with detailed findings for further analysis\n\n  Risk Scoring Methodology\n\n  Overall Risk Levels\n\n  - Critical: 80-100 points\n  - High: 60-79 points\n  - Medium: 40-59 points\n  - Low: 20-39 points\n  - Info: <20 points (for disabled accounts)\n\n  Password Policy Risk Scoring\n\n  - No complexity enabled: +20 points\n  - Password length < 14 chars: +15-30 points (scaled by severity)\n  - Min password age issues: +5-20 points\n  - Max password age > 365 days: +15-35 points\n  - Password history < 12: +10 points\n  - No account lockout: +35 points\n  - Lockout threshold issues: +5-15 points\n  - Lockout duration issues: +5-20 points\n  - Reversible encryption enabled: +35 points (critical)\n\n  User Account Risk Scoring\n\n  - Never logged on: +25-40 points\n  - No logon 30+ days: +40 points (critical)\n  - No logon 90+ days: +20 points\n  - No logon 180+ days: +30 points\n  - Password never set: +30-40 points\n  - Password > 6 months old: +20-30 points\n  - Password never expires: +25-30 points\n  - Default Administrator enabled: +40 points (critical)\n  - Multiple privileged memberships: +5 points\n\n  The compliance score is calculated as (100 - RiskScore), providing a percentage-based security posture\n  rating. The script produces actionable recommendations prioritized by risk level for immediate\n  remediation.\n\n#>\n\n# Instructions , Can be run on any Server thats on the domain , because we only capturing and quering AD - read only access is more than sufficient. \n# Reports are created on c:\\temp - copy this over to your machine and store centraly on sharepoint /SDMs to access.\n\n# N-Central Parameters\nparam(\n    [Parameter(Mandatory=$false, HelpMessage=\"Customer/Client name for the assessment (auto-generated from domain if not specified)\")]\n    [string]$CustomerName = \"\",\n    \n    [Parameter(Mandatory=$false, HelpMessage=\"Domain FQDN to assess (leave blank for current domain)\")]\n    [string]$DomainName = \"\",\n    \n    [Parameter(Mandatory=$false, HelpMessage=\"Engineer/Technician name\")]\n    [string]$EngineerName = \"N-Central RMS Assessment - $(Get-Date -Format 'yyyy-MM-dd HH:mm')\"\n)\n\n# Function to extract customer name from domain name\nfunction Get-CustomerNameFromDomain {\n    param([string]$DomainFQDN)\n    \n    if ([string]::IsNullOrWhiteSpace($DomainFQDN)) {\n        return \"\"\n    }\n    \n    # Common domain suffixes to remove\n    $suffixes = @(\n        '.local', '.co.za', '.com', '.net', '.org', '.co.uk', '.com.au', '.ca',\n        '.de', '.fr', '.it', '.nl', '.be', '.ch', '.at', '.se', '.no', '.dk',\n        '.fi', '.ie', '.pt', '.es', '.pl', '.cz', '.hu', '.sk', '.si', '.hr',\n        '.rs', '.bg', '.ro', '.gr', '.cy', '.mt', '.lu', '.li', '.mc', '.sm',\n        '.va', '.ad', '.int'\n    )\n    \n    $customerName = $DomainFQDN.ToLower()\n    \n    # Remove common suffixes\n    foreach ($suffix in $suffixes) {\n        if ($customerName.EndsWith($suffix)) {\n            $customerName = $customerName.Substring(0, $customerName.Length - $suffix.Length)\n            break\n        }\n    }\n    \n    # Handle multi-part domains (take first part before first dot if multiple dots remain)\n    if ($customerName.Contains('.')) {\n        $parts = $customerName.Split('.')\n        $customerName = $parts[0]\n    }\n    \n    # Capitalize first letter and clean up\n    if ($customerName.Length -gt 0) {\n        $customerName = $customerName.Substring(0,1).ToUpper() + $customerName.Substring(1)\n        # Replace hyphens/underscores with spaces for better formatting\n        $customerName = $customerName -replace '[-_]', ' '\n    }\n    \n    return $customerName\n}\n\n# N-Central Logging Function  \nfunction Write-NCentralLog {\n    param(\n        [string]$Message,\n        [ValidateSet(\"Info\", \"Warning\", \"Error\", \"Success\")]\n        [string]$Level = \"Info\"\n    )\n    \n    $timestamp = Get-Date -Format \"yyyy-MM-dd HH:mm:ss\"\n    $logMessage = \"[$timestamp] [$Level] $Message\"\n    \n    # Output to console for N-Central capture\n    switch ($Level) {\n        \"Error\" { Write-Error $logMessage }\n        \"Warning\" { Write-Warning $logMessage }\n        \"Success\" { Write-Host $logMessage -ForegroundColor Green }\n        default { Write-Host $logMessage -ForegroundColor Cyan }\n    }\n    \n    # Also write to log file\n    try {\n        $logPath = \"C:\\Temp\\NCentral_AD_Assessment_$(Get-Date -Format 'yyyyMMdd').log\"\n        \"$logMessage\" | Out-File -FilePath $logPath -Append -Encoding UTF8\n    } catch {\n        # Ignore logging errors to prevent script failure\n    }\n}\n\n# Initialize N-Central execution\n$StartTime = Get-Date\nWrite-NCentralLog \"Starting N-Central Complete AD Security Assessment\" -Level \"Info\"\n\n# Ensure C:\\Temp exists\nif (-not (Test-Path \"C:\\Temp\")) {\n    try {\n        New-Item -Path \"C:\\Temp\" -ItemType Directory -Force | Out-Null\n        Write-NCentralLog \"Created C:\\Temp directory\" -Level \"Info\"\n    } catch {\n        Write-NCentralLog \"Failed to create C:\\Temp directory: $($_.Exception.Message)\" -Level \"Error\"\n        exit 1\n    }\n}\n\n# Import required modules\ntry {\n    Import-Module ActiveDirectory -ErrorAction Stop\n    Write-NCentralLog \"Active Directory module imported successfully\" -Level \"Success\"\n} catch {\n    Write-NCentralLog \"Failed to import Active Directory module: $($_.Exception.Message)\" -Level \"Error\"\n    Write-NCentralLog \"Ensure RSAT-AD-PowerShell is installed\" -Level \"Error\"\n    exit 1\n}\n\n# Check for required assemblies for PDF generation\ntry {\n    Add-Type -AssemblyName System.Drawing\n    Add-Type -AssemblyName System.Windows.Forms\n    Add-Type -AssemblyName Microsoft.PowerShell.Commands.Utility\n    Write-Host \"PDF generation libraries loaded successfully\" -ForegroundColor Green\n}\ncatch {\n    Write-Warning \"Some PDF generation features may be limited. Continuing with HTML to PDF conversion.\"\n}\n\n# N-Central Automated Setup - No Interactive Prompts\nWrite-NCentralLog \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -Level \"Info\"\nWrite-NCentralLog \"N-Central Active Directory Security Assessment Tool v11.1 Complete\" -Level \"Info\"\nWrite-NCentralLog \"Comprehensive Privileged Groups & User Analysis (Automated)\" -Level \"Info\"\nWrite-NCentralLog \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -Level \"Info\"\n\n# Handle domain selection first\nif ([string]::IsNullOrWhiteSpace($DomainName)) {\n    try {\n        $Domain = Get-ADDomain\n        $DomainName = $Domain.DNSRoot\n        Write-NCentralLog \"Using current domain: $DomainName\" -Level \"Success\"\n    } catch {\n        Write-NCentralLog \"Unable to connect to current domain: $($_.Exception.Message)\" -Level \"Error\"\n        exit 1\n    }\n} else {\n    try {\n        $Domain = Get-ADDomain -Server $DomainName\n        $DomainName = $Domain.DNSRoot\n        Write-NCentralLog \"Connected to specified domain: $DomainName\" -Level \"Success\"\n    } catch {\n        Write-NCentralLog \"Unable to connect to domain '$DomainName': $($_.Exception.Message)\" -Level \"Error\"\n        exit 1\n    }\n}\n\n# Auto-generate customer name from domain if not provided\nif ([string]::IsNullOrWhiteSpace($CustomerName)) {\n    $CustomerName = Get-CustomerNameFromDomain -DomainFQDN $DomainName\n    Write-NCentralLog \"Auto-generated customer name from domain: '$CustomerName'\" -Level \"Info\"\n    \n    if ([string]::IsNullOrWhiteSpace($CustomerName)) {\n        Write-NCentralLog \"Unable to generate customer name from domain '$DomainName'. Using domain NetBIOS name as customer name.\" -Level \"Warning\"\n        $CustomerName = $Domain.NetBIOSName\n    }\n} else {\n    Write-NCentralLog \"Using provided customer name: '$CustomerName'\" -Level \"Info\"\n}\n\n# Validate final inputs\nif ([string]::IsNullOrWhiteSpace($CustomerName)) {\n    Write-NCentralLog \"Customer Name could not be determined\" -Level \"Error\"\n    exit 1\n}\n\nif ([string]::IsNullOrWhiteSpace($EngineerName)) {\n    Write-NCentralLog \"Engineer Name could not be determined\" -Level \"Error\" \n    exit 1\n}\n\n# Initialize variables with N-Central friendly naming\n$ReportDate = Get-Date -Format \"yyyy-MM-dd HH:mm:ss\"\n$SafeCustomerName = $CustomerName -replace '[^\\w\\s]', '' -replace '\\s+', '_'\n$Timestamp = Get-Date -Format 'yyyyMMdd_HHmmss'\n\n# N-Central file naming with NCentral prefix for easy identification\n$OutputPathHTML = \"C:\\Temp\\NCentral_AD_Security_Assessment_$($SafeCustomerName)_$($Domain.NetBIOSName)_$($Timestamp).html\"\n$OutputPathPDF = \"C:\\Temp\\NCentral_AD_Security_Assessment_$($SafeCustomerName)_$($Domain.NetBIOSName)_$($Timestamp).pdf\"\n$OutputPathUserHTML = \"C:\\Temp\\NCentral_AD_User_Analysis_$($SafeCustomerName)_$($Domain.NetBIOSName)_$($Timestamp).html\"\n$OutputPathUserPDF = \"C:\\Temp\\NCentral_AD_User_Analysis_$($SafeCustomerName)_$($Domain.NetBIOSName)_$($Timestamp).pdf\"\n$OutputPathCSV = \"C:\\Temp\\NCentral_AD_Complete_Assessment_$($SafeCustomerName)_$($Domain.NetBIOSName)_$($Timestamp)_Details.csv\"\n\nWrite-NCentralLog \"Starting comprehensive Active Directory Security Assessment\" -Level \"Success\"\nWrite-NCentralLog \"Customer: $CustomerName\" -Level \"Info\"\nWrite-NCentralLog \"Domain: $DomainName\" -Level \"Info\" \nWrite-NCentralLog \"Engineer: $EngineerName\" -Level \"Info\"\nWrite-NCentralLog \"Output files will be prefixed with: NCentral_AD_*_$($SafeCustomerName)_$($Domain.NetBIOSName)_$($Timestamp)\" -Level \"Info\"\n\n# Function to calculate risk score\nfunction Get-RiskLevel {\n    param($Score)\n    if ($Score -ge 80) { return 'Critical' }\n    elseif ($Score -ge 60) { return 'High' }\n    elseif ($Score -ge 40) { return 'Medium' }\n    elseif ($Score -ge 20) { return 'Low' }\n    else { return 'Info' }\n}\n\n# Function to get domain password policy with enhanced evaluation\nfunction Get-DomainPasswordPolicy {\n    param($DomainServer)\n    Write-Host \"Retrieving enhanced domain password policy...\" -ForegroundColor Yellow\n    \n    $Policy = if ($DomainServer) { \n        Get-ADDefaultDomainPasswordPolicy -Server $DomainServer \n    } else { \n        Get-ADDefaultDomainPasswordPolicy \n    }\n    \n    return @{\n        'ComplexityEnabled' = $Policy.ComplexityEnabled\n        'DistinguishedName' = $Policy.DistinguishedName\n        'LockoutDuration' = $Policy.LockoutDuration.TotalMinutes\n        'LockoutObservationWindow' = $Policy.LockoutObservationWindow.TotalMinutes\n        'LockoutThreshold' = $Policy.LockoutThreshold\n        'MaxPasswordAge' = $Policy.MaxPasswordAge.TotalDays\n        'MinPasswordAge' = $Policy.MinPasswordAge.TotalDays\n        'MinPasswordLength' = $Policy.MinPasswordLength\n        'PasswordHistoryCount' = $Policy.PasswordHistoryCount\n        'ReversibleEncryptionEnabled' = $Policy.ReversibleEncryptionEnabled\n    }\n}\n\n# Function to get fine-grained password policies\nfunction Get-FineGrainedPolicies {\n    param($DomainServer)\n    Write-Host \"Retrieving fine-grained password policies...\" -ForegroundColor Yellow\n    \n    try {\n        $FGPPs = if ($DomainServer) {\n            Get-ADFineGrainedPasswordPolicy -Filter * -Properties * -Server $DomainServer\n        } else {\n            Get-ADFineGrainedPasswordPolicy -Filter * -Properties *\n        }\n        \n        $FGPPDetails = @()\n        \n        foreach ($FGPP in $FGPPs) {\n            $AppliesTo = if ($DomainServer) {\n                (Get-ADFineGrainedPasswordPolicySubject -Identity $FGPP -Server $DomainServer).Name -join \", \"\n            } else {\n                (Get-ADFineGrainedPasswordPolicySubject -Identity $FGPP).Name -join \", \"\n            }\n            \n            $FGPPDetails += [PSCustomObject]@{\n                'Name' = $FGPP.Name\n                'Precedence' = $FGPP.Precedence\n                'ComplexityEnabled' = $FGPP.ComplexityEnabled\n                'LockoutDuration' = $FGPP.LockoutDuration.TotalMinutes\n                'LockoutObservationWindow' = $FGPP.LockoutObservationWindow.TotalMinutes\n                'LockoutThreshold' = $FGPP.LockoutThreshold\n                'MaxPasswordAge' = $FGPP.MaxPasswordAge.TotalDays\n                'MinPasswordAge' = $FGPP.MinPasswordAge.TotalDays\n                'MinPasswordLength' = $FGPP.MinPasswordLength\n                'PasswordHistoryCount' = $FGPP.PasswordHistoryCount\n                'ReversibleEncryptionEnabled' = $FGPP.ReversibleEncryptionEnabled\n                'AppliesTo' = $AppliesTo\n            }\n        }\n        \n        return $FGPPDetails\n    }\n    catch {\n        Write-Warning \"No fine-grained password policies found or insufficient permissions\"\n        return @()\n    }\n}\n\n# Enhanced function to analyze password policy compliance with new requirements\nfunction Test-PolicyCompliance {\n    param($Policy)\n    \n    $Issues = @()\n    $RiskScore = 0\n    \n    # Enhanced Microsoft Best Practices and Industry Standards\n    if (-not $Policy.ComplexityEnabled) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = 'Password complexity is disabled'\n            'Risk' = 'High'\n            'Recommendation' = 'Enable password complexity requirements'\n            'BestPractice' = 'Microsoft recommends enabling complexity for passwords'\n        }\n        $RiskScore += 20\n    }\n    \n    if ($Policy.MinPasswordLength -lt 14) {\n        $Risk = if ($Policy.MinPasswordLength -lt 8) { 'Critical' } \n               elseif ($Policy.MinPasswordLength -lt 12) { 'High' }\n               else { 'Medium' }\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Minimum password length is $($Policy.MinPasswordLength) characters\"\n            'Risk' = $Risk\n            'Recommendation' = 'Set minimum password length to 14+ characters per NIST SP 800-63B'\n            'BestPractice' = 'NIST SP 800-63B and Microsoft recommend 14+ character passwords for security'\n        }\n        $RiskScore += if ($Policy.MinPasswordLength -lt 8) { 30 } \n                     elseif ($Policy.MinPasswordLength -lt 12) { 20 } \n                     else { 15 }\n    }\n    \n    # Enhanced Minimum Password Age evaluation\n    if ($Policy.MinPasswordAge -lt 1) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Minimum password age is $($Policy.MinPasswordAge) days\"\n            'Risk' = 'High'\n            'Recommendation' = 'Set minimum password age to at least 1 day to prevent immediate password reuse'\n            'BestPractice' = 'Industry standard is 1-2 days to balance security with usability'\n        }\n        $RiskScore += 20\n    }\n    elseif ($Policy.MinPasswordAge -gt 2) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Minimum password age is $($Policy.MinPasswordAge) days\"\n            'Risk' = 'Low'\n            'Recommendation' = 'Consider reducing minimum password age to 1-2 days'\n            'BestPractice' = 'Industry standard is 1-2 days to balance security with usability'\n        }\n        $RiskScore += 5\n    }\n    \n    # Enhanced Maximum Password Age evaluation\n    if ($Policy.MaxPasswordAge -eq 0) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Maximum password age is set to never expire\"\n            'Risk' = 'Critical'\n            'Recommendation' = 'Set maximum password age to 60-365 days or implement alternative authentication'\n            'BestPractice' = 'Balance between security and usability - consider modern authentication methods'\n        }\n        $RiskScore += 35\n    }\n    elseif ($Policy.MaxPasswordAge -gt 365) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Maximum password age is $($Policy.MaxPasswordAge) days\"\n            'Risk' = 'Medium'\n            'Recommendation' = 'Consider reducing maximum password age to 365 days or less'\n            'BestPractice' = 'Regularly changed passwords reduce long-term exposure risk'\n        }\n        $RiskScore += 15\n    }\n    \n    if ($Policy.PasswordHistoryCount -lt 12) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Password history is set to $($Policy.PasswordHistoryCount) passwords\"\n            'Risk' = 'Medium'\n            'Recommendation' = 'Set password history to remember at least 12 passwords'\n            'BestPractice' = 'Prevents password reuse and cycling - Microsoft baseline recommendation'\n        }\n        $RiskScore += 10\n    }\n    \n    if ($Policy.LockoutThreshold -eq 0) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = 'Account lockout is disabled'\n            'Risk' = 'Critical'\n            'Recommendation' = 'Enable account lockout with threshold of 5-10 attempts'\n            'BestPractice' = 'Protects against brute force attacks while maintaining usability'\n        }\n        $RiskScore += 35\n    }\n    elseif ($Policy.LockoutThreshold -lt 5 -or $Policy.LockoutThreshold -gt 10) {\n        $Risk = if ($Policy.LockoutThreshold -lt 5) { 'Medium' } else { 'Low' }\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Account lockout threshold is $($Policy.LockoutThreshold) attempts\"\n            'Risk' = $Risk\n            'Recommendation' = 'Set lockout threshold to 5-10 failed attempts for optimal security'\n            'BestPractice' = 'Balance security protection with user experience'\n        }\n        $RiskScore += if ($Policy.LockoutThreshold -lt 5) { 15 } else { 5 }\n    }\n    \n    # Enhanced Lockout Duration evaluation\n    if ($Policy.LockoutDuration -lt 15) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Account lockout duration is $($Policy.LockoutDuration) minutes\"\n            'Risk' = 'High'\n            'Recommendation' = 'Set lockout duration to at least 15 minutes for optimal security'\n            'BestPractice' = 'Adequate lockout duration deters automated attacks while minimizing user impact'\n        }\n        $RiskScore += 20\n    }\n    elseif ($Policy.LockoutDuration -gt 60) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Account lockout duration is $($Policy.LockoutDuration) minutes\"\n            'Risk' = 'Low'\n            'Recommendation' = 'Consider reducing lockout duration to 15-60 minutes'\n            'BestPractice' = 'Adequate lockout duration deters automated attacks while minimizing user impact'\n        }\n        $RiskScore += 5\n    }\n    \n    # Enhanced Reset Account Lockout Counter evaluation\n    if ($Policy.LockoutObservationWindow -lt $Policy.LockoutDuration -and $Policy.LockoutThreshold -gt 0) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = \"Reset account lockout counter ($($Policy.LockoutObservationWindow) min) is less than lockout duration ($($Policy.LockoutDuration) min)\"\n            'Risk' = 'High'\n            'Recommendation' = 'Set reset lockout counter equal to or greater than lockout duration'\n            'BestPractice' = 'Ensures proper lockout behavior and prevents premature counter resets'\n        }\n        $RiskScore += 20\n    }\n    \n    if ($Policy.ReversibleEncryptionEnabled) {\n        $Issues += [PSCustomObject]@{\n            'Issue' = 'Reversible encryption is enabled'\n            'Risk' = 'Critical'\n            'Recommendation' = 'Disable reversible encryption immediately - CRITICAL SECURITY RISK'\n            'BestPractice' = 'Reversible encryption is equivalent to storing passwords in plain text'\n        }\n        $RiskScore += 35\n    }\n    \n    return @{\n        'Issues' = $Issues\n        'RiskScore' = $RiskScore\n        'RiskLevel' = Get-RiskLevel $RiskScore\n    }\n}\n\n# Enhanced function to get comprehensive privileged group analysis\nfunction Get-AllPrivilegedAccounts {\n    param($DomainServer)\n    Write-Host \"Performing comprehensive privileged group analysis...\" -ForegroundColor Yellow\n    \n    $PrivilegedGroups = @(\n        'Domain Admins',\n        'Enterprise Admins', \n        'Schema Admins',\n        'Administrators'\n    )\n    \n    $AllPrivilegedAccounts = @()\n    \n    foreach ($GroupName in $PrivilegedGroups) {\n        Write-Host \"  Analyzing group: $GroupName\" -ForegroundColor Cyan\n        \n        try {\n            # Get group with recursive membership\n            $Members = if ($DomainServer) {\n                Get-ADGroupMember $GroupName -Recursive -Server $DomainServer -ErrorAction SilentlyContinue\n            } else {\n                Get-ADGroupMember $GroupName -Recursive -ErrorAction SilentlyContinue\n            }\n            \n            foreach ($Member in $Members) {\n                if ($Member.objectClass -eq \"user\") {\n                    $User = if ($DomainServer) {\n                        Get-ADUser $Member.SamAccountName -Properties LastLogonDate, PasswordLastSet, Enabled, AccountExpirationDate, PasswordNeverExpires, MemberOf -Server $DomainServer\n                    } else {\n                        Get-ADUser $Member.SamAccountName -Properties LastLogonDate, PasswordLastSet, Enabled, AccountExpirationDate, PasswordNeverExpires, MemberOf\n                    }\n                    \n                    $LastLogon = if ($User.LastLogonDate) { $User.LastLogonDate } else { \"Never\" }\n                    $PasswordLastSet = if ($User.PasswordLastSet) { $User.PasswordLastSet } else { \"Never\" }\n                    \n                    # Calculate days since last logon and password change\n                    $DaysSinceLogon = if ($User.LastLogonDate) { (Get-Date) - $User.LastLogonDate | Select-Object -ExpandProperty Days } else { 9999 }\n                    $DaysSincePasswordChange = if ($User.PasswordLastSet) { (Get-Date) - $User.PasswordLastSet | Select-Object -ExpandProperty Days } else { 9999 }\n                    \n                    # Get all privileged groups this user belongs to\n                    $UserPrivilegedGroups = @()\n                    foreach ($CheckGroup in $PrivilegedGroups) {\n                        try {\n                            $GroupMembers = if ($DomainServer) {\n                                Get-ADGroupMember $CheckGroup -Recursive -Server $DomainServer -ErrorAction SilentlyContinue\n                            } else {\n                                Get-ADGroupMember $CheckGroup -Recursive -ErrorAction SilentlyContinue\n                            }\n                            if ($GroupMembers.SamAccountName -contains $User.SamAccountName) {\n                                $UserPrivilegedGroups += $CheckGroup\n                            }\n                        }\n                        catch {\n                            # Group might not exist in this domain\n                        }\n                    }\n                    \n                    # Enhanced risk assessment with multi-factor analysis\n                    $RiskFactors = @()\n                    $RiskScore = 0\n                    \n                    if (-not $User.Enabled) { \n                        $RiskFactors += \"Account Disabled\"\n                        $RiskScore += 0 # Disabled accounts are actually lower risk\n                    }\n                    \n                    if ($DaysSinceLogon -gt 180) { \n                        $RiskFactors += \"No logon for 180+ days\"\n                        $RiskScore += 30\n                    }\n                    elseif ($DaysSinceLogon -gt 90) { \n                        $RiskFactors += \"No logon for 90+ days\"\n                        $RiskScore += 20\n                    }\n                    elseif ($DaysSinceLogon -gt 30) { \n                        $RiskFactors += \"No logon for 30+ days\"\n                        $RiskScore += 40  # Changed to Critical for 30+ days\n                    }\n                    \n                    if ($LastLogon -eq \"Never\") {\n                        $RiskFactors += \"Never logged on\"\n                        $RiskScore += 40  # Changed to Critical\n                    }\n                    \n                    if ($DaysSincePasswordChange -gt 365) { \n                        $RiskFactors += \"Password older than 1 year\"\n                        $RiskScore += 30\n                    }\n                    elseif ($DaysSincePasswordChange -gt 180) { \n                        $RiskFactors += \"Password older than 6 months\"\n                        $RiskScore += 25  # Changed to High risk\n                    }\n                    \n                    if ($User.PasswordNeverExpires) { \n                        $RiskFactors += \"Password never expires\"\n                        $RiskScore += 30  # Changed to High risk\n                    }\n                    \n                    if ($PasswordLastSet -eq \"Never\") {\n                        $RiskFactors += \"Password never set\"\n                        $RiskScore += 40  # Changed to Critical\n                    }\n                    \n                    if ($UserPrivilegedGroups.Count -gt 1) {\n                        $RiskFactors += \"Multiple privileged group memberships\"\n                        $RiskScore += 5\n                    }\n                    \n                    # Check for default Administrator account\n                    if ($User.SamAccountName -eq \"Administrator\" -and $User.Enabled) {\n                        $RiskFactors += \"Default Administrator account is enabled\"\n                        $RiskScore += 40  # Changed to Critical\n                    }\n                    \n                    # Determine overall risk level\n                    $Risk = Get-RiskLevel $RiskScore\n                    if (-not $User.Enabled) { $Risk = 'Info' }\n                    \n                    $AllPrivilegedAccounts += [PSCustomObject]@{\n                        'Name' = $User.Name\n                        'SamAccountName' = $User.SamAccountName\n                        'PrimaryGroup' = $GroupName\n                        'AllPrivilegedGroups' = $UserPrivilegedGroups -join \"; \"\n                        'Enabled' = $User.Enabled\n                        'LastLogonDate' = $LastLogon\n                        'PasswordLastSet' = $PasswordLastSet\n                        'DaysSinceLogon' = $DaysSinceLogon\n                        'DaysSincePasswordChange' = $DaysSincePasswordChange\n                        'PasswordNeverExpires' = $User.PasswordNeverExpires\n                        'AccountExpirationDate' = $User.AccountExpirationDate\n                        'RiskFactors' = $RiskFactors -join \"; \"\n                        'RiskScore' = $RiskScore\n                        'Risk' = $Risk\n                    }\n                }\n            }\n        }\n        catch {\n            Write-Warning \"Unable to analyze group '$GroupName': $($_.Exception.Message)\"\n        }\n    }\n    \n    # Remove duplicates (users in multiple groups)\n    $UniqueAccounts = $AllPrivilegedAccounts | Sort-Object SamAccountName -Unique\n    \n    return $UniqueAccounts\n}\n\n# New function for comprehensive domain user analysis\nfunction Get-DomainUserAnalysis {\n    param($DomainServer)\n    Write-Host \"Performing comprehensive domain user analysis...\" -ForegroundColor Yellow\n    Write-Host \"  This may take several minutes for large domains...\" -ForegroundColor Cyan\n    \n    $AllUsers = if ($DomainServer) {\n        Get-ADUser -Filter * -Properties LastLogonDate, PasswordLastSet, Enabled, AccountExpirationDate, PasswordNeverExpires, Created, BadLogonCount -Server $DomainServer\n    } else {\n        Get-ADUser -Filter * -Properties LastLogonDate, PasswordLastSet, Enabled, AccountExpirationDate, PasswordNeverExpires, Created, BadLogonCount\n    }\n    \n    Write-Host \"  Analyzing $($AllUsers.Count) user accounts...\" -ForegroundColor Cyan\n    \n    $UserAnalysis = @()\n    $Counter = 0\n    \n    foreach ($User in $AllUsers) {\n        $Counter++\n        if ($Counter % 100 -eq 0) {\n            Write-Host \"    Processed $Counter of $($AllUsers.Count) users...\" -ForegroundColor Yellow\n        }\n        \n        $LastLogon = if ($User.LastLogonDate) { $User.LastLogonDate } else { \"Never\" }\n        $PasswordLastSet = if ($User.PasswordLastSet) { $User.PasswordLastSet } else { \"Never\" }\n        \n        # Calculate days since last logon and password change\n        $DaysSinceLogon = if ($User.LastLogonDate) { (Get-Date) - $User.LastLogonDate | Select-Object -ExpandProperty Days } else { 9999 }\n        $DaysSincePasswordChange = if ($User.PasswordLastSet) { (Get-Date) - $User.PasswordLastSet | Select-Object -ExpandProperty Days } else { 9999 }\n        $DaysSinceCreated = if ($User.Created) { (Get-Date) - $User.Created | Select-Object -ExpandProperty Days } else { 9999 }\n        \n        # Password and account risk assessment\n        $RiskFactors = @()\n        $RiskScore = 0\n        \n        # Account status risks\n        if (-not $User.Enabled) { \n            $RiskFactors += \"Account Disabled\"\n        }\n        \n        # Logon pattern risks\n        if ($LastLogon -eq \"Never\") {\n            $RiskFactors += \"Never logged on\"\n            $RiskScore += 25\n        }\n        elseif ($DaysSinceLogon -gt 365) { \n            $RiskFactors += \"No logon for 1+ years (Stale)\"\n            $RiskScore += 30\n        }\n        elseif ($DaysSinceLogon -gt 180) { \n            $RiskFactors += \"No logon for 6+ months\"\n            $RiskScore += 25\n        }\n        elseif ($DaysSinceLogon -gt 90) { \n            $RiskFactors += \"No logon for 3+ months\"\n            $RiskScore += 20\n        }\n        elseif ($DaysSinceLogon -gt 30) { \n            $RiskFactors += \"No logon for 30+ days\"\n            $RiskScore += 40  # Changed to Critical\n        }\n        \n        # Password security risks\n        if ($PasswordLastSet -eq \"Never\") {\n            $RiskFactors += \"Password never set\"\n            $RiskScore += 30\n        }\n        elseif ($DaysSincePasswordChange -gt 730) { \n            $RiskFactors += \"Password older than 2 years\"\n            $RiskScore += 30\n        }\n        elseif ($DaysSincePasswordChange -gt 365) { \n            $RiskFactors += \"Password older than 1 year\"\n            $RiskScore += 25\n        }\n        elseif ($DaysSincePasswordChange -gt 180) { \n            $RiskFactors += \"Password older than 6 months\"\n            $RiskScore += 20  # Changed to High risk\n        }\n        \n        if ($User.PasswordNeverExpires) { \n            $RiskFactors += \"Password never expires\"\n            $RiskScore += 25  # Changed to High risk\n        }\n        \n        # Account behavior risks\n        if ($User.BadLogonCount -gt 0) {\n            $RiskFactors += \"Recent failed logon attempts: $($User.BadLogonCount)\"\n            $RiskScore += 10\n        }\n        \n        # New account risks\n        if ($DaysSinceCreated -lt 30 -and $LastLogon -eq \"Never\") {\n            $RiskFactors += \"New account never used\"\n            $RiskScore += 15\n        }\n        \n        # Account expiration\n        if ($User.AccountExpirationDate -and $User.AccountExpirationDate -lt (Get-Date)) {\n            $RiskFactors += \"Account expired\"\n            $RiskScore += 5\n        }\n        \n        # Check for default Administrator account\n        if ($User.SamAccountName -eq \"Administrator\" -and $User.Enabled) {\n            $RiskFactors += \"Default Administrator account is enabled\"\n            $RiskScore += 40  # Changed to Critical\n        }\n        \n        # Determine overall risk level\n        $Risk = Get-RiskLevel $RiskScore\n        if (-not $User.Enabled) { $Risk = 'Info' }\n        \n        # Categorize user type\n        $UserType = \"Standard User\"\n        if ($User.SamAccountName -like \"*admin*\" -or $User.SamAccountName -like \"*svc*\" -or $User.SamAccountName -like \"*service*\") {\n            $UserType = \"Service/Admin Account\"\n        }\n        elseif ($User.SamAccountName -like \"*test*\" -or $User.SamAccountName -like \"*temp*\") {\n            $UserType = \"Test/Temp Account\"\n        }\n        \n        $UserAnalysis += [PSCustomObject]@{\n            'Name' = $User.Name\n            'SamAccountName' = $User.SamAccountName\n            'UserType' = $UserType\n            'Enabled' = $User.Enabled\n            'Created' = if ($User.Created) { $User.Created.ToString(\"yyyy-MM-dd\") } else { \"Unknown\" }\n            'LastLogonDate' = if ($LastLogon -eq \"Never\") { \"Never\" } else { $LastLogon.ToString(\"yyyy-MM-dd\") }\n            'PasswordLastSet' = if ($PasswordLastSet -eq \"Never\") { \"Never\" } else { $PasswordLastSet.ToString(\"yyyy-MM-dd\") }\n            'DaysSinceLogon' = $DaysSinceLogon\n            'DaysSincePasswordChange' = $DaysSincePasswordChange\n            'PasswordNeverExpires' = $User.PasswordNeverExpires\n            'AccountExpirationDate' = $User.AccountExpirationDate\n            'BadLogonCount' = $User.BadLogonCount\n            'RiskFactors' = if ($RiskFactors.Count -gt 0) { $RiskFactors -join \"; \" } else { \"None\" }\n            'RiskScore' = $RiskScore\n            'Risk' = $Risk\n        }\n    }\n    \n    Write-Host \"  User analysis completed!\" -ForegroundColor Green\n    return $UserAnalysis\n}\n\n# Enhanced function to generate professional HTML for main security assessment\nfunction New-SecurityAssessmentHTML {\n    param(\n        $DomainPolicy,\n        $FGPPs,\n        $PolicyCompliance,\n        $PrivilegedAccounts,\n        $CustomerName,\n        $DomainName,\n        $EngineerName\n    )\n    \n    # Calculate additional metrics\n    $StalePrivileged = $PrivilegedAccounts | Where-Object { $_.DaysSinceLogon -gt 90 -and $_.Enabled }\n    $CriticalIssues = $PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Critical' }\n    $HighIssues = $PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'High' }\n    $NeverLoggedOn = $PrivilegedAccounts | Where-Object { $_.LastLogonDate -eq 'Never' }\n    \n    $HTML = @\"\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <title>Active Directory Security Assessment Report</title>\n    <style>\n        @page {\n            margin: 0.5in;\n            @top-center {\n                content: \"Active Directory Security Assessment\";\n                font-family: 'Segoe UI', sans-serif;\n                font-size: 10px;\n                color: #666;\n            }\n            @bottom-center {\n                content: \"Page \" counter(page) \" of \" counter(pages);\n                font-family: 'Segoe UI', sans-serif;\n                font-size: 10px;\n                color: #666;\n            }\n        }\n        \n        body {\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n            margin: 0;\n            padding: 20px;\n            background-color: white;\n            line-height: 1.4;\n            font-size: 11px;\n        }\n        \n        .header {\n            text-align: center;\n            border-bottom: 3px solid #2E86AB;\n            padding-bottom: 15px;\n            margin-bottom: 20px;\n        }\n        \n        .customer-name {\n            font-size: 28px;\n            font-weight: bold;\n            color: #2E86AB;\n            margin-bottom: 5px;\n            text-transform: uppercase;\n        }\n        \n        .report-title {\n            font-size: 18px;\n            font-weight: bold;\n            color: #333;\n            margin-bottom: 15px;\n        }\n        \n        .header-info {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 20px;\n            margin-top: 15px;\n            font-size: 10px;\n        }\n        \n        .section {\n            margin-bottom: 20px;\n            page-break-inside: avoid;\n        }\n        \n        .section h2 {\n            background: linear-gradient(135deg, #2E86AB 0%, #1f5f99 100%);\n            color: white;\n            padding: 8px 15px;\n            margin: 0 0 10px 0;\n            font-size: 14px;\n            font-weight: bold;\n        }\n        \n        .section h3 {\n            color: #2E86AB;\n            font-size: 12px;\n            margin: 15px 0 8px 0;\n            border-bottom: 1px solid #ddd;\n            padding-bottom: 3px;\n        }\n        \n        .executive-summary {\n            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);\n            padding: 15px;\n            border-left: 4px solid #2E86AB;\n            margin-bottom: 20px;\n        }\n        \n        .metrics-grid {\n            display: grid;\n            grid-template-columns: repeat(4, 1fr);\n            gap: 15px;\n            margin: 15px 0;\n        }\n        \n        .metric-card {\n            text-align: center;\n            padding: 12px;\n            background: white;\n            border: 1px solid #ddd;\n            border-radius: 5px;\n        }\n        \n        .metric-value {\n            font-size: 18px;\n            font-weight: bold;\n            color: #2E86AB;\n        }\n        \n        .metric-label {\n            font-size: 10px;\n            color: #666;\n            margin-top: 5px;\n        }\n        \n        table {\n            width: 100%;\n            border-collapse: collapse;\n            margin: 10px 0;\n            font-size: 10px;\n        }\n        \n        th, td {\n            border: 1px solid #ddd;\n            padding: 6px;\n            text-align: left;\n        }\n        \n        th {\n            background-color: #f8f9fa;\n            font-weight: bold;\n            color: #2E86AB;\n        }\n        \n        .compliant {\n            background-color: #d4edda;\n            color: #155724;\n            font-weight: bold;\n        }\n        \n        .non-compliant {\n            background-color: #f8d7da;\n            color: #721c24;\n            font-weight: bold;\n        }\n        \n        .risk-critical {\n            background-color: #f8d7da;\n            border-left: 4px solid #dc3545;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-high {\n            background-color: #fff3cd;\n            border-left: 4px solid #ffc107;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-medium {\n            background-color: #d1ecf1;\n            border-left: 4px solid #17a2b8;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-low {\n            background-color: #d4edda;\n            border-left: 4px solid #28a745;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-badge {\n            padding: 3px 8px;\n            border-radius: 12px;\n            color: white;\n            font-weight: bold;\n            font-size: 9px;\n            text-transform: uppercase;\n        }\n        \n        .risk-critical .risk-badge { background-color: #dc3545; }\n        .risk-high .risk-badge { background-color: #ffc107; color: #333; }\n        .risk-medium .risk-badge { background-color: #17a2b8; }\n        .risk-low .risk-badge { background-color: #28a745; }\n        \n        .recommendation {\n            background-color: #f0f8ff;\n            border: 1px solid #b3d9ff;\n            padding: 12px;\n            margin: 10px 0;\n            border-radius: 5px;\n        }\n        \n        .recommendation h4 {\n            margin: 0 0 8px 0;\n            color: #2E86AB;\n            font-size: 11px;\n        }\n        \n        .footer {\n            border-top: 2px solid #2E86AB;\n            padding-top: 15px;\n            margin-top: 30px;\n            text-align: center;\n            font-size: 9px;\n            color: #666;\n        }\n        \n        .chart-container {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 20px;\n            margin: 15px 0;\n        }\n        \n        .chart-item {\n            background: white;\n            border: 1px solid #ddd;\n            padding: 10px;\n            border-radius: 5px;\n        }\n        \n        .progress-bar {\n            width: 100%;\n            height: 15px;\n            background-color: #e9ecef;\n            border-radius: 8px;\n            overflow: hidden;\n            margin: 5px 0;\n        }\n        \n        .progress-fill {\n            height: 100%;\n            border-radius: 8px;\n        }\n        \n        .no-break { page-break-inside: avoid; }\n        \n        .enhanced-metrics {\n            display: grid;\n            grid-template-columns: repeat(6, 1fr);\n            gap: 10px;\n            margin: 15px 0;\n        }\n        \n        .risk-distribution {\n            display: grid;\n            grid-template-columns: repeat(4, 1fr);\n            gap: 10px;\n            margin: 10px 0;\n        }\n        \n        .risk-item {\n            text-align: center;\n            padding: 8px;\n            border-radius: 5px;\n            color: white;\n            font-weight: bold;\n        }\n        \n        .risk-critical-bg { background-color: #dc3545; }\n        .risk-high-bg { background-color: #fd7e14; }\n        .risk-medium-bg { background-color: #ffc107; color: #333; }\n        .risk-low-bg { background-color: #28a745; }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <div class=\"customer-name\">$CustomerName</div>\n        <div class=\"report-title\">Active Directory Security Assessment Report</div>\n        <div style=\"font-size: 12px; color: #2E86AB; margin-top: 5px;\">Comprehensive Privileged Groups & Deafult Domain Password Policy Analysis</div>\n        \n        <div class=\"header-info\">\n            <div>\n                <strong>Customer:</strong> $CustomerName<br>\n                <strong>Domain:</strong> $DomainName<br>\n                <strong>Assessment Date:</strong> $ReportDate\n            </div>\n            <div>\n                <strong>Assessed By:</strong> $EngineerName<br>\n                <strong>Report Version:</strong> 11.0<br>\n                <strong>Classification:</strong> Domain Security\n            </div>\n        </div>\n    </div>\n\n    <div class=\"executive-summary no-break\">\n        <h2>Executive Summary</h2>\n        <p>This comprehensive assessment evaluates the Active Directory password policies, fine-grained policies, and <strong>all privileged group memberships</strong> (Domain Admins, Enterprise Admins, Schema Admins, Administrators) for <strong>$CustomerName</strong>. The evaluation compares current configurations against Microsoft security baselines, NIST SP 800-63B guidelines, and industry best practices to identify security risks and provide actionable recommendations.</p>\n        \n        <div class=\"enhanced-metrics\">\n            <div class=\"metric-card\">\n                <div class=\"metric-value\" style=\"color: $(\n                    switch ($PolicyCompliance.RiskLevel) {\n                        'Critical' { '#dc3545' }\n                        'High' { '#fd7e14' }\n                        'Medium' { '#ffc107' }\n                        'Low' { '#28a745' }\n                        default { '#17a2b8' }\n                    }\n                );\">$($PolicyCompliance.RiskLevel.ToUpper())</div>\n                <div class=\"metric-label\">Overall Risk Level</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$($PolicyCompliance.RiskScore)/100</div>\n                <div class=\"metric-label\">Policy Risk Score</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$($PolicyCompliance.Issues.Count)</div>\n                <div class=\"metric-label\">Policy Issues</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$($PrivilegedAccounts.Count)</div>\n                <div class=\"metric-label\">Privileged Accounts</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$($StalePrivileged.Count)</div>\n                <div class=\"metric-label\">Stale Privileged</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$($NeverLoggedOn.Count)</div>\n                <div class=\"metric-label\">Never Used</div>\n            </div>\n        </div>\n        \n        <div class=\"chart-container\">\n            <div class=\"chart-item\">\n                <h4>Security Compliance Score</h4>\n                <div class=\"progress-bar\">\n                    <div class=\"progress-fill\" style=\"width: $((100-$PolicyCompliance.RiskScore))%; background-color: $(\n                        if ((100-$PolicyCompliance.RiskScore) -ge 80) { '#28a745' }\n                        elseif ((100-$PolicyCompliance.RiskScore) -ge 60) { '#ffc107' }\n                        else { '#dc3545' }\n                    );\"></div>\n                </div>\n                <small>$((100-$PolicyCompliance.RiskScore))% Compliant</small>\n            </div>\n            <div class=\"chart-item\">\n                <h4>Privileged Account Health</h4>\n                <div class=\"progress-bar\">\n                    <div class=\"progress-fill\" style=\"width: $(\n                        if ($PrivilegedAccounts.Count -gt 0) {\n                            $HealthyPrivileged = $PrivilegedAccounts | Where-Object { $_.Risk -eq 'Low' -or $_.Risk -eq 'Info' }\n                            [math]::Round(($HealthyPrivileged.Count / $PrivilegedAccounts.Count) * 100, 0)\n                        } else { 0 }\n                    )%; background-color: #28a745;\"></div>\n                </div>\n                <small>$(\n                    if ($PrivilegedAccounts.Count -gt 0) {\n                        $HealthyPrivileged = $PrivilegedAccounts | Where-Object { $_.Risk -eq 'Low' -or $_.Risk -eq 'Info' }\n                        [math]::Round(($HealthyPrivileged.Count / $PrivilegedAccounts.Count) * 100, 0)\n                    } else { 0 }\n                )% Low Risk</small>\n            </div>\n        </div>\n        \n        <div class=\"risk-distribution\">\n            <div class=\"risk-item risk-critical-bg\">\n                <div>$(($PrivilegedAccounts | Where-Object { $_.Risk -eq 'Critical' }).Count)</div>\n                <div style=\"font-size: 9px;\">CRITICAL</div>\n            </div>\n            <div class=\"risk-item risk-high-bg\">\n                <div>$(($PrivilegedAccounts | Where-Object { $_.Risk -eq 'High' }).Count)</div>\n                <div style=\"font-size: 9px;\">HIGH</div>\n            </div>\n            <div class=\"risk-item risk-medium-bg\">\n                <div>$(($PrivilegedAccounts | Where-Object { $_.Risk -eq 'Medium' }).Count)</div>\n                <div style=\"font-size: 9px;\">MEDIUM</div>\n            </div>\n            <div class=\"risk-item risk-low-bg\">\n                <div>$(($PrivilegedAccounts | Where-Object { $_.Risk -eq 'Low' -or $_.Risk -eq 'Info' }).Count)</div>\n                <div style=\"font-size: 9px;\">LOW/INFO</div>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"section no-break\">\n        <h2>Domain Password Policy Assessment</h2>\n        <p>Current domain password policy configuration compared to Microsoft security baselines and NIST SP 800-63B guidelines:</p>\n        \n        <table>\n            <thead>\n                <tr>\n                    <th>Policy Setting</th>\n                    <th>Current Value</th>\n                    <th>Best Practice</th>\n                    <th>Compliance Status</th>\n                </tr>\n            </thead>\n            <tbody>\n                <tr>\n                    <td>Password Complexity</td>\n                    <td>$($DomainPolicy.ComplexityEnabled)</td>\n                    <td>Enabled</td>\n                    <td class=\"$(if($DomainPolicy.ComplexityEnabled){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.ComplexityEnabled){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Minimum Password Length</td>\n                    <td>$($DomainPolicy.MinPasswordLength) characters</td>\n                    <td>14+ characters (NIST SP 800-63B)</td>\n                    <td class=\"$(if($DomainPolicy.MinPasswordLength -ge 14){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.MinPasswordLength -ge 14){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Minimum Password Age</td>\n                    <td>$($DomainPolicy.MinPasswordAge) days</td>\n                    <td>1-2 days (prevents immediate reuse)</td>\n                    <td class=\"$(if($DomainPolicy.MinPasswordAge -ge 1 -and $DomainPolicy.MinPasswordAge -le 2){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.MinPasswordAge -ge 1 -and $DomainPolicy.MinPasswordAge -le 2){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Maximum Password Age</td>\n                    <td>$(if($DomainPolicy.MaxPasswordAge -eq 0){'Never expires'}else{\"$($DomainPolicy.MaxPasswordAge) days\"})</td>\n                    <td>60-365 days or modern auth</td>\n                    <td class=\"$(if(($DomainPolicy.MaxPasswordAge -ge 60 -and $DomainPolicy.MaxPasswordAge -le 365) -or $DomainPolicy.MaxPasswordAge -eq 0){'compliant'}else{'non-compliant'})\">\n                        $(if(($DomainPolicy.MaxPasswordAge -ge 60 -and $DomainPolicy.MaxPasswordAge -le 365) -or $DomainPolicy.MaxPasswordAge -eq 0){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Password History Count</td>\n                    <td>$($DomainPolicy.PasswordHistoryCount) passwords</td>\n                    <td>12+ passwords</td>\n                    <td class=\"$(if($DomainPolicy.PasswordHistoryCount -ge 12){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.PasswordHistoryCount -ge 12){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Account Lockout Threshold</td>\n                    <td>$($DomainPolicy.LockoutThreshold) attempts</td>\n                    <td>5-10 attempts</td>\n                    <td class=\"$(if($DomainPolicy.LockoutThreshold -ge 5 -and $DomainPolicy.LockoutThreshold -le 10){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.LockoutThreshold -ge 5 -and $DomainPolicy.LockoutThreshold -le 10){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Lockout Duration</td>\n                    <td>$($DomainPolicy.LockoutDuration) minutes</td>\n                    <td>15-60 minutes</td>\n                    <td class=\"$(if($DomainPolicy.LockoutDuration -ge 15 -and $DomainPolicy.LockoutDuration -le 60){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.LockoutDuration -ge 15 -and $DomainPolicy.LockoutDuration -le 60){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Reset Account Lockout Counter</td>\n                    <td>$($DomainPolicy.LockoutObservationWindow) minutes</td>\n                    <td>‚â• Lockout Duration ($($DomainPolicy.LockoutDuration) min)</td>\n                    <td class=\"$(if($DomainPolicy.LockoutObservationWindow -ge $DomainPolicy.LockoutDuration){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.LockoutObservationWindow -ge $DomainPolicy.LockoutDuration){'‚úì Compliant'}else{'‚úó Non-Compliant'})\n                    </td>\n                </tr>\n                <tr>\n                    <td>Reversible Encryption</td>\n                    <td>$($DomainPolicy.ReversibleEncryptionEnabled)</td>\n                    <td>Disabled (CRITICAL)</td>\n                    <td class=\"$(if(-not $DomainPolicy.ReversibleEncryptionEnabled){'compliant'}else{'non-compliant'})\">\n                        $(if(-not $DomainPolicy.ReversibleEncryptionEnabled){'‚úì Compliant'}else{'üî• CRITICAL NON-COMPLIANT'})\n                    </td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n\n    <div class=\"section\">\n        <h2>Comprehensive Privileged Group Analysis</h2>\n        <p>Analysis of ALL privileged groups with recursive nested membership support:</p>\n        \n        <h3>Privileged Group Summary</h3>\n        <div class=\"chart-container\">\n            <div class=\"chart-item\">\n                <h4>Group Membership Distribution</h4>\n\"@\n\n    # Calculate group distributions\n    $DomainAdminsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Domain Admins*\" }).Count\n    $EnterpriseAdminsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Enterprise Admins*\" }).Count\n    $SchemaAdminsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Schema Admins*\" }).Count\n    $AdministratorsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Administrators*\" }).Count\n    \n    $HTML += @\"\n                <p><strong>Domain Admins:</strong> $DomainAdminsCount</p>\n                <p><strong>Enterprise Admins:</strong> $EnterpriseAdminsCount</p>\n                <p><strong>Schema Admins:</strong> $SchemaAdminsCount</p>\n                <p><strong>Administrators:</strong> $AdministratorsCount</p>\n            </div>\n            <div class=\"chart-item\">\n                <h4>Risk Assessment Summary</h4>\n                <p><strong>Total Privileged Accounts:</strong> $($PrivilegedAccounts.Count)</p>\n                <p><strong>High Risk Accounts:</strong> $(($PrivilegedAccounts | Where-Object { $_.Risk -eq 'High' -or $_.Risk -eq 'Critical' }).Count)</p>\n                <p><strong>Stale Accounts (90+ days):</strong> $($StalePrivileged.Count)</p>\n                <p><strong>Never Logged On:</strong> $($NeverLoggedOn.Count)</p>\n            </div>\n        </div>\n        \n        <table>\n            <thead>\n                <tr>\n                    <th>Account Name</th>\n                    <th>Display Name</th>\n                    <th>All Privileged Groups</th>\n                    <th>Enabled</th>\n                    <th>Last Logon</th>\n                    <th>Password Age (Days)</th>\n                    <th>Risk Factors</th>\n                    <th>Risk Level</th>\n                </tr>\n            </thead>\n            <tbody>\n\"@\n\n    foreach ($Account in $PrivilegedAccounts) {\n        $RiskColor = switch ($Account.Risk) {\n            'Critical' { '#dc3545' }\n            'High' { '#fd7e14' }\n            'Medium' { '#ffc107' }\n            'Low' { '#28a745' }\n            default { '#17a2b8' }\n        }\n        \n        $LastLogon = if ($Account.LastLogonDate -eq \"Never\") { \"Never\" } else { $Account.LastLogonDate.ToString(\"yyyy-MM-dd\") }\n        $RiskFactorsDisplay = if ($Account.RiskFactors -eq \"\") { \"None\" } else { $Account.RiskFactors }\n        \n        $HTML += @\"\n<tr>\n    <td>$($Account.SamAccountName)</td>\n    <td>$($Account.Name)</td>\n    <td style=\"font-size: 9px;\">$($Account.AllPrivilegedGroups)</td>\n    <td>$($Account.Enabled)</td>\n    <td>$LastLogon</td>\n    <td>$($Account.DaysSincePasswordChange)</td>\n    <td style=\"font-size: 9px;\">$RiskFactorsDisplay</td>\n    <td><span style=\"color: $RiskColor; font-weight: bold;\">$($Account.Risk.ToUpper())</span></td>\n</tr>\n\"@\n    }\n\n    $HTML += @\"\n            </tbody>\n        </table>\n    </div>\n\n    <div class=\"section\">\n        <h2>Security Compliance Issues and Recommendations</h2>\n\"@\n    \n    if ($PolicyCompliance.Issues.Count -eq 0) {\n        $HTML += \"<div class='risk-low'><p><strong>‚úì Excellent:</strong> No policy compliance issues identified. Current configuration aligns with Microsoft security baselines and NIST SP 800-63B guidelines.</p></div>\"\n    }\n    else {\n        foreach ($Issue in $PolicyCompliance.Issues) {\n            $RiskClass = \"risk-$($Issue.Risk.ToLower())\"\n            $HTML += @\"\n        <div class=\"$RiskClass no-break\">\n            <h4>$($Issue.Issue) <span class=\"risk-badge\">$($Issue.Risk.ToUpper())</span></h4>\n            <p><strong>Recommendation:</strong> $($Issue.Recommendation)</p>\n            <p><strong>Best Practice:</strong> $($Issue.BestPractice)</p>\n        </div>\n\"@\n        }\n    }\n\n    # Add Fine-Grained Password Policies section if any exist\n    if ($FGPPs.Count -gt 0) {\n        $HTML += @\"\n    </div>\n\n    <div class=\"section\">\n        <h2>Fine-Grained Password Policies Analysis</h2>\n        <p>The following fine-grained password policies are configured in the domain:</p>\n        <table>\n            <thead>\n                <tr>\n                    <th>Policy Name</th>\n                    <th>Precedence</th>\n                    <th>Min Length</th>\n                    <th>Complexity</th>\n                    <th>Max Age (Days)</th>\n                    <th>Min Age (Days)</th>\n                    <th>Lockout Threshold</th>\n                    <th>Applies To</th>\n                </tr>\n            </thead>\n            <tbody>\n\"@\n        foreach ($FGPP in $FGPPs) {\n            $HTML += \"<tr><td>$($FGPP.Name)</td><td>$($FGPP.Precedence)</td><td>$($FGPP.MinPasswordLength)</td><td>$($FGPP.ComplexityEnabled)</td><td>$($FGPP.MaxPasswordAge)</td><td>$($FGPP.MinPasswordAge)</td><td>$($FGPP.LockoutThreshold)</td><td style='font-size: 9px;'>$($FGPP.AppliesTo)</td></tr>\"\n        }\n        $HTML += @\"\n            </tbody>\n        </table>\n\"@\n    }\n\n    $HTML += @\"\n    </div>\n\n    <div class=\"section\">\n        <h2>Risk Assessment Summary</h2>\n        \n        <div class=\"chart-container\">\n            <div class=\"chart-item\">\n                <h4>Policy Compliance Risk Distribution</h4>\n\"@\n\n    $TotalIssues = $PolicyCompliance.Issues.Count\n    if ($TotalIssues -gt 0) {\n        $CriticalCount = ($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Critical' }).Count\n        $HighCount = ($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'High' }).Count\n        $MediumCount = ($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Medium' }).Count\n        $LowCount = ($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Low' }).Count\n        \n        $HTML += @\"\n                <p><span style=\"color: #dc3545;\">‚óè Critical:</span> $CriticalCount ($([math]::Round(($CriticalCount/$TotalIssues)*100,1))%)</p>\n                <p><span style=\"color: #fd7e14;\">‚óè High:</span> $HighCount ($([math]::Round(($HighCount/$TotalIssues)*100,1))%)</p>\n                <p><span style=\"color: #ffc107;\">‚óè Medium:</span> $MediumCount ($([math]::Round(($MediumCount/$TotalIssues)*100,1))%)</p>\n                <p><span style=\"color: #28a745;\">‚óè Low:</span> $LowCount ($([math]::Round(($LowCount/$TotalIssues)*100,1))%)</p>\n\"@\n    } else {\n        $HTML += \"<p style='color: #28a745; font-weight: bold;'>‚úì No compliance issues identified</p>\"\n    }\n\n    $HTML += @\"\n            </div>\n            <div class=\"chart-item\">\n                <h4>Overall Security Posture</h4>\n                <p><strong>Compliance Score:</strong> $((100-$PolicyCompliance.RiskScore))/100</p>\n                <p><strong>Risk Level:</strong> <span style=\"color: $(\n                    switch ($PolicyCompliance.RiskLevel) {\n                        'Critical' { '#dc3545' }\n                        'High' { '#fd7e14' }\n                        'Medium' { '#ffc107' }\n                        'Low' { '#28a745' }\n                        default { '#17a2b8' }\n                    }\n                );\">$($PolicyCompliance.RiskLevel.ToUpper())</span></p>\n                <p><strong>Total Issues:</strong> $($PolicyCompliance.Issues.Count)</p>\n                <p><strong>Privileged Accounts:</strong> $($PrivilegedAccounts.Count)</p>\n                <p><strong>Stale Privileged:</strong> $($StalePrivileged.Count)</p>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"section\">\n        <h2>Strategic Recommendations and Implementation Roadmap</h2>\n        \n        <div class=\"recommendation\">\n            <h4>üö® IMMEDIATE ACTIONS REQUIRED (0-30 days)</h4>\n            <ul>\n\"@\n\n    # Add specific immediate recommendations\n    if ($CriticalIssues.Count -gt 0) {\n        $HTML += \"<li><strong>CRITICAL PRIORITY:</strong> Immediately address $($CriticalIssues.Count) critical security issues identified in this assessment</li>\"\n    }\n    \n    if ($StalePrivileged.Count -gt 0) {\n        $HTML += \"<li><strong>HIGH PRIORITY:</strong> Review and disable $($StalePrivileged.Count) stale privileged accounts that haven't been used in 90+ days</li>\"\n    }\n    \n    if ($NeverLoggedOn.Count -gt 0) {\n        $HTML += \"<li><strong>HIGH PRIORITY:</strong> Review $($NeverLoggedOn.Count) privileged accounts that have never been used</li>\"\n    }\n    \n    if ($DomainPolicy.MinPasswordLength -lt 14) {\n        $HTML += \"<li>Increase minimum password length requirement to 14+ characters per NIST SP 800-63B guidelines</li>\"\n    }\n    \n    if (-not $DomainPolicy.ComplexityEnabled) {\n        $HTML += \"<li>Enable password complexity requirements to strengthen password security</li>\"\n    }\n\n    if ($DomainPolicy.LockoutThreshold -eq 0) {\n        $HTML += \"<li>Implement account lockout protection with 5-10 failed attempt threshold to prevent brute force attacks</li>\"\n    }\n\n    if ($DomainPolicy.ReversibleEncryptionEnabled) {\n        $HTML += \"<li><strong>CRITICAL:</strong> Disable reversible encryption immediately - passwords are stored in plain text equivalent</li>\"\n    }\n\n    $HTML += @\"\n            </ul>\n        </div>\n        \n        <div class=\"recommendation\">\n            <h4>üìà SHORT-TERM IMPROVEMENTS (1-3 months)</h4>\n            <ul>\n                <li>Deploy multi-factor authentication (MFA) for all privileged accounts across all groups</li>\n                <li>Implement Privileged Access Management (PAM) solution for elevated account management</li>\n                <li>Establish monthly privileged account access reviews for all groups (Domain Admins, Enterprise Admins, Schema Admins, Administrators)</li>\n                <li>Deploy advanced monitoring and alerting for privileged account activities</li>\n                <li>Implement Azure AD Password Protection for enhanced password policy enforcement</li>\n                <li>Establish administrative workstation security baselines with privileged access workstations (PAWs)</li>\n                <li>Implement fine-grained password policies for privileged accounts with stricter requirements</li>\n            </ul>\n        </div>\n        \n        <div class=\"recommendation\">\n            <h4>üéØ LONG-TERM STRATEGIC ENHANCEMENTS (3-6 months)</h4>\n            <ul>\n                <li>Deploy Just-In-Time (JIT) administrative access model for all privileged groups</li>\n                <li>Implement Microsoft's enhanced administrative tier model (Tier 0, 1, 2 separation)</li>\n                <li>Establish continuous security monitoring with SIEM integration for privileged account activities</li>\n                <li>Deploy Privileged Identity Management (PIM) for cloud-hybrid environments</li>\n                <li>Implement regular penetration testing and security assessments focusing on privileged escalation</li>\n                <li>Establish comprehensive security awareness training program with privileged user focus</li>\n                <li>Consider migration to Azure AD Premium for advanced security features and conditional access</li>\n                <li>Implement break-glass emergency access procedures with proper monitoring</li>\n            </ul>\n        </div>\n    </div>\n\n    <div class=\"section\">\n        <h2>Compliance Framework Alignment</h2>\n        <p>This assessment aligns with the following industry standards and frameworks:</p>\n        \n        <table>\n            <thead>\n                <tr>\n                    <th>Framework/Standard</th>\n                    <th>Relevant Controls</th>\n                    <th>Compliance Status</th>\n                    <th>Recommendations</th>\n                </tr>\n            </thead>\n            <tbody>\n                <tr>\n                    <td>Microsoft Security Baseline</td>\n                    <td>Password Policy, Privileged Account Management</td>\n                    <td class=\"$(if($PolicyCompliance.RiskScore -lt 40){'compliant'}else{'non-compliant'})\">\n                        $(if($PolicyCompliance.RiskScore -lt 40){'Aligned'}else{'Requires Attention'})\n                    </td>\n                    <td>$(if($PolicyCompliance.RiskScore -ge 40){'Address identified policy gaps'}else{'Maintain current standards'})</td>\n                </tr>\n                <tr>\n                    <td>NIST Cybersecurity Framework</td>\n                    <td>PR.AC-1, PR.AC-4, PR.AC-7, DE.CM-3</td>\n                    <td class=\"$(if($PolicyCompliance.RiskScore -lt 30){'compliant'}else{'non-compliant'})\">\n                        $(if($PolicyCompliance.RiskScore -lt 30){'Compliant'}else{'Partial Compliance'})\n                    </td>\n                    <td>$(if($PolicyCompliance.RiskScore -ge 30){'Enhance detection and protection controls'}else{'Continue monitoring'})</td>\n                </tr>\n                <tr>\n                    <td>NIST SP 800-63B</td>\n                    <td>Password Length, Complexity, Verification</td>\n                    <td class=\"$(if($DomainPolicy.MinPasswordLength -ge 14){'compliant'}else{'non-compliant'})\">\n                        $(if($DomainPolicy.MinPasswordLength -ge 14){'Compliant'}else{'Non-Compliant'})\n                    </td>\n                    <td>$(if($DomainPolicy.MinPasswordLength -lt 14){'Increase minimum password length to 14+ characters'}else{'Maintain current standards'})</td>\n                </tr>\n                <tr>\n                    <td>CIS Controls v8</td>\n                    <td>Control 5: Account Management, Control 6: Access Control</td>\n                    <td class=\"$(if($StalePrivileged.Count -eq 0){'compliant'}else{'non-compliant'})\">\n                        $(if($StalePrivileged.Count -eq 0){'Compliant'}else{'Improvement Needed'})\n                    </td>\n                    <td>$(if($StalePrivileged.Count -gt 0){'Remove or disable stale privileged accounts'}else{'Continue regular reviews'})</td>\n                </tr>\n                <tr>\n                    <td>ISO 27001:2022</td>\n                    <td>A.9.2.1, A.9.2.2, A.9.4.3, A.18.1.4</td>\n                    <td class=\"$(if($PolicyCompliance.Issues.Count -lt 3){'compliant'}else{'non-compliant'})\">\n                        $(if($PolicyCompliance.Issues.Count -lt 3){'Satisfactory'}else{'Requires Remediation'})\n                    </td>\n                    <td>$(if($PolicyCompliance.Issues.Count -ge 3){'Address policy compliance gaps'}else{'Maintain documentation'})</td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n\n    <div class=\"footer\">\n        <p><strong>First Technology: RMS SECURITY ASSESSMENT REPORT</strong></p>\n        <p>Prepared by: $EngineerName</p>\n        <p>Assessment Tool: AD Security Assessment v11.0 | Generated: $ReportDate</p>\n        <p>Customer: $CustomerName | Domain: $DomainName</p>\n        <p>Next Recommended Review: $(((Get-Date).AddMonths(3)).ToString('yyyy-MM-dd'))</p>\n        <hr>\n        <p style=\"font-size: 8px;\">This report contains sensitive security information and should be distributed only to authorized personnel.\n        Report includes analysis of Domain Admins, Enterprise Admins, Schema Admins, and Administrators groups with recursive membership evaluation.</p>\n    </div>\n\n</body>\n</html>\n\"@\n\n    return $HTML\n}\n\n# New function to generate comprehensive user analysis HTML report\nfunction New-UserAnalysisHTML {\n    param(\n        $UserAnalysis,\n        $CustomerName,\n        $DomainName,\n        $EngineerName\n    )\n    \n    # Calculate user analysis metrics\n    $TotalUsers = $UserAnalysis.Count\n    $EnabledUsers = ($UserAnalysis | Where-Object { $_.Enabled }).Count\n    $DisabledUsers = $TotalUsers - $EnabledUsers\n    $StaleUsers = ($UserAnalysis | Where-Object { $_.DaysSinceLogon -gt 90 -and $_.Enabled }).Count\n    $NeverLoggedOnUsers = ($UserAnalysis | Where-Object { $_.LastLogonDate -eq 'Never' -and $_.Enabled }).Count\n    $PasswordNeverExpiresUsers = ($UserAnalysis | Where-Object { $_.PasswordNeverExpires -and $_.Enabled }).Count\n    $HighRiskUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'High' -or $_.Risk -eq 'Critical' }).Count\n    \n    $CriticalUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'Critical' }).Count\n    $HighUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'High' }).Count\n    $MediumUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'Medium' }).Count\n    $LowUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'Low' }).Count\n    $InfoUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'Info' }).Count\n    \n    $HTML = @\"\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"utf-8\">\n    <title>Domain User Analysis Report</title>\n    <style>\n        @page {\n            margin: 0.5in;\n            @top-center {\n                content: \"Domain User Analysis Report\";\n                font-family: 'Segoe UI', sans-serif;\n                font-size: 10px;\n                color: #666;\n            }\n            @bottom-center {\n                content: \"Page \" counter(page) \" of \" counter(pages);\n                font-family: 'Segoe UI', sans-serif;\n                font-size: 10px;\n                color: #666;\n            }\n        }\n        \n        body {\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n            margin: 0;\n            padding: 20px;\n            background-color: white;\n            line-height: 1.4;\n            font-size: 11px;\n        }\n        \n        .header {\n            text-align: center;\n            border-bottom: 3px solid #28a745;\n            padding-bottom: 15px;\n            margin-bottom: 20px;\n        }\n        \n        .customer-name {\n            font-size: 28px;\n            font-weight: bold;\n            color: #28a745;\n            margin-bottom: 5px;\n            text-transform: uppercase;\n        }\n        \n        .report-title {\n            font-size: 18px;\n            font-weight: bold;\n            color: #333;\n            margin-bottom: 15px;\n        }\n        \n        .header-info {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 20px;\n            margin-top: 15px;\n            font-size: 10px;\n        }\n        \n        .section {\n            margin-bottom: 20px;\n            page-break-inside: avoid;\n        }\n        \n        .section h2 {\n            background: linear-gradient(135deg, #28a745 0%, #1e7e34 100%);\n            color: white;\n            padding: 8px 15px;\n            margin: 0 0 10px 0;\n            font-size: 14px;\n            font-weight: bold;\n        }\n        \n        .section h3 {\n            color: #28a745;\n            font-size: 12px;\n            margin: 15px 0 8px 0;\n            border-bottom: 1px solid #ddd;\n            padding-bottom: 3px;\n        }\n        \n        .executive-summary {\n            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);\n            padding: 15px;\n            border-left: 4px solid #28a745;\n            margin-bottom: 20px;\n        }\n        \n        .metrics-grid {\n            display: grid;\n            grid-template-columns: repeat(6, 1fr);\n            gap: 10px;\n            margin: 15px 0;\n        }\n        \n        .metric-card {\n            text-align: center;\n            padding: 12px;\n            background: white;\n            border: 1px solid #ddd;\n            border-radius: 5px;\n        }\n        \n        .metric-value {\n            font-size: 18px;\n            font-weight: bold;\n            color: #28a745;\n        }\n        \n        .metric-label {\n            font-size: 10px;\n            color: #666;\n            margin-top: 5px;\n        }\n        \n        table {\n            width: 100%;\n            border-collapse: collapse;\n            margin: 10px 0;\n            font-size: 9px;\n        }\n        \n        th, td {\n            border: 1px solid #ddd;\n            padding: 4px;\n            text-align: left;\n        }\n        \n        th {\n            background-color: #f8f9fa;\n            font-weight: bold;\n            color: #28a745;\n        }\n        \n        .risk-critical {\n            background-color: #f8d7da;\n            border-left: 4px solid #dc3545;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-high {\n            background-color: #fff3cd;\n            border-left: 4px solid #ffc107;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-medium {\n            background-color: #d1ecf1;\n            border-left: 4px solid #17a2b8;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .risk-low {\n            background-color: #d4edda;\n            border-left: 4px solid #28a745;\n            padding: 10px;\n            margin: 8px 0;\n        }\n        \n        .footer {\n            border-top: 2px solid #28a745;\n            padding-top: 15px;\n            margin-top: 30px;\n            text-align: center;\n            font-size: 9px;\n            color: #666;\n        }\n        \n        .chart-container {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 20px;\n            margin: 15px 0;\n        }\n        \n        .chart-item {\n            background: white;\n            border: 1px solid #ddd;\n            padding: 10px;\n            border-radius: 5px;\n        }\n        \n        .progress-bar {\n            width: 100%;\n            height: 15px;\n            background-color: #e9ecef;\n            border-radius: 8px;\n            overflow: hidden;\n            margin: 5px 0;\n        }\n        \n        .progress-fill {\n            height: 100%;\n            border-radius: 8px;\n        }\n        \n        .no-break { page-break-inside: avoid; }\n        \n        .risk-distribution {\n            display: grid;\n            grid-template-columns: repeat(5, 1fr);\n            gap: 10px;\n            margin: 10px 0;\n        }\n        \n        .risk-item {\n            text-align: center;\n            padding: 8px;\n            border-radius: 5px;\n            color: white;\n            font-weight: bold;\n        }\n        \n        .risk-critical-bg { background-color: #dc3545; }\n        .risk-high-bg { background-color: #fd7e14; }\n        .risk-medium-bg { background-color: #ffc107; color: #333; }\n        .risk-low-bg { background-color: #28a745; }\n        .risk-info-bg { background-color: #17a2b8; }\n    </style>\n</head>\n<body>\n    <div class=\"header\">\n        <div class=\"customer-name\">$CustomerName</div>\n        <div class=\"report-title\">Domain User Analysis Report</div>\n        <div style=\"font-size: 12px; color: #28a745; margin-top: 5px;\">Complete Domain User Security Risk Assessment</div>\n        \n        <div class=\"header-info\">\n            <div>\n                <strong>Customer:</strong> $CustomerName<br>\n                <strong>Domain:</strong> $DomainName<br>\n                <strong>Assessment Date:</strong> $((Get-Date).ToString(\"yyyy-MM-dd HH:mm:ss\"))\n            </div>\n            <div>\n                <strong>Assessed By:</strong> $EngineerName<br>\n                <strong>Report Version:</strong> 11.0<br>\n                <strong>Classification:</strong> Domain Security\n            </div>\n        </div>\n    </div>\n\n    <div class=\"executive-summary no-break\">\n        <h2>Executive Summary - Domain User Analysis</h2>\n        <p>This comprehensive user analysis evaluates <strong>all $TotalUsers domain user accounts</strong> for <strong>$CustomerName</strong> to identify password security risks, stale accounts, and potential security threats. The analysis focuses on user account hygiene, password policies, and access patterns to provide actionable security recommendations.</p>\n        \n        <div class=\"metrics-grid\">\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$TotalUsers</div>\n                <div class=\"metric-label\">Total Users</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$EnabledUsers</div>\n                <div class=\"metric-label\">Enabled Users</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$StaleUsers</div>\n                <div class=\"metric-label\">Stale Users (90+ days)</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$NeverLoggedOnUsers</div>\n                <div class=\"metric-label\">Never Logged On</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$PasswordNeverExpiresUsers</div>\n                <div class=\"metric-label\">Password Never Expires</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-value\">$HighRiskUsers</div>\n                <div class=\"metric-label\">High Risk Users</div>\n            </div>\n        </div>\n        \n        <div class=\"risk-distribution\">\n            <div class=\"risk-item risk-critical-bg\">\n                <div>$CriticalUsers</div>\n                <div style=\"font-size: 9px;\">CRITICAL</div>\n            </div>\n            <div class=\"risk-item risk-high-bg\">\n                <div>$HighUsers</div>\n                <div style=\"font-size: 9px;\">HIGH</div>\n            </div>\n            <div class=\"risk-item risk-medium-bg\">\n                <div>$MediumUsers</div>\n                <div style=\"font-size: 9px;\">MEDIUM</div>\n            </div>\n            <div class=\"risk-item risk-low-bg\">\n                <div>$LowUsers</div>\n                <div style=\"font-size: 9px;\">LOW</div>\n            </div>\n            <div class=\"risk-item risk-info-bg\">\n                <div>$InfoUsers</div>\n                <div style=\"font-size: 9px;\">INFO</div>\n            </div>\n        </div>\n        \n        <div class=\"chart-container\">\n            <div class=\"chart-item\">\n                <h4>Account Health Status</h4>\n                <div class=\"progress-bar\">\n                    <div class=\"progress-fill\" style=\"width: $(if($TotalUsers -gt 0){[math]::Round(($EnabledUsers/$TotalUsers)*100,0)}else{0})%; background-color: #28a745;\"></div>\n                </div>\n                <small>$(if($TotalUsers -gt 0){[math]::Round(($EnabledUsers/$TotalUsers)*100,0)}else{0})% Enabled Accounts</small>\n            </div>\n            <div class=\"chart-item\">\n                <h4>Security Risk Level</h4>\n                <div class=\"progress-bar\">\n                    <div class=\"progress-fill\" style=\"width: $(if($EnabledUsers -gt 0){[math]::Round((($EnabledUsers-$HighRiskUsers)/$EnabledUsers)*100,0)}else{100})%; background-color: $(if($HighRiskUsers -eq 0){'#28a745'}else{'#ffc107'});\"></div>\n                </div>\n                <small>$(if($EnabledUsers -gt 0){[math]::Round((($EnabledUsers-$HighRiskUsers)/$EnabledUsers)*100,0)}else{100})% Low Risk</small>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"section no-break\">\n        <h2>Critical and High Risk User Accounts</h2>\n        <p>Immediate attention required for the following high-risk user accounts:</p>\n\"@\n\n    $HighRiskAccounts = $UserAnalysis | Where-Object { $_.Risk -eq 'Critical' -or $_.Risk -eq 'High' } | Sort-Object RiskScore -Descending\n\n    if ($HighRiskAccounts.Count -eq 0) {\n        $HTML += \"<div class='risk-low'><p><strong>‚úì Excellent:</strong> No critical or high-risk user accounts identified.</p></div>\"\n    } else {\n        $HTML += @\"\n        <table>\n            <thead>\n                <tr>\n                    <th>Account Name</th>\n                    <th>Display Name</th>\n                    <th>User Type</th>\n                    <th>Enabled</th>\n                    <th>Last Logon</th>\n                    <th>Password Age (Days)</th>\n                    <th>Risk Factors</th>\n                    <th>Risk</th>\n                </tr>\n            </thead>\n            <tbody>\n\"@\n        \n        foreach ($User in $HighRiskAccounts) {\n            $RiskColor = switch ($User.Risk) {\n                'Critical' { '#dc3545' }\n                'High' { '#fd7e14' }\n                default { '#ffc107' }\n            }\n            \n            $HTML += @\"\n<tr>\n    <td>$($User.SamAccountName)</td>\n    <td>$($User.Name)</td>\n    <td>$($User.UserType)</td>\n    <td>$($User.Enabled)</td>\n    <td>$($User.LastLogonDate)</td>\n    <td>$($User.DaysSincePasswordChange)</td>\n    <td style=\"font-size: 8px;\">$($User.RiskFactors)</td>\n    <td><span style=\"color: $RiskColor; font-weight: bold;\">$($User.Risk.ToUpper())</span></td>\n</tr>\n\"@\n        }\n        \n        $HTML += \"</tbody></table>\"\n    }\n\n    $HTML += @\"\n    </div>\n\n    <div class=\"section\">\n        <h2>Stale Account Analysis</h2>\n        <p>Analysis of accounts that haven't been used recently (potential security risks):</p>\n        \n        <div class=\"chart-container\">\n            <div class=\"chart-item\">\n                <h4>Stale Account Categories</h4>\n                <p><strong>1+ Year Stale:</strong> $(($UserAnalysis | Where-Object { $_.DaysSinceLogon -gt 365 -and $_.Enabled }).Count)</p>\n                <p><strong>6+ Months Stale:</strong> $(($UserAnalysis | Where-Object { $_.DaysSinceLogon -gt 180 -and $_.DaysSinceLogon -le 365 -and $_.Enabled }).Count)</p>\n                <p><strong>3+ Months Stale:</strong> $(($UserAnalysis | Where-Object { $_.DaysSinceLogon -gt 90 -and $_.DaysSinceLogon -le 180 -and $_.Enabled }).Count)</p>\n                <p><strong>Never Logged On:</strong> $NeverLoggedOnUsers</p>\n            </div>\n            <div class=\"chart-item\">\n                <h4>Password Security Issues</h4>\n                <p><strong>Password Never Expires:</strong> $PasswordNeverExpiresUsers</p>\n                <p><strong>Password 1+ Year Old:</strong> $(($UserAnalysis | Where-Object { $_.DaysSincePasswordChange -gt 365 -and $_.Enabled }).Count)</p>\n                <p><strong>Password Never Set:</strong> $(($UserAnalysis | Where-Object { $_.PasswordLastSet -eq 'Never' -and $_.Enabled }).Count)</p>\n                <p><strong>Failed Logon Attempts:</strong> $(($UserAnalysis | Where-Object { $_.BadLogonCount -gt 0 }).Count)</p>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"section\">\n        <h2>User Account Recommendations</h2>\n        \n        <div class=\"risk-critical\">\n            <h4>üö® IMMEDIATE ACTIONS REQUIRED</h4>\n            <ul>\n\"@\n\n    if ($CriticalUsers -gt 0) {\n        $HTML += \"<li><strong>CRITICAL PRIORITY:</strong> Review and remediate $CriticalUsers accounts with critical security risks</li>\"\n    }\n    \n    if ($HighUsers -gt 0) {\n        $HTML += \"<li><strong>HIGH PRIORITY:</strong> Address $HighUsers accounts with high security risks</li>\"\n    }\n    \n    if ($NeverLoggedOnUsers -gt 0) {\n        $HTML += \"<li>Review $NeverLoggedOnUsers enabled accounts that have never been used - consider disabling</li>\"\n    }\n    \n    if ($StaleUsers -gt 0) {\n        $HTML += \"<li>Audit $StaleUsers stale accounts (90+ days inactive) for potential deactivation</li>\"\n    }\n\n    $HTML += @\"\n            </ul>\n        </div>\n        \n        <div class=\"risk-medium\">\n            <h4>üìã MEDIUM PRIORITY ACTIONS</h4>\n            <ul>\n                <li>Implement automated account lifecycle management processes</li>\n                <li>Establish quarterly user access reviews with managers</li>\n                <li>Deploy user activity monitoring for anomaly detection</li>\n                <li>Implement self-service password reset capabilities</li>\n                <li>Review and update password policies based on user behavior patterns</li>\n            </ul>\n        </div>\n        \n        <div class=\"risk-low\">\n            <h4>üéØ LONG-TERM IMPROVEMENTS</h4>\n            <ul>\n                <li>Deploy advanced threat protection for user accounts</li>\n                <li>Implement risk-based authentication policies</li>\n                <li>Establish comprehensive user security training programs</li>\n                <li>Deploy privileged access management for elevated operations</li>\n                <li>Implement continuous compliance monitoring</li>\n            </ul>\n        </div>\n    </div>\n\n    <div class=\"footer\">\n        <p><strong>CONFIDENTIAL USER ANALYSIS REPORT</strong></p>\n        <p>Prepared by: $EngineerName</p>\n        <p>Assessment Tool: User Analysis v11.0 | Generated: $((Get-Date).ToString(\"yyyy-MM-dd HH:mm:ss\"))</p>\n        <p>Customer: $CustomerName | Domain: $DomainName | Users Analyzed: $TotalUsers</p>\n        <p>Next Recommended Review: $(((Get-Date).AddMonths(6)).ToString('yyyy-MM-dd'))</p>\n        <hr>\n        <p style=\"font-size: 8px;\">This user analysis report contains sensitive security information and should be distributed only to authorized personnel.</p>\n    </div>\n\n</body>\n</html>\n\"@\n\n    return $HTML\n}\n\n# Function to convert HTML to PDF using system tools\nfunction Convert-HTMLToPDF {\n    param(\n        [string]$HTMLPath,\n        [string]$PDFPath\n    )\n    \n    Write-Host \"Converting HTML to PDF...\" -ForegroundColor Yellow\n    \n    try {\n        # Try using Microsoft Edge (if available)\n        $EdgePath = \"${env:ProgramFiles(x86)}\\Microsoft\\Edge\\Application\\msedge.exe\"\n        if (-not (Test-Path $EdgePath)) {\n            $EdgePath = \"${env:ProgramFiles}\\Microsoft\\Edge\\Application\\msedge.exe\"\n        }\n        \n        if (Test-Path $EdgePath) {\n            Write-Host \"Using Microsoft Edge for PDF conversion...\" -ForegroundColor Green\n            $Arguments = @(\n                \"--headless\"\n                \"--disable-gpu\"\n                \"--run-all-compositor-stages-before-draw\"\n                \"--disable-extensions\"\n                \"--disable-plugins\"\n                \"--no-sandbox\"\n                \"--print-to-pdf=`\"$PDFPath`\"\"\n                \"`\"$HTMLPath`\"\"\n            )\n            \n            Start-Process -FilePath $EdgePath -ArgumentList $Arguments -Wait -NoNewWindow\n            \n            if (Test-Path $PDFPath) {\n                Write-Host \"PDF generated successfully using Edge!\" -ForegroundColor Green\n                return $true\n            }\n        }\n        \n        # Fallback: Try Chrome\n        $ChromePaths = @(\n            \"${env:ProgramFiles}\\Google\\Chrome\\Application\\chrome.exe\",\n            \"${env:ProgramFiles(x86)}\\Google\\Chrome\\Application\\chrome.exe\",\n            \"${env:LOCALAPPDATA}\\Google\\Chrome\\Application\\chrome.exe\"\n        )\n        \n        $ChromePath = $ChromePaths | Where-Object { Test-Path $_ } | Select-Object -First 1\n        \n        if ($ChromePath) {\n            Write-Host \"Using Google Chrome for PDF conversion...\" -ForegroundColor Green\n            $Arguments = @(\n                \"--headless\"\n                \"--disable-gpu\"\n                \"--run-all-compositor-stages-before-draw\"\n                \"--print-to-pdf=`\"$PDFPath`\"\"\n                \"`\"$HTMLPath`\"\"\n            )\n            \n            Start-Process -FilePath $ChromePath -ArgumentList $Arguments -Wait -NoNewWindow\n            \n            if (Test-Path $PDFPath) {\n                Write-Host \"PDF generated successfully using Chrome!\" -ForegroundColor Green\n                return $true\n            }\n        }\n        \n        Write-Warning \"No suitable PDF converter found. HTML report will be available for manual conversion.\"\n        return $false\n        \n    }\n    catch {\n        Write-Warning \"PDF conversion failed: $($_.Exception.Message)\"\n        return $false\n    }\n}\n\n# Main execution\ntry {\n    $StartTime = Get-Date\n    \n    # Ensure output directory exists\n    $OutputDir = Split-Path $OutputPathPDF -Parent\n    if (-not (Test-Path $OutputDir)) {\n        New-Item -Path $OutputDir -ItemType Directory -Force | Out-Null\n        Write-Host \"Created output directory: $OutputDir\" -ForegroundColor Green\n    }\n\n    # Gather enhanced assessment data\n    Write-Host \"\"\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Yellow\n    Write-Host \"                            GATHERING ASSESSMENT DATA\" -ForegroundColor Yellow\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Yellow\n    \n    $DomainServer = if ($Domain.DNSRoot -ne (Get-ADDomain).DNSRoot) { $Domain.DNSRoot } else { $null }\n    $DomainPolicy = Get-DomainPasswordPolicy -DomainServer $DomainServer\n    $FGPPs = Get-FineGrainedPolicies -DomainServer $DomainServer\n    $PolicyCompliance = Test-PolicyCompliance -Policy $DomainPolicy\n    $PrivilegedAccounts = Get-AllPrivilegedAccounts -DomainServer $DomainServer\n    \n    Write-Host \"\"\n    Write-Host \"Starting comprehensive domain user analysis...\" -ForegroundColor Yellow\n    $UserAnalysis = Get-DomainUserAnalysis -DomainServer $DomainServer\n\n    # Generate Main Security Assessment Report\n    Write-Host \"\"\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Green\n    Write-Host \"                        GENERATING SECURITY ASSESSMENT REPORT\" -ForegroundColor Green\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Green\n    \n    Write-Host \"Generating security assessment HTML report...\" -ForegroundColor Yellow\n    $SecurityHTMLContent = New-SecurityAssessmentHTML -DomainPolicy $DomainPolicy -FGPPs $FGPPs -PolicyCompliance $PolicyCompliance -PrivilegedAccounts $PrivilegedAccounts -CustomerName $CustomerName -DomainName $DomainName -EngineerName $EngineerName\n    $SecurityHTMLContent | Out-File -FilePath $OutputPathHTML -Encoding UTF8\n\n    # Convert Security Assessment to PDF\n    $SecurityPDFCreated = Convert-HTMLToPDF -HTMLPath $OutputPathHTML -PDFPath $OutputPathPDF\n    \n    # Generate User Analysis Report\n    Write-Host \"\"\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Green\n    Write-Host \"                         GENERATING USER ANALYSIS REPORT\" -ForegroundColor Green\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Green\n    \n    Write-Host \"Generating comprehensive user analysis HTML report...\" -ForegroundColor Yellow\n    $UserHTMLContent = New-UserAnalysisHTML -UserAnalysis $UserAnalysis -CustomerName $CustomerName -DomainName $DomainName -EngineerName $EngineerName\n    $UserHTMLContent | Out-File -FilePath $OutputPathUserHTML -Encoding UTF8\n\n    # Convert User Analysis to PDF\n    $UserPDFCreated = Convert-HTMLToPDF -HTMLPath $OutputPathUserHTML -PDFPath $OutputPathUserPDF\n    \n    # Export comprehensive data to CSV\n    Write-Host \"Exporting comprehensive assessment data to CSV...\" -ForegroundColor Yellow\n    $AllData = @()\n    \n    # Add policy compliance data\n    foreach ($Issue in $PolicyCompliance.Issues) {\n        $AllData += [PSCustomObject]@{\n            'Assessment_Date' = $ReportDate\n            'Customer' = $CustomerName\n            'Domain' = $DomainName\n            'Category' = 'Policy Compliance'\n            'Finding' = $Issue.Issue\n            'Risk_Level' = $Issue.Risk\n            'Recommendation' = $Issue.Recommendation\n            'Best_Practice' = $Issue.BestPractice\n            'Status' = 'Non-Compliant'\n            'Account_Name' = 'N/A'\n            'Account_Type' = 'N/A'\n        }\n    }\n    \n    # Add privileged account data\n    foreach ($Account in $PrivilegedAccounts) {\n        $AllData += [PSCustomObject]@{\n            'Assessment_Date' = $ReportDate\n            'Customer' = $CustomerName\n            'Domain' = $DomainName\n            'Category' = 'Privileged Account'\n            'Finding' = \"$($Account.SamAccountName) - $($Account.Name)\"\n            'Risk_Level' = $Account.Risk\n            'Recommendation' = switch ($Account.Risk) {\n                'Critical' { 'Immediate attention required - critical security risk' }\n                'High' { 'Review account usage and disable if unused' }\n                'Medium' { 'Monitor regularly and consider access review' }\n                default { 'Continue monitoring with regular reviews' }\n            }\n            'Best_Practice' = 'Regular review of privileged accounts with quarterly access assessments'\n            'Status' = if ($Account.Enabled) { 'Enabled' } else { 'Disabled' }\n            'Account_Name' = $Account.SamAccountName\n            'Account_Type' = 'Privileged'\n        }\n    }\n    \n    # Add high-risk user data (only Critical and High risk to keep CSV manageable)\n    $HighRiskUsers = $UserAnalysis | Where-Object { $_.Risk -eq 'Critical' -or $_.Risk -eq 'High' }\n    foreach ($User in $HighRiskUsers) {\n        $AllData += [PSCustomObject]@{\n            'Assessment_Date' = $ReportDate\n            'Customer' = $CustomerName\n            'Domain' = $DomainName\n            'Category' = 'High Risk User'\n            'Finding' = \"$($User.SamAccountName) - $($User.Name)\"\n            'Risk_Level' = $User.Risk\n            'Recommendation' = switch ($User.Risk) {\n                'Critical' { 'Immediate review and remediation required' }\n                'High' { 'Review account and address security risks' }\n                default { 'Monitor and review regularly' }\n            }\n            'Best_Practice' = 'Regular user access reviews and account lifecycle management'\n            'Status' = if ($User.Enabled) { 'Enabled' } else { 'Disabled' }\n            'Account_Name' = $User.SamAccountName\n            'Account_Type' = $User.UserType\n        }\n    }\n    \n    $AllData | Export-Csv -Path $OutputPathCSV -NoTypeInformation\n\n    # Display comprehensive results\n    Clear-Host\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Green\n    Write-Host \"                 ACTIVE DIRECTORY SECURITY ASSESSMENT COMPLETED\" -ForegroundColor Green\n    Write-Host \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -ForegroundColor Green\n    Write-Host \"\"\n    \n    Write-Host \"üìä ASSESSMENT SUMMARY\" -ForegroundColor Cyan\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    Write-Host \"Customer:                 $CustomerName\" -ForegroundColor White\n    Write-Host \"Domain:                   $DomainName\" -ForegroundColor White\n    Write-Host \"Assessed By:              $EngineerName\" -ForegroundColor White\n    Write-Host \"Assessment Date:          $ReportDate\" -ForegroundColor White\n    Write-Host \"Assessment Duration:      $([math]::Round(((Get-Date) - $StartTime).TotalMinutes, 1)) minutes\" -ForegroundColor White\n    Write-Host \"\"\n    \n    Write-Host \"üö® SECURITY RISK ANALYSIS\" -ForegroundColor Yellow\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    Write-Host \"Overall Risk Level:       $($PolicyCompliance.RiskLevel)\" -ForegroundColor $(\n        switch ($PolicyCompliance.RiskLevel) {\n            'Critical' { 'Red' }\n            'High' { 'Red' }\n            'Medium' { 'Yellow' }\n            'Low' { 'Green' }\n            default { 'Cyan' }\n        }\n    )\n    Write-Host \"Policy Risk Score:        $($PolicyCompliance.RiskScore)/100\" -ForegroundColor White\n    Write-Host \"Policy Compliance:        $((100-$PolicyCompliance.RiskScore))/100\" -ForegroundColor $(if((100-$PolicyCompliance.RiskScore) -ge 70){'Green'}else{'Red'})\n    Write-Host \"Policy Issues Found:      $($PolicyCompliance.Issues.Count)\" -ForegroundColor $(if($PolicyCompliance.Issues.Count -eq 0){'Green'}else{'Red'})\n    Write-Host \"\"\n    \n    Write-Host \"üë• PRIVILEGED ACCOUNT ANALYSIS\" -ForegroundColor Magenta\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    Write-Host \"Total Privileged Accounts: $($PrivilegedAccounts.Count)\" -ForegroundColor White\n    \n    $DomainAdminsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Domain Admins*\" }).Count\n    $EnterpriseAdminsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Enterprise Admins*\" }).Count\n    $SchemaAdminsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Schema Admins*\" }).Count\n    $AdministratorsCount = ($PrivilegedAccounts | Where-Object { $_.AllPrivilegedGroups -like \"*Administrators*\" }).Count\n    \n    Write-Host \"  Domain Admins:          $DomainAdminsCount\" -ForegroundColor Cyan\n    Write-Host \"  Enterprise Admins:      $EnterpriseAdminsCount\" -ForegroundColor Cyan\n    Write-Host \"  Schema Admins:          $SchemaAdminsCount\" -ForegroundColor Cyan\n    Write-Host \"  Administrators:         $AdministratorsCount\" -ForegroundColor Cyan\n    Write-Host \"\"\n    \n    $StalePrivileged = $PrivilegedAccounts | Where-Object { $_.DaysSinceLogon -gt 90 -and $_.Enabled }\n    $HighRiskPrivileged = $PrivilegedAccounts | Where-Object { $_.Risk -eq 'High' -or $_.Risk -eq 'Critical' }\n    $NeverLoggedOnPrivileged = $PrivilegedAccounts | Where-Object { $_.LastLogonDate -eq 'Never' }\n    \n    Write-Host \"Stale Privileged (90+ days): $($StalePrivileged.Count)\" -ForegroundColor $(if($StalePrivileged.Count -eq 0){'Green'}else{'Red'})\n    Write-Host \"High-Risk Privileged:     $($HighRiskPrivileged.Count)\" -ForegroundColor $(if($HighRiskPrivileged.Count -eq 0){'Green'}else{'Red'})\n    Write-Host \"Never Used Privileged:    $($NeverLoggedOnPrivileged.Count)\" -ForegroundColor $(if($NeverLoggedOnPrivileged.Count -eq 0){'Green'}else{'Red'})\n    Write-Host \"\"\n    \n    Write-Host \"üë§ DOMAIN USER ANALYSIS\" -ForegroundColor Blue\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    \n    $TotalUsers = $UserAnalysis.Count\n    $EnabledUsers = ($UserAnalysis | Where-Object { $_.Enabled }).Count\n    $StaleUsers = ($UserAnalysis | Where-Object { $_.DaysSinceLogon -gt 90 -and $_.Enabled }).Count\n    $NeverLoggedOnUsers = ($UserAnalysis | Where-Object { $_.LastLogonDate -eq 'Never' -and $_.Enabled }).Count\n    $HighRiskUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'High' -or $_.Risk -eq 'Critical' }).Count\n    $CriticalUsers = ($UserAnalysis | Where-Object { $_.Risk -eq 'Critical' }).Count\n    \n    Write-Host \"Total Domain Users:       $TotalUsers\" -ForegroundColor White\n    Write-Host \"Enabled Users:            $EnabledUsers\" -ForegroundColor White\n    Write-Host \"Stale Users (90+ days):   $StaleUsers\" -ForegroundColor $(if($StaleUsers -eq 0){'Green'}else{'Yellow'})\n    Write-Host \"Never Logged On Users:    $NeverLoggedOnUsers\" -ForegroundColor $(if($NeverLoggedOnUsers -eq 0){'Green'}else{'Yellow'})\n    Write-Host \"High-Risk Users:          $HighRiskUsers\" -ForegroundColor $(if($HighRiskUsers -eq 0){'Green'}else{'Red'})\n    Write-Host \"Critical Risk Users:      $CriticalUsers\" -ForegroundColor $(if($CriticalUsers -eq 0){'Green'}else{'Red'})\n    Write-Host \"\"\n    \n    Write-Host \"‚ö†Ô∏è  CRITICAL FINDINGS\" -ForegroundColor Red\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    $CriticalIssues = $PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Critical' }\n    if ($CriticalIssues.Count -eq 0 -and $CriticalUsers -eq 0 -and $HighRiskPrivileged.Count -eq 0) {\n        Write-Host \"‚úÖ No critical security issues identified\" -ForegroundColor Green\n    } else {\n        if ($CriticalIssues.Count -gt 0) {\n            Write-Host \"üî• Policy Issues:\" -ForegroundColor Red\n            foreach ($Issue in $CriticalIssues) {\n                Write-Host \"   ‚Ä¢ $($Issue.Issue)\" -ForegroundColor Red\n            }\n        }\n        if ($CriticalUsers -gt 0) {\n            Write-Host \"üî• $CriticalUsers critical risk user accounts require immediate attention\" -ForegroundColor Red\n        }\n        if ($HighRiskPrivileged.Count -gt 0) {\n            Write-Host \"üî• $($HighRiskPrivileged.Count) high-risk privileged accounts require review\" -ForegroundColor Red\n        }\n    }\n    \n    Write-Host \"\"\n    Write-Host \"üìÑ GENERATED REPORTS\" -ForegroundColor Green\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    \n    if ($SecurityPDFCreated) {\n        Write-Host \"‚úÖ Security Assessment PDF:  $OutputPathPDF\" -ForegroundColor Green\n    } else {\n        Write-Host \"‚ö†Ô∏è  Security PDF Failed:     Manual conversion required\" -ForegroundColor Yellow\n    }\n    Write-Host \"‚úÖ Security HTML Report:     $OutputPathHTML\" -ForegroundColor Green\n    \n    if ($UserPDFCreated) {\n        Write-Host \"‚úÖ User Analysis PDF:        $OutputPathUserPDF\" -ForegroundColor Green\n    } else {\n        Write-Host \"‚ö†Ô∏è  User Analysis PDF Failed: Manual conversion required\" -ForegroundColor Yellow\n    }\n    Write-Host \"‚úÖ User Analysis HTML:       $OutputPathUserHTML\" -ForegroundColor Green\n    Write-Host \"‚úÖ Comprehensive CSV Data:   $OutputPathCSV\" -ForegroundColor Green\n    \n    Write-Host \"\"\n    Write-Host \"üéØ RECOMMENDED NEXT STEPS\" -ForegroundColor Magenta\n    Write-Host \"‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\" -ForegroundColor Gray\n    Write-Host \"1. Review both comprehensive reports with customer stakeholders\" -ForegroundColor White\n    Write-Host \"2. Address Critical and High-risk findings within 30 days\" -ForegroundColor White\n    Write-Host \"3. Implement privileged account management improvements\" -ForegroundColor White\n    Write-Host \"4. Establish user lifecycle management processes\" -ForegroundColor White\n    Write-Host \"5. Schedule quarterly follow-up assessments\" -ForegroundColor White\n    \n    # N-Central Summary and Exit Handling (Do not open reports automatically)\n    Write-NCentralLog \"\"\n    Write-NCentralLog \"N-Central Assessment Completed Successfully\" -Level \"Success\"\n    Write-NCentralLog \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\"\n    Write-NCentralLog \"Customer: $CustomerName | Domain: $DomainName | Engineer: $EngineerName\" -Level \"Info\"\n    Write-NCentralLog \"Assessment Duration: $([math]::Round(((Get-Date) - $StartTime).TotalMinutes, 1)) minutes\" -Level \"Info\"\n    Write-NCentralLog \"Overall Risk Level: $($PolicyCompliance.RiskLevel) | Risk Score: $($PolicyCompliance.RiskScore)/100\" -Level \"Info\"\n    Write-NCentralLog \"Total Users: $TotalUsers | Privileged Accounts: $($PrivilegedAccounts.Count) | High Risk Users: $HighRiskUsers\" -Level \"Info\"\n    \n    # Create N-Central summary file\n    try {\n        $ncentralSummaryPath = \"C:\\Temp\\NCentral_AD_Assessment_Summary_$($SafeCustomerName)_$($Timestamp).txt\"\n        $ncentralSummary = @\"\nN-CENTRAL AD SECURITY ASSESSMENT SUMMARY\n=========================================\n\nCustomer: $CustomerName\nDomain: $DomainName  \nAssessment Date: $ReportDate\nExecution Time: $([math]::Round(((Get-Date) - $StartTime).TotalMinutes, 1)) minutes\n\nRISK ASSESSMENT:\nOverall Risk Level: $($PolicyCompliance.RiskLevel)\nRisk Score: $($PolicyCompliance.RiskScore)/100\nCompliance Score: $((100-$PolicyCompliance.RiskScore))/100\nTotal Issues Found: $($PolicyCompliance.Issues.Count)\n\nPRIVILEGED ACCOUNTS:\nTotal Privileged: $($PrivilegedAccounts.Count)\nHigh Risk Privileged: $($HighRiskPrivileged.Count)\n\nUSER ANALYSIS:\nTotal Users: $TotalUsers\nEnabled Users: $EnabledUsers\nHigh Risk Users: $HighRiskUsers\nCritical Risk Users: $CriticalUsers\n\nISSUE BREAKDOWN:\nCritical Issues: $(($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Critical' }).Count + $CriticalUsers + $($HighRiskPrivileged.Count))\nHigh Issues: $(($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'High' }).Count)\nMedium Issues: $(($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Medium' }).Count)\nLow Issues: $(($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Low' }).Count)\n\nFILES GENERATED:\n- Security Assessment HTML: $OutputPathHTML\n- Security Assessment PDF: $OutputPathPDF  \n- User Analysis HTML: $OutputPathUserHTML\n- User Analysis PDF: $OutputPathUserPDF\n- Complete CSV Data: $OutputPathCSV\n\nSTATUS: $( if ($PolicyCompliance.RiskScore -ge 60) { \"REQUIRES IMMEDIATE ATTENTION\" } \n          elseif ($PolicyCompliance.RiskScore -ge 40) { \"NEEDS IMPROVEMENT\" }\n          elseif ($PolicyCompliance.RiskScore -ge 20) { \"ACCEPTABLE WITH MINOR ISSUES\" }\n          else { \"GOOD SECURITY POSTURE\" } )\n\nNext Recommended Assessment: $(((Get-Date).AddMonths(3)).ToString('yyyy-MM-dd'))\n\nN-Central RMS Active Directory Security Assessment Tool v11.1 Complete\nGenerated by: $EngineerName\n\"@\n        $ncentralSummary | Out-File -FilePath $ncentralSummaryPath -Encoding UTF8\n        Write-NCentralLog \"N-Central summary file created: $ncentralSummaryPath\" -Level \"Success\"\n    } catch {\n        Write-NCentralLog \"Failed to create N-Central summary file: $($_.Exception.Message)\" -Level \"Warning\"\n    }\n    \n    Write-NCentralLog \"\"\n    Write-NCentralLog \"Files Generated Successfully:\" -Level \"Success\"\n    Write-NCentralLog \"- Security Assessment HTML: $OutputPathHTML\" -Level \"Info\"\n    Write-NCentralLog \"- Security Assessment PDF: $OutputPathPDF\" -Level \"Info\"\n    Write-NCentralLog \"- User Analysis HTML: $OutputPathUserHTML\" -Level \"Info\"  \n    Write-NCentralLog \"- User Analysis PDF: $OutputPathUserPDF\" -Level \"Info\"\n    Write-NCentralLog \"- Complete CSV Data: $OutputPathCSV\" -Level \"Info\"\n    Write-NCentralLog \"- N-Central Summary: $ncentralSummaryPath\" -Level \"Info\"\n    \n    Write-NCentralLog \"\"\n    Write-NCentralLog \"N-Central AD Security Assessment Tool v11.1 Complete - Assessment Finished\" -Level \"Success\"\n    \n    # N-Central Exit Codes for Monitoring/Alerting\n    $criticalFindings = ($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'Critical' }).Count + $CriticalUsers + $($HighRiskPrivileged.Count)\n    $highFindings = ($PolicyCompliance.Issues | Where-Object { $_.Risk -eq 'High' }).Count\n    \n    if ($criticalFindings -gt 0) {\n        Write-NCentralLog \"Exiting with error code 2 (Critical security findings detected)\" -Level \"Error\"\n        exit 2\n    } elseif ($PolicyCompliance.RiskScore -ge 60 -or $highFindings -gt 3) {\n        Write-NCentralLog \"Exiting with warning code 1 (High risk level or multiple high findings)\" -Level \"Warning\"\n        exit 1\n    } else {\n        Write-NCentralLog \"Exiting with success code 0 (Acceptable security posture)\" -Level \"Success\"\n        exit 0\n    }\n\n}\ncatch {\n    Write-NCentralLog \"\"\n    Write-NCentralLog \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -Level \"Error\"\n    Write-NCentralLog \"üö® N-CENTRAL AD SECURITY ASSESSMENT ERROR üö®\" -Level \"Error\"\n    Write-NCentralLog \"‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\" -Level \"Error\"\n    Write-NCentralLog \"Assessment failed: $($_.Exception.Message)\" -Level \"Error\"\n    Write-NCentralLog \"Stack trace: $($_.ScriptStackTrace)\" -Level \"Error\"\n    Write-NCentralLog \"\"\n    Write-NCentralLog \"TROUBLESHOOTING CHECKLIST:\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ Verify Active Directory PowerShell module is installed (Install-WindowsFeature RSAT-AD-PowerShell)\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ Confirm sufficient domain permissions (Domain Users minimum for read-only assessment)\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ Check network connectivity to domain controllers\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ Ensure C:\\Temp directory exists and is writable\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ Verify Microsoft Edge or Chrome is installed for PDF generation\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ For large domains, ensure adequate memory and processing time\" -Level \"Warning\"\n    Write-NCentralLog \"‚Ä¢ Check if domain controllers are reachable and responsive\" -Level \"Warning\"\n    Write-NCentralLog \"\"\n    Write-NCentralLog \"N-Central Assessment Failed - Exiting with error code 3\" -Level \"Error\"\n    exit 3\n}\n\n# End of Active Directory Security Assessment Tool v11.0",
                "timestamp": "2025-08-17T19:02:41.065Z",
                "description": "baseline4 ncentral repo"
              }
            ],
            "created": "2025-08-17T19:01:58.278Z",
            "modified": "2025-08-17T19:02:41.066Z",
            "timeSpent": 0
          },
          {
            "id": "file-1756688692905",
            "name": "test_why ",
            "type": "html",
            "category": "General",
            "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>test_why </title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            margin: 0;\n            padding: 20px;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n            min-height: 100vh;\n        }\n        .container {\n            max-width: 800px;\n            margin: 0 auto;\n            background: rgba(255, 255, 255, 0.1);\n            padding: 30px;\n            border-radius: 15px;\n            backdrop-filter: blur(10px);\n            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);\n        }\n        h1 {\n            color: #fff;\n            text-align: center;\n            margin-bottom: 30px;\n        }\n        .feature {\n            background: rgba(255, 255, 255, 0.1);\n            padding: 20px;\n            margin: 15px 0;\n            border-radius: 10px;\n            border-left: 4px solid #ff073a;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>üöÄ test_why </h1>\n        <div class=\"feature\">\n            <h3>‚ú® Welcome to your new HTML file!</h3>\n            <p>This HTML file was created in Nishen's AI Workspace. You can:</p>\n            <ul>\n                <li>Edit the content using the editor</li>\n                <li>Preview it live using the Preview button</li>\n                <li>Save versions for backup</li>\n                <li>Track time spent working on it</li>\n            </ul>\n        </div>\n        <div class=\"feature\">\n            <h3>üé® Styling</h3>\n            <p>This template includes some modern CSS with glassmorphism effects, gradients, and responsive design.</p>\n        </div>\n        <div class=\"feature\">\n            <h3>üîß Ready to customize</h3>\n            <p>Start building your tool, report, or application!</p>\n        </div>\n    </div>\n    \n    <script>\n        console.log('HTML file loaded in Nishen\\'s AI Workspace!');\n        // Add your JavaScript here\n    </script>\n</body>\n</html>",
            "versions": [],
            "created": "2025-09-01T01:04:52.905Z",
            "modified": "2025-09-01T01:04:52.905Z",
            "timeSpent": 0
          }
        ],
        "totalTimeSpent": 0,
        "created": "2025-08-07T09:38:41.998Z",
        "isTimerRunning": false
      }
    ],
    "timestamp": "2025-09-28T23:42:31.987Z",
    "operation": "AUTO_SAVE",
    "component": "FILES"
  },
  "nishen-workspace-notes": [
    {
      "id": "note-1759098468379",
      "title": "Task Tracker",
      "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Task Tracker</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            margin: 0;\n            padding: 20px;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n            min-height: 100vh;\n        }\n        .container {\n            max-width: 800px;\n            margin: 0 auto;\n            background: rgba(255, 255, 255, 0.1);\n            padding: 30px;\n            border-radius: 15px;\n            backdrop-filter: blur(10px);\n        }\n        h1 { color: #fff; text-align: center; margin-bottom: 30px; }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>üöÄ Task Tracker</h1>\n        <p>Start building your HTML content here...</p>\n    </div>\n</body>\n</html>",
      "category": "HTML Tools",
      "tags": [
        "tasks"
      ],
      "created": "2025-09-28T22:27:48.379Z",
      "modified": "2025-09-28T22:27:48.379Z",
      "isPinned": false,
      "isArchived": false,
      "type": "html"
    },
    {
      "id": "note-1759098334978",
      "title": "Budget Tracker",
      "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Budget Tracker</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            margin: 0;\n            padding: 20px;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n            min-height: 100vh;\n        }\n        .container {\n            max-width: 800px;\n            margin: 0 auto;\n            background: rgba(255, 255, 255, 0.1);\n            padding: 30px;\n            border-radius: 15px;\n            backdrop-filter: blur(10px);\n        }\n        h1 { color: #fff; text-align: center; margin-bottom: 30px; }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>üöÄ Budget Tracker</h1>\n        <p>Start building your HTML content here...</p>\n    </div>\n</body>\n</html>",
      "category": "HTML Tools",
      "tags": [
        "budget"
      ],
      "created": "2025-09-28T22:25:34.978Z",
      "modified": "2025-09-28T22:25:34.978Z",
      "isPinned": false,
      "isArchived": false,
      "type": "html"
    },
    {
      "id": "note-1759096483129",
      "title": "Nishen's Engineer Dashboard",
      "content": "<!DOCTYPE html>\n<!-- saved from url=(0081)file:///X:/ClaudeCode/eNGINEdashBoard_Tasks/Nishen'sTask_Notes_FileDashboard.html -->\n<html lang=\"en\"><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\n    \n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Nishen's Engineer Dashboard</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n\n        body {\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);\n            color: #ffffff;\n            min-height: 100vh;\n            padding: 15px;\n        }\n\n        .header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 20px;\n            padding: 15px 20px;\n            background: rgba(255, 255, 255, 0.1);\n            border-radius: 12px;\n            backdrop-filter: blur(10px);\n            gap: 20px;\n            height: 120px;\n        }\n\n        .header-left {\n            flex: 0 0 200px;\n        }\n\n        .header-center {\n            flex: 1;\n            text-align: center;\n        }\n\n        .header-right {\n            flex: 0 0 250px;\n            display: flex;\n            flex-direction: column;\n            align-items: flex-end;\n            gap: 10px;\n        }\n\n        .header-center h1 {\n            font-size: 1.8em;\n            margin-bottom: 8px;\n            color: #ffffff;\n            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);\n        }\n\n        /* Navigation Tabs */\n        .nav-tabs {\n            display: flex;\n            background: rgba(255, 255, 255, 0.1);\n            border-radius: 8px;\n            padding: 4px;\n            margin-top: 8px;\n            backdrop-filter: blur(10px);\n            justify-content: center;\n        }\n\n        .nav-tab {\n            background: transparent;\n            border: none;\n            color: rgba(255, 255, 255, 0.7);\n            padding: 8px 20px;\n            border-radius: 6px;\n            cursor: pointer;\n            font-size: 0.9em;\n            font-weight: 500;\n            transition: all 0.3s ease;\n            margin: 0 2px;\n        }\n\n        .nav-tab:hover {\n            color: #ffffff;\n            background: rgba(255, 255, 255, 0.1);\n        }\n\n        .nav-tab.active {\n            background: rgba(255, 255, 255, 0.2);\n            color: #ffffff;\n            font-weight: 600;\n            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\n        }\n\n        .header-center p {\n            font-size: 1em;\n            opacity: 0.9;\n        }\n\n        /* DateTime Display Styles */\n        .datetime-display {\n            text-align: right;\n            margin-bottom: 10px;\n        }\n\n        .current-time {\n            font-size: 1.6em;\n            font-weight: bold;\n            color: #ffffff;\n            font-family: 'Courier New', monospace;\n            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);\n        }\n\n        .current-date {\n            font-size: 0.85em;\n            color: #b8d4f0;\n            margin-top: 5px;\n        }\n\n        /* Config Controls Styles */\n        .config-controls {\n            display: flex;\n            gap: 10px;\n        }\n\n        .control-btn {\n            background: rgba(255, 255, 255, 0.2);\n            color: white;\n            border: none;\n            padding: 8px 15px;\n            border-radius: 8px;\n            cursor: pointer;\n            font-size: 0.85em;\n            transition: all 0.3s ease;\n            backdrop-filter: blur(5px);\n        }\n\n        .control-btn:hover {\n            background: rgba(255, 255, 255, 0.3);\n            transform: translateY(-2px);\n        }\n\n        .export-btn:hover {\n            background: rgba(76, 175, 80, 0.6);\n        }\n\n        .import-btn:hover {\n            background: rgba(33, 150, 243, 0.6);\n        }\n\n        /* Hidden file input for import */\n        #importFileInput {\n            display: none;\n        }\n\n        .grid-container {\n            display: grid;\n            grid-template-columns: repeat(3, 1fr);\n            grid-template-rows: repeat(2, 1fr);\n            gap: 20px;\n            height: calc(100vh - 200px);\n            min-height: 600px;\n        }\n\n        .folder-panel {\n            border-radius: 15px;\n            padding: 20px;\n            backdrop-filter: blur(10px);\n            border: 1px solid rgba(255, 255, 255, 0.2);\n            display: flex;\n            flex-direction: column;\n            transition: all 0.3s ease;\n        }\n\n        /* Unique colors for each panel */\n        .folder-panel:nth-child(1) { background: linear-gradient(135deg, rgba(46, 125, 50, 0.4), rgba(76, 175, 80, 0.3)); }\n        .folder-panel:nth-child(2) { background: linear-gradient(135deg, rgba(25, 118, 210, 0.4), rgba(33, 150, 243, 0.3)); }\n        .folder-panel:nth-child(3) { background: linear-gradient(135deg, rgba(156, 39, 176, 0.4), rgba(233, 30, 99, 0.3)); }\n        .folder-panel:nth-child(4) { background: linear-gradient(135deg, rgba(255, 111, 0, 0.4), rgba(255, 152, 0, 0.3)); }\n        .folder-panel:nth-child(5) { background: linear-gradient(135deg, rgba(244, 67, 54, 0.4), rgba(239, 83, 80, 0.3)); }\n        .folder-panel:nth-child(6) { background: linear-gradient(135deg, rgba(0, 150, 136, 0.4), rgba(77, 182, 172, 0.3)); }\n\n        .folder-panel:hover {\n            transform: translateY(-5px);\n            box-shadow: 0 10px 30px rgba(0,0,0,0.3);\n        }\n\n        .panel-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 15px;\n            padding-bottom: 10px;\n            border-bottom: 1px solid rgba(255, 255, 255, 0.2);\n        }\n\n        .btn-group-header {\n            display: flex;\n            gap: 5px;\n        }\n\n        .panel-title {\n            font-size: 1.1em;\n            font-weight: bold;\n            color: #ffffff;\n        }\n\n        .folder-path {\n            font-size: 0.8em;\n            color: #b8d4f0;\n            margin-bottom: 10px;\n            word-break: break-all;\n        }\n\n        .config-btn {\n            background: #4CAF50;\n            color: white;\n            border: none;\n            padding: 5px 10px;\n            border-radius: 5px;\n            cursor: pointer;\n            font-size: 0.8em;\n            transition: background 0.3s;\n        }\n\n        .config-btn:hover {\n            background: #45a049;\n        }\n\n        .reset-btn {\n            background: #f44336;\n            color: white;\n            border: none;\n            padding: 5px 10px;\n            border-radius: 5px;\n            cursor: pointer;\n            font-size: 0.8em;\n            transition: background 0.3s;\n        }\n\n        .reset-btn:hover {\n            background: #d32f2f;\n        }\n\n        .file-list {\n            flex: 1;\n            overflow-y: auto;\n            max-height: calc(100% - 80px);\n        }\n\n        .file-item {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            padding: 8px 12px;\n            margin: 5px 0;\n            background: rgba(255, 255, 255, 0.1);\n            border-radius: 8px;\n            cursor: pointer;\n            transition: all 0.2s ease;\n            border-left: 4px solid transparent;\n        }\n\n        .file-item:hover {\n            background: rgba(255, 255, 255, 0.2);\n            transform: translateX(5px);\n        }\n\n        .file-item.ps1 { border-left-color: #1f4e79; }\n        .file-item.html { border-left-color: #e34c26; }\n        .file-item.txt { border-left-color: #6c757d; }\n        .file-item.docx { border-left-color: #2b579a; }\n        .file-item.xlsx { border-left-color: #217346; }\n        .file-item.pdf { border-left-color: #dc3545; }\n\n        .file-name {\n            font-size: 0.9em;\n            color: #ffffff;\n            flex: 1;\n            margin-right: 10px;\n            white-space: nowrap;\n            overflow: hidden;\n            text-overflow: ellipsis;\n        }\n\n        .file-ext {\n            background: rgba(255, 255, 255, 0.2);\n            padding: 2px 6px;\n            border-radius: 4px;\n            font-size: 0.7em;\n            font-weight: bold;\n            margin-right: 8px;\n        }\n\n        .file-date {\n            font-size: 0.7em;\n            color: #b8d4f0;\n        }\n\n        .modal {\n            display: none;\n            position: fixed;\n            z-index: 1000;\n            left: 0;\n            top: 0;\n            width: 100%;\n            height: 100%;\n            background-color: rgba(0,0,0,0.5);\n        }\n\n        .modal-content {\n            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);\n            margin: 15% auto;\n            padding: 30px;\n            border-radius: 15px;\n            width: 50%;\n            max-width: 500px;\n            color: white;\n            box-shadow: 0 20px 60px rgba(0,0,0,0.5);\n        }\n\n        .modal h2 {\n            margin-bottom: 20px;\n            color: #ffffff;\n        }\n\n        .form-group {\n            margin-bottom: 20px;\n        }\n\n        .form-group label {\n            display: block;\n            margin-bottom: 8px;\n            font-weight: bold;\n        }\n\n        .form-group input {\n            width: 100%;\n            padding: 12px;\n            border: none;\n            border-radius: 8px;\n            background: rgba(255, 255, 255, 0.1);\n            color: white;\n            font-size: 1em;\n        }\n\n        .form-group input::placeholder {\n            color: rgba(255, 255, 255, 0.6);\n        }\n\n        .btn-group {\n            display: flex;\n            gap: 10px;\n            justify-content: flex-end;\n        }\n\n        .btn {\n            padding: 12px 24px;\n            border: none;\n            border-radius: 8px;\n            cursor: pointer;\n            font-size: 1em;\n            transition: all 0.3s ease;\n        }\n\n        .btn-primary {\n            background: #4CAF50;\n            color: white;\n        }\n\n        .btn-primary:hover {\n            background: #45a049;\n        }\n\n        .btn-secondary {\n            background: rgba(255, 255, 255, 0.2);\n            color: white;\n        }\n\n        .btn-secondary:hover {\n            background: rgba(255, 255, 255, 0.3);\n        }\n\n        .refresh-btn {\n            position: fixed;\n            bottom: 30px;\n            right: 30px;\n            background: #2196F3;\n            color: white;\n            border: none;\n            padding: 15px;\n            border-radius: 50%;\n            cursor: pointer;\n            font-size: 1.2em;\n            box-shadow: 0 5px 15px rgba(0,0,0,0.3);\n            transition: all 0.3s ease;\n        }\n\n        .refresh-btn:hover {\n            transform: scale(1.1);\n            background: #1976D2;\n        }\n\n        .empty-panel {\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n            color: rgba(255, 255, 255, 0.6);\n            text-align: center;\n        }\n\n        .empty-panel i {\n            font-size: 3em;\n            margin-bottom: 15px;\n            opacity: 0.5;\n        }\n\n        .file-list::-webkit-scrollbar {\n            width: 6px;\n        }\n\n        .file-list::-webkit-scrollbar-track {\n            background: rgba(255, 255, 255, 0.1);\n            border-radius: 3px;\n        }\n\n        .file-list::-webkit-scrollbar-thumb {\n            background: rgba(255, 255, 255, 0.3);\n            border-radius: 3px;\n        }\n\n        .file-list::-webkit-scrollbar-thumb:hover {\n            background: rgba(255, 255, 255, 0.5);\n        }\n\n        /* Task Tracker Specific Styles */\n        .task-tracker {\n            background: rgba(255, 255, 255, 0.98);\n            border-radius: 12px;\n            box-shadow: 0 25px 50px rgba(0,0,0,0.15);\n            overflow: hidden;\n            backdrop-filter: blur(10px);\n            margin: 0;\n            height: calc(100vh - 180px);\n            min-height: 650px;\n        }\n        \n        .task-header {\n            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);\n            color: white;\n            padding: 12px 25px;\n            position: relative;\n            text-align: center;\n        }\n        \n        .task-header h2 {\n            font-size: 1.3em;\n            margin-bottom: 3px;\n            color: #ecf0f1;\n            text-shadow: 1px 1px 3px rgba(0,0,0,0.3);\n        }\n        \n        .task-header p {\n            opacity: 0.85;\n            font-size: 0.85em;\n            color: #bdc3c7;\n        }\n        \n        .task-main-content {\n            display: grid;\n            grid-template-columns: 320px 1fr 300px;\n            gap: 0;\n            height: calc(100% - 65px);\n        }\n        \n        .task-sidebar {\n            background: #f8fafc;\n            padding: 15px;\n            border-right: 1px solid #e2e8f0;\n            overflow-y: auto;\n        }\n        \n        .task-area {\n            padding: 15px;\n            overflow-y: auto;\n            background: #ffffff;\n        }\n\n        .task-calendar-sidebar {\n            background: #f1f5f9;\n            padding: 15px;\n            border-left: 1px solid #e2e8f0;\n            overflow-y: auto;\n        }\n        \n        .form-section {\n            background: white;\n            border-radius: 6px;\n            padding: 15px;\n            margin-bottom: 15px;\n            box-shadow: 0 1px 4px rgba(0,0,0,0.08);\n            border: 1px solid #e2e8f0;\n        }\n        \n        .form-section h3 {\n            color: #2d3748;\n            margin-bottom: 12px;\n            font-size: 1em;\n            border-bottom: 2px solid #3182ce;\n            padding-bottom: 6px;\n        }\n        \n        .form-group {\n            margin-bottom: 10px;\n        }\n        \n        .form-group label {\n            display: block;\n            margin-bottom: 3px;\n            font-weight: 600;\n            color: #4a5568;\n            font-size: 12px;\n        }\n        \n        .form-group input, .form-group select, .form-group textarea {\n            width: 100%;\n            padding: 6px 10px;\n            border: 1px solid #e2e8f0;\n            border-radius: 4px;\n            font-size: 12px;\n            transition: all 0.2s ease;\n        }\n        \n        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {\n            outline: none;\n            border-color: #3182ce;\n            box-shadow: 0 0 0 2px rgba(49, 130, 206, 0.1);\n        }\n        \n        .form-group textarea {\n            resize: vertical;\n            min-height: 50px;\n        }\n        \n        .form-row {\n            display: grid;\n            grid-template-columns: 1fr 70px;\n            gap: 8px;\n            align-items: end;\n        }\n        \n        .btn {\n            background: linear-gradient(135deg, #3182ce 0%, #2c5282 100%);\n            color: white;\n            border: none;\n            padding: 8px 16px;\n            border-radius: 4px;\n            cursor: pointer;\n            font-size: 12px;\n            font-weight: 600;\n            transition: all 0.2s ease;\n            width: 100%;\n        }\n        \n        .btn:hover {\n            transform: translateY(-1px);\n            box-shadow: 0 3px 8px rgba(49, 130, 206, 0.3);\n        }\n        \n        .task-stats {\n            background: linear-gradient(135deg, #4c51bf 0%, #553c9a 100%);\n            color: white;\n            border-radius: 6px;\n            padding: 12px;\n            margin-bottom: 12px;\n            box-shadow: 0 2px 8px rgba(76, 81, 191, 0.15);\n        }\n        \n        .task-stats h3 {\n            margin-bottom: 10px;\n            font-size: 0.9em;\n        }\n        \n        .stats-grid {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 8px;\n        }\n        \n        .stat-item {\n            text-align: center;\n            padding: 8px;\n            border-radius: 4px;\n            background: rgba(255, 255, 255, 0.15);\n        }\n        \n        .stat-number {\n            font-size: 1.3em;\n            font-weight: bold;\n        }\n        \n        .stat-label {\n            font-size: 0.75em;\n            opacity: 0.9;\n            margin-top: 2px;\n        }\n        \n        .task-card {\n            background: white;\n            border-radius: 6px;\n            padding: 10px;\n            margin-bottom: 6px;\n            box-shadow: 0 1px 4px rgba(0,0,0,0.08);\n            border-left: 3px solid #3182ce;\n            transition: all 0.2s ease;\n            border: 1px solid #e2e8f0;\n        }\n        \n        .task-card:hover {\n            transform: translateY(-1px);\n            box-shadow: 0 2px 8px rgba(0,0,0,0.12);\n        }\n        \n        .task-header-card {\n            display: flex;\n            justify-content: space-between;\n            align-items: start;\n            margin-bottom: 6px;\n        }\n        \n        .task-title {\n            font-size: 1em;\n            font-weight: 600;\n            color: #2d3748;\n            margin-bottom: 3px;\n            line-height: 1.3;\n        }\n        \n        .task-meta {\n            display: flex;\n            gap: 4px;\n            flex-wrap: wrap;\n            margin-bottom: 5px;\n        }\n        \n        .task-badge {\n            padding: 3px 10px;\n            border-radius: 12px;\n            font-size: 0.7em;\n            font-weight: 600;\n            text-transform: uppercase;\n            letter-spacing: 0.5px;\n            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n        }\n        \n        .priority-high {\n            background: linear-gradient(135deg, #ffffff 0%, #fef5f5 100%);\n            color: #c53030;\n            border-left: 4px solid #dc2626;\n            box-shadow: 0 2px 8px rgba(220, 38, 38, 0.15);\n        }\n\n        .priority-medium {\n            background: linear-gradient(135deg, #ffffff 0%, #fffbf0 100%);\n            color: #d69e2e;\n            border-left: 4px solid #f59e0b;\n            box-shadow: 0 2px 8px rgba(245, 158, 11, 0.15);\n        }\n\n        .priority-low {\n            background: linear-gradient(135deg, #ffffff 0%, #f0fff4 100%);\n            color: #38a169;\n            border-left: 4px solid #10b981;\n            box-shadow: 0 2px 8px rgba(16, 185, 129, 0.15);\n        }\n        \n        .task-badge.priority-high {\n            background: linear-gradient(135deg, #dc2626, #ef4444);\n            color: white;\n        }\n\n        .task-badge.priority-medium {\n            background: linear-gradient(135deg, #f59e0b, #fbbf24);\n            color: white;\n        }\n\n        .task-badge.priority-low {\n            background: linear-gradient(135deg, #10b981, #34d399);\n            color: white;\n        }\n\n        .category-badge {\n            background: linear-gradient(135deg, #6366f1, #8b5cf6);\n            color: white;\n            padding: 3px 10px;\n            border-radius: 12px;\n            font-size: 0.7em;\n            font-weight: 600;\n            letter-spacing: 0.5px;\n            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n        }\n        \n        .status-badge {\n            padding: 3px 10px;\n            border-radius: 12px;\n            font-size: 0.7em;\n            font-weight: 600;\n            letter-spacing: 0.5px;\n            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n        }\n\n        .status-pending {\n            background: linear-gradient(135deg, #f59e0b, #fbbf24);\n            color: white;\n        }\n\n        .status-in-progress {\n            background: linear-gradient(135deg, #3b82f6, #60a5fa);\n            color: white;\n        }\n\n        .status-completed {\n            background: linear-gradient(135deg, #10b981, #34d399);\n            color: white;\n        }\n\n        .status-overdue {\n            background: linear-gradient(135deg, #dc2626, #ef4444);\n            color: white;\n        }\n        \n        .task-description {\n            color: #718096;\n            margin-bottom: 6px;\n            line-height: 1.3;\n            font-size: 0.85em;\n        }\n        \n        .task-footer {\n            display: grid;\n            grid-template-columns: 1fr auto auto;\n            gap: 10px;\n            align-items: center;\n            padding-top: 6px;\n            border-top: 1px solid #f7fafc;\n            font-size: 0.8em;\n        }\n        \n        .task-due {\n            color: #718096;\n        }\n        \n        .task-time {\n            color: #3182ce;\n            font-weight: 600;\n        }\n        \n        .task-actions {\n            display: flex;\n            gap: 3px;\n        }\n        \n        .action-btn {\n            padding: 6px 10px;\n            border: none;\n            border-radius: 6px;\n            cursor: pointer;\n            font-size: 11px;\n            font-weight: 600;\n            transition: all 0.2s ease;\n            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n        }\n\n        .edit-btn {\n            background: linear-gradient(135deg, #3b82f6, #60a5fa);\n            color: white;\n        }\n\n        .edit-btn:hover {\n            background: linear-gradient(135deg, #2563eb, #3b82f6);\n            transform: translateY(-1px);\n            box-shadow: 0 4px 8px rgba(59, 130, 246, 0.3);\n        }\n\n        .delete-btn {\n            background: linear-gradient(135deg, #dc2626, #ef4444);\n            color: white;\n        }\n\n        .delete-btn:hover {\n            background: linear-gradient(135deg, #b91c1c, #dc2626);\n            transform: translateY(-1px);\n            box-shadow: 0 4px 8px rgba(220, 38, 38, 0.3);\n        }\n\n        .complete-btn {\n            background: linear-gradient(135deg, #10b981, #34d399);\n            color: white;\n        }\n\n        .complete-btn:hover {\n            background: linear-gradient(135deg, #059669, #10b981);\n            transform: translateY(-1px);\n            box-shadow: 0 4px 8px rgba(16, 185, 129, 0.3);\n        }\n\n        .timer-btn {\n            background: linear-gradient(135deg, #dc2626, #ef4444);\n            color: white;\n            border: none;\n            padding: 6px 12px;\n            border-radius: 6px;\n            cursor: pointer;\n            font-size: 11px;\n            font-weight: 600;\n            transition: all 0.2s ease;\n            box-shadow: 0 2px 4px rgba(220, 38, 38, 0.2);\n            margin-left: 8px;\n        }\n\n        .timer-btn:hover {\n            background: linear-gradient(135deg, #b91c1c, #dc2626);\n            transform: translateY(-1px);\n            box-shadow: 0 4px 8px rgba(220, 38, 38, 0.3);\n        }\n\n        .timer-btn.running {\n            background: linear-gradient(135deg, #059669, #10b981);\n            animation: pulse 2s infinite;\n        }\n\n        @keyframes pulse {\n            0% { transform: scale(1); }\n            50% { transform: scale(1.05); }\n            100% { transform: scale(1); }\n        }\n        \n        .empty-state {\n            text-align: center;\n            padding: 30px 15px;\n            color: #718096;\n        }\n        \n        .empty-state h3 {\n            color: #a0aec0;\n            margin-bottom: 6px;\n        }\n\n        /* Calendar Widget Styles for Task Tracker */\n        .calendar-widget {\n            background: rgba(255, 255, 255, 0.9);\n            border-radius: 8px;\n            padding: 12px;\n            border: 1px solid rgba(0, 0, 0, 0.1);\n            margin-bottom: 15px;\n        }\n\n        .calendar-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 8px;\n        }\n\n        .calendar-title {\n            font-weight: bold;\n            font-size: 0.85em;\n            color: #2d3748;\n        }\n\n        .calendar-nav {\n            background: #e2e8f0;\n            border: none;\n            color: #4a5568;\n            padding: 4px 6px;\n            border-radius: 4px;\n            cursor: pointer;\n            font-size: 0.75em;\n            transition: background 0.3s;\n        }\n\n        .calendar-nav:hover {\n            background: #cbd5e0;\n        }\n\n        .calendar-grid {\n            display: grid;\n            grid-template-columns: repeat(7, 1fr);\n            gap: 1px;\n        }\n\n        .calendar-day {\n            text-align: center;\n            padding: 3px 1px;\n            font-size: 0.7em;\n            color: #4a5568;\n            border-radius: 2px;\n            cursor: pointer;\n            transition: all 0.2s;\n        }\n\n        .calendar-day:hover {\n            background: #e2e8f0;\n        }\n\n        .calendar-day.today {\n            background: #3182ce;\n            color: white;\n            font-weight: bold;\n        }\n\n        .calendar-day.other-month {\n            opacity: 0.4;\n        }\n\n        .calendar-day-header {\n            font-weight: bold;\n            color: #2d3748;\n            font-size: 0.65em;\n            padding: 2px;\n            text-align: center;\n        }\n\n        /* Quick Links Section */\n        .quick-links {\n            background: rgba(255, 255, 255, 0.9);\n            border-radius: 8px;\n            padding: 12px;\n            border: 1px solid rgba(0, 0, 0, 0.1);\n            margin-bottom: 15px;\n        }\n\n        .quick-links h4 {\n            color: #2d3748;\n            margin-bottom: 8px;\n            font-size: 0.9em;\n            border-bottom: 1px solid #e2e8f0;\n            padding-bottom: 4px;\n        }\n\n        .quick-link {\n            display: block;\n            padding: 6px 8px;\n            margin-bottom: 3px;\n            color: #4a5568;\n            text-decoration: none;\n            font-size: 0.8em;\n            border-radius: 4px;\n            transition: all 0.2s;\n        }\n\n        .quick-link:hover {\n            background: #e2e8f0;\n            color: #2d3748;\n        }\n\n        .quick-link i {\n            margin-right: 6px;\n            color: #3182ce;\n        }\n\n        /* Quick Notes Styles */\n        .note-item {\n            background: rgba(255, 255, 255, 0.7);\n            border: 1px solid #e2e8f0;\n            border-radius: 4px;\n            padding: 6px 8px;\n            margin-bottom: 4px;\n            font-size: 0.75em;\n            line-height: 1.3;\n            position: relative;\n            word-wrap: break-word;\n        }\n\n        .note-content {\n            color: #2d3748;\n            margin-bottom: 4px;\n        }\n\n        .note-meta {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            font-size: 0.65em;\n            color: #718096;\n            border-top: 1px solid #f1f5f9;\n            padding-top: 3px;\n        }\n\n        .note-actions {\n            display: flex;\n            gap: 3px;\n        }\n\n        .note-btn {\n            background: none;\n            border: none;\n            cursor: pointer;\n            padding: 2px 4px;\n            border-radius: 2px;\n            font-size: 0.7em;\n            transition: all 0.2s;\n        }\n\n        .note-btn:hover {\n            background: #e2e8f0;\n        }\n\n        .note-btn.convert {\n            color: #3182ce;\n        }\n\n        .note-btn.delete {\n            color: #e53e3e;\n        }\n\n        .note-timestamp {\n            font-size: 0.6em;\n            color: #a0aec0;\n        }\n    </style>\n    <link rel=\"stylesheet\" href=\"./Nishen's Engineer Dashboard/all.min.css\">\n</head>\n<body>\n    <div class=\"header\">\n        <div class=\"header-left\">\n            <!-- Empty space where calendar used to be -->\n        </div>\n        \n        <div class=\"header-center\">\n            <h1><i class=\"fas fa-server\"></i> Nishen's Engineer Dashboard</h1>\n            <p>Integrated File Browser &amp; Task Management Portal</p>\n            <div class=\"nav-tabs\">\n                <button class=\"nav-tab\" onclick=\"switchTab(&#39;files&#39;)\">\n                    <i class=\"fas fa-folder\"></i> File Browser\n                </button>\n                <button class=\"nav-tab active\" onclick=\"switchTab(&#39;tasks&#39;)\">\n                    <i class=\"fas fa-tasks\"></i> Task Tracker\n                </button>\n            </div>\n        </div>\n        \n        <div class=\"header-right\">\n            <div class=\"datetime-display\">\n                <div class=\"current-time\" id=\"currentTime\">05:10:51</div>\n                <div class=\"current-date\" id=\"currentDate\">Monday, September 22, 2025</div>\n            </div>\n            <div class=\"config-controls\">\n                <button class=\"control-btn export-btn\" onclick=\"exportConfig()\" title=\"Export Configuration\">\n                    <i class=\"fas fa-download\"></i> Export\n                </button>\n                <button class=\"control-btn import-btn\" onclick=\"importConfig()\" title=\"Import Configuration\">\n                    <i class=\"fas fa-upload\"></i> Import\n                </button>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"grid-container\" id=\"gridContainer\" style=\"display: none;\">\n        <div class=\"folder-panel\">\n            <div class=\"panel-header\">\n                <div class=\"panel-title\" id=\"panelTitle0\">Claude Dev</div>\n                <div class=\"btn-group-header\">\n                    <button class=\"config-btn\" onclick=\"openConfigModal(0)\" title=\"Configure Panel\">\n                        <i class=\"fas fa-cog\"></i>\n                    </button>\n                    <button class=\"reset-btn\" onclick=\"resetPanel(0)\" title=\"Reset Panel\">\n                        <i class=\"fas fa-trash-alt\"></i>\n                    </button>\n                </div>\n            </div>\n            <div class=\"folder-path\" id=\"folderPath0\">X:\\ClaudeCode</div>\n            <div class=\"file-list\" id=\"fileList0\">\n                <div class=\"file-item ps1\" onclick=\"openFile(&#39;script1.ps1&#39;, &#39;ps1&#39;)\">\n                    <div class=\"file-name\" title=\"script1.ps1\">script1.ps1</div>\n                    <div class=\"file-ext\">PS1</div>\n                    <div class=\"file-date\">Today</div>\n                </div>\n            \n                <div class=\"file-item xml\" onclick=\"openFile(&#39;config.xml&#39;, &#39;xml&#39;)\">\n                    <div class=\"file-name\" title=\"config.xml\">config.xml</div>\n                    <div class=\"file-ext\">XML</div>\n                    <div class=\"file-date\">Today</div>\n                </div>\n            \n                <div class=\"file-item html\" onclick=\"openFile(&#39;report.html&#39;, &#39;html&#39;)\">\n                    <div class=\"file-name\" title=\"report.html\">report.html</div>\n                    <div class=\"file-ext\">HTML</div>\n                    <div class=\"file-date\">Today</div>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"folder-panel\">\n            <div class=\"panel-header\">\n                <div class=\"panel-title\" id=\"panelTitle1\">Panel 2</div>\n                <div class=\"btn-group-header\">\n                    <button class=\"config-btn\" onclick=\"openConfigModal(1)\" title=\"Configure Panel\">\n                        <i class=\"fas fa-cog\"></i>\n                    </button>\n                    <button class=\"reset-btn\" onclick=\"resetPanel(1)\" title=\"Reset Panel\">\n                        <i class=\"fas fa-trash-alt\"></i>\n                    </button>\n                </div>\n            </div>\n            <div class=\"folder-path\" id=\"folderPath1\">No path configured</div>\n            <div class=\"file-list\" id=\"fileList1\">\n                <div class=\"empty-panel\">\n                    <i class=\"fas fa-folder-open\"></i>\n                    <div>Configure a folder path to view files</div>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"folder-panel\">\n            <div class=\"panel-header\">\n                <div class=\"panel-title\" id=\"panelTitle2\">Panel 3</div>\n                <div class=\"btn-group-header\">\n                    <button class=\"config-btn\" onclick=\"openConfigModal(2)\" title=\"Configure Panel\">\n                        <i class=\"fas fa-cog\"></i>\n                    </button>\n                    <button class=\"reset-btn\" onclick=\"resetPanel(2)\" title=\"Reset Panel\">\n                        <i class=\"fas fa-trash-alt\"></i>\n                    </button>\n                </div>\n            </div>\n            <div class=\"folder-path\" id=\"folderPath2\">No path configured</div>\n            <div class=\"file-list\" id=\"fileList2\">\n                <div class=\"empty-panel\">\n                    <i class=\"fas fa-folder-open\"></i>\n                    <div>Configure a folder path to view files</div>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"folder-panel\">\n            <div class=\"panel-header\">\n                <div class=\"panel-title\" id=\"panelTitle3\">Panel 4</div>\n                <div class=\"btn-group-header\">\n                    <button class=\"config-btn\" onclick=\"openConfigModal(3)\" title=\"Configure Panel\">\n                        <i class=\"fas fa-cog\"></i>\n                    </button>\n                    <button class=\"reset-btn\" onclick=\"resetPanel(3)\" title=\"Reset Panel\">\n                        <i class=\"fas fa-trash-alt\"></i>\n                    </button>\n                </div>\n            </div>\n            <div class=\"folder-path\" id=\"folderPath3\">No path configured</div>\n            <div class=\"file-list\" id=\"fileList3\">\n                <div class=\"empty-panel\">\n                    <i class=\"fas fa-folder-open\"></i>\n                    <div>Configure a folder path to view files</div>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"folder-panel\">\n            <div class=\"panel-header\">\n                <div class=\"panel-title\" id=\"panelTitle4\">Panel 5</div>\n                <div class=\"btn-group-header\">\n                    <button class=\"config-btn\" onclick=\"openConfigModal(4)\" title=\"Configure Panel\">\n                        <i class=\"fas fa-cog\"></i>\n                    </button>\n                    <button class=\"reset-btn\" onclick=\"resetPanel(4)\" title=\"Reset Panel\">\n                        <i class=\"fas fa-trash-alt\"></i>\n                    </button>\n                </div>\n            </div>\n            <div class=\"folder-path\" id=\"folderPath4\">No path configured</div>\n            <div class=\"file-list\" id=\"fileList4\">\n                <div class=\"empty-panel\">\n                    <i class=\"fas fa-folder-open\"></i>\n                    <div>Configure a folder path to view files</div>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"folder-panel\">\n            <div class=\"panel-header\">\n                <div class=\"panel-title\" id=\"panelTitle5\">Panel 6</div>\n                <div class=\"btn-group-header\">\n                    <button class=\"config-btn\" onclick=\"openConfigModal(5)\" title=\"Configure Panel\">\n                        <i class=\"fas fa-cog\"></i>\n                    </button>\n                    <button class=\"reset-btn\" onclick=\"resetPanel(5)\" title=\"Reset Panel\">\n                        <i class=\"fas fa-trash-alt\"></i>\n                    </button>\n                </div>\n            </div>\n            <div class=\"folder-path\" id=\"folderPath5\">No path configured</div>\n            <div class=\"file-list\" id=\"fileList5\">\n                <div class=\"empty-panel\">\n                    <i class=\"fas fa-folder-open\"></i>\n                    <div>Configure a folder path to view files</div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <!-- Task Tracker Section -->\n    <div id=\"taskTrackerSection\" style=\"display: block;\">\n        <div class=\"task-tracker\">\n            <div class=\"task-header\">\n                <h2><i class=\"fas fa-tasks\"></i> Professional Task Tracker</h2>\n                <p>Enterprise task management with cloud synchronization</p>\n            </div>\n            \n            <div class=\"task-main-content\">\n                <div class=\"task-sidebar\">\n                    <!-- Task Filters -->\n                    <div class=\"form-section\">\n                        <h3>üîç Filters</h3>\n                        <div class=\"form-group\">\n                            <label for=\"filterStatus\">Status</label>\n                            <select id=\"filterStatus\" onchange=\"applyFilters()\">\n                                <option value=\"\">All Status</option>\n                                <option value=\"pending\">Pending</option>\n                                <option value=\"in-progress\">In Progress</option>\n                                <option value=\"completed\">Completed</option>\n                                <option value=\"overdue\">Overdue</option>\n                            </select>\n                        </div>\n                        <div class=\"form-group\">\n                            <label for=\"filterPriority\">Priority</label>\n                            <select id=\"filterPriority\" onchange=\"applyFilters()\">\n                                <option value=\"\">All Priorities</option>\n                                <option value=\"High\">High</option>\n                                <option value=\"Medium\">Medium</option>\n                                <option value=\"Low\">Low</option>\n                            </select>\n                        </div>\n                        <div class=\"form-group\">\n                            <label for=\"filterCategory\">Category</label>\n                            <select id=\"filterCategory\" onchange=\"applyFilters()\">\n                                <option value=\"\">All Categories</option>\n                                <option value=\"Work\">Work</option>\n                                <option value=\"Personal\">Personal</option>\n                                <option value=\"Project\">Project</option>\n                                <option value=\"Meeting\">Meeting</option>\n                                <option value=\"Admin\">Admin</option>\n                                <option value=\"Learning\">Learning</option>\n                                <option value=\"Review\">Review</option>\n                            </select>\n                        </div>\n                        <div class=\"form-group\">\n                            <button onclick=\"clearFilters()\" class=\"btn\" style=\"background: #6b7280; font-size: 11px; padding: 6px 12px;\">Clear Filters</button>\n                        </div>\n                    </div>\n\n                    <!-- Task Statistics -->\n                    <div class=\"task-stats\">\n                        <h3>üìä Overview</h3>\n                        <div class=\"stats-grid\">\n                            <div class=\"stat-item\">\n                                <div class=\"stat-number\" id=\"totalTasks\">7</div>\n                                <div class=\"stat-label\">Total</div>\n                            </div>\n                            <div class=\"stat-item\">\n                                <div class=\"stat-number\" id=\"completedTasks\">1</div>\n                                <div class=\"stat-label\">Done</div>\n                            </div>\n                            <div class=\"stat-item\">\n                                <div class=\"stat-number\" id=\"pendingTasks\">3</div>\n                                <div class=\"stat-label\">Pending</div>\n                            </div>\n                            <div class=\"stat-item\">\n                                <div class=\"stat-number\" id=\"overdueTasks\">3</div>\n                                <div class=\"stat-label\">Overdue</div>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <!-- Add New Task Form -->\n                    <div class=\"form-section\">\n                        <h3>‚ûï New Task</h3>\n                        <form id=\"taskForm\">\n                            <div class=\"form-group\">\n                                <label for=\"taskTitle\">Title</label>\n                                <input type=\"text\" id=\"taskTitle\" required=\"\" placeholder=\"Task title...\">\n                            </div>\n                            \n                            <div class=\"form-group\">\n                                <label for=\"taskDescription\">Description</label>\n                                <textarea id=\"taskDescription\" placeholder=\"Task details...\"></textarea>\n                            </div>\n                            \n                            <div class=\"form-row\">\n                                <div class=\"form-group\">\n                                    <label for=\"taskCategory\">Category</label>\n                                    <select id=\"taskCategory\" required=\"\">\n                                        <option value=\"\">Select...</option>\n                                        <option value=\"Work\">Work</option>\n                                        <option value=\"Personal\">Personal</option>\n                                        <option value=\"Project\">Project</option>\n                                        <option value=\"Meeting\">Meeting</option>\n                                        <option value=\"Admin\">Admin</option>\n                                        <option value=\"Learning\">Learning</option>\n                                        <option value=\"Review\">Review</option>\n                                    </select>\n                                </div>\n                                <div class=\"form-group\">\n                                    <label for=\"taskHours\">Hours</label>\n                                    <input type=\"number\" id=\"taskHours\" step=\"0.5\" min=\"0\" placeholder=\"0\">\n                                </div>\n                            </div>\n                            \n                            <div class=\"form-row\">\n                                <div class=\"form-group\">\n                                    <label for=\"taskPriority\">Priority</label>\n                                    <select id=\"taskPriority\" required=\"\">\n                                        <option value=\"\">Select...</option>\n                                        <option value=\"High\">High</option>\n                                        <option value=\"Medium\">Medium</option>\n                                        <option value=\"Low\">Low</option>\n                                    </select>\n                                </div>\n                                <div class=\"form-group\">\n                                    <label for=\"taskDueDate\">Due Date</label>\n                                    <input type=\"date\" id=\"taskDueDate\" required=\"\" min=\"2025-09-22\">\n                                </div>\n                            </div>\n                            \n                            <button type=\"submit\" class=\"btn\">Add Task</button>\n                        </form>\n                    </div>\n                </div>\n                \n                <div class=\"task-area\">\n                    <div id=\"tasksList\">\n                        <div class=\"task-card priority-high\">\n                            <div class=\"task-header-card\">\n                                <div>\n                                    <div class=\"task-title\">Evo security</div>\n                                    <div class=\"task-meta\">\n                                        <span class=\"task-badge priority-high\">High</span>\n                                        <span class=\"category-badge\">Project</span>\n                                        <span class=\"status-badge status-pending\">Pending</span>\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"task-description\">Configure Solution (on)</div>\n                            \n                            <div class=\"task-footer\">\n                                <div class=\"task-due\">Due: 2025/09/24 (5 days)</div>\n                                <div class=\"task-time\">2h</div>\n                                <div class=\"task-actions\">\n                                    <button class=\"action-btn edit-btn\" onclick=\"editTask(1757329106448)\" title=\"Edit task\">‚úè</button>\n                                    <button class=\"action-btn complete-btn\" onclick=\"toggleTaskStatus(1757329106448)\" title=\"Mark as completed\">\n                                        ‚úì\n                                    </button>\n                                    <button class=\"action-btn delete-btn\" onclick=\"deleteTask(1757329106448)\" title=\"Delete task\">‚úï</button>\n                                </div>\n                            </div>\n                        </div>\n                    \n                        <div class=\"task-card priority-medium\">\n                            <div class=\"task-header-card\">\n                                <div>\n                                    <div class=\"task-title\">Sql Server Upgrade /Optimization -Pather &amp; Pather</div>\n                                    <div class=\"task-meta\">\n                                        <span class=\"task-badge priority-medium\">Medium</span>\n                                        <span class=\"category-badge\">Project</span>\n                                        <span class=\"status-badge status-pending\">Pending</span>\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"task-description\">Upgrade SQL EXPRESS TO SQL 2019 , PROVISION NEW DISKS FOR db's , LOGS, oPTIMIZE 12H QUOTED</div>\n                            \n                            <div class=\"task-footer\">\n                                <div class=\"task-due\">Due: 2025/09/20 (Tomorrow)</div>\n                                <div class=\"task-time\"></div>\n                                <div class=\"task-actions\">\n                                    <button class=\"action-btn edit-btn\" onclick=\"editTask(1758269150099)\" title=\"Edit task\">‚úè</button>\n                                    <button class=\"action-btn complete-btn\" onclick=\"toggleTaskStatus(1758269150099)\" title=\"Mark as completed\">\n                                        ‚úì\n                                    </button>\n                                    <button class=\"action-btn delete-btn\" onclick=\"deleteTask(1758269150099)\" title=\"Delete task\">‚úï</button>\n                                </div>\n                            </div>\n                        </div>\n                    \n                        <div class=\"task-card priority-medium\">\n                            <div class=\"task-header-card\">\n                                <div>\n                                    <div class=\"task-title\">Kanga SQL Optimization Assessment /Optimization</div>\n                                    <div class=\"task-meta\">\n                                        <span class=\"task-badge priority-medium\">Medium</span>\n                                        <span class=\"category-badge\">Project</span>\n                                        <span class=\"status-badge status-pending\">Pending</span>\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"task-description\">provide full assessment , SOW, project plan, Dude Monday 22 September</div>\n                            \n                            <div class=\"task-footer\">\n                                <div class=\"task-due\">Due: 2025/09/22 (3 days)</div>\n                                <div class=\"task-time\"></div>\n                                <div class=\"task-actions\">\n                                    <button class=\"action-btn edit-btn\" onclick=\"editTask(1758269289951)\" title=\"Edit task\">‚úè</button>\n                                    <button class=\"action-btn complete-btn\" onclick=\"toggleTaskStatus(1758269289951)\" title=\"Mark as completed\">\n                                        ‚úì\n                                    </button>\n                                    <button class=\"action-btn delete-btn\" onclick=\"deleteTask(1758269289951)\" title=\"Delete task\">‚úï</button>\n                                </div>\n                            </div>\n                        </div>\n                    \n                        <div class=\"task-card priority-low\">\n                            <div class=\"task-header-card\">\n                                <div>\n                                    <div class=\"task-title\">Shiplakes AD Remediation</div>\n                                    <div class=\"task-meta\">\n                                        <span class=\"task-badge priority-low\">Low</span>\n                                        <span class=\"category-badge\">Project</span>\n                                        <span class=\"status-badge status-pending\">Pending</span>\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"task-description\">Assessment - Tasks Fine Grain policy ClEANUPS</div>\n                            \n                            <div class=\"task-footer\">\n                                <div class=\"task-due\">Due: 2025/09/29 (10 days)</div>\n                                <div class=\"task-time\"></div>\n                                <div class=\"task-actions\">\n                                    <button class=\"action-btn edit-btn\" onclick=\"editTask(1758269394393)\" title=\"Edit task\">‚úè</button>\n                                    <button class=\"action-btn complete-btn\" onclick=\"toggleTaskStatus(1758269394393)\" title=\"Mark as completed\">\n                                        ‚úì\n                                    </button>\n                                    <button class=\"action-btn delete-btn\" onclick=\"deleteTask(1758269394393)\" title=\"Delete task\">‚úï</button>\n                                </div>\n                            </div>\n                        </div>\n                    \n                        <div class=\"task-card priority-low\">\n                            <div class=\"task-header-card\">\n                                <div>\n                                    <div class=\"task-title\">Ashtons AD Cleanup - Remediation</div>\n                                    <div class=\"task-meta\">\n                                        <span class=\"task-badge priority-low\">Low</span>\n                                        <span class=\"category-badge\">Project</span>\n                                        <span class=\"status-badge status-pending\">Pending</span>\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"task-description\">follow up on outstanding items , AD cleanup</div>\n                            \n                            <div class=\"task-footer\">\n                                <div class=\"task-due\">Due: 2025/10/03 (14 days)</div>\n                                <div class=\"task-time\"></div>\n                                <div class=\"task-actions\">\n                                    <button class=\"action-btn edit-btn\" onclick=\"editTask(1758269467247)\" title=\"Edit task\">‚úè</button>\n                                    <button class=\"action-btn complete-btn\" onclick=\"toggleTaskStatus(1758269467247)\" title=\"Mark as completed\">\n                                        ‚úì\n                                    </button>\n                                    <button class=\"action-btn delete-btn\" onclick=\"deleteTask(1758269467247)\" title=\"Delete task\">‚úï</button>\n                                </div>\n                            </div>\n                        </div>\n                    \n                        <div class=\"task-card priority-high\">\n                            <div class=\"task-header-card\">\n                                <div>\n                                    <div class=\"task-title\">SFTP Project  pather n pather</div>\n                                    <div class=\"task-meta\">\n                                        <span class=\"task-badge priority-high\">High</span>\n                                        <span class=\"category-badge\">Project</span>\n                                        <span class=\"status-badge status-in-progress\">In Progress</span>\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"task-description\">assess, scope, quote , implement</div>\n                            \n                            <div class=\"task-footer\">\n                                <div class=\"task-due\">Due: 2025/09/21 (2 days)</div>\n                                <div class=\"task-time\">5h</div>\n                                <div class=\"task-actions\">\n                                    <button class=\"action-btn edit-btn\" onclick=\"editTask(1757335217307)\" title=\"Edit task\">‚úè</button>\n                                    <button class=\"timer-btn\" onclick=\"toggleTimer(1757335217307)\" title=\"Start/Stop Timer\" id=\"timer-1757335217307\">‚ñ∂ Start</button>\n                                    <button class=\"action-btn complete-btn\" onclick=\"toggleTaskStatus(1757335217307)\" title=\"Mark as completed\">\n                                        ‚úì\n                                    </button>\n                                    <button class=\"action-btn delete-btn\" onclick=\"deleteTask(1757335217307)\" title=\"Delete task\">‚úï</button>\n                                </div>\n                            </div>\n                        </div>\n                    \n                        <div class=\"task-card priority-high\">\n                            <div class=\"task-header-card\">\n                                <div>\n                                    <div class=\"task-title\">RPA - align -Exam assignment issue</div>\n                                    <div class=\"task-meta\">\n                                        <span class=\"task-badge priority-high\">High</span>\n                                        <span class=\"category-badge\">Learning</span>\n                                        <span class=\"status-badge status-completed\">Completed</span>\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div class=\"task-description\">Exam assignment issue</div>\n                            \n                            <div class=\"task-footer\">\n                                <div class=\"task-due\">Due: 2025/09/19 (Today)</div>\n                                <div class=\"task-time\"></div>\n                                <div class=\"task-actions\">\n                                    <button class=\"action-btn edit-btn\" onclick=\"editTask(1757335298723)\" title=\"Edit task\">‚úè</button>\n                                    <button class=\"action-btn complete-btn\" onclick=\"toggleTaskStatus(1757335298723)\" title=\"Mark as pending\">\n                                        ‚Ü©\n                                    </button>\n                                    <button class=\"action-btn delete-btn\" onclick=\"deleteTask(1757335298723)\" title=\"Delete task\">‚úï</button>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <div class=\"task-calendar-sidebar\">\n                    <!-- Calendar Widget -->\n                    <div class=\"calendar-widget\" id=\"calendarWidget\">\n                        <div class=\"calendar-header\">\n                            <button class=\"calendar-nav\" onclick=\"previousMonth()\">&lt;</button>\n                            <div class=\"calendar-title\" id=\"calendarTitle\">September 2025</div>\n                            <button class=\"calendar-nav\" onclick=\"nextMonth()\">&gt;</button>\n                        </div>\n                        <div class=\"calendar-grid\" id=\"calendarGrid\"><div class=\"calendar-day-header\">Su</div><div class=\"calendar-day-header\">Mo</div><div class=\"calendar-day-header\">Tu</div><div class=\"calendar-day-header\">We</div><div class=\"calendar-day-header\">Th</div><div class=\"calendar-day-header\">Fr</div><div class=\"calendar-day-header\">Sa</div><div class=\"calendar-day other-month\">31</div><div class=\"calendar-day\">1</div><div class=\"calendar-day\">2</div><div class=\"calendar-day\">3</div><div class=\"calendar-day\">4</div><div class=\"calendar-day\">5</div><div class=\"calendar-day\">6</div><div class=\"calendar-day\">7</div><div class=\"calendar-day\">8</div><div class=\"calendar-day\">9</div><div class=\"calendar-day\">10</div><div class=\"calendar-day\">11</div><div class=\"calendar-day\">12</div><div class=\"calendar-day\">13</div><div class=\"calendar-day\">14</div><div class=\"calendar-day\">15</div><div class=\"calendar-day\">16</div><div class=\"calendar-day\">17</div><div class=\"calendar-day\">18</div><div class=\"calendar-day\">19</div><div class=\"calendar-day\">20</div><div class=\"calendar-day\">21</div><div class=\"calendar-day today\">22</div><div class=\"calendar-day\">23</div><div class=\"calendar-day\">24</div><div class=\"calendar-day\">25</div><div class=\"calendar-day\">26</div><div class=\"calendar-day\">27</div><div class=\"calendar-day\">28</div><div class=\"calendar-day\">29</div><div class=\"calendar-day\">30</div><div class=\"calendar-day other-month\">1</div><div class=\"calendar-day other-month\">2</div><div class=\"calendar-day other-month\">3</div><div class=\"calendar-day other-month\">4</div></div>\n                    </div>\n\n                    <!-- Quick Notes Section -->\n                    <div class=\"quick-links\">\n                        <h4><i class=\"fas fa-sticky-note\"></i> Quick Notes</h4>\n                        <div style=\"margin-bottom: 12px;\">\n                            <textarea id=\"quickNoteInput\" placeholder=\"Jot down a quick note...\" style=\"width: 100%; height: 100px; padding: 12px; border: 1px solid #e2e8f0; border-radius: 8px; font-size: 0.9em; resize: vertical; font-family: inherit; line-height: 1.4;\"></textarea>\n                            <div style=\"display: flex; gap: 4px; margin-top: 4px;\">\n                                <button onclick=\"addQuickNote()\" style=\"background: #3182ce; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer; font-size: 0.75em; flex: 1;\">Add Note</button>\n                                <button onclick=\"clearQuickNotes()\" style=\"background: #e53e3e; color: white; border: none; padding: 4px 8px; border-radius: 3px; cursor: pointer; font-size: 0.75em;\">Clear All</button>\n                            </div>\n                        </div>\n                        <div id=\"quickNotesList\" style=\"max-height: 300px; overflow-y: auto;\"><div style=\"text-align: center; color: #a0aec0; font-size: 0.75em; padding: 10px;\">No notes yet</div></div>\n                    </div>\n\n                    <!-- Quick Links Section -->\n                    <div class=\"quick-links\">\n                        <h4><i class=\"fas fa-link\"></i> Quick Links</h4>\n                        <a href=\"file:///X:/ClaudeCode/eNGINEdashBoard_Tasks/Nishen&#39;sTask_Notes_FileDashboard.html#\" class=\"quick-link\"><i class=\"fas fa-server\"></i> Server Management</a>\n                        <a href=\"file:///X:/ClaudeCode/eNGINEdashBoard_Tasks/Nishen&#39;sTask_Notes_FileDashboard.html#\" class=\"quick-link\"><i class=\"fas fa-database\"></i> SQL Server Tools</a>\n                        <a href=\"file:///X:/ClaudeCode/eNGINEdashBoard_Tasks/Nishen&#39;sTask_Notes_FileDashboard.html#\" class=\"quick-link\"><i class=\"fas fa-shield-alt\"></i> Security Center</a>\n                        <a href=\"file:///X:/ClaudeCode/eNGINEdashBoard_Tasks/Nishen&#39;sTask_Notes_FileDashboard.html#\" class=\"quick-link\"><i class=\"fas fa-users-cog\"></i> Active Directory</a>\n                        <a href=\"file:///X:/ClaudeCode/eNGINEdashBoard_Tasks/Nishen&#39;sTask_Notes_FileDashboard.html#\" class=\"quick-link\"><i class=\"fas fa-chart-line\"></i> Performance Monitor</a>\n                        <a href=\"file:///X:/ClaudeCode/eNGINEdashBoard_Tasks/Nishen&#39;sTask_Notes_FileDashboard.html#\" class=\"quick-link\"><i class=\"fas fa-file-alt\"></i> Documentation</a>\n                    </div>\n\n                    <!-- System Status -->\n                    <div class=\"quick-links\">\n                        <h4><i class=\"fas fa-heartbeat\"></i> System Status</h4>\n                        <div style=\"padding: 8px; font-size: 0.8em;\">\n                            <div style=\"display: flex; justify-content: space-between; margin-bottom: 4px;\">\n                                <span>Domain Controllers</span>\n                                <span style=\"color: #28a745;\">‚óèOnline</span>\n                            </div>\n                            <div style=\"display: flex; justify-content: space-between; margin-bottom: 4px;\">\n                                <span>SQL Servers</span>\n                                <span style=\"color: #28a745;\">‚óèOnline</span>\n                            </div>\n                            <div style=\"display: flex; justify-content: space-between; margin-bottom: 4px;\">\n                                <span>File Servers</span>\n                                <span style=\"color: #ffc107;\">‚óèWarning</span>\n                            </div>\n                            <div style=\"display: flex; justify-content: space-between;\">\n                                <span>Backup Status</span>\n                                <span style=\"color: #28a745;\">‚óèGood</span>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <button class=\"refresh-btn\" onclick=\"refreshAllPanels()\" title=\"Refresh All Panels\" style=\"display: none;\">\n        <i class=\"fas fa-sync-alt\"></i>\n    </button>\n\n    <!-- Hidden file input for import -->\n    <input type=\"file\" id=\"importFileInput\" accept=\".json\" onchange=\"handleImportFile(event)\">\n\n    <!-- Task Edit Modal -->\n    <div id=\"taskEditModal\" class=\"modal\" style=\"display: none;\">\n        <div class=\"modal-content\">\n            <h2><i class=\"fas fa-edit\"></i> Edit Task</h2>\n            <form id=\"taskEditForm\">\n                <div class=\"form-group\">\n                    <label for=\"editTaskTitle\">Title</label>\n                    <input type=\"text\" id=\"editTaskTitle\" required=\"\" placeholder=\"Task title...\">\n                </div>\n\n                <div class=\"form-group\">\n                    <label for=\"editTaskDescription\">Description</label>\n                    <textarea id=\"editTaskDescription\" placeholder=\"Task details...\"></textarea>\n                </div>\n\n                <div style=\"display: grid; grid-template-columns: 1fr 1fr; gap: 15px;\">\n                    <div class=\"form-group\">\n                        <label for=\"editTaskCategory\">Category</label>\n                        <select id=\"editTaskCategory\" required=\"\">\n                            <option value=\"\">Select...</option>\n                            <option value=\"Work\">Work</option>\n                            <option value=\"Personal\">Personal</option>\n                            <option value=\"Project\">Project</option>\n                            <option value=\"Meeting\">Meeting</option>\n                            <option value=\"Admin\">Admin</option>\n                            <option value=\"Learning\">Learning</option>\n                            <option value=\"Review\">Review</option>\n                        </select>\n                    </div>\n                    <div class=\"form-group\">\n                        <label for=\"editTaskHours\">Hours</label>\n                        <input type=\"number\" id=\"editTaskHours\" step=\"0.5\" min=\"0\" placeholder=\"0\">\n                    </div>\n                </div>\n\n                <div style=\"display: grid; grid-template-columns: 1fr 1fr; gap: 15px;\">\n                    <div class=\"form-group\">\n                        <label for=\"editTaskPriority\">Priority</label>\n                        <select id=\"editTaskPriority\" required=\"\">\n                            <option value=\"\">Select...</option>\n                            <option value=\"High\">High</option>\n                            <option value=\"Medium\">Medium</option>\n                            <option value=\"Low\">Low</option>\n                        </select>\n                    </div>\n                    <div class=\"form-group\">\n                        <label for=\"editTaskDueDate\">Due Date</label>\n                        <input type=\"date\" id=\"editTaskDueDate\" required=\"\" min=\"2025-09-22\">\n                    </div>\n                </div>\n\n                <div class=\"btn-group\">\n                    <button type=\"button\" class=\"btn btn-secondary\" onclick=\"closeTaskEditModal()\">Cancel</button>\n                    <button type=\"submit\" class=\"btn btn-primary\">Save Changes</button>\n                </div>\n            </form>\n        </div>\n    </div>\n\n    <!-- Configuration Modal -->\n    <div id=\"configModal\" class=\"modal\" style=\"display: none;\">\n        <div class=\"modal-content\">\n            <h2><i class=\"fas fa-cog\"></i> Configure Folder Path</h2>\n            <div class=\"form-group\">\n                <label for=\"panelTitle\">Panel Title:</label>\n                <input type=\"text\" id=\"panelTitle\" placeholder=\"e.g., PowerShell Scripts\">\n            </div>\n            <div class=\"form-group\">\n                <label for=\"folderPath\">Folder Path:</label>\n                <input type=\"text\" id=\"folderPath\" placeholder=\"e.g., C:\\Scripts\\PowerShell\">\n            </div>\n            <div class=\"btn-group\">\n                <button class=\"btn btn-secondary\" onclick=\"closeModal()\">Cancel</button>\n                <button class=\"btn btn-primary\" onclick=\"savePanelConfig()\">Save</button>\n            </div>\n        </div>\n    </div>\n\n    <script>\n        let panels = [];\n        let currentPanelIndex = -1;\n        let currentDate = new Date();\n\n        // Initialize everything when DOM is loaded\n        document.addEventListener('DOMContentLoaded', function() {\n            console.log('DOM loaded, initializing...');\n            \n            setTimeout(() => {\n                try {\n                    loadConfiguration();\n                    initializePanels();\n                    initializeDateTime();\n                    initializeCalendar();\n                    refreshAllPanels();\n                    console.log('Initialization complete');\n                } catch (error) {\n                    console.error('Initialization error:', error);\n                }\n            }, 100);\n        });\n\n        function initializePanels() {\n            const container = document.getElementById('gridContainer');\n            if (!container) {\n                console.error('Grid container not found');\n                return;\n            }\n            \n            updatePanelDisplays();\n            console.log('Panels initialized');\n        }\n\n        function updatePanelDisplays() {\n            for (let i = 0; i < 6; i++) {\n                const panel = panels[i];\n                const titleElement = document.getElementById(`panelTitle${i}`);\n                const pathElement = document.getElementById(`folderPath${i}`);\n\n                if (titleElement && pathElement) {\n                    if (panel) {\n                        titleElement.textContent = panel.title;\n                        pathElement.textContent = panel.path;\n                    } else {\n                        titleElement.textContent = `Panel ${i + 1}`;\n                        pathElement.textContent = 'No path configured';\n                    }\n                }\n            }\n        }\n\n        function openConfigModal(panelIndex) {\n            currentPanelIndex = panelIndex;\n            const panel = panels[panelIndex] || {};\n            \n            const titleInput = document.getElementById('panelTitle');\n            const pathInput = document.getElementById('folderPath');\n            const modal = document.getElementById('configModal');\n            \n            if (titleInput) titleInput.value = panel.title || `Panel ${panelIndex + 1}`;\n            if (pathInput) pathInput.value = panel.path || '';\n            if (modal) modal.style.display = 'block';\n        }\n\n        function closeModal() {\n            const modal = document.getElementById('configModal');\n            if (modal) modal.style.display = 'none';\n            currentPanelIndex = -1;\n        }\n\n        function savePanelConfig() {\n            if (currentPanelIndex === -1) return;\n\n            const titleInput = document.getElementById('panelTitle');\n            const pathInput = document.getElementById('folderPath');\n            \n            const title = titleInput ? titleInput.value : '';\n            const path = pathInput ? pathInput.value : '';\n\n            if (!title || !path) {\n                alert('Please fill in both title and folder path');\n                return;\n            }\n\n            panels[currentPanelIndex] = { title, path };\n            saveConfiguration();\n            updatePanelDisplays();\n            refreshPanel(currentPanelIndex);\n            closeModal();\n        }\n\n        function resetPanel(panelIndex) {\n            if (confirm(`Are you sure you want to reset Panel ${panelIndex + 1}? This will clear all configuration and files.`)) {\n                delete panels[panelIndex];\n                \n                const titleElement = document.getElementById(`panelTitle${panelIndex}`);\n                const pathElement = document.getElementById(`folderPath${panelIndex}`);\n                const fileListElement = document.getElementById(`fileList${panelIndex}`);\n                \n                if (titleElement) titleElement.textContent = `Panel ${panelIndex + 1}`;\n                if (pathElement) pathElement.textContent = 'No path configured';\n                if (fileListElement) {\n                    fileListElement.innerHTML = `\n                        <div class=\"empty-panel\">\n                            <i class=\"fas fa-folder-open\"></i>\n                            <div>Configure a folder path to view files</div>\n                        </div>\n                    `;\n                }\n                \n                saveConfiguration();\n            }\n        }\n\n        async function refreshPanel(panelIndex) {\n            const panel = panels[panelIndex];\n            if (!panel) return;\n\n            const fileListElement = document.getElementById(`fileList${panelIndex}`);\n            if (!fileListElement) return;\n            \n            try {\n                const files = await readRealFiles(panel.path);\n                displayFiles(fileListElement, files);\n            } catch (error) {\n                fileListElement.innerHTML = `\n                    <div class=\"empty-panel\">\n                        <i class=\"fas fa-exclamation-triangle\"></i>\n                        <div>Error reading folder: ${error.message}</div>\n                        <div style=\"font-size: 0.8em; margin-top: 10px;\">\n                            Check if the folder path exists and is accessible.\n                        </div>\n                    </div>\n                `;\n            }\n        }\n\n        async function readRealFiles(folderPath) {\n            // Mock data for demonstration\n            return [\n                { name: 'script1.ps1', ext: 'ps1', modified: new Date() },\n                { name: 'config.xml', ext: 'xml', modified: new Date() },\n                { name: 'report.html', ext: 'html', modified: new Date() }\n            ];\n        }\n\n        function displayFiles(container, files) {\n            if (!container) return;\n            \n            if (files.length === 0) {\n                container.innerHTML = `\n                    <div class=\"empty-panel\">\n                        <i class=\"fas fa-folder-open\"></i>\n                        <div>No files found in this directory</div>\n                    </div>\n                `;\n                return;\n            }\n\n            container.innerHTML = files.map(file => `\n                <div class=\"file-item ${file.ext}\" onclick=\"openFile('${file.name}', '${file.ext}')\">\n                    <div class=\"file-name\" title=\"${file.name}\">${file.name}</div>\n                    <div class=\"file-ext\">${file.ext.toUpperCase()}</div>\n                    <div class=\"file-date\">${formatDate(file.modified)}</div>\n                </div>\n            `).join('');\n        }\n\n        function openFile(fileName, extension) {\n            alert(`Opening ${fileName} (${extension.toUpperCase()}) - File handling functionality preserved from original`);\n        }\n\n        function formatDate(date) {\n            const now = new Date();\n            const diffTime = now - date;\n            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));\n\n            if (diffDays === 0) {\n                return 'Today';\n            } else if (diffDays === 1) {\n                return 'Yesterday';\n            } else if (diffDays < 7) {\n                return `${diffDays} days ago`;\n            } else {\n                return date.toLocaleDateString();\n            }\n        }\n\n        function refreshAllPanels() {\n            for (let i = 0; i < 6; i++) {\n                if (panels[i]) {\n                    refreshPanel(i);\n                }\n            }\n        }\n\n        function saveConfiguration() {\n            localStorage.setItem('fileBrowserPanels', JSON.stringify(panels));\n        }\n\n        function loadConfiguration() {\n            try {\n                const saved = localStorage.getItem('fileBrowserPanels');\n                if (saved) {\n                    panels = JSON.parse(saved);\n                }\n            } catch (error) {\n                console.error('Load configuration error:', error);\n                panels = [];\n            }\n        }\n\n        // DateTime functions\n        function initializeDateTime() {\n            updateDateTime();\n            setInterval(updateDateTime, 1000);\n        }\n\n        function updateDateTime() {\n            const now = new Date();\n            const timeOptions = { \n                hour12: false, \n                hour: '2-digit', \n                minute: '2-digit', \n                second: '2-digit' \n            };\n            const dateOptions = { \n                weekday: 'long', \n                year: 'numeric', \n                month: 'long', \n                day: 'numeric' \n            };\n\n            const timeElement = document.getElementById('currentTime');\n            const dateElement = document.getElementById('currentDate');\n            \n            if (timeElement) {\n                timeElement.textContent = now.toLocaleTimeString('en-US', timeOptions);\n            }\n            if (dateElement) {\n                dateElement.textContent = now.toLocaleDateString('en-US', dateOptions);\n            }\n        }\n\n        // Calendar functions\n        function initializeCalendar() {\n            renderCalendar();\n        }\n\n        function renderCalendar() {\n            const year = currentDate.getFullYear();\n            const month = currentDate.getMonth();\n            \n            const monthNames = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\",\n                \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\n            \n            const titleElement = document.getElementById('calendarTitle');\n            if (titleElement) {\n                titleElement.textContent = `${monthNames[month]} ${year}`;\n            }\n\n            const calendarGrid = document.getElementById('calendarGrid');\n            if (!calendarGrid) return;\n            \n            calendarGrid.innerHTML = '';\n\n            // Add day headers\n            const dayHeaders = ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'];\n            dayHeaders.forEach(day => {\n                const dayHeader = document.createElement('div');\n                dayHeader.className = 'calendar-day-header';\n                dayHeader.textContent = day;\n                calendarGrid.appendChild(dayHeader);\n            });\n\n            // Get first day of month and number of days\n            const firstDay = new Date(year, month, 1);\n            const lastDay = new Date(year, month + 1, 0);\n            const firstDayOfWeek = firstDay.getDay();\n            const daysInMonth = lastDay.getDate();\n\n            // Add empty cells for days before month starts\n            for (let i = 0; i < firstDayOfWeek; i++) {\n                const emptyDay = document.createElement('div');\n                emptyDay.className = 'calendar-day other-month';\n                const prevMonthDay = new Date(year, month, 0 - (firstDayOfWeek - 1 - i));\n                emptyDay.textContent = prevMonthDay.getDate();\n                calendarGrid.appendChild(emptyDay);\n            }\n\n            // Add days of current month\n            const today = new Date();\n            for (let day = 1; day <= daysInMonth; day++) {\n                const dayElement = document.createElement('div');\n                dayElement.className = 'calendar-day';\n                dayElement.textContent = day;\n                \n                // Highlight today\n                if (year === today.getFullYear() && \n                    month === today.getMonth() && \n                    day === today.getDate()) {\n                    dayElement.classList.add('today');\n                }\n                \n                calendarGrid.appendChild(dayElement);\n            }\n\n            // Add empty cells for days after month ends\n            const totalCells = calendarGrid.children.length;\n            const remainingCells = 42 - totalCells;\n            for (let i = 1; i <= remainingCells && i <= 14; i++) {\n                const nextMonthDay = document.createElement('div');\n                nextMonthDay.className = 'calendar-day other-month';\n                nextMonthDay.textContent = i;\n                calendarGrid.appendChild(nextMonthDay);\n            }\n        }\n\n        function previousMonth() {\n            currentDate.setMonth(currentDate.getMonth() - 1);\n            renderCalendar();\n        }\n\n        function nextMonth() {\n            currentDate.setMonth(currentDate.getMonth() + 1);\n            renderCalendar();\n        }\n\n        // Export/Import functions\n        function exportConfig() {\n            try {\n                const config = {\n                    panels: panels,\n                    exportDate: new Date().toISOString(),\n                    version: \"1.0\",\n                    application: \"Senior Systems Engineer File Browser\"\n                };\n\n                const dataStr = JSON.stringify(config, null, 2);\n                const dataBlob = new Blob([dataStr], { type: 'application/json' });\n                \n                const link = document.createElement('a');\n                link.href = URL.createObjectURL(dataBlob);\n                link.download = `file-browser-config-${new Date().toISOString().split('T')[0]}.json`;\n                document.body.appendChild(link);\n                link.click();\n                document.body.removeChild(link);\n                \n                alert('Configuration exported successfully!');\n            } catch (error) {\n                console.error('Export error:', error);\n                alert('Error exporting configuration: ' + error.message);\n            }\n        }\n\n        function importConfig() {\n            try {\n                const fileInput = document.getElementById('importFileInput');\n                if (fileInput) {\n                    fileInput.click();\n                }\n            } catch (error) {\n                console.error('Import error:', error);\n                alert('Error opening file dialog: ' + error.message);\n            }\n        }\n\n        function handleImportFile(event) {\n            try {\n                const file = event.target.files[0];\n                if (!file) return;\n\n                const reader = new FileReader();\n                reader.onload = function(e) {\n                    try {\n                        const config = JSON.parse(e.target.result);\n                        \n                        if (!config.panels || !Array.isArray(config.panels)) {\n                            throw new Error('Invalid configuration format');\n                        }\n\n                        const exportDate = config.exportDate ? new Date(config.exportDate).toLocaleDateString() : 'Unknown';\n                        const confirmMessage = `Import configuration exported on ${exportDate}?\\n\\nThis will replace your current configuration.`;\n                        if (confirm(confirmMessage)) {\n                            panels = config.panels;\n                            saveConfiguration();\n                            updatePanelDisplays();\n                            refreshAllPanels();\n                            alert('Configuration imported successfully!');\n                        }\n                    } catch (error) {\n                        alert(`Error importing configuration: ${error.message}`);\n                    }\n                };\n                reader.readAsText(file);\n                \n                event.target.value = '';\n            } catch (error) {\n                console.error('Handle import file error:', error);\n                alert('Error handling import file: ' + error.message);\n            }\n        }\n\n        // Tab switching functionality\n        function switchTab(tab) {\n            const fileBrowserSection = document.getElementById('gridContainer');\n            const taskTrackerSection = document.getElementById('taskTrackerSection');\n            const refreshBtn = document.querySelector('.refresh-btn');\n            const tabs = document.querySelectorAll('.nav-tab');\n            \n            // Update tab states\n            tabs.forEach(t => t.classList.remove('active'));\n            event.target.classList.add('active');\n            \n            if (tab === 'files') {\n                fileBrowserSection.style.display = 'grid';\n                taskTrackerSection.style.display = 'none';\n                refreshBtn.style.display = 'block';\n            } else if (tab === 'tasks') {\n                fileBrowserSection.style.display = 'none';\n                taskTrackerSection.style.display = 'block';\n                refreshBtn.style.display = 'none';\n                initializeTaskTracker();\n            }\n        }\n        \n        function initializeTaskTracker() {\n            // Task management variables\n            let tasks = [\n                {\n                    id: 1757329106448,\n                    title: \"Evo security\",\n                    description: \"Configure Solution (on)\",\n                    category: \"Project\",\n                    priority: \"High\",\n                    dueDate: \"2025-09-24\",\n                    hours: 2,\n                    status: \"pending\",\n                    createdAt: \"2025-09-19T10:00:00Z\",\n                    completedAt: null\n                },\n                {\n                    id: 1758269150099,\n                    title: \"Sql Server Upgrade /Optimization -Pather & Pather\",\n                    description: \"Upgrade SQL EXPRESS TO SQL 2019 , PROVISION NEW DISKS FOR db's , LOGS, oPTIMIZE 12H QUOTED\",\n                    category: \"Project\",\n                    priority: \"Medium\",\n                    dueDate: \"2025-09-20\",\n                    hours: 0,\n                    status: \"pending\",\n                    createdAt: \"2025-09-19T10:00:00Z\",\n                    completedAt: null\n                }\n            ];\n\n            // Quick Notes management\n            let quickNotes = [];\n\n            // Timer management\n            let taskTimers = {};\n            let currentEditTaskId = null;\n            \n            // Load tasks from localStorage\n            function loadTasks() {\n                try {\n                    const saved = localStorage.getItem('taskTracker_tasks');\n                    if (saved) {\n                        tasks = JSON.parse(saved);\n                    }\n                } catch (error) {\n                    console.error('Error loading saved tasks:', error);\n                }\n            }\n            \n            // Save tasks to localStorage\n            function saveTasks() {\n                try {\n                    localStorage.setItem('taskTracker_tasks', JSON.stringify(tasks));\n                } catch (error) {\n                    console.error('Error saving tasks:', error);\n                }\n            }\n\n            // Load notes from localStorage\n            function loadQuickNotes() {\n                try {\n                    const saved = localStorage.getItem('taskTracker_quickNotes');\n                    if (saved) {\n                        quickNotes = JSON.parse(saved);\n                    }\n                } catch (error) {\n                    console.error('Error loading saved notes:', error);\n                }\n            }\n            \n            // Save notes to localStorage\n            function saveQuickNotes() {\n                try {\n                    localStorage.setItem('taskTracker_quickNotes', JSON.stringify(quickNotes));\n                } catch (error) {\n                    console.error('Error saving notes:', error);\n                }\n            }\n\n            // Render quick notes\n            function renderQuickNotes() {\n                const notesList = document.getElementById('quickNotesList');\n                if (!notesList) return;\n\n                if (quickNotes.length === 0) {\n                    notesList.innerHTML = '<div style=\"text-align: center; color: #a0aec0; font-size: 0.75em; padding: 10px;\">No notes yet</div>';\n                    return;\n                }\n\n                notesList.innerHTML = quickNotes.map(note => `\n                    <div class=\"note-item\">\n                        <div class=\"note-content\">${escapeHtml(note.content)}</div>\n                        <div class=\"note-meta\">\n                            <span class=\"note-timestamp\">${formatNoteDate(note.createdAt)}</span>\n                            <div class=\"note-actions\">\n                                <button class=\"note-btn convert\" onclick=\"convertNoteToTask(${note.id})\" title=\"Convert to Task\">\n                                    <i class=\"fas fa-arrow-right\"></i>\n                                </button>\n                                <button class=\"note-btn delete\" onclick=\"deleteQuickNote(${note.id})\" title=\"Delete Note\">\n                                    <i class=\"fas fa-times\"></i>\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                `).join('');\n            }\n\n            // Add quick note function\n            window.addQuickNote = function() {\n                const input = document.getElementById('quickNoteInput');\n                if (!input) return;\n\n                const content = input.value.trim();\n                if (!content) {\n                    alert('Please enter a note before adding');\n                    return;\n                }\n\n                const note = {\n                    id: Date.now(),\n                    content: content,\n                    createdAt: new Date().toISOString()\n                };\n\n                quickNotes.unshift(note); // Add to beginning of array\n                saveQuickNotes();\n                renderQuickNotes();\n                input.value = ''; // Clear input\n            };\n\n            // Delete quick note function\n            window.deleteQuickNote = function(id) {\n                quickNotes = quickNotes.filter(note => note.id !== id);\n                saveQuickNotes();\n                renderQuickNotes();\n            };\n\n            // Clear all notes function\n            window.clearQuickNotes = function() {\n                if (quickNotes.length === 0) {\n                    alert('No notes to clear');\n                    return;\n                }\n\n                if (confirm(`Are you sure you want to delete all ${quickNotes.length} notes?`)) {\n                    quickNotes = [];\n                    saveQuickNotes();\n                    renderQuickNotes();\n                }\n            };\n\n            // Convert note to task function\n            window.convertNoteToTask = function(noteId) {\n                const note = quickNotes.find(n => n.id === noteId);\n                if (!note) return;\n\n                // Pre-fill the task form with note content\n                const titleInput = document.getElementById('taskTitle');\n                const descriptionInput = document.getElementById('taskDescription');\n                \n                if (titleInput) {\n                    // Use first 50 characters as title, or full content if shorter\n                    titleInput.value = note.content.length > 50 ? \n                        note.content.substring(0, 50) + '...' : \n                        note.content;\n                }\n                \n                if (descriptionInput) {\n                    descriptionInput.value = note.content;\n                }\n\n                // Set default values for new task\n                const categoryInput = document.getElementById('taskCategory');\n                const priorityInput = document.getElementById('taskPriority');\n                const dueDateInput = document.getElementById('taskDueDate');\n\n                if (categoryInput) categoryInput.value = 'Work';\n                if (priorityInput) priorityInput.value = 'Medium';\n                if (dueDateInput) {\n                    // Set due date to tomorrow\n                    const tomorrow = new Date();\n                    tomorrow.setDate(tomorrow.getDate() + 1);\n                    dueDateInput.value = tomorrow.toISOString().split('T')[0];\n                }\n\n                // Ask if user wants to delete the note after conversion\n                if (confirm('Note content copied to task form. Delete the original note?')) {\n                    deleteQuickNote(noteId);\n                }\n\n                // Scroll to task form\n                const taskForm = document.getElementById('taskForm');\n                if (taskForm) {\n                    taskForm.scrollIntoView({ behavior: 'smooth', block: 'start' });\n                }\n            };\n\n            // Format note date\n            function formatNoteDate(dateString) {\n                const date = new Date(dateString);\n                const now = new Date();\n                const diffMs = now - date;\n                const diffMins = Math.floor(diffMs / (1000 * 60));\n                const diffHours = Math.floor(diffMs / (1000 * 60 * 60));\n                const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));\n\n                if (diffMins < 1) return 'Just now';\n                if (diffMins < 60) return `${diffMins}m ago`;\n                if (diffHours < 24) return `${diffHours}h ago`;\n                if (diffDays < 7) return `${diffDays}d ago`;\n                return date.toLocaleDateString();\n            }\n\n            // Add Enter key support for quick note input\n            document.getElementById('quickNoteInput')?.addEventListener('keydown', function(e) {\n                if (e.key === 'Enter' && !e.shiftKey) {\n                    e.preventDefault();\n                    addQuickNote();\n                }\n            });\n            \n            // Update statistics\n            function updateStats() {\n                const total = tasks.length;\n                const completed = tasks.filter(t => t.status === 'completed').length;\n                const pending = tasks.filter(t => getTaskStatus(t) === 'pending').length;\n                const overdue = tasks.filter(t => getTaskStatus(t) === 'overdue').length;\n                \n                const totalEl = document.getElementById('totalTasks');\n                const completedEl = document.getElementById('completedTasks');\n                const pendingEl = document.getElementById('pendingTasks');\n                const overdueEl = document.getElementById('overdueTasks');\n                \n                if (totalEl) totalEl.textContent = total;\n                if (completedEl) completedEl.textContent = completed;\n                if (pendingEl) pendingEl.textContent = pending;\n                if (overdueEl) overdueEl.textContent = overdue;\n            }\n            \n            // Get task status\n            function getTaskStatus(task) {\n                if (task.status === 'completed') return 'completed';\n                \n                const today = new Date();\n                const dueDate = new Date(task.dueDate);\n                \n                if (dueDate < today) return 'overdue';\n                return task.status;\n            }\n\n            // Helper function to escape HTML\n            function escapeHtml(text) {\n                const div = document.createElement('div');\n                div.textContent = text;\n                return div.innerHTML;\n            }\n            \n            // Toggle task status\n            window.toggleTaskStatus = function(id) {\n                const task = tasks.find(t => t.id === id);\n                if (!task) return;\n                \n                if (task.status === 'completed') {\n                    task.status = 'pending';\n                    task.completedAt = null;\n                } else {\n                    task.status = 'completed';\n                    task.completedAt = new Date().toISOString();\n                }\n                \n                saveTasks();\n                updateStats();\n            };\n            \n            // Delete task\n            window.deleteTask = function(id) {\n                if (confirm('Are you sure you want to delete this task?')) {\n                    tasks = tasks.filter(t => t.id !== id);\n                    saveTasks();\n                    updateStats();\n                }\n            };\n\n            // Edit task function\n            window.editTask = function(id) {\n                const task = tasks.find(t => t.id === id);\n                if (!task) return;\n\n                currentEditTaskId = id;\n\n                // Populate edit form\n                document.getElementById('editTaskTitle').value = task.title;\n                document.getElementById('editTaskDescription').value = task.description;\n                document.getElementById('editTaskCategory').value = task.category;\n                document.getElementById('editTaskPriority').value = task.priority;\n                document.getElementById('editTaskDueDate').value = task.dueDate;\n                document.getElementById('editTaskHours').value = task.hours || 0;\n\n                // Show modal\n                document.getElementById('taskEditModal').style.display = 'block';\n            };\n\n            // Close task edit modal\n            window.closeTaskEditModal = function() {\n                document.getElementById('taskEditModal').style.display = 'none';\n                currentEditTaskId = null;\n            };\n\n            // Timer functions\n            window.toggleTimer = function(id) {\n                const timerBtn = document.getElementById(`timer-${id}`);\n                if (!timerBtn) return;\n\n                if (taskTimers[id]) {\n                    // Stop timer\n                    const startTime = taskTimers[id];\n                    const elapsedMs = Date.now() - startTime;\n                    const elapsedHours = elapsedMs / (1000 * 60 * 60);\n\n                    // Update task hours\n                    const task = tasks.find(t => t.id === id);\n                    if (task) {\n                        task.hours = (task.hours || 0) + elapsedHours;\n                        task.hours = Math.round(task.hours * 100) / 100; // Round to 2 decimal places\n                        saveTasks();\n                    }\n\n                    delete taskTimers[id];\n                    timerBtn.textContent = '‚ñ∂ Start';\n                    timerBtn.classList.remove('running');\n                } else {\n                    // Start timer\n                    taskTimers[id] = Date.now();\n                    timerBtn.textContent = '‚è∏ Stop';\n                    timerBtn.classList.add('running');\n                }\n            };\n\n            // Filter functions\n            window.applyFilters = function() {\n                const statusFilter = document.getElementById('filterStatus').value;\n                const priorityFilter = document.getElementById('filterPriority').value;\n                const categoryFilter = document.getElementById('filterCategory').value;\n\n                // This would normally filter the displayed tasks\n                // For now, we'll just show an alert\n                console.log('Applying filters:', { statusFilter, priorityFilter, categoryFilter });\n            };\n\n            window.clearFilters = function() {\n                document.getElementById('filterStatus').value = '';\n                document.getElementById('filterPriority').value = '';\n                document.getElementById('filterCategory').value = '';\n                applyFilters();\n            };\n            \n            // Add task form handler\n            const taskForm = document.getElementById('taskForm');\n            if (taskForm) {\n                taskForm.addEventListener('submit', function(e) {\n                    e.preventDefault();\n                    \n                    const title = document.getElementById('taskTitle').value.trim();\n                    const description = document.getElementById('taskDescription').value.trim();\n                    const category = document.getElementById('taskCategory').value;\n                    const priority = document.getElementById('taskPriority').value;\n                    const dueDate = document.getElementById('taskDueDate').value;\n                    const hours = parseFloat(document.getElementById('taskHours').value) || 0;\n                    \n                    if (!title || !category || !priority || !dueDate) {\n                        alert('Please fill in all required fields');\n                        return;\n                    }\n                    \n                    const task = {\n                        id: Date.now(),\n                        title: title,\n                        description: description,\n                        category: category,\n                        priority: priority,\n                        dueDate: dueDate,\n                        hours: hours,\n                        status: 'pending',\n                        createdAt: new Date().toISOString(),\n                        completedAt: null\n                    };\n                    \n                    tasks.push(task);\n                    saveTasks();\n                    updateStats();\n                    \n                    // Reset form\n                    taskForm.reset();\n                });\n            }\n            \n            // Edit task form handler\n            const taskEditForm = document.getElementById('taskEditForm');\n            if (taskEditForm) {\n                taskEditForm.addEventListener('submit', function(e) {\n                    e.preventDefault();\n\n                    if (!currentEditTaskId) return;\n\n                    const title = document.getElementById('editTaskTitle').value.trim();\n                    const description = document.getElementById('editTaskDescription').value.trim();\n                    const category = document.getElementById('editTaskCategory').value;\n                    const priority = document.getElementById('editTaskPriority').value;\n                    const dueDate = document.getElementById('editTaskDueDate').value;\n                    const hours = parseFloat(document.getElementById('editTaskHours').value) || 0;\n\n                    if (!title || !category || !priority || !dueDate) {\n                        alert('Please fill in all required fields');\n                        return;\n                    }\n\n                    // Find and update task\n                    const taskIndex = tasks.findIndex(t => t.id === currentEditTaskId);\n                    if (taskIndex !== -1) {\n                        tasks[taskIndex] = {\n                            ...tasks[taskIndex],\n                            title: title,\n                            description: description,\n                            category: category,\n                            priority: priority,\n                            dueDate: dueDate,\n                            hours: hours\n                        };\n\n                        saveTasks();\n                        updateStats();\n                        closeTaskEditModal();\n\n                        // In a real implementation, you would re-render the tasks list here\n                        alert('Task updated successfully! Please refresh to see changes.');\n                    }\n                });\n            }\n\n            // Set minimum date to today\n            const today = new Date().toISOString().split('T')[0];\n            const dueDateInput = document.getElementById('taskDueDate');\n            if (dueDateInput) {\n                dueDateInput.setAttribute('min', today);\n            }\n\n            const editDueDateInput = document.getElementById('editTaskDueDate');\n            if (editDueDateInput) {\n                editDueDateInput.setAttribute('min', today);\n            }\n            \n            // Initialize\n            loadTasks();\n            loadQuickNotes();\n            updateStats();\n            renderQuickNotes();\n        }\n\n        // Event handlers\n        window.onclick = function(event) {\n            const configModal = document.getElementById('configModal');\n            const taskEditModal = document.getElementById('taskEditModal');\n\n            if (event.target === configModal) {\n                closeModal();\n            }\n            if (event.target === taskEditModal) {\n                closeTaskEditModal();\n            }\n        }\n\n        document.addEventListener('keydown', function(event) {\n            const modal = document.getElementById('configModal');\n            if (event.key === 'Enter' && modal && modal.style.display === 'block') {\n                savePanelConfig();\n            }\n        });\n    </script>\n\n\n</body></html>",
      "category": "HTML Tools",
      "tags": [
        "Engineer",
        "Dashboard",
        "tasktracker"
      ],
      "created": "2025-09-28T21:54:43.129Z",
      "modified": "2025-09-28T21:58:41.334Z",
      "isPinned": false,
      "isArchived": false,
      "type": "html"
    },
    {
      "id": "note-1757846283968",
      "title": "UI Designing AI-Driven Terms",
      "content": "Here's a breakdown of key UI building terms for AI modernization:\n\nAI-Driven Design:\n\nGenerative AI (GenAI):\nUsing AI to create design elements, suggest layouts, and generate components based on historical data and real-time feedback. \n\nAI-Generated User Interfaces (AIGUI):\nDynamic designs created on the fly by AI companions or other AI-powered systems. \nAI-Powered Prototyping Tools:\nTools that leverage AI to suggest design elements and interaction patterns during the prototyping phase. \nModern UI/UX Principles:\nResponsiveness:\nDesigns that adapt to different screen sizes and devices, ensuring a consistent experience across platforms. \nInteraction Design:\nDesigning intuitive and smooth user interactions with elements like buttons, forms, and animations. \nBehavioral Design:\nFocusing on understanding and influencing user behavior through design to guide their actions within the interface. \nUsability:\nThe ease with which users can achieve their goals using the interface. \nAccessibility:\nDesigning interfaces that are usable by everyone, including people with disabilities. \nAI Integration into the UI:\nAI Interfaces and Presence:\nThe overall experience of interacting with AI within a digital interface, encompassing both functionality and aesthetics. \n\nContextual AI:\nAI that understands and adapts to the user's context, providing relevant information and features when needed. \n\nUnderlying Processes:\nPrototyping:\nCreating detailed representations of the final product to test and refine design concepts before full development. \n\nTest Automation:\nUsing automated tools to test user interfaces, improving development speed and reliability. ",
      "category": "Development",
      "tags": [
        "ui",
        "ai",
        "gui design"
      ],
      "created": "2025-09-14T10:38:03.968Z",
      "modified": "2025-09-14T10:41:23.991Z",
      "isPinned": true,
      "isArchived": false,
      "type": "document"
    },
    {
      "id": "note-1757453538331",
      "title": "UbUNTU Setup",
      "content": "iNSTALL uBUNTU 1ST , Launch terminal and update Ubuntu\n\n#!/bin/bash\nset -e\n\necho \"Starting Ubuntu configuration for Claude Code...\"\n\n# Update package lists\nsudo apt update && sudo apt upgrade -y\n\n# Install essential packages\nsudo apt install -y curl wget git build-essential python3 python3-pip nodejs npm\n\n# Install Node.js LTS via NodeSource\ncurl -fsSL https://deb.nodesource.com/setup_lts.x | sudo -E bash -\nsudo apt-get install -y nodejs\n\n# Verify installations\necho \"Node.js version: \\\"\necho \"npm version: \\\"\necho \"Python version: \\\"\n\n# Install Claude Code\necho \"Installing Claude Code...\"\nnpm install -g @anthropic-ai/claude-code\n\n# Verify Claude Code installation\nif command -v claude-code &> /dev/null; then\n    echo \"Claude Code installed successfully!\"\n    echo \"Version: \\\"\nelse\n    echo \"Claude Code installation failed!\"\n    exit 1\nfi\n\n# Set up git configuration prompts\necho \"Setting up Git configuration...\"\necho \"Please configure Git with your details:\"\nread -p \"Enter your Git username: \" git_username\nread -p \"Enter your Git email: \" git_email\n\ngit config --global user.name \"\\\"\ngit config --global user.email \"\\\"\n\n# Create workspace directory\nmkdir -p ~/workspace/claude-projects\ncd ~/workspace/claude-projects\n\necho \"Setup complete! You can now use Claude Code.\"\necho \"Run 'claude-code --help' to get started.\"\necho \"Workspace created at: ~/workspace/claude-projects\"\n",
      "category": "Setup Scripts -1installer",
      "tags": [
        "Ubuntu Setup",
        "Claude",
        "WSL"
      ],
      "created": "2025-09-09T21:32:18.331Z",
      "modified": "2025-09-09T21:34:22.558Z",
      "isPinned": false,
      "isArchived": false,
      "type": "code"
    },
    {
      "id": "note-1756884962650",
      "title": "Standby Email Template -Disk Alerts ",
      "content": "Standby Email Template -Disk Alerts \n====================================\n\nCreated in Nishen's AI Workspace on 2025/09/03\n\nOverview:\n---------\nDocument description here.\n\nContents:\n---------\n- Section 1\n- Section 2\n- Section 3\n\nNotes:\n------\nAdd your documentation content here.",
      "category": "Documentation",
      "tags": [
        "standby",
        "template"
      ],
      "created": "2025-09-03T07:36:02.650Z",
      "modified": "2025-09-03T07:36:02.650Z",
      "isPinned": false,
      "isArchived": false,
      "type": "document"
    },
    {
      "id": "note-1756884603452",
      "title": "Standby Template Failed Disk Alerts",
      "content": "Standby Template Failed Disk Alerts\n===================================\n\nCreated in Nishen's AI Workspace on 2025/09/03\n\nOverview:\n---------\nDocument description here.\n\nContents:\n---------\n- Section 1\n- Section 2\n- Section 3\n\nNotes:\n------\nAdd your documentation content here.",
      "category": "Documentation",
      "tags": [
        "standby",
        "template",
        ""
      ],
      "created": "2025-09-03T07:30:03.452Z",
      "modified": "2025-09-03T07:30:03.452Z",
      "isPinned": false,
      "isArchived": false,
      "type": "document"
    },
    {
      "id": "note-1755651165564",
      "title": "evo security",
      "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>evo security</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            margin: 0;\n            padding: 20px;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n            min-height: 100vh;\n        }\n        .container {\n            max-width: 800px;\n            margin: 0 auto;\n            background: rgba(255, 255, 255, 0.1);\n            padding: 30px;\n            border-radius: 15px;\n            backdrop-filter: blur(10px);\n        }\n        h1 { color: #fff; text-align: center; margin-bottom: 30px; }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>üöÄ evo security</h1>\n        <p>EVO Cloud\nFor the below we‚Äôre going to add a simple\n Evo Cloud Directory-as-a-Service (DaaS). Unlike the other directory types, an Evo Cloud directory doesn‚Äôt sync users, once the directory is created, you‚Äôll need to add users directly to Evo.\n1. From the left navigation menu, select My Company. Alternatively, select Customers and choose a customer from the list.\n2. From the side navigation, click Directories.\n3. Select the Evo Cloud tab.\n4. Click the Add New Directory\n5. Enter a name for the directory.\n6. Click Create Directory.\nAt this point, users will automatically start to populate into the People section of the Evo portal if you have setup one of the sync options.\n\nStep 3. User Licensing\nOnce you have users syncing and showing up in the People section, the next step is to assign those user licenses. To enable features like MFA, SSO, or Elevated Access, all users must have an Evo license assigned to them. \n1. Expand the below section to see instructions on how to assign licenses to users:\n\n\nAssigning Licenses\n1. On the People screen, select the user(s) using the checkbox on the left.\n2. Click Actions ‚Üí Assign Licenses ‚Üí EVO Standard.\n\n\n1. The license for the user now shows EVO Standard\n\n\n\nStep 4. Converting Users to Admins\nThe next step is to convert users to admins. When you or your technicians need to manage customers, need to have privileges within the Evo portal or use Elevated Access/Shared accounts, their user will need to be converted into an Admin. \nConverting a user to an admin does not give them additional privileges or access. That is configured separately in subsequent steps.\n1. Expand the below section to see instructions on how to convert users to admins:\n\nConverting Users into Evo Admins\n1. Select People from the left navigation menu.\n2. In the displayed list of users, click on the user you want to edit.\n3. Click Convert to Admin.\n\n\n4. Click Yes.\n\nStep 5. Setting Up EVO Portal Admins\nEVO Portal Admins are users that will have administrative access to your EVO MSP portal.\n\nRole-Based Permission Groups\nRole-Based Permissions are permission groups.\n5. Expand the below section to see instructions on how to create a permission group:\n\n\nCreating Role-Based Permission Groups & Assigning Users\n6. From the dashboard, click Access.\n7. Click Role-Based Permissions.\n8. Click Create New Permission Group.\n9. Enter a name for the new group (EVO Admins) for example, and optionally a description.\n\n\n10. Click Next.\n11. Check Select All Roles\n\n\n12. If creating a group for restricted permissions (Technician access for example), you can use the ‚ÄúTechnicians‚Äù example permissions below.\n13. Click Next.\n14. From the list of administrators, check each administrator that should be included in the group.\n15. Click Complete.\n\nExamples of Permissions for technicians that normally preform basic EVO management functions:\n‚Ä¢ Users\n\t‚Ä¢ All\n‚Ä¢ Directories\n\t‚Ä¢ View Directories\n‚Ä¢ Elevated Access\n\t‚Ä¢ Can be Elevated Admin\n‚Ä¢ Keys\n\t‚Ä¢ All\n‚Ä¢ Devices\n\t‚Ä¢ All\n‚Ä¢ Billing\n\t‚Ä¢ All\n‚Ä¢ Customers\n\t‚Ä¢ All\n‚Ä¢ Dashboard\n\t‚Ä¢ All\n\nCustomer Access Permissions\nNow we need to grant access to customers (if any) to your EVO admin users.\n16. Expand the below section to see instructions on how to grant customer permissions to EVO admins:\n\n\nManaging Customer Access\n17. From the dashboard, click Access.\n18. Click Customer Access.\n19. In the displayed list of customers located on the left, find the customer for the restrictions that are to be made. Click the customer‚Äôs name.\n20. From the list of administrators: Changes made are automatically saved.\n21. To grant access: Check the row for each user who should be granted access.\n22. To remove access: Uncheck the row for each user who should no longer be granted access.\n\n\n\nFrom <https://www.sonicwall.com/support/knowledge-base/evo-partner-deployment-guide/240827123540380> \n\nMSS EVO User Guide\n\n\n..</p>\n    </div>\n</body>\n</html>",
      "category": "Documentation",
      "tags": [],
      "created": "2025-08-20T00:52:45.564Z",
      "modified": "2025-08-20T00:54:59.928Z",
      "isPinned": true,
      "isArchived": false,
      "type": "html"
    },
    {
      "id": "note-1755524238196",
      "title": "Evo Security: RMS Technical Document ",
      "content": "Evo Security: RMS Technical Document -    by:  Nishen Harichunder RMS L4            Aug 2025\n\n\nFTRMS Engineer Group Definitions - (Naming conventions & Standards)\n\n\n\n\n\n\n\n\n\n\nEVO User Accounts - Explained\n\n1. Use Evo Cloud User for everyday MSP engineers or operational staff.\n\n2. Use Evo Cloud User (Admin) for MSP administrators who manage the EvoSecurity environment.   - (Restricted to L4 )\n\n3. Use Evo Cloud User (Guest) for temporary or highly restricted access users such as external auditors or clients with minimal interaction rights.\n\n\nChoosing the appropriate user type ensures proper segmentation of duties and adherence to least privilege principles within the EvoSecurity system.\n\n",
      "category": "System Admin",
      "tags": [
        "EvoSecurity",
        "evo",
        "rms doc",
        "msp"
      ],
      "created": "2025-08-18T13:37:18.196Z",
      "modified": "2025-08-18T13:48:16.093Z",
      "isPinned": false,
      "isArchived": false,
      "type": "document"
    },
    {
      "id": "note-1755179491076",
      "title": "Halo and Ncentral Cheats",
      "content": "Halo and Ncentral Cheats\n========================\n\nCreated in Nishen's AI Workspace on 2025/08/14\n\nOverview:\n---------\nDocument description here.\n\nContents:\n---------\n- Section 1\n- Section 2\n- Section 3\n\nNotes:\n------\nAdd your documentation content here.",
      "category": "Documentation",
      "tags": [
        "cheats"
      ],
      "created": "2025-08-14T13:51:31.076Z",
      "modified": "2025-08-14T13:51:31.076Z",
      "isPinned": false,
      "isArchived": false,
      "type": "document"
    },
    {
      "id": "note-1754492581306",
      "title": "Rewst-Enhanced Power Verification Solution<Standby checks -POWER CONFIRMATION ",
      "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Email Summary - Rewst Power Verification</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            line-height: 1.6;\n            color: #333;\n            max-width: 800px;\n            margin: 0 auto;\n            padding: 20px;\n            background: #f9f9f9;\n        }\n        \n        .email-container {\n            background: white;\n            padding: 30px;\n            border-radius: 8px;\n            box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n        }\n        \n        .header {\n            text-align: center;\n            margin-bottom: 30px;\n            padding-bottom: 15px;\n            border-bottom: 2px solid #3498db;\n        }\n        \n        .header h1 {\n            color: #2c3e50;\n            margin: 0;\n            font-size: 1.8em;\n        }\n        \n        .header p {\n            color: #7f8c8d;\n            margin: 5px 0 0 0;\n            font-style: italic;\n        }\n        \n        .executive-summary {\n            background: linear-gradient(135deg, #3498db, #2980b9);\n            color: white;\n            padding: 20px;\n            border-radius: 8px;\n            margin: 20px 0;\n            text-align: center;\n        }\n        \n        .key-benefits {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));\n            gap: 15px;\n            margin: 20px 0;\n        }\n        \n        .benefit-card {\n            background: #e8f4fd;\n            border: 1px solid #bee5eb;\n            border-radius: 6px;\n            padding: 15px;\n            text-align: center;\n        }\n        \n        .benefit-number {\n            font-size: 2em;\n            font-weight: bold;\n            color: #e74c3c;\n            margin-bottom: 5px;\n        }\n        \n        .benefit-text {\n            font-size: 0.9em;\n            color: #2c3e50;\n        }\n        \n        .flowchart {\n            background: #f8f9fa;\n            border: 2px solid #dee2e6;\n            border-radius: 10px;\n            padding: 20px;\n            margin: 25px 0;\n            text-align: center;\n        }\n        \n        .flow-step {\n            display: inline-block;\n            background: #fff;\n            border: 2px solid #3498db;\n            border-radius: 8px;\n            padding: 12px;\n            margin: 8px;\n            min-width: 120px;\n            font-size: 0.9em;\n            vertical-align: top;\n        }\n        \n        .flow-trigger {\n            background: linear-gradient(135deg, #e74c3c, #c0392b);\n            color: white;\n            border-color: #c0392b;\n        }\n        \n        .flow-process {\n            background: linear-gradient(135deg, #9b59b6, #8e44ad);\n            color: white;\n            border-color: #8e44ad;\n        }\n        \n        .flow-decision {\n            background: linear-gradient(135deg, #f39c12, #e67e22);\n            color: white;\n            border-color: #e67e22;\n            border-radius: 50px;\n            width: 140px;\n            height: 80px;\n            display: inline-flex;\n            align-items: center;\n            justify-content: center;\n            text-align: center;\n        }\n        \n        .flow-outcome-a {\n            background: linear-gradient(135deg, #e74c3c, #c0392b);\n            color: white;\n            border-color: #c0392b;\n        }\n        \n        .flow-outcome-b {\n            background: linear-gradient(135deg, #27ae60, #229954);\n            color: white;\n            border-color: #229954;\n        }\n        \n        .flow-arrow {\n            font-size: 20px;\n            color: #3498db;\n            margin: 0 5px;\n        }\n        \n        .comparison-table {\n            width: 100%;\n            border-collapse: collapse;\n            margin: 20px 0;\n            font-size: 0.9em;\n        }\n        \n        .comparison-table th,\n        .comparison-table td {\n            padding: 10px;\n            border: 1px solid #ddd;\n            text-align: left;\n        }\n        \n        .comparison-table th {\n            background: #3498db;\n            color: white;\n        }\n        \n        .comparison-table tr:nth-child(even) {\n            background: #f8f9fa;\n        }\n        \n        .current-problem {\n            background: #fff5f5;\n            border-left: 4px solid #e74c3c;\n            padding: 15px;\n            margin: 15px 0;\n        }\n        \n        .proposed-solution {\n            background: #f0fff4;\n            border-left: 4px solid #27ae60;\n            padding: 15px;\n            margin: 15px 0;\n        }\n        \n        .timeline {\n            background: #f8f9fa;\n            border-radius: 8px;\n            padding: 15px;\n            margin: 20px 0;\n        }\n        \n        .timeline-item {\n            display: flex;\n            align-items: center;\n            margin: 10px 0;\n            padding: 8px;\n            background: white;\n            border-radius: 5px;\n        }\n        \n        .timeline-day {\n            background: #3498db;\n            color: white;\n            border-radius: 50%;\n            width: 35px;\n            height: 35px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            margin-right: 15px;\n            font-weight: bold;\n            font-size: 0.8em;\n        }\n        \n        .roi-highlight {\n            background: linear-gradient(135deg, #2ecc71, #27ae60);\n            color: white;\n            padding: 20px;\n            border-radius: 8px;\n            text-align: center;\n            margin: 20px 0;\n        }\n        \n        .action-required {\n            background: #fff3cd;\n            border: 1px solid #ffc107;\n            border-radius: 6px;\n            padding: 15px;\n            margin: 20px 0;\n        }\n        \n        .signature {\n            margin-top: 30px;\n            padding-top: 15px;\n            border-top: 1px solid #dee2e6;\n            font-size: 0.9em;\n            color: #6c757d;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"email-container\">\n        <div class=\"header\">\n            <h1>üöÄ Automated Power Verification Solution</h1>\n            <p>Rewst-Enhanced Implementation | FTech KZN | August 2025</p>\n        </div>\n\n        <div class=\"executive-summary\">\n            <h3 style=\"margin-top: 0;\">Executive Summary</h3>\n            <p>Transform FTech's incident response from manual customer inquiries to intelligent, automated service delivery. Eliminate \"Do you have power?\" calls and provide proactive customer communication.</p>\n        </div>\n\n        <h3>üìä Key Benefits & ROI</h3>\n        <div class=\"key-benefits\">\n            <div class=\"benefit-card\">\n                <div class=\"benefit-number\">80%</div>\n                <div class=\"benefit-text\">Reduction in Customer<br>Power Inquiries</div>\n            </div>\n            <div class=\"benefit-card\">\n                <div class=\"benefit-number\">40%</div>\n                <div class=\"benefit-text\">Faster Mean Time<br>to Resolution</div>\n            </div>\n            <div class=\"benefit-card\">\n                <div class=\"benefit-number\">90%</div>\n                <div class=\"benefit-text\">Automated Ticket<br>Enrichment Rate</div>\n            </div>\n            <div class=\"benefit-card\">\n                <div class=\"benefit-number\">10</div>\n                <div class=\"benefit-text\">Days Implementation<br>Timeline</div>\n            </div>\n        </div>\n\n        <h3>üîÑ Complete Workflow Process</h3>\n        <div class=\"flowchart\">\n            <!-- Row 1: Trigger -->\n            <div style=\"margin: 15px 0;\">\n                <div class=\"flow-step flow-trigger\">\n                    <strong>üö® SERVER OFFLINE</strong><br>\n                    N-Central Alert<br>\n                    \"OfflineDevice Rule\"\n                </div>\n            </div>\n            \n            <div class=\"flow-arrow\">‚¨áÔ∏è</div>\n            \n            <!-- Row 2: Processing -->\n            <div style=\"margin: 15px 0;\">\n                <div class=\"flow-step flow-process\">\n                    <strong>üîç REWST WORKFLOW</strong><br>\n                    Automated Correlation<br>\n                    Multi-Source Analysis\n                </div>\n            </div>\n            \n            <div class=\"flow-arrow\">‚¨áÔ∏è</div>\n            \n            <!-- Row 3: Data Collection -->\n            <div style=\"margin: 15px 0;\">\n                <div class=\"flow-step\" style=\"background: #ecf0f1; border-color: #bdc3c7;\">\n                    <strong>N-Central</strong><br>\n                    Site Devices<br>\n                    OOB Status\n                </div>\n                \n                <div class=\"flow-step\" style=\"background: #ecf0f1; border-color: #bdc3c7;\">\n                    <strong>NMSaaS</strong><br>\n                    APs, Switches<br>\n                    Firewall, Router\n                </div>\n                \n                <div class=\"flow-step\" style=\"background: #ecf0f1; border-color: #bdc3c7;\">\n                    <strong>WAN Links</strong><br>\n                    Primary Link<br>\n                    Failover Status\n                </div>\n            </div>\n            \n            <div class=\"flow-arrow\">‚¨áÔ∏è</div>\n            \n            <!-- Row 4: Decision -->\n            <div style=\"margin: 20px 0;\">\n                <div class=\"flow-decision\">\n                    <strong>‚ö° POWER<br>STATUS<br>DECISION</strong>\n                </div>\n            </div>\n            \n            <div style=\"margin: 10px 0;\">\n                <span class=\"flow-arrow\">‚¨áÔ∏è</span>\n                <span style=\"margin: 0 80px;\"></span>\n                <span class=\"flow-arrow\">‚¨áÔ∏è</span>\n            </div>\n            \n            <!-- Row 5: Outcomes -->\n            <div style=\"margin: 15px 0;\">\n                <div class=\"flow-step flow-outcome-a\" style=\"display: inline-block; margin: 0 20px;\">\n                    <strong>üî¥ OUTCOME A</strong><br>\n                    POWER OUTAGE<br>\n                    <small>Confidence &lt;50%</small><br><br>\n                    \n                    <div style=\"font-size: 0.8em; margin-top: 8px;\">\n                        ‚Ä¢ Critical Priority<br>\n                        ‚Ä¢ Utility Engagement<br>\n                        ‚Ä¢ Proactive Customer SMS\n                    </div>\n                </div>\n                \n                <div class=\"flow-step flow-outcome-b\" style=\"display: inline-block; margin: 0 20px;\">\n                    <strong>üü¢ OUTCOME B</strong><br>\n                    DEVICE ISSUE<br>\n                    <small>Confidence ‚â•80%</small><br><br>\n                    \n                    <div style=\"font-size: 0.8em; margin-top: 8px;\">\n                        ‚Ä¢ Medium Priority<br>\n                        ‚Ä¢ Hardware Investigation<br>\n                        ‚Ä¢ Technical Update Email\n                    </div>\n                </div>\n            </div>\n            \n            <div style=\"background: #d5f4e6; padding: 10px; border-radius: 5px; margin-top: 20px; border: 2px solid #27ae60;\">\n                <strong>‚úÖ RESULT: Zero manual verification + Proactive customer communication</strong>\n            </div>\n        </div>\n\n        <h3>üìã Current vs Future State</h3>\n        <table class=\"comparison-table\">\n            <tr>\n                <th>Process</th>\n                <th>Current State ‚ùå</th>\n                <th>Future State ‚úÖ</th>\n            </tr>\n            <tr>\n                <td><strong>Power Verification</strong></td>\n                <td>Manual customer calls</td>\n                <td>Automated multi-source correlation</td>\n            </tr>\n            <tr>\n                <td><strong>Data Collection</strong></td>\n                <td>Manual NMSaaS login checks</td>\n                <td>Parallel API queries (5 seconds)</td>\n            </tr>\n            <tr>\n                <td><strong>Ticket Creation</strong></td>\n                <td>Basic alerts, no context</td>\n                <td>Enriched tickets with full analysis</td>\n            </tr>\n            <tr>\n                <td><strong>Customer Communication</strong></td>\n                <td>\"Do you have power?\"</td>\n                <td>\"We've detected a power outage\"</td>\n            </tr>\n            <tr>\n                <td><strong>Response Time</strong></td>\n                <td>15+ minutes investigation</td>\n                <td>Immediate intelligent response</td>\n            </tr>\n        </table>\n\n        <h3>üí∞ Why Rewst Changes Everything</h3>\n        <div class=\"current-problem\">\n            <h4>‚ùå Without Rewst (Original 4-Week Plan):</h4>\n            <ul>\n                <li>Custom PowerShell service development required</li>\n                <li>Manual Windows service management and maintenance</li>\n                <li>Basic error handling and single-threaded processing</li>\n                <li>Limited visibility into workflow execution</li>\n            </ul>\n        </div>\n\n        <div class=\"proposed-solution\">\n            <h4>‚úÖ With Rewst Integration (10-Day Implementation):</h4>\n            <ul>\n                <li><strong>75% faster implementation</strong> - Visual workflow builder, no coding</li>\n                <li><strong>Enterprise reliability</strong> - 99.9% uptime SLA, advanced error handling</li>\n                <li><strong>Real-time monitoring</strong> - Live dashboards, performance analytics</li>\n                <li><strong>Parallel processing</strong> - Sub-10 second correlation vs 30+ seconds</li>\n            </ul>\n        </div>\n\n        <h3>üìÖ Implementation Timeline</h3>\n        <div class=\"timeline\">\n            <div class=\"timeline-item\">\n                <div class=\"timeline-day\">1-2</div>\n                <div><strong>Foundation Setup:</strong> API validation, Rewst access, site inventory</div>\n            </div>\n            <div class=\"timeline-item\">\n                <div class=\"timeline-day\">3-6</div>\n                <div><strong>Workflow Development:</strong> Visual workflow creation, data correlation logic</div>\n            </div>\n            <div class=\"timeline-item\">\n                <div class=\"timeline-day\">7-8</div>\n                <div><strong>Testing & Validation:</strong> End-to-end testing, pilot customer validation</div>\n            </div>\n            <div class=\"timeline-item\">\n                <div class=\"timeline-day\">9-10</div>\n                <div><strong>Go-Live & Training:</strong> Production deployment, staff training</div>\n            </div>\n        </div>\n\n        <div class=\"roi-highlight\">\n            <h3 style=\"margin-top: 0;\">üéØ Strategic Impact</h3>\n            <p><strong>This transforms FTech from reactive support to proactive service delivery, establishing us as the premier MSP in the region through intelligent automation and superior customer experience.</strong></p>\n        </div>\n\n        <h3>‚ö° Technical Requirements</h3>\n        <ul>\n            <li><strong>‚úÖ Rewst Platform:</strong> Already integrated with N-Central and HaloPSA</li>\n            <li><strong>‚úÖ API Access:</strong> Existing N-Central and HaloPSA API credentials</li>\n            <li><strong>üîß NMSaaS Integration:</strong> API access validation required</li>\n            <li><strong>üìã Configuration:</strong> Alert rules, webhook setup, ticket templates</li>\n        </ul>\n\n        <div class=\"action-required\">\n            <h4>üöÄ Action Required - Management Decision</h4>\n            <p><strong>Recommendation:</strong> Proceed with immediate implementation to capitalize on Rewst's existing integration and achieve rapid ROI.</p>\n            \n            <p><strong>Next Steps:</strong></p>\n            <ul>\n                <li>Management approval to proceed</li>\n                <li>Project team assignment (Technical Lead, Platform Admins)</li>\n                <li>Pilot customer site selection</li>\n                <li>Implementation start date confirmation</li>\n            </ul>\n            \n            <p><strong>Expected Go-Live:</strong> End of August 2025</p>\n        </div>\n\n        <h3>üìä Success Metrics (30 Days Post-Implementation)</h3>\n        <ul>\n            <li><strong>Zero</strong> manual power verification customer calls</li>\n            <li><strong>90%+</strong> automated ticket enrichment rate</li>\n            <li><strong>40%</strong> reduction in mean time to resolution</li>\n            <li><strong>25%</strong> improvement in customer satisfaction scores</li>\n            <li><strong>&lt;5%</strong> false positive rate</li>\n        </ul>\n\n        <div style=\"background: linear-gradient(135deg, #3498db, #2980b9); color: white; padding: 20px; border-radius: 8px; text-align: center; margin: 25px 0;\">\n            <h4 style=\"margin-top: 0;\">üí° Bottom Line</h4>\n            <p style=\"margin-bottom: 0; font-size: 1.1em;\">\n                <strong>With Rewst already integrated, this solution delivers enterprise-grade automation in 10 days instead of 4+ weeks, transforming customer experience while reducing operational overhead.</strong>\n            </p>\n        </div>\n\n        <div class=\"signature\">\n            <p><strong>Prepared by:</strong> Senior Systems Engineer<br>\n            <strong>For:</strong> RMS - First Technology KZN<br>\n            <strong>Project Sponsor:</strong> Nishen Harichunder<br>\n            <strong>Date:</strong> August 2025</p>\n        </div>\n    </div>\n</body>\n</html>",
      "category": "Documentation",
      "tags": [],
      "created": "2025-08-06T15:03:01.306Z",
      "modified": "2025-08-06T15:04:51.949Z",
      "isPinned": false,
      "isArchived": false,
      "type": "html"
    },
    {
      "id": "note-1754479735446",
      "title": "Rewst-Enhanced Power Verification Solution<Standby checks -POWER CONFIRMATION ",
      "content": "\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Rewst-Enhanced Power Verification Solution</title>\n    <style>\n        body {\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n            line-height: 1.6;\n            color: #333;\n            max-width: 1200px;\n            margin: 0 auto;\n            padding: 20px;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            min-height: 100vh;\n        }\n        \n        .container {\n            background: white;\n            border-radius: 15px;\n            padding: 30px;\n            box-shadow: 0 20px 40px rgba(0,0,0,0.1);\n        }\n        \n        h1 {\n            color: #2c3e50;\n            text-align: center;\n            margin-bottom: 30px;\n            font-size: 2.5em;\n            background: linear-gradient(45deg, #3498db, #2ecc71);\n            -webkit-background-clip: text;\n            -webkit-text-fill-color: transparent;\n        }\n        \n        h2 {\n            color: #34495e;\n            border-bottom: 3px solid #3498db;\n            padding-bottom: 10px;\n            margin-top: 40px;\n        }\n        \n        .comparison-grid {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 30px;\n            margin: 30px 0;\n        }\n        \n        .before-box {\n            background: #fff5f5;\n            border: 2px solid #e74c3c;\n            border-radius: 10px;\n            padding: 20px;\n        }\n        \n        .after-box {\n            background: #f0fff4;\n            border: 2px solid #27ae60;\n            border-radius: 10px;\n            padding: 20px;\n        }\n        \n        .box-header {\n            font-weight: bold;\n            font-size: 1.2em;\n            margin-bottom: 15px;\n            text-align: center;\n        }\n        \n        .before-header {\n            color: #e74c3c;\n        }\n        \n        .after-header {\n            color: #27ae60;\n        }\n        \n        .workflow-section {\n            background: #f8f9fa;\n            border: 2px solid #e9ecef;\n            border-radius: 15px;\n            padding: 30px;\n            margin: 30px 0;\n        }\n        \n        .rewst-workflow {\n            background: linear-gradient(135deg, #6c5ce7, #a29bfe);\n            color: white;\n            padding: 20px;\n            border-radius: 10px;\n            margin: 20px 0;\n            text-align: center;\n        }\n        \n        .workflow-step {\n            background: white;\n            border: 1px solid #ddd;\n            border-radius: 8px;\n            padding: 15px;\n            margin: 15px 0;\n            display: flex;\n            align-items: center;\n        }\n        \n        .step-number {\n            background: #3498db;\n            color: white;\n            border-radius: 50%;\n            width: 30px;\n            height: 30px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            margin-right: 15px;\n            font-weight: bold;\n        }\n        \n        .advantage-card {\n            background: #e8f5e8;\n            border-left: 4px solid #27ae60;\n            padding: 15px;\n            margin: 15px 0;\n            border-radius: 5px;\n        }\n        \n        .implementation-table {\n            width: 100%;\n            border-collapse: collapse;\n            margin: 20px 0;\n        }\n        \n        .implementation-table th,\n        .implementation-table td {\n            border: 1px solid #ddd;\n            padding: 12px;\n            text-align: left;\n        }\n        \n        .implementation-table th {\n            background: #3498db;\n            color: white;\n        }\n        \n        .implementation-table tr:nth-child(even) {\n            background: #f2f2f2;\n        }\n        \n        .code-block {\n            background: #2d3748;\n            color: #e2e8f0;\n            padding: 20px;\n            border-radius: 8px;\n            overflow-x: auto;\n            font-family: 'Courier New', monospace;\n            margin: 15px 0;\n        }\n        \n        .highlight {\n            background: #fff3cd;\n            padding: 2px 6px;\n            border-radius: 4px;\n            font-weight: bold;\n        }\n        \n        .warning-box {\n            background: #fff3cd;\n            border: 1px solid #ffeaa7;\n            border-radius: 6px;\n            padding: 15px;\n            margin: 15px 0;\n            border-left: 4px solid #ffc107;\n        }\n        \n        .info-box {\n            background: #d1ecf1;\n            border: 1px solid #bee5eb;\n            border-radius: 6px;\n            padding: 15px;\n            margin: 15px 0;\n            border-left: 4px solid #17a2b8;\n        }\n        \n        .metric-improvement {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n            gap: 20px;\n            margin: 30px 0;\n        }\n        \n        .metric-card {\n            background: linear-gradient(135deg, #74b9ff, #0984e3);\n            color: white;\n            padding: 20px;\n            border-radius: 10px;\n            text-align: center;\n        }\n        \n        .metric-number {\n            font-size: 2em;\n            font-weight: bold;\n            margin-bottom: 5px;\n        }\n        \n        .architecture-diagram {\n            background: #f8f9fa;\n            border: 2px dashed #6c757d;\n            border-radius: 10px;\n            padding: 20px;\n            text-align: center;\n            margin: 20px 0;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>üöÄ Rewst-Enhanced Power Verification Solution</h1>\n        \n        <div class=\"info-box\">\n            <strong>üéØ Game Changer:</strong> With Rewst already integrated to N-Central and HaloPSA APIs, this solution transforms from a custom PowerShell implementation to a robust, enterprise-grade automation platform with advanced workflow capabilities, error handling, and scalability.\n        </div>\n\n        <h2>üìà How Rewst Transforms the Solution</h2>\n\n        <div class=\"comparison-grid\">\n            <div class=\"before-box\">\n                <div class=\"box-header before-header\">‚ùå Without Rewst (Original Plan)</div>\n                <ul>\n                    <li>Custom PowerShell service development</li>\n                    <li>Manual Windows service management</li>\n                    <li>Basic error handling</li>\n                    <li>Limited workflow visualization</li>\n                    <li>Monitoring via logs only</li>\n                    <li>Single-threaded processing</li>\n                    <li>4+ weeks development time</li>\n                </ul>\n            </div>\n            \n            <div class=\"after-box\">\n                <div class=\"box-header after-header\">‚úÖ With Rewst Integration</div>\n                <ul>\n                    <li>Visual workflow builder - no coding required</li>\n                    <li>Enterprise-grade automation platform</li>\n                    <li>Advanced error handling & retry logic</li>\n                    <li>Real-time workflow monitoring</li>\n                    <li>Built-in alerting and notifications</li>\n                    <li>Parallel processing capabilities</li>\n                    <li>1-2 weeks implementation time</li>\n                </ul>\n            </div>\n        </div>\n\n        <h2>üîß Rewst-Enhanced Architecture</h2>\n\n        <div class=\"architecture-diagram\">\n            <h3>Streamlined Integration Flow</h3>\n            \n            <div style=\"display: flex; justify-content: space-around; align-items: center; flex-wrap: wrap; gap: 20px; margin: 30px 0;\">\n                <div style=\"background: #3498db; color: white; padding: 15px; border-radius: 8px; min-width: 150px;\">\n                    <strong>N-Central Alert</strong><br>\n                    Device Offline<br>\n                    Webhook Trigger\n                </div>\n                \n                <div style=\"font-size: 28px; color: #e74c3c;\">‚û°Ô∏è</div>\n                \n                <div style=\"background: #6c5ce7; color: white; padding: 15px; border-radius: 8px; min-width: 150px;\">\n                    <strong>Rewst Workflow</strong><br>\n                    Automated Correlation<br>\n                    Decision Engine\n                </div>\n                \n                <div style=\"font-size: 28px; color: #e74c3c;\">‚û°Ô∏è</div>\n                \n                <div style=\"background: #27ae60; color: white; padding: 15px; border-radius: 8px; min-width: 150px;\">\n                    <strong>HaloPSA Ticket</strong><br>\n                    Enriched Context<br>\n                    Automated Priority\n                </div>\n            </div>\n        </div>\n\n        <h2>üéØ Enhanced Workflow with Rewst</h2>\n\n        <div class=\"rewst-workflow\">\n            <h3 style=\"margin-top: 0;\">‚ö° Rewst Automation Workflow</h3>\n            <p>Visual, drag-and-drop workflow builder with enterprise capabilities</p>\n        </div>\n\n        <div class=\"workflow-section\">\n            <h4 style=\"color: #2c3e50; margin-top: 0;\">Complete Rewst Workflow Steps:</h4>\n            \n            <div class=\"workflow-step\">\n                <div class=\"step-number\">1</div>\n                <div>\n                    <strong>Webhook Trigger:</strong> N-Central sends OfflineDevice alert to Rewst webhook endpoint\n                    <br><em>Advantage: Instant triggering, no polling delays</em>\n                </div>\n            </div>\n            \n            <div class=\"workflow-step\">\n                <div class=\"step-number\">2</div>\n                <div>\n                    <strong>Parallel Data Collection:</strong> Rewst simultaneously queries multiple sources\n                    <br><em>‚Ä¢ N-Central API: Site devices, OOB status, connectivity</em>\n                    <br><em>‚Ä¢ NMSaaS API: APs, switches, firewalls, routers</em>\n                    <br><em>‚Ä¢ External checks: ISP gateways, DNS servers</em>\n                </div>\n            </div>\n            \n            <div class=\"workflow-step\">\n                <div class=\"step-number\">3</div>\n                <div>\n                    <strong>Intelligent Decision Engine:</strong> Built-in logic evaluates all data points\n                    <br><em>Advantage: Visual decision trees, easy to modify thresholds</em>\n                </div>\n            </div>\n            \n            <div class=\"workflow-step\">\n                <div class=\"step-number\">4</div>\n                <div>\n                    <strong>Dynamic Ticket Creation:</strong> HaloPSA API creates contextual tickets\n                    <br><em>Advantage: Template-based, consistent formatting, automatic field population</em>\n                </div>\n            </div>\n            \n            <div class=\"workflow-step\">\n                <div class=\"step-number\">5</div>\n                <div>\n                    <strong>Multi-Channel Notifications:</strong> Customer and team communication\n                    <br><em>Advantage: Email, SMS, Teams, Slack - all configurable</em>\n                </div>\n            </div>\n            \n            <div class=\"workflow-step\">\n                <div class=\"step-number\">6</div>\n                <div>\n                    <strong>Monitoring & Reporting:</strong> Real-time workflow execution tracking\n                    <br><em>Advantage: Built-in dashboards, success/failure metrics, performance analytics</em>\n                </div>\n            </div>\n        </div>\n\n        <h2>üíé Key Advantages with Rewst</h2>\n\n        <div class=\"advantage-card\">\n            <h4>üé® Visual Workflow Builder</h4>\n            <p>No PowerShell coding required. Drag-and-drop workflow creation with visual decision trees, making it easy to modify logic and add new data sources.</p>\n        </div>\n\n        <div class=\"advantage-card\">\n            <h4>üîÑ Advanced Error Handling</h4>\n            <p>Built-in retry logic, error branching, and fallback procedures. If one API is down, workflow continues with available data sources.</p>\n        </div>\n\n        <div class=\"advantage-card\">\n            <h4>‚ö° Parallel Processing</h4>\n            <p>Simultaneous API calls reduce correlation time from 30+ seconds to under 5 seconds. Multiple site checks can run concurrently.</p>\n        </div>\n\n        <div class=\"advantage-card\">\n            <h4>üìä Real-time Monitoring</h4>\n            <p>Live workflow execution monitoring, success/failure tracking, performance metrics, and detailed audit trails for compliance.</p>\n        </div>\n\n        <div class=\"advantage-card\">\n            <h4>üîß Template Management</h4>\n            <p>Standardized ticket templates, customer communication templates, and easy customization for different customer types or SLA levels.</p>\n        </div>\n\n        <div class=\"advantage-card\">\n            <h4>üìà Scalability</h4>\n            <p>Handle hundreds of concurrent alerts, auto-scaling, and enterprise-grade reliability with built-in high availability.</p>\n        </div>\n\n        <h2>üìä Improved Metrics with Rewst</h2>\n\n        <div class=\"metric-improvement\">\n            <div class=\"metric-card\">\n                <div class=\"metric-number\">90%</div>\n                <div>Faster Implementation<br>(1-2 weeks vs 4+ weeks)</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-number\">5 sec</div>\n                <div>Correlation Time<br>(vs 30+ seconds)</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-number\">99.9%</div>\n                <div>Reliability<br>Enterprise Platform</div>\n            </div>\n            <div class=\"metric-card\">\n                <div class=\"metric-number\">100%</div>\n                <div>Workflow Visibility<br>Real-time Monitoring</div>\n            </div>\n        </div>\n\n        <h2>üõ†Ô∏è Implementation Comparison</h2>\n\n        <table class=\"implementation-table\">\n            <tr>\n                <th>Aspect</th>\n                <th>PowerShell Solution</th>\n                <th>Rewst Solution</th>\n                <th>Improvement</th>\n            </tr>\n            <tr>\n                <td><strong>Development Time</strong></td>\n                <td>4+ weeks coding</td>\n                <td>1-2 weeks configuration</td>\n                <td>75% time reduction</td>\n            </tr>\n            <tr>\n                <td><strong>Error Handling</strong></td>\n                <td>Basic try/catch</td>\n                <td>Enterprise-grade retry/fallback</td>\n                <td>Robust failure recovery</td>\n            </tr>\n            <tr>\n                <td><strong>Monitoring</strong></td>\n                <td>Log file analysis</td>\n                <td>Real-time dashboards</td>\n                <td>Live visibility</td>\n            </tr>\n            <tr>\n                <td><strong>Scalability</strong></td>\n                <td>Single-threaded processing</td>\n                <td>Parallel multi-threading</td>\n                <td>10x performance improvement</td>\n            </tr>\n            <tr>\n                <td><strong>Maintenance</strong></td>\n                <td>Code updates required</td>\n                <td>Visual workflow updates</td>\n                <td>No technical skills needed</td>\n            </tr>\n            <tr>\n                <td><strong>Reliability</strong></td>\n                <td>Custom service dependency</td>\n                <td>Enterprise platform SLA</td>\n                <td>99.9% uptime guarantee</td>\n            </tr>\n        </table>\n\n        <h2>üîß Rewst Workflow Configuration</h2>\n\n        <div class=\"code-block\">\n# Rewst Workflow Components (Visual Configuration, No Coding Required)\n\n## Trigger Configuration\n- Webhook URL: https://rewst.ftechkzn.co.za/webhooks/power-verification\n- Source: N-Central OfflineDevice alerts\n- Authentication: API key validation\n\n## Data Collection (Parallel Actions)\nAction 1: N-Central Site Query\n  ‚îú‚îÄ‚îÄ Get site devices status\n  ‚îú‚îÄ‚îÄ Check OOB device connectivity  \n  ‚îî‚îÄ‚îÄ Verify other servers online\n\nAction 2: NMSaaS Network Check\n  ‚îú‚îÄ‚îÄ Query AP status\n  ‚îú‚îÄ‚îÄ Check switch connectivity\n  ‚îú‚îÄ‚îÄ Validate firewall status\n  ‚îî‚îÄ‚îÄ Test router reachability\n\nAction 3: External Validation\n  ‚îú‚îÄ‚îÄ ISP gateway ping\n  ‚îú‚îÄ‚îÄ DNS resolution tests\n  ‚îî‚îÄ‚îÄ Cloud service connectivity\n\n## Decision Engine (Visual Logic Tree)\nIF (Confidence Score >= 80):\n  ‚îî‚îÄ‚îÄ Branch to \"Device Issue\" workflow\nELSE IF (Confidence Score < 50):\n  ‚îî‚îÄ‚îÄ Branch to \"Power Outage\" workflow  \nELSE:\n  ‚îî‚îÄ‚îÄ Branch to \"Manual Review\" workflow\n\n## Output Actions\n- HaloPSA ticket creation with templates\n- Customer notification (email/SMS)\n- Team alert (Slack/Teams)\n- Dashboard metric updates\n        </div>\n\n        <h2>üéØ Enhanced Business Benefits</h2>\n\n        <div class=\"info-box\">\n            <h4>üí∞ Additional ROI with Rewst:</h4>\n            <ul>\n                <li><strong>Faster Time to Market:</strong> 75% reduction in development time</li>\n                <li><strong>Reduced Technical Debt:</strong> No custom code to maintain</li>\n                <li><strong>Enhanced Reliability:</strong> Enterprise-grade platform with SLA</li>\n                <li><strong>Future Extensibility:</strong> Easy to add new integrations and workflows</li>\n                <li><strong>Compliance Ready:</strong> Built-in audit trails and reporting</li>\n                <li><strong>Team Efficiency:</strong> Non-technical staff can modify workflows</li>\n            </ul>\n        </div>\n\n        <h2>üöÄ Recommended Implementation Strategy</h2>\n\n        <div class=\"workflow-section\">\n            <h4>Week 1: Rewst Workflow Design</h4>\n            <ul>\n                <li>Configure N-Central webhook triggers</li>\n                <li>Design visual workflow in Rewst platform</li>\n                <li>Set up parallel data collection actions</li>\n                <li>Create decision logic and confidence scoring</li>\n            </ul>\n            \n            <h4>Week 2: Integration & Testing</h4>\n            <ul>\n                <li>Connect HaloPSA ticket creation templates</li>\n                <li>Configure customer notification channels</li>\n                <li>Set up monitoring dashboards</li>\n                <li>Pilot test with selected customer sites</li>\n            </ul>\n        </div>\n\n        <div class=\"warning-box\">\n            <h4>‚ö° Strategic Recommendation:</h4>\n            <p><strong>Leverage Rewst immediately!</strong> Since APIs are already integrated, you can build this solution 75% faster with enterprise-grade reliability, visual workflows, and real-time monitoring. This transforms the project from a development effort to a configuration task, dramatically reducing risk and time to value.</p>\n        </div>\n\n        <div style=\"background: linear-gradient(135deg, #2ecc71, #27ae60); color: white; padding: 25px; border-radius: 10px; text-align: center; margin: 30px 0;\">\n            <h3 style=\"margin-top: 0;\">üéØ Bottom Line Impact</h3>\n            <p style=\"font-size: 1.1em; margin-bottom: 0;\">\n                With Rewst, this solution goes from a \"4-week development project\" to a \"1-2 week configuration task\" with enterprise-grade capabilities, dramatically improving ROI and reducing implementation risk.\n            </p>\n        </div>\n    </div>\n</body>\n</html>",
      "category": "Development",
      "tags": [],
      "created": "2025-08-06T11:28:55.446Z",
      "modified": "2025-08-06T11:31:27.967Z",
      "isPinned": false,
      "isArchived": false,
      "type": "html"
    },
    {
      "id": "note-1",
      "title": "PowerShell Best Practices",
      "content": "# PowerShell Best Practices for System Administration\n\n## Key Guidelines:\n- Always use approved verbs (Get-, Set-, New-, Remove-)\n- Use proper error handling with try/catch blocks\n- Implement parameter validation\n- Use Write-Output instead of Write-Host for data\n- Always test scripts in development environment first\n\n## Security Considerations:\n- Use execution policies appropriately\n- Avoid hardcoded credentials\n- Implement proper logging\n- Use constrained endpoints when possible\n\n## Performance Tips:\n- Use pipeline efficiently\n- Avoid unnecessary object creation\n- Filter left, format right\n- Use specific property selection",
      "category": "System Admin",
      "tags": [
        "powershell",
        "best-practices",
        "security"
      ],
      "created": "2025-06-15T00:00:00.000Z",
      "modified": "2025-06-30T00:00:00.000Z",
      "isPinned": true,
      "isArchived": false,
      "type": "markdown"
    },
    {
      "id": "note-2",
      "title": "Next.js 14 Project Setup",
      "content": "# Next.js 14 Project Setup Notes\n\n## Installation:\n```bash\nnpx create-next-app@latest my-app\ncd my-app\nnpm run dev\n```\n\n## Key Features in v14:\n- App Router (stable)\n- Server Components by default\n- Improved TypeScript support\n- Turbopack (beta)\n\n## Essential Dependencies:\n- tailwindcss\n- @types/node\n- lucide-react for icons\n\n## Configuration Tips:\n- Use exact versions to avoid compatibility issues\n- Configure tailwind.config.ts for custom colors\n- Set up proper ESLint rules",
      "category": "Development",
      "tags": [
        "nextjs",
        "react",
        "setup"
      ],
      "created": "2025-06-20T00:00:00.000Z",
      "modified": "2025-06-28T00:00:00.000Z",
      "isPinned": false,
      "isArchived": false,
      "type": "markdown"
    },
    {
      "id": "note-3",
      "title": "Workspace Color Scheme",
      "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Nishen's AI Workspace Color Palette</title>\n    <style>\n        body {\n            font-family: Arial, sans-serif;\n            margin: 0;\n            padding: 20px;\n            background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);\n            color: white;\n            min-height: 100vh;\n        }\n        .container {\n            max-width: 800px;\n            margin: 0 auto;\n            background: rgba(255, 255, 255, 0.1);\n            padding: 30px;\n            border-radius: 15px;\n            backdrop-filter: blur(10px);\n        }\n        .color-swatch {\n            display: flex;\n            align-items: center;\n            margin: 10px 0;\n            padding: 10px;\n            border-radius: 8px;\n            background: rgba(255, 255, 255, 0.1);\n        }\n        .color-box {\n            width: 50px;\n            height: 50px;\n            border-radius: 8px;\n            margin-right: 15px;\n            border: 2px solid rgba(255, 255, 255, 0.3);\n        }\n        .neon-red { background: #ff073a; }\n        .burnt-orange { background: #cc5500; }\n        .british-silver { background: #8B9499; }\n        .neon-green { background: #00CC33; }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <h1>üé® Nishen's AI Workspace Color Palette</h1>\n        \n        <div class=\"color-swatch\">\n            <div class=\"color-box neon-red\"></div>\n            <div>\n                <strong>Neon Red</strong> - #ff073a<br>\n                <small>Primary actions, highlights, active states</small>\n            </div>\n        </div>\n        \n        <div class=\"color-swatch\">\n            <div class=\"color-box burnt-orange\"></div>\n            <div>\n                <strong>Burnt Orange</strong> - #cc5500<br>\n                <small>Secondary actions, accents, hover states</small>\n            </div>\n        </div>\n        \n        <div class=\"color-swatch\">\n            <div class=\"color-box british-silver\"></div>\n            <div>\n                <strong>British Silver</strong> - #8B9499<br>\n                <small>Professional silver theme, neutral accents</small>\n            </div>\n        </div>\n        \n        <div class=\"color-swatch\">\n            <div class=\"color-box neon-green\"></div>\n            <div>\n                <strong>Neon Green</strong> - #00CC33<br>\n                <small>Success states, accent green theme</small>\n            </div>\n        </div>\n        \n        <h2>üéØ Usage Guidelines</h2>\n        <ul>\n            <li>Use neon red for primary CTAs and active states</li>\n            <li>Burnt orange for secondary actions and hover states</li>\n            <li>Gray scale for text hierarchy</li>\n            <li>Maintain WCAG contrast ratios</li>\n        </ul>\n    </div>\n</body>\n</html>",
      "category": "Documentation",
      "tags": [
        "design",
        "colors",
        "branding"
      ],
      "created": "2025-06-25T00:00:00.000Z",
      "modified": "2025-06-25T00:00:00.000Z",
      "isPinned": false,
      "isArchived": false,
      "type": "html"
    },
    {
      "id": "note-4",
      "title": "Nishen's Skills Development and Knowledge Gained on the Job and in R&D",
      "content": "# Nishen's Skills Development and Knowledge Gained on the Job and in R&D\n\n## Project Portfolio & Technical Skills\n\n### üöÄ Nishen's AI Workspace (July 2025 - Ongoing)\n**Status**: Production Ready | **Time Invested**: 17.5+ hours | **Category**: Full-Stack Web/Desktop Application\n\n#### Technologies Mastered:\n- **Frontend**: React 18.2.0, Next.js 14.2.5, TypeScript, Tailwind CSS\n- **Desktop**: Electron (cross-platform Windows/macOS/Linux)\n- **State Management**: React Context API, localStorage persistence\n- **UI/UX**: Dynamic theming system, responsive design, accessibility (WCAG)\n- **Build Tools**: npm, webpack, electron-builder\n- **Development**: VS Code, ESLint, Hot reload, TypeScript strict mode\n\n#### Architecture Patterns Learned:\n- **Single-page workspace architecture** with state-based routing\n- **Component composition** with conditional rendering\n- **CSS custom properties** for dynamic theming\n- **Hydration-safe rendering** for SSR/CSR compatibility\n- **Systematic error handling** and dependency management\n- **Minimal dependency approach** for stability\n- **Production build optimization** and static export configuration\n\n#### Advanced Features Implemented:\n- **Real-time settings system** with 6 configuration categories\n- **Multi-format file preview** (HTML/Markdown rendering)\n- **Terminal simulation** with command history and Claude integration\n- **Note-taking system** with categories, search, tags, pin/unpin functionality\n- **Professional prompt engineering database** with usage tracking\n- **20+ system administration tools** with monitoring simulation\n- **Cross-platform desktop packaging** with native menu integration\n\n#### Key Problem-Solving Skills Developed:\n- **Systematic debugging methodology** using scanning approaches\n- **Production deployment troubleshooting** (Electron static export issues)\n- **TypeScript error resolution** with proper type casting\n- **CSS architecture design** for maintainable theming systems\n- **Performance optimization** for smooth user experience\n- **Version control management** with meaningful commit messages\n\n### üõ†Ô∏è Development Environment Expertise\n\n#### Platforms Mastered:\n- **Ubuntu Linux** (WSL2 on Windows) - Primary development environment\n- **Windows PowerShell** - Cross-platform scripting and terminal management\n- **VS Code** - Advanced configuration, extensions, integrated terminal usage\n- **Git** - Version control, branching strategies, commit message standards\n\n#### Command Line Proficiency:\n- **Node.js/npm** - Package management, script automation, dependency resolution\n- **Bash/PowerShell** - File system operations, process management, environment setup\n- **Build tools** - npm scripts, webpack configuration, production optimization\n- **System administration** - Process monitoring, resource management, troubleshooting\n\n### üìä Technical Documentation & Project Management\n\n#### Skills Developed:\n- **Comprehensive time tracking** with detailed session logs\n- **Technical documentation** writing (README files, API docs, user guides)\n- **Project planning** with phase-based development approaches\n- **Code review methodologies** and systematic testing approaches\n- **Backup and recovery procedures** with versioned snapshots\n- **Performance monitoring** and resource optimization\n\n#### Professional Development Practices:\n- **Agile methodology** application in solo development\n- **Test-driven development** mindset for reliability\n- **Security-first approach** in authentication and data handling\n- **User experience design** with accessibility considerations\n- **Cross-browser compatibility** testing and optimization\n\n### üéØ Current Expertise Level Assessment\n\n#### Advanced Skills:\n- React/Next.js full-stack development\n- TypeScript advanced type system usage\n- Electron desktop application development\n- CSS architecture and dynamic theming\n- Component-based UI design patterns\n\n#### Intermediate Skills:\n- System administration and monitoring\n- Build tool configuration and optimization\n- Cross-platform development considerations\n- Performance profiling and optimization\n- API design and integration patterns\n\n#### Growing Skills:\n- Advanced Node.js backend development\n- Database design and management\n- DevOps and CI/CD pipeline setup\n- Cloud deployment and scaling\n- Advanced security implementation\n\n### üìà Learning & Development Goals\n\n#### Short-term (Next 30 days):\n- Real Claude AI API integration with streaming responses\n- Advanced terminal emulation with multiple shell support\n- File system integration for real file operations\n- Performance optimization and memory management\n\n#### Medium-term (Next 90 days):\n- Backend API development with authentication\n- Database integration (PostgreSQL/MongoDB)\n- Real-time collaboration features\n- Advanced DevOps and deployment automation\n\n#### Long-term (Next 6 months):\n- Cloud-native architecture design\n- Microservices development patterns\n- Advanced security and compliance implementation\n- Team leadership and code review processes\n\n---\n\n**Last Updated**: July 12, 2025  \n**Auto-Update Schedule**: Every 2 days  \n**Total Projects Completed**: 1 major (Nishen's AI Workspace)  \n**Total Development Hours**: 17.5+ hours  \n**Current Focus**: Real-time features and Claude AI integration",
      "category": "Personal",
      "tags": [
        "skills",
        "development",
        "career",
        "projects",
        "learning"
      ],
      "created": "2025-07-12T00:00:00.000Z",
      "modified": "2025-07-12T00:00:00.000Z",
      "isPinned": true,
      "isArchived": false,
      "type": "markdown"
    }
  ],
  "nishen-workspace-prompt-categories": [
    {
      "id": "cat-1",
      "name": "System Prompts",
      "color": "#ff073a",
      "count": 1,
      "description": "Core system instructions and personas"
    },
    {
      "id": "cat-2",
      "name": "Code Generation",
      "color": "#cc5500",
      "count": 3,
      "description": "Programming and development prompts"
    },
    {
      "id": "cat-3",
      "name": "Analysis & Research",
      "color": "#0ea5e9",
      "count": 0,
      "description": "Data analysis and research assistance"
    },
    {
      "id": "cat-4",
      "name": "Creative Writing",
      "color": "#10b981",
      "count": 1,
      "description": "Content creation and storytelling"
    },
    {
      "id": "cat-5",
      "name": "Problem Solving",
      "color": "#8b5cf6",
      "count": 1,
      "description": "Troubleshooting and solution design"
    },
    {
      "id": "cat-6",
      "name": "Documentation",
      "color": "#f59e0b",
      "count": 1,
      "description": "Technical writing and documentation"
    }
  ]
}